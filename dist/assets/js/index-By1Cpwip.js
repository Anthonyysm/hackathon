var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertyNames,r=Object.getOwnPropertySymbols,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=Reflect.get,c=(t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,u=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&c(e,n,t[n]);if(r)for(var n of r(t))o.call(t,n)&&c(e,n,t[n]);return e},d=(e,s)=>t(e,n(s)),h=(e,t)=>{var n={};for(var s in e)a.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&r)for(var s of r(e))t.indexOf(s)<0&&o.call(e,s)&&(n[s]=e[s]);return n},m=(e,t,n)=>l(i(e),n,t),p=(e,t,n)=>new Promise((s,r)=>{var i=e=>{try{o(n.next(e))}catch(t){r(t)}},a=e=>{try{o(n.throw(e))}catch(t){r(t)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,a);o((n=n.apply(e,t)).next())});import{r as f,a as g,R as x}from"./vendor-DtX1tuCI.js";import{M as b,L as v,a as y,H as w,A as N,U as j,S as C,b as _,c as k,d as E,e as S,B as I,f as T,g as A,E as R,h as D,i as P,C as L,P as O,j as M,I as U,k as F,X as V,l as $,F as z,m as B,n as q,o as G,p as H,q as W,r as K,s as Q,T as J,t as X,u as Y,v as Z,w as ee,x as te,y as ne,z as se,D as re,G as ie,J as ae,K as oe,N as le,O as ce,R as ue,Q as de,V as he,W as me,Y as pe,Z as fe,_ as ge,$ as xe,a0 as be,a1 as ve,a2 as ye,a3 as we,a4 as Ne,a5 as je,a6 as Ce,a7 as _e,a8 as ke,a9 as Ee,aa as Se,ab as Ie}from"./icons-CyGBhB-4.js";var Te,Ae,Re=(Te={"assets/js/index-By1Cpwip.js"(e){!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var t={exports:{}},n={},s=f,r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var s,i={},c=null,u=null;for(s in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,s)&&!l.hasOwnProperty(s)&&(i[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===i[s]&&(i[s]=t[s]);return{$$typeof:r,type:e,key:c,ref:u,props:i,_owner:o.current}}n.Fragment=i,n.jsx=c,n.jsxs=c,t.exports=n;var Te,Ae=t.exports,Re=g;Te=Re.createRoot,Re.hydrateRoot;
/**
     * react-router v7.8.2
     *
     * Copyright (c) Remix Software Inc.
     *
     * This source code is licensed under the MIT license found in the
     * LICENSE.md file in the root directory of this source tree.
     *
     * @license MIT
     */
var De="popstate";function Pe(e={}){return function(e,t,n,s={}){let{window:r=document.defaultView,v5Compat:i=!1}=s,a=r.history,o="POP",l=null,c=h();function h(){return(a.state||{idx:null}).idx}function m(){o="POP";let e=h(),t=null==e?null:e-c;c=e,l&&l({action:o,location:x.location,delta:t})}function p(e,t){o="PUSH";let n=Ue(x.location,e,t);c=h()+1;let s=Me(n,c),u=x.createHref(n);try{a.pushState(s,"",u)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;r.location.assign(u)}i&&l&&l({action:o,location:x.location,delta:1})}function f(e,t){o="REPLACE";let n=Ue(x.location,e,t);c=h();let s=Me(n,c),r=x.createHref(n);a.replaceState(s,"",r),i&&l&&l({action:o,location:x.location,delta:0})}function g(e){return function(e,t=!1){let n="http://localhost";"undefined"!=typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),Le(n,"No window.location.(origin|href) available to create URL");let s="string"==typeof e?e:Fe(e);return s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=n+s),new URL(s,n)}(e)}null==c&&(c=0,a.replaceState(d(u({},a.state),{idx:c}),""));let x={get action(){return o},get location(){return e(r,a)},listen(e){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(De,m),l=e,()=>{r.removeEventListener(De,m),l=null}},createHref:e=>t(r,e),createURL:g,encodeLocation(e){let t=g(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:p,replace:f,go:e=>a.go(e)};return x}(function(e,t){let{pathname:n,search:s,hash:r}=e.location;return Ue("",{pathname:n,search:s,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:Fe(t)},0,e)}function Le(e,t){if(!1===e||null==e)throw new Error(t)}function Oe(e,t){if(!e)try{throw new Error(t)}catch(n){}}function Me(e,t){return{usr:e.state,key:e.key,idx:t}}function Ue(e,t,n=null,s){return d(u({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?Ve(t):t),{state:n,key:t&&t.key||s||Math.random().toString(36).substring(2,10)})}function Fe({pathname:e="/",search:t="",hash:n=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),n&&"#"!==n&&(e+="#"===n.charAt(0)?n:"#"+n),e}function Ve(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function $e(e,t,n="/"){return function(e,t,n,s){let r="string"==typeof t?Ve(t):t,i=Je(r.pathname||"/",n);if(null==i)return null;let a=ze(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(a);let o=null;for(let l=0;null==o&&l<a.length;++l){let e=Qe(i);o=We(a[l],e,s)}return o}(e,t,n,!1)}function ze(e,t=[],n=[],s="",r=!1){let i=(e,i,a=r,o)=>{let l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(s)&&a)return;Le(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length)}let c=et([s,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(Le(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),ze(e.children,t,u,c,a)),(null!=e.path||e.index)&&t.push({path:c,score:He(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&(null==(n=e.path)?void 0:n.includes("?")))for(let s of Be(e.path))i(e,t,!0,s);else i(e,t)}),t}function Be(e){let t=e.split("/");if(0===t.length)return[];let[n,...s]=t,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===s.length)return r?[i,""]:[i];let a=Be(s.join("/")),o=[];return o.push(...a.map(e=>""===e?i:[i,e].join("/"))),r&&o.push(...a),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var qe=/^:[\w-]+$/,Ge=e=>"*"===e;function He(e,t){let n=e.split("/"),s=n.length;return n.some(Ge)&&(s+=-2),t&&(s+=2),n.filter(e=>!Ge(e)).reduce((e,t)=>e+(qe.test(t)?3:""===t?1:10),s)}function We(e,t,n=!1){let{routesMeta:s}=e,r={},i="/",a=[];for(let o=0;o<s.length;++o){let e=s[o],l=o===s.length-1,c="/"===i?t:t.slice(i.length)||"/",u=Ke({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!s[s.length-1].route.index&&(u=Ke({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),a.push({params:r,pathname:et([i,u.pathname]),pathnameBase:tt(et([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=et([i,u.pathnameBase]))}return a}function Ke(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,s]=function(e,t=!1,n=!0){Oe("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(s.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");e.endsWith("*")?(s.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let i=new RegExp(r,t?void 0:"i");return[i,s]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let i=r[0],a=i.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:s.reduce((e,{paramName:t,isOptional:n},s)=>{if("*"===t){let e=o[s]||"";a=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const r=o[s];return e[t]=n&&!r?void 0:(r||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:a,pattern:e}}function Qe(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return Oe(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Je(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,s=e.charAt(n);return s&&"/"!==s?null:e.slice(n)||"/"}function Xe(e,t,n,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Ye(e){let t=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function Ze(e,t,n,s=!1){let r;"string"==typeof e?r=Ve(e):(r=u({},e),Le(!r.pathname||!r.pathname.includes("?"),Xe("?","pathname","search",r)),Le(!r.pathname||!r.pathname.includes("#"),Xe("#","pathname","hash",r)),Le(!r.search||!r.search.includes("#"),Xe("#","search","hash",r)));let i,a=""===e||""===r.pathname,o=a?"/":r.pathname;if(null==o)i=n;else{let e=t.length-1;if(!s&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=function(e,t="/"){let{pathname:n,search:s="",hash:r=""}="string"==typeof e?Ve(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:nt(s),hash:st(r)}}(r,i),c=o&&"/"!==o&&o.endsWith("/"),d=(a||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!d||(l.pathname+="/"),l}var et=e=>e.join("/").replace(/\/\/+/g,"/"),tt=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),nt=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",st=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"",rt=["POST","PUT","PATCH","DELETE"];new Set(rt);var it=["GET",...rt];new Set(it);var at=f.createContext(null);at.displayName="DataRouter";var ot=f.createContext(null);ot.displayName="DataRouterState",f.createContext(!1);var lt=f.createContext({isTransitioning:!1});lt.displayName="ViewTransition",f.createContext(new Map).displayName="Fetchers",f.createContext(null).displayName="Await";var ct=f.createContext(null);ct.displayName="Navigation";var ut=f.createContext(null);ut.displayName="Location";var dt=f.createContext({outlet:null,matches:[],isDataRoute:!1});dt.displayName="Route";var ht=f.createContext(null);function mt(){return null!=f.useContext(ut)}function pt(){return Le(mt(),"useLocation() may be used only in the context of a <Router> component."),f.useContext(ut).location}ht.displayName="RouteError";var ft="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function gt(e){f.useContext(ct).static||f.useLayoutEffect(e)}function xt(){let{isDataRoute:e}=f.useContext(dt);return e?function(){let{router:e}=function(e){let t=f.useContext(at);return Le(t,_t(e)),t}("useNavigate"),t=kt("useNavigate"),n=f.useRef(!1);return gt(()=>{n.current=!0}),f.useCallback((s,...r)=>p(this,[s,...r],function*(s,r={}){Oe(n.current,ft),n.current&&("number"==typeof s?e.navigate(s):yield e.navigate(s,u({fromRouteId:t},r)))}),[e,t])}():function(){Le(mt(),"useNavigate() may be used only in the context of a <Router> component.");let e=f.useContext(at),{basename:t,navigator:n}=f.useContext(ct),{matches:s}=f.useContext(dt),{pathname:r}=pt(),i=JSON.stringify(Ye(s)),a=f.useRef(!1);return gt(()=>{a.current=!0}),f.useCallback((s,o={})=>{if(Oe(a.current,ft),!a.current)return;if("number"==typeof s)return void n.go(s);let l=Ze(s,JSON.parse(i),r,"path"===o.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:et([t,l.pathname])),(o.replace?n.replace:n.push)(l,o.state,o)},[t,n,i,r,e])}()}function bt(){let{matches:e}=f.useContext(dt),t=e[e.length-1];return t?t.params:{}}function vt(e,{relative:t}={}){let{matches:n}=f.useContext(dt),{pathname:s}=pt(),r=JSON.stringify(Ye(n));return f.useMemo(()=>Ze(e,JSON.parse(r),s,"path"===t),[e,r,s,t])}function yt(e,t,n,s,r){var i;Le(mt(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=f.useContext(ct),{matches:o}=f.useContext(dt),l=o[o.length-1],c=l?l.params:{},d=l?l.pathname:"/",h=l?l.pathnameBase:"/",m=l&&l.route;{let e=m&&m.path||"";St(d,!m||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let p,g=pt();if(t){let e="string"==typeof t?Ve(t):t;Le("/"===h||(null==(i=e.pathname)?void 0:i.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${e.pathname}" was given in the \`location\` prop.`),p=e}else p=g;let x=p.pathname||"/",b=x;if("/"!==h){let e=h.replace(/^\//,"").split("/");b="/"+x.replace(/^\//,"").split("/").slice(e.length).join("/")}let v=$e(e,{pathname:b});Oe(m||null!=v,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Oe(null==v||void 0!==v[v.length-1].route.element||void 0!==v[v.length-1].route.Component||void 0!==v[v.length-1].route.lazy,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let y=function(e,t=[],n=null,s=null){if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let r=e,i=null==n?void 0:n.errors;if(null!=i){let e=r.findIndex(e=>e.route.id&&void 0!==(null==i?void 0:i[e.route.id]));Le(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),r=r.slice(0,Math.min(r.length,e+1))}let a=!1,o=-1;if(n)for(let l=0;l<r.length;l++){let e=r[l];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(o=l),e.route.id){let{loaderData:t,errors:s}=n,i=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!s||void 0===s[e.route.id]);if(e.route.lazy||i){a=!0,r=o>=0?r.slice(0,o+1):[r[0]];break}}}return r.reduceRight((e,l,c)=>{let u,d=!1,h=null,m=null;n&&(u=i&&l.route.id?i[l.route.id]:void 0,h=l.route.errorElement||Nt,a&&(o<0&&0===c?(St("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,m=null):o===c&&(d=!0,m=l.route.hydrateFallbackElement||null)));let p=t.concat(r.slice(0,c+1)),g=()=>{let t;return t=u?h:d?m:l.route.Component?f.createElement(l.route.Component,null):l.route.element?l.route.element:e,f.createElement(Ct,{match:l,routeContext:{outlet:e,matches:p,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?f.createElement(jt,{location:n.location,revalidation:n.revalidation,component:h,error:u,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0},unstable_onError:s}):g()},null)}(v&&v.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:et([h,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:et([h,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,n,s);return t&&y?f.createElement(ut.Provider,{value:{location:u({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:"POP"}},y):y}function wt(){let e=function(){var e;let t=f.useContext(ht),n=function(e){let t=f.useContext(ot);return Le(t,_t(e)),t}("useRouteError"),s=kt("useRouteError");return void 0!==t?t:null==(e=n.errors)?void 0:e[s]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},i={padding:"2px 4px",backgroundColor:s},a=null;return a=f.createElement(f.Fragment,null,f.createElement("p",null,"💿 Hey developer 👋"),f.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",f.createElement("code",{style:i},"ErrorBoundary")," or"," ",f.createElement("code",{style:i},"errorElement")," prop on your route.")),f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},t),n?f.createElement("pre",{style:r},n):null,a)}f.createContext(null);var Nt=f.createElement(wt,null),jt=class extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError&&this.props.unstable_onError(e,t)}render(){return void 0!==this.state.error?f.createElement(dt.Provider,{value:this.props.routeContext},f.createElement(ht.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ct({routeContext:e,match:t,children:n}){let s=f.useContext(at);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),f.createElement(dt.Provider,{value:e},n)}function _t(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kt(e){let t=function(e){let t=f.useContext(dt);return Le(t,_t(e)),t}(e),n=t.matches[t.matches.length-1];return Le(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}var Et={};function St(e,t,n){t||Et[e]||(Et[e]=!0,Oe(!1,n))}function It({to:e,replace:t,state:n,relative:s}){Le(mt(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=f.useContext(ct);Oe(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=f.useContext(dt),{pathname:a}=pt(),o=xt(),l=Ze(e,Ye(i),a,"path"===s),c=JSON.stringify(l);return f.useEffect(()=>{o(JSON.parse(c),{replace:t,state:n,relative:s})},[o,c,s,t,n]),null}function Tt(e){Le(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function At({basename:e="/",children:t=null,location:n,navigationType:s="POP",navigator:r,static:i=!1}){Le(!mt(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=e.replace(/^\/*/,"/"),o=f.useMemo(()=>({basename:a,navigator:r,static:i,future:{}}),[a,r,i]);"string"==typeof n&&(n=Ve(n));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:h="default"}=n,m=f.useMemo(()=>{let e=Je(l,a);return null==e?null:{location:{pathname:e,search:c,hash:u,state:d,key:h},navigationType:s}},[a,l,c,u,d,h,s]);return Oe(null!=m,`<Router basename="${a}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),null==m?null:f.createElement(ct.Provider,{value:o},f.createElement(ut.Provider,{children:t,value:m}))}function Rt({children:e,location:t}){return yt(Dt(e),t)}function Dt(e,t=[]){let n=[];return f.Children.forEach(e,(e,s)=>{if(!f.isValidElement(e))return;let r=[...t,s];if(e.type===f.Fragment)return void n.push.apply(n,Dt(e.props.children,r));Le(e.type===Tt,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Le(!e.props.index||!e.props.children,"An index route cannot have child routes.");let i={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Dt(e.props.children,r)),n.push(i)}),n}f.memo(function({routes:e,future:t,state:n,unstable_onError:s}){return yt(e,void 0,n,s,t)});var Pt="get",Lt="application/x-www-form-urlencoded";function Ot(e){return null!=e&&"string"==typeof e.tagName}var Mt=null,Ut=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ft(e){return null==e||Ut.has(e)?e:(Oe(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Lt}"`),null)}function Vt(e,t){let n,s,r,i,a;if(Ot(o=e)&&"form"===o.tagName.toLowerCase()){let a=e.getAttribute("action");s=a?Je(a,t):null,n=e.getAttribute("method")||Pt,r=Ft(e.getAttribute("enctype"))||Lt,i=new FormData(e)}else if(function(e){return Ot(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Ot(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||a.getAttribute("action");if(s=o?Je(o,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||Pt,r=Ft(e.getAttribute("formenctype"))||Ft(a.getAttribute("enctype"))||Lt,i=new FormData(a,e),!function(){if(null===Mt)try{new FormData(document.createElement("form"),0),Mt=!1}catch(e){Mt=!0}return Mt}()){let{name:t,type:n,value:s}=e;if("image"===n){let e=t?`${t}.`:"";i.append(`${e}x`,"0"),i.append(`${e}y`,"0")}else t&&i.append(t,s)}}else{if(Ot(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Pt,s=null,r=Lt,a=e}var o;return i&&"text/plain"===r&&(a=i,i=void 0),{action:s,method:n.toLowerCase(),encType:r,formData:i,body:a}}function $t(e,t){if(!1===e||null==e)throw new Error(t)}function zt(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function Bt(e,t,n){return p(this,null,function*(){return function(e,t){let n=new Set;return new Set(t),e.reduce((e,t)=>{let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let s of n)t[s]=e[s];return t}(t));return n.has(s)||(n.add(s),e.push({key:s,link:t})),e},[])}((yield Promise.all(e.map(e=>p(this,null,function*(){let s=t.routes[e.route.id];if(s){let e=yield function(e,t){return p(this,null,function*(){if(e.id in t)return t[e.id];try{let n=yield import(e.module);return t[e.id]=n,n}catch(n){return window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}})}(s,n);return e.links?e.links():[]}return[]})))).flat(1).filter(zt).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?d(u({},e),{rel:"prefetch",as:"style"}):d(u({},e),{rel:"prefetch"})))})}function qt(e,t,n,s,r,i){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var s;return n[t].pathname!==e.pathname||(null==(s=n[t].route.path)?void 0:s.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===i?t.filter((e,t)=>a(e,t)||o(e,t)):"data"===i?t.filter((t,i)=>{var l;let c=s.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(a(t,i)||o(t,i))return!0;if(t.route.shouldRevalidate){let s=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null==(l=n[0])?void 0:l.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof s)return s}return!0}):[]}function Gt(e,t,{includeHydrateFallback:n}={}){return s=e.map(e=>{let s=t.routes[e.route.id];if(!s)return[];let r=[s.module];return s.clientActionModule&&(r=r.concat(s.clientActionModule)),s.clientLoaderModule&&(r=r.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(r=r.concat(s.hydrateFallbackModule)),s.imports&&(r=r.concat(s.imports)),r}).flat(1),[...new Set(s)];var s}function Ht(){let e=f.useContext(at);return $t(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Wt=f.createContext(void 0);function Kt(){let e=f.useContext(Wt);return $t(e,"You must render this element inside a <HydratedRouter> element"),e}function Qt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function Jt(e){var t=e,{page:n}=t,s=h(t,["page"]);let{router:r}=Ht(),i=f.useMemo(()=>$e(r.routes,n,r.basename),[r.routes,n,r.basename]);return i?f.createElement(Xt,u({page:n,matches:i},s)):null}function Xt(e){var t=e,{page:n,matches:s}=t,r=h(t,["page","matches"]);let i=pt(),{manifest:a,routeModules:o}=Kt(),{basename:l}=Ht(),{loaderData:c,matches:d}=function(){let e=f.useContext(ot);return $t(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}(),m=f.useMemo(()=>qt(n,s,d,a,i,"data"),[n,s,d,a,i]),p=f.useMemo(()=>qt(n,s,d,a,i,"assets"),[n,s,d,a,i]),g=f.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let e=new Set,t=!1;if(s.forEach(n=>{var s;let r=a.routes[n.route.id];r&&r.hasLoader&&(!m.some(e=>e.route.id===n.route.id)&&n.route.id in c&&(null==(s=o[n.route.id])?void 0:s.shouldRevalidate)||r.hasClientLoader?t=!0:e.add(n.route.id))}),0===e.size)return[];let r=function(e,t,n){let s="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===s.pathname?s.pathname=`_root.${n}`:t&&"/"===Je(s.pathname,t)?s.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}(n,l,"data");return t&&e.size>0&&r.searchParams.set("_routes",s.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[r.pathname+r.search]},[l,c,i,a,m,s,n,o]),x=f.useMemo(()=>Gt(p,a),[p,a]),b=function(e){let{manifest:t,routeModules:n}=Kt(),[s,r]=f.useState([]);return f.useEffect(()=>{let s=!1;return Bt(e,t,n).then(e=>{s||r(e)}),()=>{s=!0}},[e,t,n]),s}(p);return f.createElement(f.Fragment,null,g.map(e=>f.createElement("link",u({key:e,rel:"prefetch",as:"fetch",href:e},r))),x.map(e=>f.createElement("link",u({key:e,rel:"modulepreload",href:e},r))),b.map(({key:e,link:t})=>f.createElement("link",u({key:e,nonce:r.nonce},t))))}function Yt(...e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}Wt.displayName="FrameworkContext";var Zt="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{Zt&&(window.__reactRouterVersion="7.8.2")}catch(Py){}function en({basename:e,children:t,window:n}){let s=f.useRef();null==s.current&&(s.current=Pe({window:n,v5Compat:!0}));let r=s.current,[i,a]=f.useState({action:r.action,location:r.location}),o=f.useCallback(e=>{f.startTransition(()=>a(e))},[a]);return f.useLayoutEffect(()=>r.listen(o),[r,o]),f.createElement(At,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:r})}var tn=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nn=f.forwardRef(function(e,t){var n=e,{onClick:s,discover:r="render",prefetch:i="none",relative:a,reloadDocument:o,replace:l,state:c,target:m,to:p,preventScrollReset:g,viewTransition:x}=n,b=h(n,["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"]);let v,{basename:y}=f.useContext(ct),w="string"==typeof p&&tn.test(p),N=!1;if("string"==typeof p&&w&&(v=p,Zt))try{let e=new URL(window.location.href),t=p.startsWith("//")?new URL(e.protocol+p):new URL(p),n=Je(t.pathname,y);t.origin===e.origin&&null!=n?p=n+t.search+t.hash:N=!0}catch(Py){Oe(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let j=function(e,{relative:t}={}){Le(mt(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=f.useContext(ct),{hash:r,pathname:i,search:a}=vt(e,{relative:t}),o=i;return"/"!==n&&(o="/"===i?n:et([n,i])),s.createHref({pathname:o,search:a,hash:r})}(p,{relative:a}),[C,_,k]=function(e,t){let n=f.useContext(Wt),[s,r]=f.useState(!1),[i,a]=f.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=t,h=f.useRef(null);f.useEffect(()=>{if("render"===e&&a(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{a(e.isIntersecting)})},{threshold:.5});return h.current&&e.observe(h.current),()=>{e.disconnect()}}},[e]),f.useEffect(()=>{if(s){let e=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(e)}}},[s]);let m=()=>{r(!0)},p=()=>{r(!1),a(!1)};return n?"intent"!==e?[i,h,{}]:[i,h,{onFocus:Qt(o,m),onBlur:Qt(l,p),onMouseEnter:Qt(c,m),onMouseLeave:Qt(u,p),onTouchStart:Qt(d,m)}]:[!1,h,{}]}(i,b),E=function(e,{target:t,replace:n,state:s,preventScrollReset:r,relative:i,viewTransition:a}={}){let o=xt(),l=pt(),c=vt(e,{relative:i});return f.useCallback(u=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(u,t)){u.preventDefault();let t=void 0!==n?n:Fe(l)===Fe(c);o(e,{replace:t,state:s,preventScrollReset:r,relative:i,viewTransition:a})}},[l,o,c,n,s,t,e,r,i,a])}(p,{replace:l,state:c,target:m,preventScrollReset:g,relative:a,viewTransition:x}),S=f.createElement("a",d(u(u({},b),k),{href:v||j,onClick:N||o?s:function(e){s&&s(e),e.defaultPrevented||E(e)},ref:Yt(t,_),target:m,"data-discover":w||"render"!==r?void 0:"true"}));return C&&!w?f.createElement(f.Fragment,null,S,f.createElement(Jt,{page:j})):S});function sn(e){let t=f.useContext(at);return Le(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}nn.displayName="Link",f.forwardRef(function(e,t){var n=e,{"aria-current":s="page",caseSensitive:r=!1,className:i="",end:a=!1,style:o,to:l,viewTransition:c,children:m}=n,p=h(n,["aria-current","caseSensitive","className","end","style","to","viewTransition","children"]);let g=vt(l,{relative:p.relative}),x=pt(),b=f.useContext(ot),{navigator:v,basename:y}=f.useContext(ct),w=null!=b&&function(e,{relative:t}={}){let n=f.useContext(lt);Le(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=sn("useViewTransitionState"),r=vt(e,{relative:t});if(!n.isTransitioning)return!1;let i=Je(n.currentLocation.pathname,s)||n.currentLocation.pathname,a=Je(n.nextLocation.pathname,s)||n.nextLocation.pathname;return null!=Ke(r.pathname,a)||null!=Ke(r.pathname,i)}(g)&&!0===c,N=v.encodeLocation?v.encodeLocation(g).pathname:g.pathname,j=x.pathname,C=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;r||(j=j.toLowerCase(),C=C?C.toLowerCase():null,N=N.toLowerCase()),C&&y&&(C=Je(C,y)||C);const _="/"!==N&&N.endsWith("/")?N.length-1:N.length;let k,E=j===N||!a&&j.startsWith(N)&&"/"===j.charAt(_),S=null!=C&&(C===N||!a&&C.startsWith(N)&&"/"===C.charAt(N.length)),I={isActive:E,isPending:S,isTransitioning:w},T=E?s:void 0;k="function"==typeof i?i(I):[i,E?"active":null,S?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let A="function"==typeof o?o(I):o;return f.createElement(nn,d(u({},p),{"aria-current":T,className:k,ref:t,style:A,to:l,viewTransition:c}),"function"==typeof m?m(I):m)}).displayName="NavLink",f.forwardRef((e,t)=>{var n=e,{discover:s="render",fetcherKey:r,navigate:i,reloadDocument:a,replace:o,state:l,method:c=Pt,action:m,onSubmit:g,relative:x,preventScrollReset:b,viewTransition:v}=n,y=h(n,["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"]);let w=function(){let{router:e}=sn("useSubmit"),{basename:t}=f.useContext(ct),n=kt("useRouteId");return f.useCallback((s,...r)=>p(this,[s,...r],function*(s,r={}){let{action:i,method:a,encType:o,formData:l,body:c}=Vt(s,t);if(!1===r.navigate){let t=r.fetcherKey||`__${String(++rn)}__`;yield e.fetch(t,n,r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||a,formEncType:r.encType||o,flushSync:r.flushSync})}else yield e.navigate(r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||a,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})}),[e,t,n])}(),N=function(e,{relative:t}={}){let{basename:n}=f.useContext(ct),s=f.useContext(dt);Le(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),i=u({},vt(e||".",{relative:t})),a=pt();if(null==e){i.search=a.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();i.search=n?`?${n}`:""}}return e&&"."!==e||!r.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),"/"!==n&&(i.pathname="/"===i.pathname?n:et([n,i.pathname])),Fe(i)}(m,{relative:x}),j="get"===c.toLowerCase()?"get":"post",C="string"==typeof m&&tn.test(m);return f.createElement("form",d(u({ref:t,method:j,action:N,onSubmit:a?g:e=>{if(g&&g(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null==t?void 0:t.getAttribute("formmethod"))||c;w(t||e.currentTarget,{fetcherKey:r,method:n,navigate:i,replace:o,state:l,relative:x,preventScrollReset:b,viewTransition:v})}},y),{"data-discover":C||"render"!==s?void 0:"true"}))}).displayName="Form";var rn=0,an={};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const on=function(e){const t=[];let n=0;for(let s=0;s<e.length;s++){let r=e.charCodeAt(s);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&s+1<e.length&&56320==(64512&e.charCodeAt(s+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++s)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},ln={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<e.length;r+=3){const t=e[r],i=r+1<e.length,a=i?e[r+1]:0,o=r+2<e.length,l=o?e[r+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,i||(d=64)),s.push(n[c],n[u],n[d],n[h])}return s.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(on(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,s=0;for(;n<e.length;){const r=e[n++];if(r<128)t[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=e[n++];t[s++]=String.fromCharCode((31&r)<<6|63&i)}else if(r>239&&r<365){const i=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[s++]=String.fromCharCode(55296+(i>>10)),t[s++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],a=e[n++];t[s++]=String.fromCharCode((15&r)<<12|(63&i)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],i=r<e.length?n[e.charAt(r)]:0;++r;const a=r<e.length?n[e.charAt(r)]:64;++r;const o=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==i||null==a||null==o)throw new cn;const l=t<<2|i>>4;if(s.push(l),64!==a){const e=i<<4&240|a>>2;if(s.push(e),64!==o){const e=a<<6&192|o;s.push(e)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class cn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const un=function(e){return function(e){const t=on(e);return ln.encodeByteArray(t,!0)}(e).replace(/\./g,"")},dn=function(e){try{return ln.decodeString(e,!0)}catch(Py){}return null},hn=()=>
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */().__FIREBASE_DEFAULTS__,mn=()=>{try{return hn()||(()=>{if("undefined"==typeof process)return;const e=an.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Py){return}const t=e&&dn(e[1]);return t&&JSON.parse(t)})()}catch(Py){return}},pn=e=>{var t,n;return null==(n=null==(t=mn())?void 0:t.emulatorHosts)?void 0:n[e]},fn=e=>{const t=pn(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const s=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),s]:[t.substring(0,n),s]},gn=()=>{var e;return null==(e=mn())?void 0:e.config},xn=e=>{var t;return null==(t=mn())?void 0:t[`_${e}`]};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class bn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}
/**
     * @license
     * Copyright 2025 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vn(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(Py){return!1}}function yn(e){return p(this,null,function*(){return(yield fetch(e,{credentials:"include"})).ok})}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function wn(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",s=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=u({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[un(JSON.stringify({alg:"none",type:"JWT"})),un(JSON.stringify(i)),""].join(".")}const Nn={};let jn=!1;function Cn(e,t){if("undefined"==typeof window||"undefined"==typeof document||!vn(window.location.host)||Nn[e]===t||Nn[e]||jn)return;function n(e){return`__firebase__banner__${e}`}Nn[e]=t;const s="__firebase__banner",r=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(Nn))Nn[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{jn=!0,function(){const e=document.getElementById(s);e&&e.remove()}()},e}function a(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(s),t=n("text"),a=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=i();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,a,l,n),document.body.appendChild(t)}r?(a.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',a.innerText="Preview backend running in this workspace."),a.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _n(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function kn(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function En(){return!function(){var e;const t=null==(e=mn())?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(Py){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Sn(){try{return"object"==typeof indexedDB}catch(Py){return!1}}function In(){return new Promise((e,t)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null==(e=r.error)?void 0:e.message)||"")}}catch(n){t(n)}})}class Tn extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Tn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,An.prototype.create)}}class An{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(Rn,(e,n)=>{const s=t[n];return null!=s?String(s):`<${n}?>`})}(r,n):"Error",a=`${this.serviceName}: ${i} (${s}).`;return new Tn(s,a,n)}}const Rn=/\{\$([^}]+)}/g;function Dn(e,t){if(e===t)return!0;const n=Object.keys(e),s=Object.keys(t);for(const r of n){if(!s.includes(r))return!1;const n=e[r],i=t[r];if(Pn(n)&&Pn(i)){if(!Dn(n,i))return!1}else if(n!==i)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function Pn(e){return null!==e&&"object"==typeof e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ln(e){const t=[];for(const[n,s]of Object.entries(e))Array.isArray(s)?s.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return t.length?"&"+t.join("&"):""}function On(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,s]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(s)}}),t}function Mn(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Un{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");s=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===s.next&&(s.next=Fn),void 0===s.error&&(s.error=Fn),void 0===s.complete&&(s.complete=Fn);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch(Py){}}),this.observers.push(s),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(Py){"undefined"!=typeof console&&console.error}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Fn(){}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Vn(e,t=1e3,n=2){const s=t*Math.pow(n,e),r=Math.round(.5*s*(Math.random()-.5)*2);return Math.min(144e5,s+r)}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $n(e){return e&&e._delegate?e._delegate:e}class zn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Bn="[DEFAULT]";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class qn{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new bn;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(Py){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),s=null!=(t=null==e?void 0:e.optional)&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(Py){if(s)return null;throw Py}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e))try{this.getOrInitializeService({instanceIdentifier:Bn})}catch(Py){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(Py){}}}}clearInstance(e=Bn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return p(this,null,function*(){const e=Array.from(this.instances.values());yield Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])})}isComponentSet(){return null!=this.component}isInitialized(e=Bn){return this.instances.has(e)}getOptions(e=Bn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,i]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(r)&&i.resolve(s);return s}onInit(e,t){var n;const s=this.normalizeInstanceIdentifier(t),r=null!=(n=this.onInitCallbacks.get(s))?n:new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch(Py){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(s=e,s===Bn?void 0:s),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(Py){}var s;return n||null}normalizeInstanceIdentifier(e=Bn){return this.component?this.component.multipleInstances?e:Bn:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Gn{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new qn(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Hn,Wn;(Wn=Hn||(Hn={}))[Wn.DEBUG=0]="DEBUG",Wn[Wn.VERBOSE=1]="VERBOSE",Wn[Wn.INFO=2]="INFO",Wn[Wn.WARN=3]="WARN",Wn[Wn.ERROR=4]="ERROR",Wn[Wn.SILENT=5]="SILENT";const Kn={debug:Hn.DEBUG,verbose:Hn.VERBOSE,info:Hn.INFO,warn:Hn.WARN,error:Hn.ERROR,silent:Hn.SILENT},Qn=Hn.INFO,Jn={[Hn.DEBUG]:"log",[Hn.VERBOSE]:"log",[Hn.INFO]:"info",[Hn.WARN]:"warn",[Hn.ERROR]:"error"},Xn=(e,t,...n)=>{if(!(t<e.logLevel||((new Date).toISOString(),Jn[t])))throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Yn{constructor(e){this.name=e,this._logLevel=Qn,this._logHandler=Xn,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Hn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Kn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Hn.DEBUG,...e),this._logHandler(this,Hn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Hn.VERBOSE,...e),this._logHandler(this,Hn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Hn.INFO,...e),this._logHandler(this,Hn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Hn.WARN,...e),this._logHandler(this,Hn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Hn.ERROR,...e),this._logHandler(this,Hn.ERROR,...e)}}let Zn,es;const ts=new WeakMap,ns=new WeakMap,ss=new WeakMap,rs=new WeakMap,is=new WeakMap;let as={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ns.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ss.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return cs(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function os(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(es||(es=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(us(this),t),cs(ts.get(this))}:function(...t){return cs(e.apply(us(this),t))}:function(t,...n){const s=e.call(us(this),t,...n);return ss.set(s,t.sort?t.sort():[t]),cs(s)}}function ls(e){return"function"==typeof e?os(e):(e instanceof IDBTransaction&&function(e){if(ns.has(e))return;const t=new Promise((t,n)=>{const s=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",i),e.removeEventListener("abort",i)},r=()=>{t(),s()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",r),e.addEventListener("error",i),e.addEventListener("abort",i)});ns.set(e,t)}(e),t=e,(Zn||(Zn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,as):e);var t}function cs(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const s=()=>{e.removeEventListener("success",r),e.removeEventListener("error",i)},r=()=>{t(cs(e.result)),s()},i=()=>{n(e.error),s()};e.addEventListener("success",r),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&ts.set(t,e)}).catch(()=>{}),is.set(t,e),t}(e);if(rs.has(e))return rs.get(e);const t=ls(e);return t!==e&&(rs.set(e,t),is.set(t,e)),t}const us=e=>is.get(e);function ds(e,t,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const a=indexedDB.open(e,t),o=cs(a);return s&&a.addEventListener("upgradeneeded",e=>{s(cs(a.result),e.oldVersion,e.newVersion,cs(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{i&&e.addEventListener("close",()=>i()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}const hs=["get","getKey","getAll","getAllKeys","count"],ms=["put","add","delete","clear"],ps=new Map;function fs(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(ps.get(t))return ps.get(t);const n=t.replace(/FromIndex$/,""),s=t!==n,r=ms.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!r&&!hs.includes(n))return;const i=function(e,...t){return p(this,null,function*(){const i=this.transaction(e,r?"readwrite":"readonly");let a=i.store;return s&&(a=a.index(t.shift())),(yield Promise.all([a[n](...t),r&&i.done]))[0]})};return ps.set(t,i),i}var gs;as=d(u({},gs=as),{get:(e,t,n)=>fs(e,t)||gs.get(e,t,n),has:(e,t)=>!!fs(e,t)||gs.has(e,t)});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class xs{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const bs="@firebase/app",vs="0.14.1",ys=new Yn("@firebase/app"),ws="@firebase/app-compat",Ns="@firebase/analytics-compat",js="@firebase/analytics",Cs="@firebase/app-check-compat",_s="@firebase/app-check",ks="@firebase/auth",Es="@firebase/auth-compat",Ss="@firebase/database",Is="@firebase/data-connect",Ts="@firebase/database-compat",As="@firebase/functions",Rs="@firebase/functions-compat",Ds="@firebase/installations",Ps="@firebase/installations-compat",Ls="@firebase/messaging",Os="@firebase/messaging-compat",Ms="@firebase/performance",Us="@firebase/performance-compat",Fs="@firebase/remote-config",Vs="@firebase/remote-config-compat",$s="@firebase/storage",zs="@firebase/storage-compat",Bs="@firebase/firestore",qs="@firebase/ai",Gs="@firebase/firestore-compat",Hs="firebase",Ws="[DEFAULT]",Ks={[bs]:"fire-core",[ws]:"fire-core-compat",[js]:"fire-analytics",[Ns]:"fire-analytics-compat",[_s]:"fire-app-check",[Cs]:"fire-app-check-compat",[ks]:"fire-auth",[Es]:"fire-auth-compat",[Ss]:"fire-rtdb",[Is]:"fire-data-connect",[Ts]:"fire-rtdb-compat",[As]:"fire-fn",[Rs]:"fire-fn-compat",[Ds]:"fire-iid",[Ps]:"fire-iid-compat",[Ls]:"fire-fcm",[Os]:"fire-fcm-compat",[Ms]:"fire-perf",[Us]:"fire-perf-compat",[Fs]:"fire-rc",[Vs]:"fire-rc-compat",[$s]:"fire-gcs",[zs]:"fire-gcs-compat",[Bs]:"fire-fst",[Gs]:"fire-fst-compat",[qs]:"fire-vertex","fire-js":"fire-js",[Hs]:"fire-js-all"},Qs=new Map,Js=new Map,Xs=new Map;function Ys(e,t){try{e.container.addComponent(t)}catch(Py){ys.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,Py)}}function Zs(e){const t=e.name;if(Xs.has(t))return ys.debug(`There were multiple attempts to register component ${t}.`),!1;Xs.set(t,e);for(const n of Qs.values())Ys(n,e);for(const n of Js.values())Ys(n,e);return!0}function er(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function tr(e){return null!=e&&void 0!==e.settings}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const nr=new An("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class sr{constructor(e,t,n){this._isDeleted=!1,this._options=u({},e),this._config=u({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new zn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw nr.create("app-deleted",{appName:this._name})}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const rr="12.1.0";function ir(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const s=u({name:Ws,automaticDataCollectionEnabled:!0},t),r=s.name;if("string"!=typeof r||!r)throw nr.create("bad-app-name",{appName:String(r)});if(n||(n=gn()),!n)throw nr.create("no-options");const i=Qs.get(r);if(i){if(Dn(n,i.options)&&Dn(s,i.config))return i;throw nr.create("duplicate-app",{appName:r})}const a=new Gn(r);for(const l of Xs.values())a.addComponent(l);const o=new sr(n,s,a);return Qs.set(r,o),o}function ar(e=Ws){const t=Qs.get(e);if(!t&&e===Ws&&gn())return ir();if(!t)throw nr.create("no-app",{appName:e});return t}function or(e,t,n){var s;let r=null!=(s=Ks[e])?s:e;n&&(r+=`-${n}`);const i=r.match(/\s|\//),a=t.match(/\s|\//);if(i||a){const e=[`Unable to register library "${r}" with version "${t}":`];return i&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ys.warn(e.join(" "))}Zs(new zn(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const lr="firebase-heartbeat-store";let cr=null;function ur(){return cr||(cr=ds("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(lr)}catch(Py){}}}).catch(e=>{throw nr.create("idb-open",{originalErrorMessage:e.message})})),cr}function dr(e,t){return p(this,null,function*(){try{const n=(yield ur()).transaction(lr,"readwrite"),s=n.objectStore(lr);yield s.put(t,hr(e)),yield n.done}catch(Py){if(Py instanceof Tn)ys.warn(Py.message);else{const t=nr.create("idb-set",{originalErrorMessage:null==Py?void 0:Py.message});ys.warn(t.message)}}})}function hr(e){return`${e.name}!${e.options.appId}`}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class mr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new fr(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}triggerHeartbeat(){return p(this,null,function*(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=pr();if(null==(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,null==(null==(t=this._heartbeatsCache)?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(e=>e.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let s=1;s<e.length;s++)e[s].date<n&&(n=e[s].date,t=s);return t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(Py){ys.warn(Py)}})}getHeartbeatsHeader(){return p(this,null,function*(){var e;try{if(null===this._heartbeatsCache&&(yield this._heartbeatsCachePromise),null==(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=pr(),{heartbeatsToSend:n,unsentEntries:s}=function(e,t=1024){const n=[];let s=e.slice();for(const r of e){const e=n.find(e=>e.agent===r.agent);if(e){if(e.dates.push(r.date),gr(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),gr(n)>t){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}(this._heartbeatsCache.heartbeats),r=un(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(Py){return ys.warn(Py),""}})}}function pr(){return(new Date).toISOString().substring(0,10)}class fr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return p(this,null,function*(){return!!Sn()&&In().then(()=>!0).catch(()=>!1)})}read(){return p(this,null,function*(){if(yield this._canUseIndexedDBPromise){const e=yield function(e){return p(this,null,function*(){try{const t=(yield ur()).transaction(lr),n=yield t.objectStore(lr).get(hr(e));return yield t.done,n}catch(Py){if(Py instanceof Tn)ys.warn(Py.message);else{const t=nr.create("idb-get",{originalErrorMessage:null==Py?void 0:Py.message});ys.warn(t.message)}}})}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}})}overwrite(e){return p(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){const n=yield this.read();return dr(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})}add(e){return p(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){const n=yield this.read();return dr(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}})}}function gr(e){return un(JSON.stringify({version:2,heartbeats:e})).length}var xr;xr="",Zs(new zn("platform-logger",e=>new xs(e),"PRIVATE")),Zs(new zn("heartbeat",e=>new mr(e),"PRIVATE")),or(bs,vs,xr),or(bs,vs,"esm2020"),or("fire-js",""),
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
or("firebase","12.1.0","app");const br="@firebase/installations",vr="0.6.19",yr=1e4,wr=`w:${vr}`,Nr="FIS_v2",jr=36e5,Cr=new An("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function _r(e){return e instanceof Tn&&e.code.includes("request-failed")}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kr({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function Er(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}function Sr(e,t){return p(this,null,function*(){const n=(yield t.json()).error;return Cr.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})})}function Ir({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Tr(e,{refreshToken:t}){const n=Ir(e);return n.append("Authorization",function(e){return`${Nr} ${e}`}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)),n}function Ar(e){return p(this,null,function*(){const t=yield e();return t.status>=500&&t.status<600?e():t})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Rr(e){return new Promise(t=>{setTimeout(t,e)})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Dr=/^[cdef][\w-]{21}$/;function Pr(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e);return Dr.test(t)?t:""}catch(Py){return""}}function Lr(e){return`${e.appName}!${e.appId}`}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Or=new Map;function Mr(e,t){const n=Lr(e);Ur(n,t),function(e,t){const n=(!Fr&&"BroadcastChannel"in self&&(Fr=new BroadcastChannel("[Firebase] FID Change"),Fr.onmessage=e=>{Ur(e.data.key,e.data.fid)}),Fr);n&&n.postMessage({key:e,fid:t}),0===Or.size&&Fr&&(Fr.close(),Fr=null)}(n,t)}function Ur(e,t){const n=Or.get(e);if(n)for(const s of n)s(t)}let Fr=null;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Vr="firebase-installations-store";let $r=null;function zr(){return $r||($r=ds("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Vr)}})),$r}function Br(e,t){return p(this,null,function*(){const n=Lr(e),s=(yield zr()).transaction(Vr,"readwrite"),r=s.objectStore(Vr),i=yield r.get(n);return yield r.put(t,n),yield s.done,i&&i.fid===t.fid||Mr(e,t.fid),t})}function qr(e){return p(this,null,function*(){const t=Lr(e),n=(yield zr()).transaction(Vr,"readwrite");yield n.objectStore(Vr).delete(t),yield n.done})}function Gr(e,t){return p(this,null,function*(){const n=Lr(e),s=(yield zr()).transaction(Vr,"readwrite"),r=s.objectStore(Vr),i=yield r.get(n),a=t(i);return void 0===a?yield r.delete(n):yield r.put(a,n),yield s.done,!a||i&&i.fid===a.fid||Mr(e,a.fid),a})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hr(e){return p(this,null,function*(){let t;const n=yield Gr(e.appConfig,n=>{const s=function(e){const t=e||{fid:Pr(),registrationStatus:0};return Qr(t)}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Cr.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},s=function(e,t){return p(this,null,function*(){try{const n=yield function(e,t){return p(this,arguments,function*({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const s=kr(e),r=Ir(e),i=t.getImmediate({optional:!0});if(i){const e=yield i.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const a={fid:n,authVersion:Nr,appId:e.appId,sdkVersion:wr},o={method:"POST",headers:r,body:JSON.stringify(a)},l=yield Ar(()=>fetch(s,o));if(l.ok){const e=yield l.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:Er(e.authToken)}}throw yield Sr("Create Installation",l)})}(e,t);return Br(e.appConfig,n)}catch(Py){throw _r(Py)&&409===Py.customData.serverCode?yield qr(e.appConfig):yield Br(e.appConfig,{fid:t.fid,registrationStatus:0}),Py}})}(e,n);return{installationEntry:n,registrationPromise:s}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Wr(e)}:{installationEntry:t}}(e,s);return t=r.registrationPromise,r.installationEntry});return""===n.fid?{installationEntry:yield t}:{installationEntry:n,registrationPromise:t}})}function Wr(e){return p(this,null,function*(){let t=yield Kr(e.appConfig);for(;1===t.registrationStatus;)yield Rr(100),t=yield Kr(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=yield Hr(e);return n||t}return t})}function Kr(e){return Gr(e,e=>{if(!e)throw Cr.create("installation-not-found");return Qr(e)})}function Qr(e){return 1===(t=e).registrationStatus&&t.registrationTime+yr<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}function Jr(e,t){return p(this,arguments,function*({appConfig:e,heartbeatServiceProvider:t},n){const s=function(e,{fid:t}){return`${kr(e)}/${t}/authTokens:generate`}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,n),r=Tr(e,n),i=t.getImmediate({optional:!0});if(i){const e=yield i.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const a={installation:{sdkVersion:wr,appId:e.appId}},o={method:"POST",headers:r,body:JSON.stringify(a)},l=yield Ar(()=>fetch(s,o));if(l.ok)return Er(yield l.json());throw yield Sr("Generate Auth Token",l)})}function Xr(e,t=!1){return p(this,null,function*(){let n;const s=yield Gr(e.appConfig,s=>{if(!Zr(s))throw Cr.create("not-registered");const r=s.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+jr}(e)}(r))return s;if(1===r.requestStatus)return n=function(e,t){return p(this,null,function*(){let n=yield Yr(e.appConfig);for(;1===n.authToken.requestStatus;)yield Rr(100),n=yield Yr(e.appConfig);const s=n.authToken;return 0===s.requestStatus?Xr(e,t):s})}(e,t),s;{if(!navigator.onLine)throw Cr.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return d(u({},e),{authToken:t})}(s);return n=function(e,t){return p(this,null,function*(){try{const n=yield Jr(e,t),s=d(u({},t),{authToken:n});return yield Br(e.appConfig,s),n}catch(Py){if(!_r(Py)||401!==Py.customData.serverCode&&404!==Py.customData.serverCode){const n=d(u({},t),{authToken:{requestStatus:0}});yield Br(e.appConfig,n)}else yield qr(e.appConfig);throw Py}})}(e,t),t}});return n?yield n:s.authToken})}function Yr(e){return Gr(e,e=>{if(!Zr(e))throw Cr.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+yr<Date.now()?d(u({},e),{authToken:{requestStatus:0}}):e;var n;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */})}function Zr(e){return void 0!==e&&2===e.registrationStatus}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function ei(e,t=!1){return p(this,null,function*(){const n=e;return yield function(e){return p(this,null,function*(){const{registrationPromise:t}=yield Hr(e);t&&(yield t)})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(n),(yield Xr(n,t)).token})}function ti(e){return Cr.create("missing-app-config-values",{valueName:e})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const ni="installations",si=e=>{const t=er(e.getProvider("app").getImmediate(),ni).getImmediate();return{getId:()=>function(e){return p(this,null,function*(){const t=e,{installationEntry:n,registrationPromise:s}=yield Hr(t);return s?s.catch(console.error):Xr(t).catch(console.error),n.fid})}(t),getToken:e=>ei(t,e)}};Zs(new zn(ni,e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw ti("App Configuration");if(!e.name)throw ti("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw ti(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:er(t,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),Zs(new zn("installations-internal",si,"PRIVATE")),or(br,vr),or(br,vr,"esm2020");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ri="analytics",ii="https://www.googletagmanager.com/gtag/js",ai=new Yn("@firebase/analytics"),oi=new An("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function li(e){if(!e.startsWith(ii)){const t=oi.create("invalid-gtag-resource",{gtagURL:e});return ai.warn(t.message),""}return e}function ci(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function ui(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:li}),s=document.createElement("script"),r=`${ii}?l=${e}&id=${t}`;s.src=n?null==n?void 0:n.createScriptURL(r):r,s.async=!0,document.head.appendChild(s)}function di(e,t,n,s){return function(r,...i){return p(this,null,function*(){try{if("event"===r){const[s,r]=i;yield function(e,t,n,s,r){return p(this,null,function*(){try{let i=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const s=yield ci(n);for(const n of e){const e=s.find(e=>e.measurementId===n),r=e&&t[e.appId];if(!r){i=[];break}i.push(r)}}0===i.length&&(i=Object.values(t)),yield Promise.all(i),e("event",s,r||{})}catch(Py){ai.error(Py)}})}(e,t,n,s,r)}else if("config"===r){const[r,a]=i;yield function(e,t,n,s,r,i){return p(this,null,function*(){const a=s[r];try{if(a)yield t[a];else{const e=(yield ci(n)).find(e=>e.measurementId===r);e&&(yield t[e.appId])}}catch(Py){ai.error(Py)}e("config",r,i)})}(e,t,n,s,r,a)}else if("consent"===r){const[t,n]=i;e("consent",t,n)}else if("get"===r){const[t,n,s]=i;e("get",t,n,s)}else if("set"===r){const[t]=i;e("set",t)}else e(r,...i)}catch(Py){ai.error(Py)}})}}const hi=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function mi(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function pi(e){return p(this,arguments,function*(e,t=hi,n){const{appId:s,apiKey:r,measurementId:i}=e.options;if(!s)throw oi.create("no-app-id");if(!r){if(i)return{measurementId:i,appId:s};throw oi.create("no-api-key")}const a=t.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new gi;return setTimeout(()=>p(this,null,function*(){o.abort()}),6e4),fi({appId:s,apiKey:r,measurementId:i},a,o,t)})}function fi(e,t,n){return p(this,arguments,function*(e,{throttleEndTimeMillis:t,backoffCount:n},s,r=hi){var i;const{appId:a,measurementId:o}=e;try{yield function(e,t){return new Promise((n,s)=>{const r=Math.max(t-Date.now(),0),i=setTimeout(n,r);e.addEventListener(()=>{clearTimeout(i),s(oi.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(s,t)}catch(Py){if(o)return ai.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==Py?void 0:Py.message}]`),{appId:a,measurementId:o};throw Py}try{const t=yield function(e){return p(this,null,function*(){var t;const{appId:n,apiKey:s}=e,r={method:"GET",headers:mi(s)},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),a=yield fetch(i,r);if(200!==a.status&&304!==a.status){let e="";try{const n=yield a.json();(null==(t=n.error)?void 0:t.message)&&(e=n.error.message)}catch(o){}throw oi.create("config-fetch-failed",{httpStatus:a.status,responseMessage:e})}return a.json()})}(e);return r.deleteThrottleMetadata(a),t}catch(Py){const l=Py;if(!function(e){if(!(e instanceof Tn&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(l)){if(r.deleteThrottleMetadata(a),o)return ai.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==l?void 0:l.message}]`),{appId:a,measurementId:o};throw Py}const c=503===Number(null==(i=null==l?void 0:l.customData)?void 0:i.httpStatus)?Vn(n,r.intervalMillis,30):Vn(n,r.intervalMillis),u={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return r.setThrottleMetadata(a,u),ai.debug(`Calling attemptFetch again in ${c} millis`),fi(e,u,s,r)}})}class gi{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}function xi(e,t,n,s,r,i,a){return p(this,null,function*(){var o;const l=pi(e);l.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&ai.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>ai.error(e)),t.push(l);const c=
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(){return p(this,null,function*(){if(!Sn())return ai.warn(oi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield In()}catch(Py){return ai.warn(oi.create("indexeddb-unavailable",{errorInfo:null==Py?void 0:Py.toString()}).message),!1}return!0})}().then(e=>e?s.getId():void 0),[u,d]=yield Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(ii)&&n.src.includes(e))return n;return null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */)(i)||ui(i,u.measurementId),r("js",new Date);const h=null!=(o=null==a?void 0:a.config)?o:{};return h.origin="firebase",h.update=!0,null!=d&&(h.firebase_id=d),r("config",u.measurementId,h),u.measurementId})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class bi{constructor(e){this.app=e}_delete(){return delete vi[this.app.options.appId],Promise.resolve()}}let vi={},yi=[];const wi={};let Ni,ji,Ci="dataLayer",_i=!1;function ki(){const e=[];if(kn()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>`(${t+1}) ${e}`).join(" "),n=oi.create("invalid-analytics-context",{errorInfo:t});ai.warn(n.message)}}function Ei(e,t,n){ki();const s=e.options.appId;if(!s)throw oi.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw oi.create("no-api-key");ai.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=vi[s])throw oi.create("already-exists",{id:s});if(!_i){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(Ci);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,s,r){let i=function(...e){window[s].push(arguments)};return window[r]&&"function"==typeof window[r]&&(i=window[r]),window[r]=di(i,e,t,n),{gtagCore:i,wrappedGtag:window[r]}}(vi,yi,wi,Ci,"gtag");ji=e,Ni=t,_i=!0}return vi[s]=xi(e,yi,wi,t,Ni,Ci,n),new bi(e)}function Si(e,t,n,s){e=$n(e),function(e,t,n,s,r){return p(this,null,function*(){if(r&&r.global)e("event",n,s);else{const r=yield t,i=d(u({},s),{send_to:r});e("event",n,i)}})}(ji,vi[e.app.options.appId],t,n,s).catch(e=>ai.error(e))}const Ii="@firebase/analytics",Ti="0.10.18";function Ai(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}Zs(new zn(ri,(e,{options:t})=>Ei(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),Zs(new zn("analytics-internal",function(e){try{const t=e.getProvider(ri).getImmediate();return{logEvent:(e,n,s)=>Si(t,e,n,s)}}catch(Py){throw oi.create("interop-component-reg-failed",{reason:Py})}},"PRIVATE")),or(Ii,Ti),or(Ii,Ti,"esm2020");const Ri=Ai,Di=new An("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Pi=new Yn("@firebase/auth");function Li(e,...t){Pi.logLevel<=Hn.ERROR&&Pi.error(`Auth (${rr}): ${e}`,...t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Oi(e,...t){throw Vi(e,...t)}function Mi(e,...t){return Vi(e,...t)}function Ui(e,t,n){const s=d(u({},Ri()),{[t]:n});return new An("auth","Firebase",s).create(t,{appName:e.name})}function Fi(e){return Ui(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vi(e,...t){if("string"!=typeof e){const n=t[0],s=[...t.slice(1)];return s[0]&&(s[0].appName=e.name),e._errorFactory.create(n,...s)}return Di.create(e,...t)}function $i(e,t,...n){if(!e)throw Vi(t,...n)}function zi(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Li(t),new Error(t)}function Bi(e,t){e||zi(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function qi(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.href)||""}function Gi(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.protocol)||null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hi(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==Gi()&&"https:"!==Gi()&&!kn()&&!("connection"in navigator)||navigator.onLine}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Wi{constructor(e,t){this.shortDelay=e,this.longDelay=t,Bi(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_n())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return Hi()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ki(e,t){Bi(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Qi{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void zi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void zi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void zi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ji={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Xi=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Yi=new Wi(3e4,6e4);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zi(e,t){return e.tenantId&&!t.tenantId?d(u({},t),{tenantId:e.tenantId}):t}function ea(e,t,n,s){return p(this,arguments,function*(e,t,n,s,r={}){return ta(e,r,()=>p(this,null,function*(){let r={},i={};s&&("GET"===t?i=s:r={body:JSON.stringify(s)});const a=Ln(u({key:e.config.apiKey},i)).slice(1),o=yield e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=u({method:t,headers:o},r);return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&vn(e.emulatorConfig.host)&&(l.credentials="include"),Qi.fetch()(yield sa(e,e.config.apiHost,n,a),l)}))})}function ta(e,t,n){return p(this,null,function*(){e._canInitEmulator=!1;const s=u(u({},Ji),t);try{const t=new ia(e),r=yield Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=yield r.json();if("needConfirmation"in i)throw aa(e,"account-exists-with-different-credential",i);if(r.ok&&!("errorMessage"in i))return i;{const t=r.ok?i.errorMessage:i.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw aa(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw aa(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw aa(e,"user-disabled",i);const o=s[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw Ui(e,o,a);Oi(e,o)}}catch(Py){if(Py instanceof Tn)throw Py;Oi(e,"network-request-failed",{message:String(Py)})}})}function na(e,t,n,s){return p(this,arguments,function*(e,t,n,s,r={}){const i=yield ea(e,t,n,s,r);return"mfaPendingCredential"in i&&Oi(e,"multi-factor-auth-required",{_serverResponse:i}),i})}function sa(e,t,n,s){return p(this,null,function*(){const r=`${t}${n}?${s}`,i=e,a=i.config.emulator?Ki(e.config,r):`${e.config.apiScheme}://${r}`;return Xi.includes(n)&&(yield i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())?i._getPersistence()._getFinalTarget(a).toString():a})}function ra(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ia{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Mi(this.auth,"network-request-failed")),Yi.get())})}}function aa(e,t,n){const s={appName:e.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=Mi(e,t,s);return r.customData._tokenResponse=n,r}function oa(e){return void 0!==e&&void 0!==e.enterprise}class la{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ra(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}function ca(e,t){return p(this,null,function*(){return ea(e,"POST","/v1/accounts:lookup",t)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ua(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(Py){}}function da(e,t=!1){return p(this,null,function*(){const n=$n(e),s=yield n.getIdToken(t),r=ma(s);$i(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i="object"==typeof r.firebase?r.firebase:void 0,a=null==i?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:ua(ha(r.auth_time)),issuedAtTime:ua(ha(r.iat)),expirationTime:ua(ha(r.exp)),signInProvider:a||null,signInSecondFactor:(null==i?void 0:i.sign_in_second_factor)||null}})}function ha(e){return 1e3*Number(e)}function ma(e){const[t,n,s]=e.split(".");if(void 0===t||void 0===n||void 0===s)return Li("JWT malformed, contained fewer than 3 sections"),null;try{const e=dn(n);return e?JSON.parse(e):(Li("Failed to decode base64 JWT payload"),null)}catch(Py){return Li("Caught error parsing JWT payload as JSON",null==Py?void 0:Py.toString()),null}}function pa(e){const t=ma(e);return $i(t,"internal-error"),$i(void 0!==t.exp,"internal-error"),$i(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fa(e,t,n=!1){return p(this,null,function*(){if(n)return t;try{return yield t}catch(Py){throw Py instanceof Tn&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(Py)&&e.auth.currentUser===e&&(yield e.auth.signOut()),Py}})}class ga{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!=(t=this.user.stsTokenManager.expirationTime)?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(()=>p(this,null,function*(){yield this.iteration()}),t)}iteration(){return p(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(Py){return void("auth/network-request-failed"===(null==Py?void 0:Py.code)&&this.schedule(!0))}this.schedule()})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xa{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ua(this.lastLoginAt),this.creationTime=ua(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ba(e){return p(this,null,function*(){var t;const n=e.auth,s=yield e.getIdToken(),r=yield fa(e,ca(n,{idToken:s}));$i(null==r?void 0:r.users.length,n,"internal-error");const i=r.users[0];e._notifyReloadListener(i);const a=(null==(t=i.providerUserInfo)?void 0:t.length)?ya(i.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&i.passwordHash||(null==o?void 0:o.length)),h=!!u&&d,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new xa(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,m)})}function va(e){return p(this,null,function*(){const t=$n(e);yield ba(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)})}function ya(e){return e.map(e=>{var t=e,{providerId:n}=t,s=h(t,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class wa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$i(e.idToken,"internal-error"),$i(void 0!==e.idToken,"internal-error"),$i(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):pa(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$i(0!==e.length,"internal-error");const t=pa(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return p(this,null,function*(){return t||!this.accessToken||this.isExpired?($i(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return p(this,null,function*(){const{accessToken:n,refreshToken:s,expiresIn:r}=yield function(e,t){return p(this,null,function*(){const n=yield ta(e,{},()=>p(this,null,function*(){const n=Ln({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:r}=e.config,i=yield sa(e,s,"/v1/token",`key=${r}`),a=yield e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:a,body:n};return e.emulatorConfig&&vn(e.emulatorConfig.host)&&(o.credentials="include"),Qi.fetch()(i,o)}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}(e,t);this.updateTokensAndExpiration(n,s,Number(r))})}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:r}=t,i=new wa;return n&&($i("string"==typeof n,"internal-error",{appName:e}),i.refreshToken=n),s&&($i("string"==typeof s,"internal-error",{appName:e}),i.accessToken=s),r&&($i("number"==typeof r,"internal-error",{appName:e}),i.expirationTime=r),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wa,this.toJSON())}_performRefresh(){return zi("not implemented")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Na(e,t){$i("string"==typeof e||void 0===e,"internal-error",{appName:t})}class ja{constructor(e){var t=e,{uid:n,auth:s,stsTokenManager:r}=t,i=h(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ga(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new xa(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(e){return p(this,null,function*(){const t=yield fa(this,this.stsTokenManager.getToken(this.auth,e));return $i(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return da(this,e)}reload(){return va(this)}_assign(e){this!==e&&($i(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>u({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ja(d(u({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$i(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return p(this,null,function*(){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&(yield ba(this)),yield this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)})}delete(){return p(this,null,function*(){if(tr(this.auth.app))return Promise.reject(Fi(this.auth));const e=yield this.getIdToken();return yield fa(this,
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){return p(this,null,function*(){return ea(e,"POST","/v1/accounts:delete",t)})}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return d(u({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>u({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,s,r,i,a,o,l,c;const d=null!=(n=t.displayName)?n:void 0,h=null!=(s=t.email)?s:void 0,m=null!=(r=t.phoneNumber)?r:void 0,p=null!=(i=t.photoURL)?i:void 0,f=null!=(a=t.tenantId)?a:void 0,g=null!=(o=t._redirectEventId)?o:void 0,x=null!=(l=t.createdAt)?l:void 0,b=null!=(c=t.lastLoginAt)?c:void 0,{uid:v,emailVerified:y,isAnonymous:w,providerData:N,stsTokenManager:j}=t;$i(v&&j,e,"internal-error");const C=wa.fromJSON(this.name,j);$i("string"==typeof v,e,"internal-error"),Na(d,e.name),Na(h,e.name),$i("boolean"==typeof y,e,"internal-error"),$i("boolean"==typeof w,e,"internal-error"),Na(m,e.name),Na(p,e.name),Na(f,e.name),Na(g,e.name),Na(x,e.name),Na(b,e.name);const _=new ja({uid:v,auth:e,email:h,emailVerified:y,displayName:d,isAnonymous:w,photoURL:p,phoneNumber:m,tenantId:f,stsTokenManager:C,createdAt:x,lastLoginAt:b});return N&&Array.isArray(N)&&(_.providerData=N.map(e=>u({},e))),g&&(_._redirectEventId=g),_}static _fromIdTokenResponse(e,t,n=!1){return p(this,null,function*(){const s=new wa;s.updateFromServerResponse(t);const r=new ja({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return yield ba(r),r})}static _fromGetAccountInfoResponse(e,t,n){return p(this,null,function*(){const s=t.users[0];$i(void 0!==s.localId,"internal-error");const r=void 0!==s.providerUserInfo?ya(s.providerUserInfo):[],i=!(s.email&&s.passwordHash||(null==r?void 0:r.length)),a=new wa;a.updateFromIdToken(n);const o=new ja({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:i}),l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new xa(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash||(null==r?void 0:r.length))};return Object.assign(o,l),o})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ca=new Map;function _a(e){Bi(e instanceof Function,"Expected a class definition");let t=Ca.get(e);return t?(Bi(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Ca.set(e,t),t)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ka{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return p(this,null,function*(){return!0})}_set(e,t){return p(this,null,function*(){this.storage[e]=t})}_get(e){return p(this,null,function*(){const t=this.storage[e];return void 0===t?null:t})}_remove(e){return p(this,null,function*(){delete this.storage[e]})}_addListener(e,t){}_removeListener(e,t){}}ka.type="NONE";const Ea=ka;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Sa(e,t,n){return`firebase:${e}:${t}:${n}`}class Ia{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:r}=this.auth;this.fullUserKey=Sa(this.userKey,s.apiKey,r),this.fullPersistenceKey=Sa("persistence",s.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return p(this,null,function*(){const e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=yield ca(this.auth,{idToken:e}).catch(()=>{});return t?ja._fromGetAccountInfoResponse(this.auth,t,e):null}return ja._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return p(this,null,function*(){if(this.persistence===e)return;const t=yield this.getCurrentUser();return yield this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return p(this,null,function*(){if(!t.length)return new Ia(_a(Ea),e,n);const s=(yield Promise.all(t.map(e=>p(this,null,function*(){if(yield e._isAvailable())return e})))).filter(e=>e);let r=s[0]||_a(Ea);const i=Sa(n,e.config.apiKey,e.name);let a=null;for(const n of t)try{const t=yield n._get(i);if(t){let s;if("string"==typeof t){const n=yield ca(e,{idToken:t}).catch(()=>{});if(!n)break;s=yield ja._fromGetAccountInfoResponse(e,n,t)}else s=ja._fromJSON(e,t);n!==r&&(a=s),r=n;break}}catch(Py){}const o=s.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&o.length?(r=o[0],a&&(yield r._set(i,a.toJSON())),yield Promise.all(t.map(e=>p(this,null,function*(){if(e!==r)try{yield e._remove(i)}catch(Py){}}))),new Ia(r,e,n)):new Ia(r,e,n)})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ta(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Pa(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Aa(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Oa(t))return"Blackberry";if(Ma(t))return"Webos";if(Ra(t))return"Safari";if((t.includes("chrome/")||Da(t))&&!t.includes("edge/"))return"Chrome";if(La(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Aa(e=_n()){return/firefox\//i.test(e)}function Ra(e=_n()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Da(e=_n()){return/crios\//i.test(e)}function Pa(e=_n()){return/iemobile/i.test(e)}function La(e=_n()){return/android/i.test(e)}function Oa(e=_n()){return/blackberry/i.test(e)}function Ma(e=_n()){return/webos/i.test(e)}function Ua(e=_n()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Fa(){return function(){const e=_n();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Va(e=_n()){return Ua(e)||La(e)||Ma(e)||Oa(e)||/windows phone/i.test(e)||Pa(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $a(e,t=[]){let n;switch(e){case"Browser":n=Ta(_n());break;case"Worker":n=`${Ta(_n())}-${e}`;break;default:n=e}const s=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${rr}/${s}`}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class za{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,s)=>{try{n(e(t))}catch(Py){s(Py)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(e){return p(this,null,function*(){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)yield n(e),n.onAbort&&t.push(n.onAbort)}catch(Py){t.reverse();for(const s of t)try{s()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==Py?void 0:Py.message})}})}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ba{constructor(e){var t,n,s,r;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!=(t=i.minPasswordLength)?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!=(s=null==(n=e.allowedNonAlphanumericCharacters)?void 0:n.join(""))?s:"",this.forceUpgradeOnSignin=null!=(r=e.forceUpgradeOnSignin)&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,s,r,i,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null==(t=o.meetsMinPasswordLength)||t),o.isValid&&(o.isValid=null==(n=o.meetsMaxPasswordLength)||n),o.isValid&&(o.isValid=null==(s=o.containsLowercaseLetter)||s),o.isValid&&(o.isValid=null==(r=o.containsUppercaseLetter)||r),o.isValid&&(o.isValid=null==(i=o.containsNumericCharacter)||i),o.isValid&&(o.isValid=null==(a=o.containsNonAlphanumericCharacter)||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class qa{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ha(this),this.idTokenSubscription=new Ha(this),this.beforeStateQueue=new za(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Di,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_a(t)),this._initializationPromise=this.queue(()=>p(this,null,function*(){var n,s,r;if(!this._deleted&&(this.persistenceManager=yield Ia.create(this,e),null==(n=this._resolvePersistenceManagerAvailable)||n.call(this),!this._deleted)){if(null==(s=this._popupRedirectResolver)?void 0:s._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch(Py){}yield this.initializeCurrentUser(t),this.lastNotifiedUid=(null==(r=this.currentUser)?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return p(this,null,function*(){if(this._deleted)return;const e=yield this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(yield this.currentUser.getIdToken())):void(yield this._updateCurrentUser(e,!0)):void 0})}initializeCurrentUserFromIdToken(e){return p(this,null,function*(){try{const t=yield ca(this,{idToken:e}),n=yield ja._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(n)}catch(t){yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return p(this,null,function*(){var t;if(tr(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=yield this.assertedPersistence.getCurrentUser();let s=n,r=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();const n=null==(t=this.redirectUser)?void 0:t._redirectEventId,i=null==s?void 0:s._redirectEventId,a=yield this.tryRedirectSignIn(e);n&&n!==i||!(null==a?void 0:a.user)||(s=a.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{yield this.beforeStateQueue.runMiddleware(s)}catch(Py){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(Py))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return $i(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)})}tryRedirectSignIn(e){return p(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(Py){yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return p(this,null,function*(){try{yield ba(e)}catch(Py){if("auth/network-request-failed"!==(null==Py?void 0:Py.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}_delete(){return p(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return p(this,null,function*(){if(tr(this.app))return Promise.reject(Fi(this));const t=e?$n(e):null;return t&&$i(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return p(this,null,function*(){if(!this._deleted)return e&&$i(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>p(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return p(this,null,function*(){return tr(this.app)?Promise.reject(Fi(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return tr(this.app)?Promise.reject(Fi(this)):this.queue(()=>p(this,null,function*(){yield this.assertedPersistence.setPersistence(_a(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return p(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return p(this,null,function*(){const e=yield function(e){return p(this,arguments,function*(e,t={}){return ea(e,"GET","/v2/passwordPolicy",Zi(e,t))})}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this),t=new Ba(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new An("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}revokeAccessToken(e){return p(this,null,function*(){if(this.currentUser){const t=yield this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};null!=this.tenantId&&(n.tenantId=this.tenantId),yield function(e,t){return p(this,null,function*(){return ea(e,"POST","/v2/accounts:revokeToken",Zi(e,t))})}(this,n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null==(e=this._currentUser)?void 0:e.toJSON()}}_setRedirectUser(e,t){return p(this,null,function*(){const n=yield this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return p(this,null,function*(){if(!this.redirectPersistenceManager){const t=e&&_a(e)||this._popupRedirectResolver;$i(t,this,"argument-error"),this.redirectPersistenceManager=yield Ia.create(this,[_a(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return p(this,null,function*(){var t,n;return this._isInitialized&&(yield this.queue(()=>p(this,null,function*(){}))),(null==(t=this._currentUser)?void 0:t._redirectEventId)===e?this._currentUser:(null==(n=this.redirectUser)?void 0:n._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return p(this,null,function*(){if(e===this.currentUser)return this.queue(()=>p(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!=(t=null==(e=this.currentUser)?void 0:e.uid)?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t);let i=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if($i(a,this,"internal-error"),a.then(()=>{i||r(this.currentUser)}),"function"==typeof t){const r=e.addObserver(t,n,s);return()=>{i=!0,r()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}directlySetCurrentUser(e){return p(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $i(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$a(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return p(this,null,function*(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=yield null==(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))?void 0:e.getHeartbeatsHeader();n&&(t["X-Firebase-Client"]=n);const s=yield this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t})}_getAppCheckToken(){return p(this,null,function*(){var e;if(tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=yield null==(e=this.appCheckServiceProvider.getImmediate({optional:!0}))?void 0:e.getToken();return(null==t?void 0:t.error)&&function(e,...t){Pi.logLevel<=Hn.WARN&&Pi.warn(`Auth (${rr}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token})}}function Ga(e){return $n(e)}class Ha{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Un(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return $i(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let Wa={loadJS(){return p(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ka(e){return Wa.loadJS(e)}class Qa{constructor(){this.enterprise=new Ja}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Ja{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Xa="NO_RECAPTCHA";class Ya{constructor(e){this.type="recaptcha-enterprise",this.auth=Ga(e)}verify(e="verify",t=!1){return p(this,null,function*(){function n(e){return p(this,null,function*(){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((t,n)=>p(this,null,function*(){(function(e,t){return p(this,null,function*(){return ea(e,"GET","/v2/recaptchaConfig",Zi(e,t))})})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(s=>{if(void 0!==s.recaptchaKey){const n=new la(s);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})}))})}function s(t,n,s){const r=window.grecaptcha;oa(r)?r.enterprise.ready(()=>{r.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Xa)})}):s(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?(new Qa).execute("siteKey",{action:"verify"}):new Promise((e,r)=>{n(this.auth).then(n=>{if(!t&&oa(window.grecaptcha))s(n,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Wa.recaptchaEnterpriseScript;0!==t.length&&(t+=n),Ka(t).then(()=>{s(n,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})})}}function Za(e,t,n,s=!1,r=!1){return p(this,null,function*(){const i=new Ya(e);let a;if(r)a=Xa;else try{a=yield i.verify(n)}catch(l){a=yield i.verify(n,!0)}const o=u({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return s?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function eo(e,t,n,s,r){return p(this,null,function*(){var r;if(null==(r=e._getRecaptchaConfig())?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=yield Za(e,t,n,"getOobCode"===n);return s(e,r)}return s(e,t).catch(r=>p(this,null,function*(){if("auth/missing-recaptcha-token"===r.code){const r=yield Za(e,t,n,"getOobCode"===n);return s(e,r)}return Promise.reject(r)}))})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function to(e,t){const n=er(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Dn(n.getOptions(),null!=t?t:{}))return e;Oi(e,"already-initialized")}return n.initialize({options:t})}function no(e,t,n){const s=Ga(e);$i(/^https?:\/\//.test(t),s,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),i=so(t),{host:a,port:o}=function(e){const t=so(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const e=r[1];return{host:e,port:ro(s.substr(e.length+1))}}{const[e,t]=s.split(":");return{host:e,port:ro(t)}}}(t),l=null===o?"":`:${o}`,c={url:`${i}//${a}${l}/`},u=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator)return $i(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),void $i(Dn(c,s.config.emulator)&&Dn(u,s.emulatorConfig),s,"emulator-config-failed");s.config.emulator=c,s.emulatorConfig=u,s.settings.appVerificationDisabledForTesting=!0,vn(a)?(yn(`${i}//${a}${l}`),Cn("Auth",!0)):function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&console.info,"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */()}function so(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ro(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class io{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return zi("not implemented")}_getIdTokenResponse(e){return zi("not implemented")}_linkToIdToken(e,t){return zi("not implemented")}_getReauthenticationResolver(e){return zi("not implemented")}}function ao(e,t){return p(this,null,function*(){return ea(e,"POST","/v1/accounts:signUp",t)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function oo(e,t){return p(this,null,function*(){return na(e,"POST","/v1/accounts:signInWithPassword",Zi(e,t))})}function lo(e,t){return p(this,null,function*(){return function(e,t){return p(this,null,function*(){return ea(e,"POST","/v1/accounts:sendOobCode",Zi(e,t))})}(e,t)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class co extends io{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new co(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new co(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return p(this,null,function*(){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return eo(e,t,"signInWithPassword",oo);case"emailLink":return function(e,t){return p(this,null,function*(){return na(e,"POST","/v1/accounts:signInWithEmailLink",Zi(e,t))})}(e,{email:this._email,oobCode:this._password});default:Oi(e,"internal-error")}})}_linkToIdToken(e,t){return p(this,null,function*(){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return eo(e,n,"signUpPassword",ao);case"emailLink":return function(e,t){return p(this,null,function*(){return na(e,"POST","/v1/accounts:signInWithEmailLink",Zi(e,t))})}(e,{idToken:t,email:this._email,oobCode:this._password});default:Oi(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function uo(e,t){return p(this,null,function*(){return na(e,"POST","/v1/accounts:signInWithIdp",Zi(e,t))})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ho extends io{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ho(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Oi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:s}=t,r=h(t,["providerId","signInMethod"]);if(!n||!s)return null;const i=new ho(n,s);return i.idToken=r.idToken||void 0,i.accessToken=r.accessToken||void 0,i.secret=r.secret,i.nonce=r.nonce,i.pendingToken=r.pendingToken||null,i}_getIdTokenResponse(e){return uo(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,uo(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,uo(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ln(t)}return e}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class mo{constructor(e){var t,n,s,r,i,a;const o=On(Mn(e)),l=null!=(t=o.apiKey)?t:null,c=null!=(n=o.oobCode)?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!=(s=o.mode)?s:null);$i(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!=(r=o.continueUrl)?r:null,this.languageCode=null!=(i=o.lang)?i:null,this.tenantId=null!=(a=o.tenantId)?a:null}static parseLink(e){const t=function(e){const t=On(Mn(e)).link,n=t?On(Mn(t)).deep_link_id:null,s=On(Mn(e)).deep_link_id;return(s?On(Mn(s)).link:null)||s||n||t||e}(e);try{return new mo(t)}catch(Py){return null}}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class po{constructor(){this.providerId=po.PROVIDER_ID}static credential(e,t){return co._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=mo.parseLink(t);return $i(n,"argument-error"),co._fromEmailAndCode(e,n.code,n.tenantId)}}po.PROVIDER_ID="password",po.EMAIL_PASSWORD_SIGN_IN_METHOD="password",po.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class fo{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class go extends fo{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xo extends go{constructor(){super("facebook.com")}static credential(e){return ho._fromParams({providerId:xo.PROVIDER_ID,signInMethod:xo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xo.credentialFromTaggedObject(e)}static credentialFromError(e){return xo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return xo.credential(e.oauthAccessToken)}catch(Py){return null}}}xo.FACEBOOK_SIGN_IN_METHOD="facebook.com",xo.PROVIDER_ID="facebook.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class bo extends go{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ho._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return bo.credential(t,n)}catch(Py){return null}}}bo.GOOGLE_SIGN_IN_METHOD="google.com",bo.PROVIDER_ID="google.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class vo extends go{constructor(){super("github.com")}static credential(e){return ho._fromParams({providerId:vo.PROVIDER_ID,signInMethod:vo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vo.credentialFromTaggedObject(e)}static credentialFromError(e){return vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return vo.credential(e.oauthAccessToken)}catch(Py){return null}}}vo.GITHUB_SIGN_IN_METHOD="github.com",vo.PROVIDER_ID="github.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class yo extends go{constructor(){super("twitter.com")}static credential(e,t){return ho._fromParams({providerId:yo.PROVIDER_ID,signInMethod:yo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return yo.credentialFromTaggedObject(e)}static credentialFromError(e){return yo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return yo.credential(t,n)}catch(Py){return null}}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function wo(e,t){return p(this,null,function*(){return na(e,"POST","/v1/accounts:signUp",Zi(e,t))})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */yo.TWITTER_SIGN_IN_METHOD="twitter.com",yo.PROVIDER_ID="twitter.com";class No{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,s=!1){return p(this,null,function*(){const r=yield ja._fromIdTokenResponse(e,n,s),i=jo(n);return new No({user:r,providerId:i,_tokenResponse:n,operationType:t})})}static _forOperation(e,t,n){return p(this,null,function*(){yield e._updateTokensIfNecessary(n,!0);const s=jo(n);return new No({user:e,providerId:s,_tokenResponse:n,operationType:t})})}}function jo(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Co(e){return p(this,null,function*(){var t;if(tr(e.app))return Promise.reject(Fi(e));const n=Ga(e);if(yield n._initializationPromise,null==(t=n.currentUser)?void 0:t.isAnonymous)return new No({user:n.currentUser,providerId:null,operationType:"signIn"});const s=yield wo(n,{returnSecureToken:!0}),r=yield No._fromIdTokenResponse(n,"signIn",s,!0);return yield n._updateCurrentUser(r.user),r})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _o extends Tn{constructor(e,t,n,s){var r;super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,_o.prototype),this.customData={appName:e.name,tenantId:null!=(r=e.tenantId)?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new _o(e,t,n,s)}}function ko(e,t,n,s){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw _o._fromErrorAndOperation(e,n,t,s);throw n})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Eo(e,t,n=!1){return p(this,null,function*(){if(tr(e.app))return Promise.reject(Fi(e));const s="signIn",r=yield ko(e,s,t),i=yield No._fromIdTokenResponse(e,s,r);return n||(yield e._updateCurrentUser(i.user)),i})}function So(e,t){return p(this,null,function*(){return Eo(Ga(e),t)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Io(e){return p(this,null,function*(){const t=Ga(e);t._getPasswordPolicyInternal()&&(yield t._updatePasswordPolicy())})}function To(e,t,n){return p(this,null,function*(){if(tr(e.app))return Promise.reject(Fi(e));const s=Ga(e),r=eo(s,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",wo),i=yield r.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Io(e),t}),a=yield No._fromIdTokenResponse(s,"signIn",i);return yield s._updateCurrentUser(a.user),a})}function Ao(e,t,n){return tr(e.app)?Promise.reject(Fi(e)):So($n(e),po.credential(t,n)).catch(t=>p(this,null,function*(){throw"auth/password-does-not-meet-requirements"===t.code&&Io(e),t}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ro(e,t){return p(this,arguments,function*(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const s=$n(e),r={idToken:yield s.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},i=yield fa(s,function(e,t){return p(this,null,function*(){return ea(e,"POST","/v1/accounts:update",t)})}(s.auth,r));s.displayName=i.displayName||null,s.photoURL=i.photoUrl||null;const a=s.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=s.displayName,a.photoURL=s.photoURL),yield s._updateTokensIfNecessary(i)})}function Do(e,t,n,s){return $n(e).onIdTokenChanged(t,n,s)}function Po(e,t,n){return $n(e).beforeAuthStateChanged(t,n)}function Lo(e,t,n,s){return $n(e).onAuthStateChanged(t,n,s)}function Oo(e){return p(this,null,function*(){return $n(e).delete()})}const Mo="__sak";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Uo{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Mo,"1"),this.storage.removeItem(Mo),Promise.resolve(!0)):Promise.resolve(!1)}catch(Py){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Fo extends Uo{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Va(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);Fa()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,10):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,t){return p(this,null,function*(){yield m(Fo.prototype,this,"_set").call(this,e,t),this.localCache[e]=JSON.stringify(t)})}_get(e){return p(this,null,function*(){const t=yield m(Fo.prototype,this,"_get").call(this,e);return this.localCache[e]=JSON.stringify(t),t})}_remove(e){return p(this,null,function*(){yield m(Fo.prototype,this,"_remove").call(this,e),delete this.localCache[e]})}}Fo.type="LOCAL";const Vo=Fo;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class $o extends Uo{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}$o.type="SESSION";const zo=$o;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Bo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Bo(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}handleEvent(e){return p(this,null,function*(){const t=e,{eventId:n,eventType:s,data:r}=t.data,i=this.handlersMap[s];if(!(null==i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const a=Array.from(i).map(e=>p(this,null,function*(){return e(t.origin,r)})),o=yield function(e){return Promise.all(e.map(e=>p(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:o})})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function qo(e="",t=10){let n="";for(let s=0;s<t;s++)n+=Math.floor(10*Math.random());return e+n}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Bo.receivers=[];class Go{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){return p(this,null,function*(){const s="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,i;return new Promise((a,o)=>{const l=qo("",20);s.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),r=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(t.data.response);break;default:clearTimeout(c),clearTimeout(r),o(new Error("invalid_response"))}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ho(){return window}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Wo(){return void 0!==Ho().WorkerGlobalScope&&"function"==typeof Ho().importScripts}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Ko="firebaseLocalStorageDb",Qo="firebaseLocalStorage",Jo="fbase_key";class Xo{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Yo(e,t){return e.transaction([Qo],t?"readwrite":"readonly").objectStore(Qo)}function Zo(){const e=indexedDB.open(Ko,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Qo,{keyPath:Jo})}catch(Py){n(Py)}}),e.addEventListener("success",()=>p(this,null,function*(){const n=e.result;n.objectStoreNames.contains(Qo)?t(n):(n.close(),yield function(){const e=indexedDB.deleteDatabase(Ko);return new Xo(e).toPromise()}(),t(yield Zo()))}))})}function el(e,t,n){return p(this,null,function*(){const s=Yo(e,!0).put({[Jo]:t,value:n});return new Xo(s).toPromise()})}function tl(e,t){const n=Yo(e,!0).delete(t);return new Xo(n).toPromise()}class nl{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return p(this,null,function*(){return this.db||(this.db=yield Zo()),this.db})}_withRetries(e){return p(this,null,function*(){let t=0;for(;;)try{const t=yield this._openDb();return yield e(t)}catch(Py){if(t++>3)throw Py;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return p(this,null,function*(){return Wo()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return p(this,null,function*(){this.receiver=Bo._getInstance(Wo()?self:null),this.receiver._subscribe("keyChanged",(e,t)=>p(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(t.key)}})),this.receiver._subscribe("ping",(e,t)=>p(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return p(this,null,function*(){var e,t;if(this.activeServiceWorker=yield function(){return p(this,null,function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(Py){return null}})}(),!this.activeServiceWorker)return;this.sender=new Go(this.activeServiceWorker);const n=yield this.sender._send("ping",{},800);n&&(null==(e=n[0])?void 0:e.fulfilled)&&(null==(t=n[0])?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(e){return p(this,null,function*(){var t;if(this.sender&&this.activeServiceWorker&&((null==(t=null==navigator?void 0:navigator.serviceWorker)?void 0:t.controller)||null)===this.activeServiceWorker)try{yield this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(Py){}})}_isAvailable(){return p(this,null,function*(){try{if(!indexedDB)return!1;const e=yield Zo();return yield el(e,Mo,"1"),yield tl(e,Mo),!0}catch(Py){}return!1})}_withPendingWrite(e){return p(this,null,function*(){this.pendingWrites++;try{yield e()}finally{this.pendingWrites--}})}_set(e,t){return p(this,null,function*(){return this._withPendingWrite(()=>p(this,null,function*(){return yield this._withRetries(n=>el(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)}))})}_get(e){return p(this,null,function*(){const t=yield this._withRetries(t=>function(e,t){return p(this,null,function*(){const n=Yo(e,!1).get(t),s=yield new Xo(n).toPromise();return void 0===s?null:s.value})}(t,e));return this.localCache[e]=t,t})}_remove(e){return p(this,null,function*(){return this._withPendingWrite(()=>p(this,null,function*(){return yield this._withRetries(t=>tl(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)}))})}_poll(){return p(this,null,function*(){const e=yield this._withRetries(e=>{const t=Yo(e,!1).getAll();return new Xo(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:s,value:r}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t})}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>p(this,null,function*(){return this._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}nl.type="LOCAL";const sl=nl;
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function rl(e,t){return t?_a(t):($i(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */new Wi(3e4,6e4);class il extends io{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return uo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return uo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return uo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function al(e){return Eo(e.auth,new il(e),e.bypassAuthState)}function ol(e){const{auth:t,user:n}=e;return $i(n,t,"internal-error"),
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t,n=!1){return p(this,null,function*(){const{auth:s}=e;if(tr(s.app))return Promise.reject(Fi(s));const r="reauthenticate";try{const i=yield fa(e,ko(s,r,t,e),n);$i(i.idToken,s,"internal-error");const a=ma(i.idToken);$i(a,s,"internal-error");const{sub:o}=a;return $i(e.uid===o,s,"user-mismatch"),No._forOperation(e,r,i)}catch(Py){throw"auth/user-not-found"===(null==Py?void 0:Py.code)&&Oi(s,"user-mismatch"),Py}})}(n,new il(e),e.bypassAuthState)}function ll(e){return p(this,null,function*(){const{auth:t,user:n}=e;return $i(n,t,"internal-error"),function(e,t,n=!1){return p(this,null,function*(){const s=yield fa(e,t._linkToIdToken(e.auth,yield e.getIdToken()),n);return No._forOperation(e,"link",s)})}(n,new il(e),e.bypassAuthState)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cl{constructor(e,t,n,s,r=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>p(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(Py){this.reject(Py)}}))}onAuthEvent(e){return p(this,null,function*(){const{urlResponse:t,sessionId:n,postBody:s,tenantId:r,error:i,type:a}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(o))}catch(Py){this.reject(Py)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return al;case"linkViaPopup":case"linkViaRedirect":return ll;case"reauthViaPopup":case"reauthViaRedirect":return ol;default:Oi(this.auth,"internal-error")}}resolve(e){Bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const ul=new Wi(2e3,1e4);function dl(e,t,n){return p(this,null,function*(){if(tr(e.app))return Promise.reject(Mi(e,"operation-not-supported-in-this-environment"));const s=Ga(e);!function(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Oi(e,"argument-error"),Ui(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(e,t,fo);const r=rl(s,n);return new hl(s,"signInViaPopup",t,r).executeNotNull()})}class hl extends cl{constructor(e,t,n,s,r){super(e,t,s,r),this.provider=n,this.authWindow=null,this.pollId=null,hl.currentPopupAction&&hl.currentPopupAction.cancel(),hl.currentPopupAction=this}executeNotNull(){return p(this,null,function*(){const e=yield this.execute();return $i(e,this.auth,"internal-error"),e})}onExecution(){return p(this,null,function*(){Bi(1===this.filter.length,"Popup operations only handle one event");const e=qo();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Mi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var e;return(null==(e=this.authWindow)?void 0:e.associatedEvent)||null}cancel(){this.reject(Mi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,hl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null==(n=null==(t=this.authWindow)?void 0:t.window)?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Mi(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,ul.get())};e()}}hl.currentPopupAction=null;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ml="pendingRedirect",pl=new Map;class fl extends cl{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){return p(this,null,function*(){let e=pl.get(this.auth._key());if(!e){try{const t=(yield function(e,t){return p(this,null,function*(){const n=function(e){return Sa(ml,e.config.apiKey,e.name)}(t),s=function(e){return _a(e._redirectPersistence)}(e);if(!(yield s._isAvailable()))return!1;const r="true"===(yield s._get(n));return yield s._remove(n),r})}(this.resolver,this.auth))?yield m(fl.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(t)}catch(Py){e=()=>Promise.reject(Py)}pl.set(this.auth._key(),e)}return this.bypassAuthState||pl.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return p(this,null,function*(){if("signInViaRedirect"===e.type)return m(fl.prototype,this,"onAuthEvent").call(this,e);if("unknown"!==e.type){if(e.eventId){const t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,m(fl.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}}else this.resolve(null)})}onExecution(){return p(this,null,function*(){})}cleanUp(){}}function gl(e,t){pl.set(e._key(),t)}function xl(e,t,n=!1){return p(this,null,function*(){if(tr(e.app))return Promise.reject(Fi(e));const s=Ga(e),r=rl(s,t),i=new fl(s,r,n),a=yield i.execute();return a&&!n&&(delete a.user._redirectEventId,yield s._persistUserIfCurrent(a.user),yield s._setRedirectUser(null,t)),a})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class bl{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yl(e);default:return!1}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!yl(e)){const s=(null==(n=e.error.code)?void 0:n.split("auth/")[1])||"internal-error";t.onError(Mi(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(vl(e))}saveEventToCache(e){this.cachedEventUids.add(vl(e)),this.lastProcessedEventTime=Date.now()}}function vl(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function yl({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const wl=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Nl=/^https?/;function jl(e){return p(this,null,function*(){if(e.config.emulator)return;const{authorizedDomains:t}=yield function(e){return p(this,arguments,function*(e,t={}){return ea(e,"GET","/v1/projects",t)})}(e);for(const e of t)try{if(Cl(e))return}catch(Py){}Oi(e,"unauthorized-domain")})}function Cl(e){const t=qi(),{protocol:n,hostname:s}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===s?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===s}if(!Nl.test(n))return!1;if(wl.test(e))return s===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const _l=new Wi(3e4,6e4);function kl(){const e=Ho().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function El(e){return new Promise((t,n)=>{var s,r,i;function a(){kl(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{kl(),n(Mi(e,"network-request-failed"))},timeout:_l.get()})}if(null==(r=null==(s=Ho().gapi)?void 0:s.iframes)?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null==(i=Ho().gapi)?void 0:i.load)){const t=`__iframefcb${Math.floor(1e6*Math.random())}`;return Ho()[t]=()=>{gapi.load?a():n(Mi(e,"network-request-failed"))},Ka(`${Wa.gapiScript}?onload=${t}`).catch(e=>n(e))}a()}}).catch(e=>{throw Sl=null,e})}let Sl=null;
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Il=new Wi(5e3,15e3),Tl={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Al=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Rl(e){const t=e.config;$i(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Ki(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,s={apiKey:t.apiKey,appName:e.name,v:rr},r=Al.get(e.config.apiHost);r&&(s.eid=r);const i=e._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${Ln(s).slice(1)}`}function Dl(e){return p(this,null,function*(){const t=yield function(e){return Sl=Sl||El(e),Sl}(e),n=Ho().gapi;return $i(n,e,"internal-error"),t.open({where:document.body,url:Rl(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Tl,dontclear:!0},t=>new Promise((n,s)=>p(this,null,function*(){yield t.restyle({setHideOnLeave:!1});const r=Mi(e,"network-request-failed"),i=Ho().setTimeout(()=>{s(r)},Il.get());function a(){Ho().clearTimeout(i),n(t)}t.ping(a).then(a,()=>{s(r)})})))})}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Pl={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ll{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(Py){}}}function Ol(e,t,n,s=500,r=600){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let o="";const l=d(u({},Pl),{width:s.toString(),height:r.toString(),top:i,left:a}),c=_n().toLowerCase();n&&(o=Da(c)?"_blank":n),Aa(c)&&(t=t||"http://localhost",l.scrollbars="yes");const h=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=_n()){var t;return Ua(e)&&!!(null==(t=window.navigator)?void 0:t.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t||"",o),new Ll(null);const m=window.open(t||"",o,h);$i(m,e,"popup-blocked");try{m.focus()}catch(Py){}return new Ll(m)}const Ml="__/auth/handler",Ul="emulator/auth/handler",Fl=encodeURIComponent("fac");function Vl(e,t,n,s,r,i){return p(this,null,function*(){$i(e.config.authDomain,e,"auth-domain-config-required"),$i(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:s,v:rr,eventId:r};if(t instanceof fo){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))i[e]=t}if(t instanceof go){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(i.scopes=e.join(","))}e.tenantId&&(i.tid=e.tenantId);const a=i;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const o=yield e._getAppCheckToken(),l=o?`#${Fl}=${encodeURIComponent(o)}`:"";return`${function({config:e}){return e.emulator?Ki(e,Ul):`https://${e.authDomain}/${Ml}`}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)}?${Ln(a).slice(1)}${l}`})}const $l="webStorageSupport",zl=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zo,this._completeRedirectFn=xl,this._overrideRedirectResult=gl}_openPopup(e,t,n,s){return p(this,null,function*(){var r;Bi(null==(r=this.eventManagers[e._key()])?void 0:r.manager,"_initialize() not called before _openPopup()");const i=yield Vl(e,t,n,qi(),s);return Ol(e,i,qo())})}_openRedirect(e,t,n,s){return p(this,null,function*(){return yield this._originValidation(e),function(e){Ho().location.href=e}(yield Vl(e,t,n,qi(),s)),new Promise(()=>{})})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Bi(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){return p(this,null,function*(){const t=yield Dl(e),n=new bl(e);return t.register("authEvent",t=>($i(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send($l,{type:$l},n=>{var s;const r=null==(s=null==n?void 0:n[0])?void 0:s[$l];void 0!==r&&t(!!r),Oi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=jl(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Va()||Ra()||Ua()}};var Bl="@firebase/auth",ql="1.11.0";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Gl{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null==(e=this.auth.currentUser)?void 0:e.uid)||null}getToken(e){return p(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$i(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Hl=xn("authIdTokenMaxAge")||300;let Wl=null;function Kl(t=ar()){const n=er(t,"auth");if(n.isInitialized())return n.getImmediate();const s=to(t,{popupRedirectResolver:zl,persistence:[sl,Vo,zo]}),r=xn("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const t=new URL(r,location.origin);if(location.origin===t.origin){const n=(i=t.toString(),t=>p(e,null,function*(){const e=t&&(yield t.getIdTokenResult()),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>Hl)return;const s=null==e?void 0:e.token;Wl!==s&&(Wl=s,yield fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))}));Po(s,n,()=>n(s.currentUser)),Do(s,e=>n(e))}}var i;const a=pn("auth");return a&&no(s,`http://${a}`),s}var Ql;Wa={loadJS:e=>new Promise((t,n)=>{const s=document.createElement("script");var r,i;s.setAttribute("src",e),s.onload=t,s.onerror=e=>{const t=Mi("internal-error");t.customData=e,n(t)},s.type="text/javascript",s.charset="UTF-8",(null!=(i=null==(r=document.getElementsByTagName("head"))?void 0:r[0])?i:document).appendChild(s)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Ql="Browser",Zs(new zn("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:i,authDomain:a}=n.options;$i(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const o={apiKey:i,authDomain:a,clientPlatform:Ql,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$a(Ql)},l=new qa(n,s,r,o);return function(e,t){const n=(null==t?void 0:t.persistence)||[],s=(Array.isArray(n)?n:[n]).map(_a);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(s,null==t?void 0:t.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Zs(new zn("auth-internal",e=>{const t=Ga(e.getProvider("auth").getImmediate());return new Gl(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),or(Bl,ql,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Ql)),or(Bl,ql,"esm2020");const Jl=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:mo,AuthCredential:io,EmailAuthCredential:co,EmailAuthProvider:po,FacebookAuthProvider:xo,GithubAuthProvider:vo,GoogleAuthProvider:bo,OAuthCredential:ho,TwitterAuthProvider:yo,beforeAuthStateChanged:Po,browserLocalPersistence:Vo,browserPopupRedirectResolver:zl,browserSessionPersistence:zo,connectAuthEmulator:no,createUserWithEmailAndPassword:To,deleteUser:Oo,getAuth:Kl,getIdTokenResult:da,inMemoryPersistence:Ea,indexedDBLocalPersistence:sl,initializeAuth:to,onAuthStateChanged:Lo,onIdTokenChanged:Do,prodErrorMap:Ri,reload:va,sendPasswordResetEmail:function(e,t,n){return p(this,null,function*(){const s=Ga(e),r={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&function(e,t,n){var s;$i((null==(s=n.url)?void 0:s.length)>0,e,"invalid-continue-uri"),$i(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),$i(void 0===n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&($i(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&($i(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}(s,r,n),yield eo(s,r,"getOobCode",lo)})},signInAnonymously:Co,signInWithCredential:So,signInWithEmailAndPassword:Ao,signInWithPopup:dl,updateProfile:Ro},Symbol.toStringTag,{value:"Module"}));var Xl,Yl,Zl="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
    Copyright The Closure Library Authors.
    SPDX-License-Identifier: Apache-2.0
    */(function(){var e;
/** @license
      
       Copyright The Closure Library Authors.
       SPDX-License-Identifier: Apache-2.0
      */function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var s=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)s[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)s[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var i=e.g[3],a=t+(i^n&(r^i))+s[0]+3614090360&4294967295;a=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=n+(a<<7&4294967295|a>>>25))+((a=i+(r^t&(n^r))+s[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=r+(n^i&(t^n))+s[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^r&(i^t))+s[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(r^i))+s[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=i+(r^t&(n^r))+s[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=r+(n^i&(t^n))+s[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^r&(i^t))+s[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(r^i))+s[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=i+(r^t&(n^r))+s[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=r+(n^i&(t^n))+s[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^r&(i^t))+s[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(r^i))+s[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=i+(r^t&(n^r))+s[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=r+(n^i&(t^n))+s[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^r&(i^t))+s[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(r^i&(n^r))+s[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^r&(t^n))+s[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=r+(t^n&(i^t))+s[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(r^i))+s[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(r^i&(n^r))+s[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^r&(t^n))+s[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=r+(t^n&(i^t))+s[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(r^i))+s[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(r^i&(n^r))+s[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^r&(t^n))+s[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=r+(t^n&(i^t))+s[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(r^i))+s[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(r^i&(n^r))+s[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^r&(t^n))+s[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=r+(t^n&(i^t))+s[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(r^i))+s[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^r^i)+s[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^r)+s[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=r+(i^t^n)+s[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(r^i^t)+s[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^r^i)+s[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^r)+s[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=r+(i^t^n)+s[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(r^i^t)+s[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^r^i)+s[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^r)+s[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=r+(i^t^n)+s[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(r^i^t)+s[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^r^i)+s[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^r)+s[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=r+(i^t^n)+s[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(r^i^t)+s[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(r^(n|~i))+s[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~r))+s[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=r+(t^(i|~n))+s[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(r|~t))+s[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(r^(n|~i))+s[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~r))+s[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=r+(t^(i|~n))+s[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(r|~t))+s[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(r^(n|~i))+s[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~r))+s[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=r+(t^(i|~n))+s[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(r|~t))+s[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((i=(t=n+((a=t+(r^(n|~i))+s[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~r))+s[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((r=i+((a=r+(t^(i|~n))+s[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+s[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+i&4294967295}function s(e,t){this.h=t;for(var n=[],s=!0,r=e.length-1;0<=r;r--){var i=0|e[r];s&&i==t||(n[r]=i,s=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,s){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return t.prototype[n].apply(e,r)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var s=t-this.blockSize,r=this.B,i=this.h,a=0;a<t;){if(0==i)for(;a<=s;)n(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(r[i++]=e.charCodeAt(a++),i==this.blockSize){n(this,r),i=0;break}}else for(;a<t;)if(r[i++]=e[a++],i==this.blockSize){n(this,r),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var s=0;32>s;s+=8)e[n++]=this.g[t]>>>s&255;return e};var r={};function i(e){return-128<=e&&128>e?function(e,t){var n=r;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new s([0|e],0>e?-1:0)}):new s([0|e],0>e?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(a(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new s(t,0)}var o=i(0),l=i(1),c=i(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new s(n,~e.h).add(l)}function m(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function f(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new f(o,o);if(d(e))return t=g(h(e),t),new f(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new f(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,s=t;0>=s.l(e);)n=x(n),s=x(s);var r=b(n,1),i=b(s,1);for(s=b(s,2),n=b(n,2);!u(s);){var c=i.add(s);0>=c.l(e)&&(r=r.add(n),i=c),s=b(s,1),n=b(n,1)}return t=m(e,r.j(t)),new f(r,t)}for(r=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),s=48>=(s=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,s-48),c=(i=a(n)).j(t);d(c)||0<c.l(e);)c=(i=a(n-=s)).j(t);u(i)&&(i=l),r=r.add(i),e=m(e,c)}return new f(r,e)}function x(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new s(n,e.h)}function b(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],a=0;a<r;a++)i[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new s(i,e.h)}(e=s.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var s=this.i(n);e+=(0<=s?s:4294967296+s)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=a(Math.pow(e,6)),n=this,s="";;){var r=g(n,t).g,i=((0<(n=m(n,r.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=r))return i+s;for(;6>i.length;)i="0"+i;s=i+s}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=m(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var a=r+(65535&this.i(i))+(65535&e.i(i)),o=(a>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=o>>>16,a&=65535,o&=65535,n[i]=o<<16|a}return new s(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return a(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var l=this.i(r)>>>16,m=65535&this.i(r),f=e.i(i)>>>16,g=65535&e.i(i);n[2*r+2*i]+=m*g,p(n,2*r+2*i),n[2*r+2*i+1]+=l*g,p(n,2*r+2*i+1),n[2*r+2*i+1]+=m*f,p(n,2*r+2*i+1),n[2*r+2*i+2]+=l*f,p(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new s(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new s(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new s(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new s(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Yl=t,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=a,s.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var s=a(Math.pow(n,8)),r=o,i=0;i<t.length;i+=8){var l=Math.min(8,t.length-i),c=parseInt(t.substring(i,i+l),n);8>l?(l=a(Math.pow(n,l)),r=r.j(l).add(a(c))):r=(r=r.j(s)).add(a(c))}return r},Xl=s}).apply(void 0!==Zl?Zl:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ec,tc,nc,sc,rc,ic,ac,oc,lc="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
    Copyright The Closure Library Authors.
    SPDX-License-Identifier: Apache-2.0
    */(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof lc&&lc];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,s){if(s)e:{var r=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var a=e[i];if(!(a in r))break e;r=r[a]}(s=s(i=r[e=e[e.length-1]]))!=i&&null!=s&&t(r,e,{configurable:!0,writable:!0,value:s})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,s=!1,r={next:function(){if(!s&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return s=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,function(e,t){return t})}});
/** @license
      
       Copyright The Closure Library Authors.
       SPDX-License-Identifier: Apache-2.0
      */
var s=s||{},r=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,s),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,s){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return t.prototype[n].apply(e,r)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let s=0;s<t;s++)n[s]=e[s];return n}return[]}function m(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,s=t.length||0;e.length=n+s;for(let r=0;r<s;r++)e[n+r]=t[r]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function f(){var e=r.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var x=!(-1==f().indexOf("Gecko")||-1!=f().toLowerCase().indexOf("webkit")&&-1==f().indexOf("Edge")||-1!=f().indexOf("Trident")||-1!=f().indexOf("MSIE")||-1!=f().indexOf("Edge"));function b(e,t,n){for(const s in e)t.call(n,e[s],s,e)}function v(e){const t={};for(const n in e)t[n]=e[n];return t}const y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(e,t){let n,s;for(let r=1;r<arguments.length;r++){for(n in s=arguments[r],s)e[n]=s[n];for(let t=0;t<y.length;t++)n=y[t],Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}}function N(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function j(e){r.setTimeout(()=>{throw e},0)}function C(){var e=I;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var _=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new k,e=>e.reset());class k{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let E,S=!1,I=new class{constructor(){this.h=this.g=null}add(e,t){const n=_.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},T=()=>{const e=r.Promise.resolve(void 0);E=()=>{e.then(A)}};var A=()=>{for(var e;e=C();){try{e.h.call(e.g)}catch(n){j(n)}var t=_;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}S=!1};function R(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};r.addEventListener("test",e,t),r.removeEventListener("test",e,t)}catch(n){}return e}();function L(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,s=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(x){e:{try{g(t.nodeName);var r=!0;break e}catch(i){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,s?(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:O[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}d(L,D);var O={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),U=0;function F(e,t,n,s,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!s,this.ha=r,this.key=++U,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function $(e){this.src=e,this.g={},this.h=0}function z(e,t){var n=t.type;if(n in e.g){var s,r=e.g[n],i=Array.prototype.indexOf.call(r,t,void 0);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function B(e,t,n,s){for(var r=0;r<e.length;++r){var i=e[r];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==s)return r}return-1}$.prototype.add=function(e,t,n,s,r){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var a=B(e,t,s,r);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new F(t,this.src,i,!!s,r)).fa=n,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),G={};function H(e,t,n,s,r){if(Array.isArray(t)){for(var i=0;i<t.length;i++)H(e,t[i],n,s,r);return null}return n=Z(n),e&&e[M]?e.K(t,n,a(s)?!!s.capture:!!s,r):function(e,t,n,s,r,i){if(!t)throw Error("Invalid event type");var o=a(r)?!!r.capture:!!r,l=X(e);if(l||(e[q]=l=new $(e)),(n=l.add(t,n,s,o,i)).proxy)return n;if(s=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=s,s.src=e,s.listener=n,e.addEventListener)P||(r=o),void 0===r&&(r=!1),e.addEventListener(t.toString(),s,r);else if(e.attachEvent)e.attachEvent(Q(t.toString()),s);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(s)}return n}(e,t,n,!1,s,r)}function W(e,t,n,s,r){if(Array.isArray(t))for(var i=0;i<t.length;i++)W(e,t[i],n,s,r);else s=a(s)?!!s.capture:!!s,n=Z(n),e&&e[M]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=B(i=e.g[t],n,s,r))&&(V(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--))):e&&(e=X(e))&&(t=e.g[t.toString()],e=-1,t&&(e=B(t,n,s,r)),(n=-1<e?t[e]:null)&&K(n))}function K(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])z(t.i,e);else{var n=e.type,s=e.proxy;t.removeEventListener?t.removeEventListener(n,s,e.capture):t.detachEvent?t.detachEvent(Q(n),s):t.addListener&&t.removeListener&&t.removeListener(s),(n=X(t))?(z(n,e),0==n.h&&(n.src=null,t[q]=null)):V(e)}}}function Q(e){return e in G?G[e]:G[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new L(t,this);var n=e.listener,s=e.ha||e.src;e.fa&&K(e),e=n.call(s,t)}return e}function X(e){return(e=e[q])instanceof $?e:null}var Y="__closure_events_fn_"+(1e9*Math.random()>>>0);function Z(e){return"function"==typeof e?e:(e[Y]||(e[Y]=function(t){return e.handleEvent(t)}),e[Y])}function ee(){R.call(this),this.i=new $(this),this.M=this,this.F=null}function te(e,t){var n,s=e.F;if(s)for(n=[];s;s=s.F)n.push(s);if(e=e.M,s=t.type||t,"string"==typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var r=t;w(t=new D(s,e),r)}if(r=!0,n)for(var i=n.length-1;0<=i;i--){var a=t.g=n[i];r=ne(a,s,!0,t)&&r}if(r=ne(a=t.g=e,s,!0,t)&&r,r=ne(a,s,!1,t)&&r,n)for(i=0;i<n.length;i++)r=ne(a=t.g=n[i],s,!1,t)&&r}function ne(e,t,n,s){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,i=0;i<t.length;++i){var a=t[i];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&z(e.i,a),r=!1!==o.call(l,s)&&r}}return r&&!s.defaultPrevented}function se(e,t,n){if("function"==typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:r.setTimeout(e,t||0)}function re(e){e.g=se(()=>{e.g=null,e.i&&(e.i=!1,re(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ee,R),ee.prototype[M]=!0,ee.prototype.removeEventListener=function(e,t,n,s){W(this,e,t,n,s)},ee.prototype.N=function(){if(ee.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],s=0;s<n.length;s++)V(n[s]);delete t.g[e],t.h--}}this.F=null},ee.prototype.K=function(e,t,n,s){return this.i.add(String(e),t,!1,n,s)},ee.prototype.L=function(e,t,n,s){return this.i.add(String(e),t,!0,n,s)};class ie extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:re(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ae(e){R.call(this),this.h=e,this.g={}}d(ae,R);var oe=[];function le(e){b(e.g,function(e,t){this.g.hasOwnProperty(t)&&K(e)},e),e.g={}}ae.prototype.N=function(){ae.aa.N.call(this),le(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=r.JSON.stringify,ue=r.JSON.parse,de=class{stringify(e){return r.JSON.stringify(e,void 0)}parse(e){return r.JSON.parse(e,void 0)}};function he(){}function me(e){return e.h||(e.h=e.i())}function pe(){}he.prototype.h=null;var fe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ge(){D.call(this,"d")}function xe(){D.call(this,"c")}d(ge,D),d(xe,D);var be={},ve=null;function ye(){return ve=ve||new ee}function we(e){D.call(this,be.La,e)}function Ne(e){const t=ye();te(t,new we(t))}function je(e,t){D.call(this,be.STAT_EVENT,e),this.stat=t}function Ce(e){const t=ye();te(t,new je(t,e))}function _e(e,t){D.call(this,be.Ma,e),this.size=t}function ke(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return r.setTimeout(function(){e()},t)}function Ee(){this.g=!0}function Se(e,t,n,s){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var s=n[e];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var a=1;a<r.length;a++)r[a]=""}}}return ce(n)}catch(o){return t}}(e,n)+(s?" "+s:"")})}be.La="serverreachability",d(we,D),be.STAT_EVENT="statevent",d(je,D),be.Ma="timingevent",d(_e,D),Ee.prototype.xa=function(){this.g=!1},Ee.prototype.info=function(){};var Ie,Te={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ae={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Re(){}function De(e,t,n,s){this.j=e,this.i=t,this.l=n,this.R=s||1,this.U=new ae(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Pe}function Pe(){this.i=null,this.g="",this.h=!1}d(Re,he),Re.prototype.g=function(){return new XMLHttpRequest},Re.prototype.i=function(){return{}},Ie=new Re;var Le={},Oe={};function Me(e,t,n){e.L=1,e.v=ct(rt(t)),e.m=n,e.P=!0,Ue(e,null)}function Ue(e,t){e.F=Date.now(),$e(e),e.A=rt(e.v);var n=e.A,s=e.R;Array.isArray(s)||(s=[String(s)]),Nt(n.i,"t",s),e.C=0,n=e.j.J,e.h=new Pe,e.g=un(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ie(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,s=e.ca;var r="readystatechange";Array.isArray(r)||(r&&(oe[0]=r.toString()),r=oe);for(var i=0;i<r.length;i++){var a=H(n,r[i],s||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?v(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ne(),function(e,t,n,s,r,i){e.info(function(){if(e.g)if(i)for(var a="",o=i.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");a=2<=d.length&&"type"==d[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+t+"\n"+n+"\n"+a})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Fe(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.j.Ca}function Ve(e,t){var n=e.C,s=t.indexOf("\n",n);return-1==s?Oe:(n=Number(t.substring(n,s)),isNaN(n)?Le:(s+=1)+n>t.length?Oe:(t=t.slice(s,s+n),e.C=s+n,t))}function $e(e){e.S=Date.now()+e.I,ze(e,e.I)}function ze(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ke(c(e.ba,e),t)}function Be(e){e.B&&(r.clearTimeout(e.B),e.B=null)}function qe(e){0==e.j.G||e.J||rn(e.j,e)}function Ge(e){Be(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,le(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function He(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Xe(n.h,e)))if(!e.K&&Xe(n.h,e)&&3==n.G){try{var s=n.Da.g.parse(t)}catch(u){s=null}if(Array.isArray(s)&&3==s.length){var r=s;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;sn(n),Wt(n)}en(n),Ce(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=ke(c(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else on(n,11)}else if((e.K||n.g==e)&&sn(n),!p(t))for(r=n.Da.g.parse(t),t=0;t<r.length;t++){let c=r[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const r=c[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(s=1.5*u,n.L=s,n.j.info("backChannelRequestTimeoutMs_="+s)),s=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=s.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(Ye(i,i.h),i.h=null))}if(s.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(s.ya=e,lt(s.I,s.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((s=n).qa=cn(s,s.J?s.ia:null,s.W),a.K){Ze(s.h,a);var o=a,l=s.L;l&&(o.I=l),o.B&&(Be(o),$e(o)),s.g=a}else Zt(s);0<n.i.length&&Qt(n)}else"stop"!=c[0]&&"close"!=c[0]||on(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?on(n,7):Ht(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ne()}catch(u){}}De.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==zt(e)?t.j():this.Y(e)},De.prototype.Y=function(e){try{if(e==this.g)e:{const h=zt(this.g);var t=this.g.Ba();if(this.g.Z(),!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Bt(this.g)))){this.J||4!=h||7==t||Ne(),Be(this);var n=this.g.Z();this.X=n;t:if(Fe(this)){var s=Bt(this.g);e="";var i=s.length,a=4==zt(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ge(this),qe(this);var o="";break t}this.h.i=new r.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(s[t],{stream:!(a&&t==i-1)});s.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,s,r,i,a){e.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+i+" "+a})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Ce(12),Ge(this),qe(this);break e}Se(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,He(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Ve(this,o),e==Oe){4==h&&(this.s=4,Ce(14),n=!1),Se(this.i,this.l,null,"[Incomplete Response]");break}if(e==Le){this.s=4,Ce(15),Se(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Se(this.i,this.l,e,null),He(this,e)}if(Fe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Ce(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),tn(d),d.M=!0,Ce(11))}}else Se(this.i,this.l,o,"[Invalid Chunked Response]"),Ge(this),qe(this)}else Se(this.i,this.l,o,null),He(this,o);4==h&&Ge(this),this.o&&!this.J&&(4==h?rn(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=zt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let s=0;s<e.length;s++){if(p(e[s]))continue;var n=N(e[s]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const i=t[r]||[];t[r]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),Ge(this),qe(this)}}}catch(h){}},De.prototype.cancel=function(){this.J=!0,Ge(this)},De.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Ne(),Ce(17)),Ge(this),this.s=2,qe(this)):ze(this,this.S-e)};var We=class{constructor(e,t){this.g=e,this.map=t}};function Ke(e){this.l=e||10,e=r.PerformanceNavigationTiming?0<(e=r.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Xe(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Ye(e,t){e.g?e.g.add(t):e.h=t}function Ze(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function et(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function tt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(i(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const s in e)t[n++]=s;return t}}}(e),s=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,s=0;s<n;s++)t.push(e[s]);return t}for(s in t=[],n=0,e)t[n++]=e[s];return t}(e),r=s.length,a=0;a<r;a++)t.call(void 0,s[a],n&&n[a],e)}Ke.prototype.cancel=function(){if(this.i=et(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var nt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,it(this,e.j),this.o=e.o,this.g=e.g,at(this,e.s),this.l=e.l;var t=e.i,n=new bt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ot(this,n),this.m=e.m}else e&&(t=String(e).match(nt))?(this.h=!1,it(this,t[1]||"",!0),this.o=ut(t[2]||""),this.g=ut(t[3]||"",!0),at(this,t[4]),this.l=ut(t[5]||"",!0),ot(this,t[6]||"",!0),this.m=ut(t[7]||"")):(this.h=!1,this.i=new bt(null,this.h))}function rt(e){return new st(e)}function it(e,t,n){e.j=n?ut(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function at(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ot(e,t,n){t instanceof bt?(e.i=t,function(e,t){t&&!e.j&&(vt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(yt(this,t),Nt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=dt(t,gt)),e.i=new bt(t,e.h))}function lt(e,t,n){e.i.set(t,n)}function ct(e){return lt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ut(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function dt(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ht),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ht(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(dt(t,mt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(dt(t,mt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(dt(n,"/"==n.charAt(0)?ft:pt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",dt(n,xt)),e.join("")};var mt=/[#\/\?@]/g,pt=/[#\?:]/g,ft=/[#\?]/g,gt=/[#\?@]/g,xt=/#/g;function bt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function vt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var s=e[n].indexOf("="),r=null;if(0<=s){var i=e[n].substring(0,s);r=e[n].substring(s+1)}else i=e[n];t(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function yt(e,t){vt(e),t=jt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function wt(e,t){return vt(e),t=jt(e,t),e.g.has(t)}function Nt(e,t,n){yt(e,t),0<n.length&&(e.i=null,e.g.set(jt(e,t),h(n)),e.h+=n.length)}function jt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ct(e,t,n,s,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),s(n)}catch(i){}}function _t(){this.g=new de}function kt(e,t,n){const s=n||"";try{tt(e,function(e,n){let r=e;a(e)&&(r=ce(e)),t.push(s+n+"="+encodeURIComponent(r))})}catch(Py){throw t.push(s+"type="+encodeURIComponent("_badmap")),Py}}function Et(e){this.l=e.Ub||null,this.j=e.eb||!1}function St(e,t){ee.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function It(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Tt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,At(e)}function At(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Rt(e){let t="";return b(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Dt(e,t,n){e:{for(s in n){var s=!1;break e}s=!0}s||(n=Rt(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):lt(e,t,n))}function Pt(e){ee.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=bt.prototype).add=function(e,t){vt(this),this.i=null,e=jt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){vt(this),this.g.forEach(function(n,s){n.forEach(function(n){e.call(t,n,s,this)},this)},this)},e.na=function(){vt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let s=0;s<t.length;s++){const r=e[s];for(let e=0;e<r.length;e++)n.push(t[s])}return n},e.V=function(e){vt(this);let t=[];if("string"==typeof e)wt(this,e)&&(t=t.concat(this.g.get(jt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return vt(this),this.i=null,wt(this,e=jt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var s=t[n];const i=encodeURIComponent(String(s)),a=this.V(s);for(s=0;s<a.length;s++){var r=i;""!==a[s]&&(r+="="+encodeURIComponent(String(a[s]))),e.push(r)}}return this.i=e.join("&")},d(Et,he),Et.prototype.g=function(){return new St(this.l,this.j)},Et.prototype.i=function(e){return function(){return e}}({}),d(St,ee),(e=St.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,At(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||r).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Tt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,At(this)),this.g&&(this.readyState=3,At(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==r.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;It(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Tt(this):At(this),3==this.readyState&&It(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Tt(this))},e.Qa=function(e){this.g&&(this.response=e,Tt(this))},e.ga=function(){this.g&&Tt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(St.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Pt,ee);var Lt=/^https?$/i,Ot=["POST","PUT"];function Mt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Ut(e),Vt(e)}function Ut(e){e.A||(e.A=!0,te(e,"complete"),te(e,"error"))}function Ft(e){if(e.h&&void 0!==s&&(!e.v[1]||4!=zt(e)||2!=e.Z()))if(e.u&&4==zt(e))se(e.Ea,0,e);else if(te(e,"readystatechange"),4==zt(e)){e.h=!1;try{const s=e.Z();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===s){var a=String(e.D).match(nt)[1]||null;!a&&r.self&&r.self.location&&(a=r.self.location.protocol.slice(0,-1)),i=!Lt.test(a?a.toLowerCase():"")}n=i}if(n)te(e,"complete"),te(e,"success");else{e.m=6;try{var o=2<zt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Ut(e)}}finally{Vt(e)}}}function Vt(e,t){if(e.g){$t(e);const n=e.g,s=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||te(e,"ready");try{n.onreadystatechange=s}catch(Py){}}}function $t(e){e.I&&(r.clearTimeout(e.I),e.I=null)}function zt(e){return e.g?e.g.readyState:0}function Bt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function qt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gt(e){this.Aa=0,this.i=[],this.j=new Ee,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=qt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=qt("baseRetryDelayMs",5e3,e),this.cb=qt("retryDelaySeedMs",1e4,e),this.Wa=qt("forwardChannelMaxRetries",2,e),this.wa=qt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ke(e&&e.concurrentRequestLimit),this.Da=new _t,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Ht(e){if(Kt(e),3==e.G){var t=e.U++,n=rt(e.I);if(lt(n,"SID",e.K),lt(n,"RID",t),lt(n,"TYPE","terminate"),Xt(e,n),(t=new De(e,e.j,t)).L=2,t.v=ct(rt(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(t.v.toString(),"")}catch(s){}!n&&r.Image&&((new Image).src=t.v,n=!0),n||(t.g=un(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}ln(e)}function Wt(e){e.g&&(tn(e),e.g.cancel(),e.g=null)}function Kt(e){Wt(e),e.u&&(r.clearTimeout(e.u),e.u=null),sn(e),e.h.cancel(),e.s&&("number"==typeof e.s&&r.clearTimeout(e.s),e.s=null)}function Qt(e){if(!Qe(e.h)&&!e.s){e.s=!0;var t=e.Ga;E||T(),S||(E(),S=!0),I.add(t,e),e.B=0}}function Jt(e,t){var n;n=t?t.l:e.U++;const s=rt(e.I);lt(s,"SID",e.K),lt(s,"RID",n),lt(s,"AID",e.T),Xt(e,s),e.m&&e.o&&Dt(s,e.m,e.o),n=new De(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=Yt(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),Ye(e.h,n),Me(n,s,t)}function Xt(e,t){e.H&&b(e.H,function(e,n){lt(t,n,e)}),e.l&&tt({},function(e,n){lt(t,n,e)})}function Yt(e,t,n){n=Math.min(e.i.length,n);var s=e.l?c(e.l.Na,e.l,e):null;e:{var r=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let o=0;o<n;o++){let n=r[o].g;const l=r[o].map;if(n-=t,0>n)t=Math.max(0,r[o].g-100),a=!1;else try{kt(l,e,"req"+n+"_")}catch(i){s&&s(l)}}if(a){s=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,s}function Zt(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;E||T(),S||(E(),S=!0),I.add(t,e),e.v=0}}function en(e){return!(e.g||e.u||3<=e.v||(e.Y++,e.u=ke(c(e.Fa,e),an(e,e.v)),e.v++,0))}function tn(e){null!=e.A&&(r.clearTimeout(e.A),e.A=null)}function nn(e){e.g=new De(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=rt(e.qa);lt(t,"RID","rpc"),lt(t,"SID",e.K),lt(t,"AID",e.T),lt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&lt(t,"TO",e.ja),lt(t,"TYPE","xmlhttp"),Xt(e,t),e.m&&e.o&&Dt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ct(rt(t)),n.m=null,n.P=!0,Ue(n,e)}function sn(e){null!=e.C&&(r.clearTimeout(e.C),e.C=null)}function rn(e,t){var n=null;if(e.g==t){sn(e),tn(e),e.g=null;var s=2}else{if(!Xe(e.h,t))return;n=t.D,Ze(e.h,t),s=1}if(0!=e.G)if(t.o)if(1==s){n=t.m?t.m.length:0,t=Date.now()-t.F;var r=e.B;te(s=ye(),new _e(s,n)),Qt(e)}else Zt(e);else if(3==(r=t.s)||0==r&&0<t.X||!(1==s&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0)||(e.s?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa)||(e.s=ke(c(e.Ga,e,t),an(e,e.B)),e.B++,0)))}(e,t)||2==s&&en(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),r){case 1:on(e,5);break;case 4:on(e,10);break;case 3:on(e,6);break;default:on(e,2)}}function an(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function on(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),s=e.Xa;const t=!s;s=new st(s||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||it(s,"https"),ct(s),t?function(e,t){const n=new Ee;if(r.Image){const s=new Image;s.onload=u(Ct,n,"TestLoadImage: loaded",!0,t,s),s.onerror=u(Ct,n,"TestLoadImage: error",!1,t,s),s.onabort=u(Ct,n,"TestLoadImage: abort",!1,t,s),s.ontimeout=u(Ct,n,"TestLoadImage: timeout",!1,t,s),r.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=e}else t(!1)}(s.toString(),n):function(e,t){new Ee;const n=new AbortController,s=setTimeout(()=>{n.abort(),Ct(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(s),e.ok?Ct(0,0,!0,t):Ct(0,0,!1,t)}).catch(()=>{clearTimeout(s),Ct(0,0,!1,t)})}(s.toString(),n)}else Ce(2);e.G=0,e.l&&e.l.sa(t),ln(e),Kt(e)}function ln(e){if(e.G=0,e.ka=[],e.l){const t=et(e.h);0==t.length&&0==e.i.length||(m(e.ka,t),m(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function cn(e,t,n){var s=n instanceof st?rt(n):new st(n);if(""!=s.g)t&&(s.g=t+"."+s.g),at(s,s.s);else{var i=r.location;s=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new st(null);s&&it(a,s),t&&(a.g=t),i&&at(a,i),n&&(a.l=n),s=a}return n=e.D,t=e.ya,n&&t&&lt(s,n,t),lt(s,"VER",e.la),Xt(e,s),s}function un(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Pt(new Et({eb:n})):new Pt(e.pa)).Ha(e.J),t}function dn(){}function hn(){}function mn(e,t){ee.call(this),this.g=new Gt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new gn(this)}function pn(e){ge.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function fn(){xe.call(this),this.status=1}function gn(e){this.g=e}(e=Pt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ie.g(),this.v=this.o?me(this.o):me(Ie),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Mt(this,a)}if(e=n||"",n=new Map(this.headers),s)if(Object.getPrototypeOf(s)===Object.prototype)for(var i in s)n.set(i,s[i]);else{if("function"!=typeof s.keys||"function"!=typeof s.get)throw Error("Unknown input type for opt_headers: "+String(s));for(const e of s.keys())n.set(e,s.get(e))}s=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=r.FormData&&e instanceof r.FormData,!(0<=Array.prototype.indexOf.call(Ot,t,void 0))||s||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[r,o]of n)this.g.setRequestHeader(r,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$t(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){Mt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,te(this,"complete"),te(this,"abort"),Vt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vt(this,!0)),Pt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Ft(this):this.bb())},e.bb=function(){Ft(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<zt(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ue(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Gt.prototype).la=8,e.G=1,e.connect=function(e,t,n,s){Ce(0),this.W=e,this.H=t||{},n&&void 0!==s&&(this.H.OSID=n,this.H.OAID=s),this.F=this.X,this.I=cn(this,null,this.W),Qt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const r=new De(this,this.j,e);let i=this.o;if(this.S&&(i?(i=v(i),w(i,this.S)):i=this.S),null!==this.m||this.O||(r.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var s=this.i[n];if(void 0===(s="__data__"in s.map&&"string"==typeof(s=s.map.__data__)?s.length:void 0))break;if(4096<(t+=s)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Yt(this,r,t),lt(n=rt(this.I),"RID",e),lt(n,"CVER",22),this.D&&lt(n,"X-HTTP-Session-Id",this.D),Xt(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Rt(i)))+"&"+t:this.m&&Dt(n,this.m,i)),Ye(this.h,r),this.Ua&&lt(n,"TYPE","init"),this.P?(lt(n,"$req",t),lt(n,"SID","null"),r.T=!0,Me(r,n,null)):Me(r,n,t),this.G=2}}else 3==this.G&&(e?Jt(this,e):0==this.i.length||Qe(this.h)||Jt(this))},e.Fa=function(){if(this.u=null,nn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=ke(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),Wt(this),nn(this))},e.Za=function(){null!=this.C&&(this.C=null,Wt(this),en(this),Ce(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=dn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},hn.prototype.g=function(e,t){return new mn(e,t)},d(mn,ee),mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mn.prototype.close=function(){Ht(this.g)},mn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=ce(e),e=n);t.i.push(new We(t.Ya++,e)),3==t.G&&Qt(t)},mn.prototype.N=function(){this.g.l=null,delete this.j,Ht(this.g),delete this.g,mn.aa.N.call(this)},d(pn,ge),d(fn,xe),d(gn,dn),gn.prototype.ua=function(){te(this.g,"a")},gn.prototype.ta=function(e){te(this.g,new pn(e))},gn.prototype.sa=function(e){te(this.g,new fn)},gn.prototype.ra=function(){te(this.g,"b")},hn.prototype.createWebChannel=hn.prototype.g,mn.prototype.send=mn.prototype.o,mn.prototype.open=mn.prototype.m,mn.prototype.close=mn.prototype.close,oc=function(){return new hn},ac=function(){return ye()},ic=be,rc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,sc=Te,Ae.COMPLETE="complete",nc=Ae,pe.EventType=fe,fe.OPEN="a",fe.CLOSE="b",fe.ERROR="c",fe.MESSAGE="d",ee.prototype.listen=ee.prototype.K,tc=pe,Pt.prototype.listenOnce=Pt.prototype.L,Pt.prototype.getLastError=Pt.prototype.Ka,Pt.prototype.getLastErrorCode=Pt.prototype.Ba,Pt.prototype.getStatus=Pt.prototype.Z,Pt.prototype.getResponseJson=Pt.prototype.Oa,Pt.prototype.getResponseText=Pt.prototype.oa,Pt.prototype.send=Pt.prototype.ea,Pt.prototype.setWithCredentials=Pt.prototype.Ha,ec=Pt}).apply(void 0!==lc?lc:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const cc="@firebase/firestore",uc="4.9.0";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class dc{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}dc.UNAUTHENTICATED=new dc(null),dc.GOOGLE_CREDENTIALS=new dc("google-credentials-uid"),dc.FIRST_PARTY=new dc("first-party-uid"),dc.MOCK_USER=new dc("mock-user");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
let hc="12.0.0";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const mc=new Yn("@firebase/firestore");function pc(){return mc.logLevel}function fc(e,...t){if(mc.logLevel<=Hn.DEBUG){const n=t.map(bc);mc.debug(`Firestore (${hc}): ${e}`,...n)}}function gc(e,...t){if(mc.logLevel<=Hn.ERROR){const n=t.map(bc);mc.error(`Firestore (${hc}): ${e}`,...n)}}function xc(e,...t){if(mc.logLevel<=Hn.WARN){const n=t.map(bc);mc.warn(`Firestore (${hc}): ${e}`,...n)}}function bc(e){if("string"==typeof e)return e;try{
/**
        * @license
        * Copyright 2020 Google LLC
        *
        * Licensed under the Apache License, Version 2.0 (the "License");
        * you may not use this file except in compliance with the License.
        * You may obtain a copy of the License at
        *
        *   http://www.apache.org/licenses/LICENSE-2.0
        *
        * Unless required by applicable law or agreed to in writing, software
        * distributed under the License is distributed on an "AS IS" BASIS,
        * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
        * See the License for the specific language governing permissions and
        * limitations under the License.
        */
return t=e,JSON.stringify(t)}catch(n){return e}var t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vc(e,t,n){let s="Unexpected state";"string"==typeof t?s=t:n=t,yc(e,s,n)}function yc(e,t,n){let s=`FIRESTORE (${hc}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{s+=" CONTEXT: "+JSON.stringify(n)}catch(r){s+=" CONTEXT: "+n}throw gc(s),new Error(s)}function wc(e,t,n,s){let r="Unexpected state";"string"==typeof n?r=n:s=n,e||yc(t,r,s)}function Nc(e,t){return e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const jc={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Cc extends Tn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _c{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class kc{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ec{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(dc.UNAUTHENTICATED))}shutdown(){}}class Sc{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Ic{constructor(e){this.t=e,this.currentUser=dc.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){wc(void 0===this.o,42304);let n=this.i;const s=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new _c;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new _c,e.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const t=r;e.enqueueRetryable(()=>p(this,null,function*(){yield t.promise,yield s(this.currentUser)}))},a=e=>{fc("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(fc("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new _c)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(fc("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(wc("string"==typeof t.accessToken,31837,{l:t}),new kc(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return wc(null===e||"string"==typeof e,2055,{h:e}),new dc(e)}}class Tc{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=dc.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Ac{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Tc(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(dc.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Rc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Dc{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,tr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){wc(void 0===this.o,3512);const n=e=>{null!=e.error&&fc("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,fc("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const s=e=>{fc("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>s(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?s(e):fc("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Rc(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(wc("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new Rc(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pc(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let s=0;s<e;s++)n[s]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Lc{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Pc(40);for(let s=0;s<n.length;++s)t.length<20&&n[s]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[s]%62))}return t}}function Oc(e,t){return e<t?-1:e>t?1:0}function Mc(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const n=e.charAt(s),r=t.charAt(s);if(n!==r)return Uc(n)===Uc(r)?Oc(n,r):Uc(n)?1:-1}return Oc(e.length,t.length)}function Uc(e){const t=e.charCodeAt(0);return t>=55296&&t<=57343}function Fc(e,t,n){return e.length===t.length&&e.every((e,s)=>n(e,t[s]))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Vc="__name__";class $c{constructor(e,t,n){void 0===t?t=0:t>e.length&&vc(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&vc(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===$c.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof $c?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const n=$c.compareSegments(e.get(s),t.get(s));if(0!==n)return n}return Oc(e.length,t.length)}static compareSegments(e,t){const n=$c.isNumericId(e),s=$c.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?$c.extractNumericId(e).compare($c.extractNumericId(t)):Mc(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xl.fromString(e.substring(4,e.length-2))}}class zc extends $c{construct(e,t,n){return new zc(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Cc(jc.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new zc(t)}static emptyPath(){return new zc([])}}const Bc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qc extends $c{construct(e,t,n){return new qc(e,t,n)}static isValidIdentifier(e){return Bc.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qc.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Vc}static keyField(){return new qc([Vc])}static fromServerFormat(e){const t=[];let n="",s=0;const r=()=>{if(0===n.length)throw new Cc(jc.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;s<e.length;){const t=e[s];if("\\"===t){if(s+1===e.length)throw new Cc(jc.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[s+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Cc(jc.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,s+=2}else"`"===t?(i=!i,s++):"."!==t||i?(n+=t,s++):(r(),s++)}if(r(),i)throw new Cc(jc.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qc(t)}static emptyPath(){return new qc([])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Gc{constructor(e){this.path=e}static fromPath(e){return new Gc(zc.fromString(e))}static fromName(e){return new Gc(zc.fromString(e).popFirst(5))}static empty(){return new Gc(zc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===zc.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return zc.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Gc(new zc(e.slice()))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hc(e,t,n){if(!n)throw new Cc(jc.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Wc(e){if(!Gc.isDocumentKey(e))throw new Cc(jc.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Kc(e){if(Gc.isDocumentKey(e))throw new Cc(jc.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Qc(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function Jc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":vc(12329,{type:typeof e})}function Xc(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Cc(jc.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Jc(e);throw new Cc(jc.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
     * @license
     * Copyright 2025 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Yc(e,t){const n={typeString:e};return t&&(n.value=t),n}function Zc(e,t){if(!Qc(e))throw new Cc(jc.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in t)if(t[s]){const r=t[s].typeString,i="value"in t[s]?{value:t[s].value}:void 0;if(!(s in e)){n=`JSON missing required field: '${s}'`;break}const a=e[s];if(r&&typeof a!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(void 0!==i&&a!==i.value){n=`Expected '${s}' field to equal '${i.value}'`;break}}if(n)throw new Cc(jc.INVALID_ARGUMENT,n);return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const eu=-62135596800,tu=1e6;class nu{static now(){return nu.fromMillis(Date.now())}static fromDate(e){return nu.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*tu);return new nu(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Cc(jc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Cc(jc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<eu)throw new Cc(jc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Cc(jc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/tu}_compareTo(e){return this.seconds===e.seconds?Oc(this.nanoseconds,e.nanoseconds):Oc(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:nu._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Zc(e,nu._jsonSchema))return new nu(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-eu;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}nu._jsonSchemaVersion="firestore/timestamp/1.0",nu._jsonSchema={type:Yc("string",nu._jsonSchemaVersion),seconds:Yc("number"),nanoseconds:Yc("number")};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class su{static fromTimestamp(e){return new su(e)}static min(){return new su(new nu(0,0))}static max(){return new su(new nu(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ru(e){return new iu(e.readTime,e.key,-1)}class iu{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new iu(su.min(),Gc.empty(),-1)}static max(){return new iu(su.max(),Gc.empty(),-1)}}function au(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Gc.comparator(e.documentKey,t.documentKey),0!==n?n:Oc(e.largestBatchId,t.largestBatchId)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */)}class ou{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function lu(e){return p(this,null,function*(){if(e.code!==jc.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;fc("LocalStore","Unexpectedly lost primary lease")})}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cu{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&vc(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new cu((n,s)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,s)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof cu?t:cu.resolve(t)}catch(t){return cu.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):cu.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):cu.reject(t)}static resolve(e){return new cu((t,n)=>{t(e)})}static reject(e){return new cu((t,n)=>{n(e)})}static waitFor(e){return new cu((t,n)=>{let s=0,r=0,i=!1;e.forEach(e=>{++s,e.next(()=>{++r,i&&r===s&&t()},e=>n(e))}),i=!0,r===s&&t()})}static or(e){let t=cu.resolve(!1);for(const n of e)t=t.next(e=>e?cu.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,s)=>{n.push(t.call(this,e,s))}),this.waitFor(n)}static mapArray(e,t){return new cu((n,s)=>{const r=e.length,i=new Array(r);let a=0;for(let o=0;o<r;o++){const l=o;t(e[l]).next(e=>{i[l]=e,++a,a===r&&n(i)},e=>s(e))}})}static doWhile(e,t){return new cu((n,s)=>{const r=()=>{!0===e()?t().next(()=>{r()},s):n()};r()})}}function uu(e){return"IndexedDbTransactionError"===e.name}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class du{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}function hu(e){return null==e}function mu(e){return 0===e&&1/e==-1/0}function pu(e,t){let n=t;const s=e.length;for(let r=0;r<s;r++){const t=e.charAt(r);switch(t){case"\0":n+="";break;case"":n+="";break;default:n+=t}}return n}function fu(e){return e+""}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function gu(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function xu(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function bu(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */du.ce=-1;class vu{constructor(e,t){this.comparator=e,this.root=t||wu.EMPTY}insert(e,t){return new vu(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,wu.BLACK,null,null))}remove(e){return new vu(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wu.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(0===s)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yu(this.root,e,this.comparator,!1)}getReverseIterator(){return new yu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yu(this.root,e,this.comparator,!0)}}class yu{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&s&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wu{constructor(e,t,n,s,r){this.key=e,this.value=t,this.color=null!=n?n:wu.RED,this.left=null!=s?s:wu.EMPTY,this.right=null!=r?r:wu.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,r){return new wu(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=s?s:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const r=n(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,t,n),null):0===r?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return wu.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===t(e,s.key)){if(s.right.isEmpty())return wu.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw vc(43730,{key:this.key,value:this.value});if(this.right.isRed())throw vc(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw vc(27949);return e+(this.isRed()?0:1)}}wu.EMPTY=null,wu.RED=!0,wu.BLACK=!1,wu.EMPTY=new class{constructor(){this.size=0}get key(){throw vc(57766)}get value(){throw vc(16141)}get color(){throw vc(16727)}get left(){throw vc(29726)}get right(){throw vc(36894)}copy(e,t,n,s,r){return this}insert(e,t,n){return new wu(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Nu{constructor(e){this.comparator=e,this.data=new vu(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ju(this.data.getIterator())}getIteratorFrom(e){return new ju(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Nu))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(e,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Nu(this.comparator);return t.data=e,t}}class ju{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Cu{constructor(e){this.fields=e,e.sort(qc.comparator)}static empty(){return new Cu([])}unionWith(e){let t=new Nu(qc.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Cu(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fc(this.fields,e.fields,(e,t)=>e.isEqual(t))}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _u extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ku{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new _u("Invalid base64 string: "+t):t}}(e);return new ku(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ku(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ku.EMPTY_BYTE_STRING=new ku("");const Eu=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Su(e){if(wc(!!e,39018),"string"==typeof e){let t=0;const n=Eu.exec(e);if(wc(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const s=new Date(e);return{seconds:Math.floor(s.getTime()/1e3),nanos:t}}return{seconds:Iu(e.seconds),nanos:Iu(e.nanos)}}function Iu(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Tu(e){return"string"==typeof e?ku.fromBase64String(e):ku.fromUint8Array(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Au="server_timestamp",Ru="__type__",Du="__previous_value__",Pu="__local_write_time__";function Lu(e){var t,n;return(null==(n=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[Ru])?void 0:n.stringValue)===Au}function Ou(e){const t=e.mapValue.fields[Du];return Lu(t)?Ou(t):t}function Mu(e){const t=Su(e.mapValue.fields[Pu].timestampValue);return new nu(t.seconds,t.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Uu{constructor(e,t,n,s,r,i,a,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=r,this.forceLongPolling=i,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const Fu="(default)";class Vu{constructor(e,t){this.projectId=e,this.database=t||Fu}static empty(){return new Vu("","")}get isDefaultDatabase(){return this.database===Fu}isEqual(e){return e instanceof Vu&&e.projectId===this.projectId&&e.database===this.database}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const $u="__type__",zu="__max__",Bu={fields:{__type__:{stringValue:zu}}},qu="__vector__",Gu="value";function Hu(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Lu(e)?4:function(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===zu}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)?9007199254740991:function(e){var t,n;const s=null==(n=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[$u])?void 0:n.stringValue;return s===qu}(e)?10:11:vc(28295,{value:e})}function Wu(e,t){if(e===t)return!0;const n=Hu(e);if(n!==Hu(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Mu(e).isEqual(Mu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Su(e.timestampValue),s=Su(t.timestampValue);return n.seconds===s.seconds&&n.nanos===s.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return s=t,Tu(e.bytesValue).isEqual(Tu(s.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Iu(e.geoPointValue.latitude)===Iu(t.geoPointValue.latitude)&&Iu(e.geoPointValue.longitude)===Iu(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Iu(e.integerValue)===Iu(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Iu(e.doubleValue),s=Iu(t.doubleValue);return n===s?mu(n)===mu(s):isNaN(n)&&isNaN(s)}return!1}(e,t);case 9:return Fc(e.arrayValue.values||[],t.arrayValue.values||[],Wu);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},s=t.mapValue.fields||{};if(gu(n)!==gu(s))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===s[r]||!Wu(n[r],s[r])))return!1;return!0}(e,t);default:return vc(52216,{left:e})}var s}function Ku(e,t){return void 0!==(e.values||[]).find(e=>Wu(e,t))}function Qu(e,t){if(e===t)return 0;const n=Hu(e),s=Hu(t);if(n!==s)return Oc(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Oc(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Iu(e.integerValue||e.doubleValue),s=Iu(t.integerValue||t.doubleValue);return n<s?-1:n>s?1:n===s?0:isNaN(n)?isNaN(s)?0:-1:1}(e,t);case 3:return Ju(e.timestampValue,t.timestampValue);case 4:return Ju(Mu(e),Mu(t));case 5:return Mc(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Tu(e),s=Tu(t);return n.compareTo(s)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),s=t.split("/");for(let r=0;r<n.length&&r<s.length;r++){const e=Oc(n[r],s[r]);if(0!==e)return e}return Oc(n.length,s.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Oc(Iu(e.latitude),Iu(t.latitude));return 0!==n?n:Oc(Iu(e.longitude),Iu(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Xu(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,s,r,i;const a=e.fields||{},o=t.fields||{},l=null==(n=a[Gu])?void 0:n.arrayValue,c=null==(s=o[Gu])?void 0:s.arrayValue,u=Oc((null==(r=null==l?void 0:l.values)?void 0:r.length)||0,(null==(i=null==c?void 0:c.values)?void 0:i.length)||0);return 0!==u?u:Xu(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Bu&&t===Bu)return 0;if(e===Bu)return 1;if(t===Bu)return-1;const n=e.fields||{},s=Object.keys(n),r=t.fields||{},i=Object.keys(r);s.sort(),i.sort();for(let a=0;a<s.length&&a<i.length;++a){const e=Mc(s[a],i[a]);if(0!==e)return e;const t=Qu(n[s[a]],r[i[a]]);if(0!==t)return t}return Oc(s.length,i.length)}(e.mapValue,t.mapValue);default:throw vc(23264,{he:n})}}function Ju(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Oc(e,t);const n=Su(e),s=Su(t),r=Oc(n.seconds,s.seconds);return 0!==r?r:Oc(n.nanos,s.nanos)}function Xu(e,t){const n=e.values||[],s=t.values||[];for(let r=0;r<n.length&&r<s.length;++r){const e=Qu(n[r],s[r]);if(e)return e}return Oc(n.length,s.length)}function Yu(e){return Zu(e)}function Zu(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Su(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Tu(e.bytesValue).toBase64():"referenceValue"in e?function(e){return Gc.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const s of e.values||[])n?n=!1:t+=",",t+=Zu(s);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",s=!0;for(const r of t)s?s=!1:n+=",",n+=`${r}:${Zu(e.fields[r])}`;return n+"}"}(e.mapValue):vc(61005,{value:e})}function ed(e){switch(Hu(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Ou(e);return t?16+ed(t):16;case 5:return 2*e.stringValue.length;case 6:return Tu(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(e.arrayValue.values||[]).reduce((e,t)=>e+ed(t),0);case 10:case 11:return function(e){let t=0;return xu(e.fields,(e,n)=>{t+=e.length+ed(n)}),t}(e.mapValue);default:throw vc(13486,{value:e})}}function td(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function nd(e){return!!e&&"integerValue"in e}function sd(e){return!!e&&"arrayValue"in e}function rd(e){return!!e&&"nullValue"in e}function id(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ad(e){return!!e&&"mapValue"in e}function od(e){if(e.geoPointValue)return{geoPointValue:u({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:u({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return xu(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=od(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=od(e.arrayValue.values[n]);return t}return u({},e)}class ld{constructor(e){this.value=e}static empty(){return new ld({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ad(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=od(t)}setAll(e){let t=qc.emptyPath(),n={},s=[];e.forEach((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,s),n={},s=[],t=r.popLast()}e?n[r.lastSegment()]=od(e):s.push(r.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,n,s)}delete(e){const t=this.field(e.popLast());ad(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];ad(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){xu(t,(t,n)=>e[t]=n);for(const s of n)delete e[s]}clone(){return new ld(od(this.value))}}function cd(e){const t=[];return xu(e.fields,(e,n)=>{const s=new qc([e]);if(ad(n)){const e=cd(n.mapValue).fields;if(0===e.length)t.push(s);else for(const n of e)t.push(s.child(n))}else t.push(s)}),new Cu(t)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class ud{constructor(e,t,n,s,r,i,a){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=r,this.data=i,this.documentState=a}static newInvalidDocument(e){return new ud(e,0,su.min(),su.min(),su.min(),ld.empty(),0)}static newFoundDocument(e,t,n,s){return new ud(e,1,t,su.min(),n,s,0)}static newNoDocument(e,t){return new ud(e,2,t,su.min(),su.min(),ld.empty(),0)}static newUnknownDocument(e,t){return new ud(e,3,t,su.min(),su.min(),ld.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(su.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ld.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ld.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=su.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ud&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ud(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class dd{constructor(e,t){this.position=e,this.inclusive=t}}function hd(e,t,n){let s=0;for(let r=0;r<e.position.length;r++){const i=t[r],a=e.position[r];if(s=i.field.isKeyField()?Gc.comparator(Gc.fromName(a.referenceValue),n.key):Qu(a,n.data.field(i.field)),"desc"===i.dir&&(s*=-1),0!==s)break}return s}function md(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Wu(e.position[n],t.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class pd{constructor(e,t="asc"){this.field=e,this.dir=t}}function fd(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gd{}class xd extends gd{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Cd(e,t,n):"array-contains"===t?new Sd(e,n):"in"===t?new Id(e,n):"not-in"===t?new Td(e,n):"array-contains-any"===t?new Ad(e,n):new xd(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new _d(e,n):new kd(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(Qu(t,this.value)):null!==t&&Hu(this.value)===Hu(t)&&this.matchesComparison(Qu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return vc(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class bd extends gd{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new bd(e,t)}matches(e){return vd(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function vd(e){return"and"===e.op}function yd(e){return function(e){for(const t of e.filters)if(t instanceof bd)return!1;return!0}(e)&&vd(e)}function wd(e){if(e instanceof xd)return e.field.canonicalString()+e.op.toString()+Yu(e.value);if(yd(e))return e.filters.map(e=>wd(e)).join(",");{const t=e.filters.map(e=>wd(e)).join(",");return`${e.op}(${t})`}}function Nd(e,t){return e instanceof xd?(n=e,(s=t)instanceof xd&&n.op===s.op&&n.field.isEqual(s.field)&&Wu(n.value,s.value)):e instanceof bd?function(e,t){return t instanceof bd&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,s)=>e&&Nd(n,t.filters[s]),!0)}(e,t):void vc(19439);var n,s}function jd(e){return e instanceof xd?`${(t=e).field.canonicalString()} ${t.op} ${Yu(t.value)}`:e instanceof bd?function(e){return e.op.toString()+" {"+e.getFilters().map(jd).join(" ,")+"}"}(e):"Filter";var t}class Cd extends xd{constructor(e,t,n){super(e,t,n),this.key=Gc.fromName(n.referenceValue)}matches(e){const t=Gc.comparator(e.key,this.key);return this.matchesComparison(t)}}class _d extends xd{constructor(e,t){super(e,"in",t),this.keys=Ed(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class kd extends xd{constructor(e,t){super(e,"not-in",t),this.keys=Ed(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Ed(e,t){var n;return((null==(n=t.arrayValue)?void 0:n.values)||[]).map(e=>Gc.fromName(e.referenceValue))}class Sd extends xd{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return sd(t)&&Ku(t.arrayValue,this.value)}}class Id extends xd{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ku(this.value.arrayValue,t)}}class Td extends xd{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ku(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Ku(this.value.arrayValue,t)}}class Ad extends xd{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!sd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Ku(this.value.arrayValue,e))}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Rd{constructor(e,t=null,n=[],s=[],r=null,i=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=r,this.startAt=i,this.endAt=a,this.Te=null}}function Dd(e,t=null,n=[],s=[],r=null,i=null,a=null){return new Rd(e,t,n,s,r,i,a)}function Pd(e){const t=Nc(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>wd(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),hu(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Yu(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Yu(e)).join(",")),t.Te=e}return t.Te}function Ld(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!fd(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Nd(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!md(e.startAt,t.startAt)&&md(e.endAt,t.endAt)}function Od(e){return Gc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Md{constructor(e,t=null,n=[],s=[],r=null,i="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=r,this.limitType=i,this.startAt=a,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Ud(e){return new Md(e)}function Fd(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Vd(e){return null!==e.collectionGroup}function $d(e){const t=Nc(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const s of t.explicitOrderBy)t.Ie.push(s),e.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(e){let t=new Nu(qc.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t})(t).forEach(s=>{e.has(s.canonicalString())||s.isKeyField()||t.Ie.push(new pd(s,n))}),e.has(qc.keyField().canonicalString())||t.Ie.push(new pd(qc.keyField(),n))}return t.Ie}function zd(e){const t=Nc(e);return t.Ee||(t.Ee=function(e,t){if("F"===e.limitType)return Dd(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new pd(e.field,t)});const n=e.endAt?new dd(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new dd(e.startAt.position,e.startAt.inclusive):null;return Dd(e.path,e.collectionGroup,t,e.filters,e.limit,n,s)}}(t,$d(e))),t.Ee}function Bd(e,t){const n=e.filters.concat([t]);return new Md(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function qd(e,t,n){return new Md(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Gd(e,t){return Ld(zd(e),zd(t))&&e.limitType===t.limitType}function Hd(e){return`${Pd(zd(e))}|lt:${e.limitType}`}function Wd(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>jd(e)).join(", ")}]`),hu(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Yu(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Yu(e)).join(",")),`Target(${t})`}(zd(e))}; limitType=${e.limitType})`}function Kd(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Gc.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of $d(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(s=t,!((n=e).startAt&&!function(e,t,n){const s=hd(e,t,n);return e.inclusive?s<=0:s<0}(n.startAt,$d(n),s)||n.endAt&&!function(e,t,n){const s=hd(e,t,n);return e.inclusive?s>=0:s>0}(n.endAt,$d(n),s)));var n,s}function Qd(e){return(t,n)=>{let s=!1;for(const r of $d(e)){const e=Jd(r,t,n);if(0!==e)return e;s=s||r.field.isKeyField()}return 0}}function Jd(e,t,n){const s=e.field.isKeyField()?Gc.comparator(t.key,n.key):function(e,t,n){const s=t.data.field(e),r=n.data.field(e);return null!==s&&null!==r?Qu(s,r):vc(42886)}(e.field,t,n);switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return vc(19790,{direction:e.dir})}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Xd{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[s,r]of n)if(this.equalsFn(s,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(void 0===s)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return void(s[r]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return 1===n.length?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){xu(this.inner,(t,n)=>{for(const[s,r]of n)e(s,r)})}isEmpty(){return bu(this.inner)}size(){return this.innerSize}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Yd=new vu(Gc.comparator);function Zd(){return Yd}const eh=new vu(Gc.comparator);function th(...e){let t=eh;for(const n of e)t=t.insert(n.key,n);return t}function nh(e){let t=eh;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function sh(){return ih()}function rh(){return ih()}function ih(){return new Xd(e=>e.toString(),(e,t)=>e.isEqual(t))}const ah=new vu(Gc.comparator),oh=new Nu(Gc.comparator);function lh(...e){let t=oh;for(const n of e)t=t.add(n);return t}const ch=new Nu(Oc);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function uh(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mu(t)?"-0":t}}function dh(e){return{integerValue:""+e}}function hh(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!mu(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)?dh(t):uh(e,t)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class mh{constructor(){this._=void 0}}function ph(e,t,n){return e instanceof xh?function(e,t){const n={fields:{[Ru]:{stringValue:Au},[Pu]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Lu(t)&&(t=Ou(t)),t&&(n.fields[Du]=t),{mapValue:n}}(n,t):e instanceof bh?vh(e,t):e instanceof yh?wh(e,t):function(e,t){const n=gh(e,t),s=jh(n)+jh(e.Ae);return nd(n)&&nd(e.Ae)?dh(s):uh(e.serializer,s)}(e,t)}function fh(e,t,n){return e instanceof bh?vh(e,t):e instanceof yh?wh(e,t):n}function gh(e,t){return e instanceof Nh?nd(n=t)||(s=n)&&"doubleValue"in s?t:{integerValue:0}:null;var n,s}class xh extends mh{}class bh extends mh{constructor(e){super(),this.elements=e}}function vh(e,t){const n=Ch(t);for(const s of e.elements)n.some(e=>Wu(e,s))||n.push(s);return{arrayValue:{values:n}}}class yh extends mh{constructor(e){super(),this.elements=e}}function wh(e,t){let n=Ch(t);for(const s of e.elements)n=n.filter(e=>!Wu(e,s));return{arrayValue:{values:n}}}class Nh extends mh{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function jh(e){return Iu(e.integerValue||e.doubleValue)}function Ch(e){return sd(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _h{constructor(e,t){this.field=e,this.transform=t}}class kh{constructor(e,t){this.version=e,this.transformResults=t}}class Eh{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Eh}static exists(e){return new Eh(void 0,e)}static updateTime(e){return new Eh(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sh(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ih{}function Th(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Vh(e.key,Eh.none()):new Lh(e.key,e.data,Eh.none());{const n=e.data,s=ld.empty();let r=new Nu(qc.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?s.delete(e):s.set(e,t),r=r.add(e)}return new Oh(e.key,s,new Cu(r.toArray()),Eh.none())}}function Ah(e,t,n){var s;e instanceof Lh?function(e,t,n){const s=e.value.clone(),r=Uh(e.fieldTransforms,t,n.transformResults);s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):e instanceof Oh?function(e,t,n){if(!Sh(e.precondition,t))return void t.convertToUnknownDocument(n.version);const s=Uh(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(Mh(e)),r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):(s=n,t.convertToNoDocument(s.version).setHasCommittedMutations())}function Rh(e,t,n,s){return e instanceof Lh?function(e,t,n,s){if(!Sh(e.precondition,t))return n;const r=e.value.clone(),i=Fh(e.fieldTransforms,s,t);return r.setAll(i),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,s):e instanceof Oh?function(e,t,n,s){if(!Sh(e.precondition,t))return n;const r=Fh(e.fieldTransforms,s,t),i=t.data;return i.setAll(Mh(e)),i.setAll(r),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,s):(r=t,i=n,Sh(e.precondition,r)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):i);var r,i}function Dh(e,t){let n=null;for(const s of e.fieldTransforms){const e=t.data.field(s.field),r=gh(s.transform,e||null);null!=r&&(null===n&&(n=ld.empty()),n.set(s.field,r))}return n||null}function Ph(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,s=t.fieldTransforms,!!(void 0===n&&void 0===s||n&&s&&Fc(n,s,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,s=t.transform,n instanceof bh&&s instanceof bh||n instanceof yh&&s instanceof yh?Fc(n.elements,s.elements,Wu):n instanceof Nh&&s instanceof Nh?Wu(n.Ae,s.Ae):n instanceof xh&&s instanceof xh);var n,s}(e,t)))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,s}class Lh extends Ih{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Oh extends Ih{constructor(e,t,n,s,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Mh(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=e.data.field(n);t.set(n,s)}}),t}function Uh(e,t,n){const s=new Map;wc(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let r=0;r<n.length;r++){const i=e[r],a=i.transform,o=t.data.field(i.field);s.set(i.field,fh(a,o,n[r]))}return s}function Fh(e,t,n){const s=new Map;for(const r of e){const e=r.transform,i=n.data.field(r.field);s.set(r.field,ph(e,i,t))}return s}class Vh extends Ih{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $h extends Ih{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zh{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const t=this.mutations[s];t.key.isEqual(e.key)&&Ah(t,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Rh(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Rh(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=rh();return this.mutations.forEach(s=>{const r=e.get(s.key),i=r.overlayedDocument;let a=this.applyToLocalView(i,r.mutatedFields);a=t.has(s.key)?null:a;const o=Th(i,a);null!==o&&n.set(s.key,o),i.isValidDocument()||i.convertToNoDocument(su.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),lh())}isEqual(e){return this.batchId===e.batchId&&Fc(this.mutations,e.mutations,(e,t)=>Ph(e,t))&&Fc(this.baseMutations,e.baseMutations,(e,t)=>Ph(e,t))}}class Bh{constructor(e,t,n,s){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=s}static from(e,t,n){wc(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return ah}();const r=e.mutations;for(let i=0;i<r.length;i++)s=s.insert(r[i].key,n[i].version);return new Bh(e,t,n,s)}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class qh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Gh{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Hh,Wh;function Kh(e){if(void 0===e)return gc("GRPC error has no .code"),jc.UNKNOWN;switch(e){case Hh.OK:return jc.OK;case Hh.CANCELLED:return jc.CANCELLED;case Hh.UNKNOWN:return jc.UNKNOWN;case Hh.DEADLINE_EXCEEDED:return jc.DEADLINE_EXCEEDED;case Hh.RESOURCE_EXHAUSTED:return jc.RESOURCE_EXHAUSTED;case Hh.INTERNAL:return jc.INTERNAL;case Hh.UNAVAILABLE:return jc.UNAVAILABLE;case Hh.UNAUTHENTICATED:return jc.UNAUTHENTICATED;case Hh.INVALID_ARGUMENT:return jc.INVALID_ARGUMENT;case Hh.NOT_FOUND:return jc.NOT_FOUND;case Hh.ALREADY_EXISTS:return jc.ALREADY_EXISTS;case Hh.PERMISSION_DENIED:return jc.PERMISSION_DENIED;case Hh.FAILED_PRECONDITION:return jc.FAILED_PRECONDITION;case Hh.ABORTED:return jc.ABORTED;case Hh.OUT_OF_RANGE:return jc.OUT_OF_RANGE;case Hh.UNIMPLEMENTED:return jc.UNIMPLEMENTED;case Hh.DATA_LOSS:return jc.DATA_LOSS;default:return vc(39323,{code:e})}}(Wh=Hh||(Hh={}))[Wh.OK=0]="OK",Wh[Wh.CANCELLED=1]="CANCELLED",Wh[Wh.UNKNOWN=2]="UNKNOWN",Wh[Wh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wh[Wh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wh[Wh.NOT_FOUND=5]="NOT_FOUND",Wh[Wh.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wh[Wh.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wh[Wh.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wh[Wh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wh[Wh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wh[Wh.ABORTED=10]="ABORTED",Wh[Wh.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wh[Wh.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wh[Wh.INTERNAL=13]="INTERNAL",Wh[Wh.UNAVAILABLE=14]="UNAVAILABLE",Wh[Wh.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Qh=new Xl([4294967295,4294967295],0);function Jh(e){const t=(new TextEncoder).encode(e),n=new Yl;return n.update(t),new Uint8Array(n.digest())}function Xh(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),s=t.getUint32(4,!0),r=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new Xl([n,s],0),new Xl([r,i],0)]}class Yh{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Zh(`Invalid padding: ${t}`);if(n<0)throw new Zh(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Zh(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Zh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Xl.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(Xl.fromNumber(n)));return 1===s.compare(Qh)&&(s=new Xl([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=Jh(e),[n,s]=Xh(t);for(let r=0;r<this.hashCount;r++){const e=this.ye(n,s,r);if(!this.we(e))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),i=new Yh(r,s,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.ge)return;const t=Jh(e),[n,s]=Xh(t);for(let r=0;r<this.hashCount;r++){const e=this.ye(n,s,r);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Zh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class em{constructor(e,t,n,s,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,tm.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new em(su.min(),s,new vu(Oc),Zd(),lh())}}class tm{constructor(e,t,n,s,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new tm(n,t,lh(),lh(),lh())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class nm{constructor(e,t,n,s){this.be=e,this.removedTargetIds=t,this.key=n,this.De=s}}class sm{constructor(e,t){this.targetId=e,this.Ce=t}}class rm{constructor(e,t,n=ku.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class im{constructor(){this.ve=0,this.Fe=lm(),this.Me=ku.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=lh(),t=lh(),n=lh();return this.Fe.forEach((s,r)=>{switch(r){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:vc(38017,{changeType:r})}}),new tm(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=lm()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,wc(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class am{constructor(e){this.Ge=e,this.ze=new Map,this.je=Zd(),this.Je=om(),this.He=om(),this.Ye=new vu(Oc)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:vc(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const r=s.target;if(Od(r))if(0===n){const e=new Gc(r.path);this.et(t,e,ud.newNoDocument(e,su.min()))}else wc(1===n,20013,{expectedCount:n});else{const s=this._t(t);if(s!==n){const n=this.ut(e),r=n?this.ct(n,e,s):1;if(0!==r){this.it(t);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:r=0}=t;let i,a;try{i=Tu(n).toUint8Array()}catch(o){if(o instanceof _u)return xc("Decoding the base64 bloom filter in existence filter failed ("+o.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw o}try{a=new Yh(i,s,r)}catch(o){return xc(o instanceof Zh?"BloomFilter error: ":"Applying bloom filter failed: ",o),null}return 0===a.ge?null:a}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach(n=>{const r=this.Ge.ht(),i=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;e.mightContain(i)||(this.et(t,n,null),s++)}),s}Tt(e){const t=new Map;this.ze.forEach((n,s)=>{const r=this.ot(s);if(r){if(n.current&&Od(r.target)){const t=new Gc(r.target.path);this.It(t).has(s)||this.Et(s,t)||this.et(s,t,ud.newNoDocument(t,e))}n.Be&&(t.set(s,n.ke()),n.qe())}});let n=lh();this.He.forEach((e,t)=>{let s=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(s=!1,!1)}),s&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const s=new em(e,t,this.Ye,this.je,n);return this.je=Zd(),this.Je=om(),this.He=om(),this.Ye=new vu(Oc),s}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new im,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Nu(Oc),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Nu(Oc),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||fc("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new im),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function om(){return new vu(Gc.comparator)}function lm(){return new vu(Gc.comparator)}const cm=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),um=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),dm=(()=>({and:"AND",or:"OR"}))();class hm{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function mm(e,t){return e.useProto3Json||hu(t)?t:{value:t}}function pm(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function fm(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function gm(e,t){return pm(e,t.toTimestamp())}function xm(e){return wc(!!e,49232),su.fromTimestamp(function(e){const t=Su(e);return new nu(t.seconds,t.nanos)}(e))}function bm(e,t){return vm(e,t).canonicalString()}function vm(e,t){const n=(s=e,new zc(["projects",s.projectId,"databases",s.database])).child("documents");var s;return void 0===t?n:n.child(t)}function ym(e){const t=zc.fromString(e);return wc(Um(t),10190,{key:t.toString()}),t}function wm(e,t){return bm(e.databaseId,t.path)}function Nm(e,t){const n=ym(t);if(n.get(1)!==e.databaseId.projectId)throw new Cc(jc.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Cc(jc.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Gc(_m(n))}function jm(e,t){return bm(e.databaseId,t)}function Cm(e){return new zc(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function _m(e){return wc(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function km(e,t,n){return{name:wm(e,t),fields:n.value.mapValue.fields}}function Em(e,t){return{documents:[jm(e,t.path)]}}function Sm(e,t){const n={structuredQuery:{}},s=t.path;let r;null!==t.collectionGroup?(r=s,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=jm(e,r);const i=function(e){if(0!==e.length)return Om(bd.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const a=function(e){if(0!==e.length)return e.map(e=>{return{field:Pm((t=e).field),direction:Am(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=mm(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:r};var l}function Im(e){let t=function(e){const t=ym(e);return 4===t.length?zc.emptyPath():_m(t)}(e.parent);const n=e.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){wc(1===s,65062);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=Tm(e);return t instanceof bd&&yd(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=n.orderBy.map(e=>{return new pd(Lm((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,hu(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new dd(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new dd(n,t)}(n.endAt)),function(e,t,n,s,r,i,a,o){return new Md(e,t,n,s,r,i,a,o)}(t,r,a,i,o,"F",l,c)}function Tm(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Lm(e.unaryFilter.field);return xd.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Lm(e.unaryFilter.field);return xd.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Lm(e.unaryFilter.field);return xd.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Lm(e.unaryFilter.field);return xd.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return vc(61313);default:return vc(60726)}}(e):void 0!==e.fieldFilter?(t=e,xd.create(Lm(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return vc(58110);default:return vc(50506)}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return bd.create(e.compositeFilter.filters.map(e=>Tm(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return vc(1026)}}(e.compositeFilter.op))}(e):vc(30097,{filter:e});var t}function Am(e){return cm[e]}function Rm(e){return um[e]}function Dm(e){return dm[e]}function Pm(e){return{fieldPath:e.canonicalString()}}function Lm(e){return qc.fromServerFormat(e.fieldPath)}function Om(e){return e instanceof xd?function(e){if("=="===e.op){if(id(e.value))return{unaryFilter:{field:Pm(e.field),op:"IS_NAN"}};if(rd(e.value))return{unaryFilter:{field:Pm(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(id(e.value))return{unaryFilter:{field:Pm(e.field),op:"IS_NOT_NAN"}};if(rd(e.value))return{unaryFilter:{field:Pm(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pm(e.field),op:Rm(e.op),value:e.value}}}(e):e instanceof bd?function(e){const t=e.getFilters().map(e=>Om(e));return 1===t.length?t[0]:{compositeFilter:{op:Dm(e.op),filters:t}}}(e):vc(54877,{filter:e})}function Mm(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Um(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Fm{constructor(e,t,n,s,r=su.min(),i=su.min(),a=ku.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new Fm(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Fm(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fm(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fm(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Vm{constructor(e){this.yt=e}}function $m(e){const t=Im({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?qd(t,t.limit,"L"):t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zm{constructor(){this.Cn=new Bm}addToCollectionParentIndex(e,t){return this.Cn.add(t),cu.resolve()}getCollectionParents(e,t){return cu.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return cu.resolve()}deleteFieldIndex(e,t){return cu.resolve()}deleteAllFieldIndexes(e){return cu.resolve()}createTargetIndexes(e,t){return cu.resolve()}getDocumentsMatchingTarget(e,t){return cu.resolve(null)}getIndexType(e,t){return cu.resolve(0)}getFieldIndexes(e,t){return cu.resolve([])}getNextCollectionGroupToUpdate(e){return cu.resolve(null)}getMinOffset(e,t){return cu.resolve(iu.min())}getMinOffsetFromCollectionGroup(e,t){return cu.resolve(iu.min())}updateCollectionGroup(e,t,n){return cu.resolve()}updateIndexEntries(e,t){return cu.resolve()}}class Bm{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new Nu(zc.comparator),r=!s.has(n);return this.index[t]=s.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Nu(zc.comparator)).toArray()}}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const qm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Gm=41943040;class Hm{static withCacheSize(e){return new Hm(e,Hm.DEFAULT_COLLECTION_PERCENTILE,Hm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Hm.DEFAULT_COLLECTION_PERCENTILE=10,Hm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Hm.DEFAULT=new Hm(Gm,Hm.DEFAULT_COLLECTION_PERCENTILE,Hm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Hm.DISABLED=new Hm(-1,0,0);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Wm{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Wm(0)}static cr(){return new Wm(-1)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Km="LruGarbageCollector";function Qm([e,t],[n,s]){const r=Oc(e,n);return 0===r?Oc(t,s):r}class Jm{constructor(e){this.Ir=e,this.buffer=new Nu(Qm),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Qm(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Xm{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){fc(Km,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>p(this,null,function*(){this.Rr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(e){uu(e)?fc(Km,"Ignoring IndexedDB error during garbage collection: ",e):yield lu(e)}yield this.Vr(3e5)}))}}class Ym{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return cu.resolve(du.ce);const n=new Jm(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(fc("LruGarbageCollector","Garbage collection skipped; disabled"),cu.resolve(qm)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(fc("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qm):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,s,r,i,a,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(fc("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),s=this.params.maximumSequenceNumbersToCollect):s=t,i=Date.now(),this.nthSequenceNumber(e,s))).next(s=>(n=s,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(r=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),pc()<=Hn.DEBUG&&fc("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-c}ms\n\tDetermined least recently used ${s} in `+(a-i)+`ms\n\tRemoved ${r} targets in `+(o-a)+`ms\n\tRemoved ${e} documents in `+(l-o)+`ms\nTotal Duration: ${l-c}ms`),cu.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:e})))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Zm{constructor(){this.changes=new Xd(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ud.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?cu.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ep{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class tp{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Rh(n.mutation,e,Cu.empty(),nu.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,lh()).next(()=>t))}getLocalViewOfDocuments(e,t,n=lh()){const s=sh();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,n).next(e=>{let t=th();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=sh();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,lh()))}populateOverlays(e,t,n){const s=[];return n.forEach(e=>{t.has(e)||s.push(e)}),this.documentOverlayCache.getOverlays(e,s).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,s){let r=Zd();const i=ih(),a=ih();return t.forEach((e,t)=>{const a=n.get(t.key);s.has(t.key)&&(void 0===a||a.mutation instanceof Oh)?r=r.insert(t.key,t):void 0!==a?(i.set(t.key,a.mutation.getFieldMask()),Rh(a.mutation,t,a.mutation.getFieldMask(),nu.now())):i.set(t.key,Cu.empty())}),this.recalculateAndSaveOverlays(e,r).next(e=>(e.forEach((e,t)=>i.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new ep(t,null!=(n=i.get(e))?n:null))}),a))}recalculateAndSaveOverlays(e,t){const n=ih();let s=new vu((e,t)=>e-t),r=lh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const r of e)r.keys().forEach(e=>{const i=t.get(e);if(null===i)return;let a=n.get(e)||Cu.empty();a=r.applyToLocalView(i,a),n.set(e,a);const o=(s.get(r.batchId)||lh()).add(e);s=s.insert(r.batchId,o)})}).next(()=>{const i=[],a=s.getReverseIterator();for(;a.hasNext();){const s=a.getNext(),o=s.key,l=s.value,c=rh();l.forEach(e=>{if(!r.has(e)){const s=Th(t.get(e),n.get(e));null!==s&&c.set(e,s),r=r.add(e)}}),i.push(this.documentOverlayCache.saveOverlays(e,o,c))}return cu.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,s){return r=t,Gc.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Vd(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s);var r}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next(r=>{const i=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-r.size):cu.resolve(sh());let a=-1,o=r;return i.next(t=>cu.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),r.get(t)?cu.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,r)).next(()=>this.computeViews(e,o,t,lh())).next(e=>({batchId:a,changes:nh(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Gc(t)).next(e=>{let t=th();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const r=t.collectionGroup;let i=th();return this.indexManager.getCollectionParents(e,r).next(a=>cu.forEach(a,a=>{const o=(l=t,c=a.child(r),new Md(c,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,c;return this.getDocumentsMatchingCollectionQuery(e,o,n,s).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n,s){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,s))).next(e=>{r.forEach((t,n)=>{const s=n.getKey();null===e.get(s)&&(e=e.insert(s,ud.newInvalidDocument(s)))});let n=th();return e.forEach((e,s)=>{const i=r.get(e);void 0!==i&&Rh(i.mutation,s,Cu.empty(),nu.now()),Kd(t,s)&&(n=n.insert(e,s))}),n})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class np{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return cu.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,{id:(n=t).id,version:n.version,createTime:xm(n.createTime)}),cu.resolve();var n}getNamedQuery(e,t){return cu.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,{name:(n=t).name,query:$m(n.bundledQuery),readTime:xm(n.readTime)}),cu.resolve();var n}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class sp{constructor(){this.overlays=new vu(Gc.comparator),this.qr=new Map}getOverlay(e,t){return cu.resolve(this.overlays.get(t))}getOverlays(e,t){const n=sh();return cu.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,s)=>{this.St(e,t,s)}),cu.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.qr.get(n);return void 0!==s&&(s.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),cu.resolve()}getOverlaysForCollection(e,t,n){const s=sh(),r=t.length+1,i=new Gc(t.child("")),a=this.overlays.getIteratorFrom(i);for(;a.hasNext();){const e=a.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===r&&e.largestBatchId>n&&s.set(e.getKey(),e)}return cu.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let r=new vu((e,t)=>e-t);const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=sh(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=sh(),o=r.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=s)););return cu.resolve(a)}St(e,t,n){const s=this.overlays.get(n.key);if(null!==s){const e=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new qh(t,n));let r=this.qr.get(t);void 0===r&&(r=lh(),this.qr.set(t,r)),this.qr.set(t,r.add(n.key))}}
/**
     * @license
     * Copyright 2024 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class rp{constructor(){this.sessionToken=ku.EMPTY_BYTE_STRING}getSessionToken(e){return cu.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,cu.resolve()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ip{constructor(){this.Qr=new Nu(ap.$r),this.Ur=new Nu(ap.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new ap(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new ap(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new Gc(new zc([])),n=new ap(t,e),s=new ap(t,e+1),r=[];return this.Ur.forEachInRange([n,s],e=>{this.Gr(e),r.push(e.key)}),r}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Gc(new zc([])),n=new ap(t,e),s=new ap(t,e+1);let r=lh();return this.Ur.forEachInRange([n,s],e=>{r=r.add(e.key)}),r}containsKey(e){const t=new ap(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ap{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Gc.comparator(e.key,t.key)||Oc(e.Yr,t.Yr)}static Kr(e,t){return Oc(e.Yr,t.Yr)||Gc.comparator(e.key,t.key)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class op{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Nu(ap.$r)}checkEmpty(e){return cu.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,s){const r=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new zh(r,t,n,s);this.mutationQueue.push(i);for(const a of s)this.Zr=this.Zr.add(new ap(a.key,r)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return cu.resolve(i)}lookupMutationBatch(e,t){return cu.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.ei(n),r=s<0?0:s;return cu.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return cu.resolve(0===this.mutationQueue.length?-1:this.tr-1)}getAllMutationBatches(e){return cu.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ap(t,0),s=new ap(t,Number.POSITIVE_INFINITY),r=[];return this.Zr.forEachInRange([n,s],e=>{const t=this.Xr(e.Yr);r.push(t)}),cu.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Nu(Oc);return t.forEach(e=>{const t=new ap(e,0),s=new ap(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,s],e=>{n=n.add(e.Yr)})}),cu.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let r=n;Gc.isDocumentKey(r)||(r=r.child(""));const i=new ap(new Gc(r),0);let a=new Nu(Oc);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===s&&(a=a.add(e.Yr)),!0)},i),cu.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){wc(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return cu.forEach(t.mutations,s=>{const r=new ap(s.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new ap(t,0),s=this.Zr.firstAfterOrEqual(n);return cu.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,cu.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lp{constructor(e){this.ri=e,this.docs=new vu(Gc.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),r=s?s.size:0,i=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return cu.resolve(n?n.document.mutableCopy():ud.newInvalidDocument(t))}getEntries(e,t){let n=Zd();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ud.newInvalidDocument(e))}),cu.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let r=Zd();const i=t.path,a=new Gc(i.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||au(ru(a),n)<=0||(s.has(a.key)||Kd(t,a))&&(r=r.insert(a.key,a.mutableCopy()))}return cu.resolve(r)}getAllFromCollectionGroup(e,t,n,s){vc(9500)}ii(e,t){return cu.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new cp(this)}getSize(e){return cu.resolve(this.size)}}class cp extends Zm{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),cu.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class up{constructor(e){this.persistence=e,this.si=new Xd(e=>Pd(e),Ld),this.lastRemoteSnapshotVersion=su.min(),this.highestTargetId=0,this.oi=0,this._i=new ip,this.targetCount=0,this.ai=Wm.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),cu.resolve()}getLastRemoteSnapshotVersion(e){return cu.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return cu.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),cu.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),cu.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Wm(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,cu.resolve()}updateTargetData(e,t){return this.Pr(t),cu.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,cu.resolve()}removeTargets(e,t,n){let s=0;const r=[];return this.si.forEach((i,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.si.delete(i),r.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),cu.waitFor(r).next(()=>s)}getTargetCount(e){return cu.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return cu.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),cu.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const s=this.persistence.referenceDelegate,r=[];return s&&t.forEach(t=>{r.push(s.markPotentiallyOrphaned(e,t))}),cu.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),cu.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return cu.resolve(n)}containsKey(e,t){return cu.resolve(this._i.containsKey(t))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class dp{constructor(e,t){this.ui={},this.overlays={},this.ci=new du(0),this.li=!1,this.li=!0,this.hi=new rp,this.referenceDelegate=e(this),this.Pi=new up(this),this.indexManager=new zm,this.remoteDocumentCache=new lp(e=>this.referenceDelegate.Ti(e)),this.serializer=new Vm(t),this.Ii=new np(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new sp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new op(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){fc("MemoryPersistence","Starting transaction:",e);const s=new hp(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(e=>this.referenceDelegate.di(s).next(()=>e)).toPromise().then(e=>(s.raiseOnCommittedEvent(),e))}Ai(e,t){return cu.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class hp extends ou{constructor(e){super(),this.currentSequenceNumber=e}}class mp{constructor(e){this.persistence=e,this.Ri=new ip,this.Vi=null}static mi(e){return new mp(e)}get fi(){if(this.Vi)return this.Vi;throw vc(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),cu.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),cu.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),cu.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return cu.forEach(this.fi,n=>{const s=Gc.fromPath(n);return this.gi(e,s).next(e=>{e||t.removeEntry(s,su.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return cu.or([()=>cu.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class pp{constructor(e,t){this.persistence=e,this.pi=new Xd(e=>function(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=fu(t)),t=pu(e.get(n),t);return fu(t)}(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=function(e,t){return new Ym(e,t)}(this,t)}static mi(e,t){return new pp(e,t)}Ei(){}di(e){return cu.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return cu.forEach(this.pi,(n,s)=>this.br(e,n,s).next(e=>e?cu.resolve():t(s)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.ii(e,s=>this.br(e,s,t).next(e=>{e||(n++,r.removeEntry(s,su.min()))})).next(()=>r.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),cu.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),cu.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),cu.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),cu.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ed(e.data.value)),t}br(e,t,n){return cu.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return cu.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class fp{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=s}static As(e,t){let n=lh(),s=lh();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new fp(e,t.fromCache,n,s)}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gp{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xp{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=En()?8:function(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}(_n())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const r={result:null};return this.ys(e,t).next(e=>{r.result=e}).next(()=>{if(!r.result)return this.ws(e,t,s,n).next(e=>{r.result=e})}).next(()=>{if(r.result)return;const n=new gp;return this.Ss(e,t,n).next(s=>{if(r.result=s,this.Vs)return this.bs(e,t,n,s.size)})}).next(()=>r.result)}bs(e,t,n,s){return n.documentReadCount<this.fs?(pc()<=Hn.DEBUG&&fc("QueryEngine","SDK will not create cache indexes for query:",Wd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),cu.resolve()):(pc()<=Hn.DEBUG&&fc("QueryEngine","Query:",Wd(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(pc()<=Hn.DEBUG&&fc("QueryEngine","The SDK decides to create cache indexes for query:",Wd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zd(t))):cu.resolve())}ys(e,t){if(Fd(t))return cu.resolve(null);let n=zd(t);return this.indexManager.getIndexType(e,n).next(s=>0===s?null:(null!==t.limit&&1===s&&(t=qd(t,null,"F"),n=zd(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const r=lh(...s);return this.ps.getDocuments(e,r).next(s=>this.indexManager.getMinOffset(e,n).next(n=>{const i=this.Ds(t,s);return this.Cs(t,i,r,n.readTime)?this.ys(e,qd(t,null,"F")):this.vs(e,i,t,n)}))})))}ws(e,t,n,s){return Fd(t)||s.isEqual(su.min())?cu.resolve(null):this.ps.getDocuments(e,n).next(r=>{const i=this.Ds(t,r);return this.Cs(t,i,n,s)?cu.resolve(null):(pc()<=Hn.DEBUG&&fc("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Wd(t)),this.vs(e,i,t,function(e,t){const n=e.toTimestamp().seconds,s=e.toTimestamp().nanoseconds+1,r=su.fromTimestamp(1e9===s?new nu(n+1,0):new nu(n,s));return new iu(r,Gc.empty(),t)}(s,-1)).next(e=>e))})}Ds(e,t){let n=new Nu(Qd(e));return t.forEach((t,s)=>{Kd(e,s)&&(n=n.add(s))}),n}Cs(e,t,n,s){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Ss(e,t,n){return pc()<=Hn.DEBUG&&fc("QueryEngine","Using full collection scan to execute query:",Wd(t)),this.ps.getDocumentsMatchingQuery(e,t,iu.min(),n)}vs(e,t,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const bp="LocalStore";class vp{constructor(e,t,n,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new vu(Oc),this.xs=new Xd(e=>Pd(e),Ld),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tp(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function yp(e,t){return p(this,null,function*(){const n=Nc(e);return yield n.persistence.runTransaction("Handle user change","readonly",e=>{let s;return n.mutationQueue.getAllMutationBatches(e).next(r=>(s=r,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const r=[],i=[];let a=lh();for(const e of s){r.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({Ls:e,removedBatchIds:r,addedBatchIds:i}))})})})}function wp(e){const t=Nc(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Np(e,t){const n=Nc(e),s=t.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const i=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const a=[];t.targetChanges.forEach((i,o)=>{const l=r.get(o);if(!l)return;a.push(n.Pi.removeMatchingKeys(e,i.removedDocuments,o).next(()=>n.Pi.addMatchingKeys(e,i.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);var u,d,h;null!==t.targetMismatches.get(o)?c=c.withResumeToken(ku.EMPTY_BYTE_STRING,su.min()).withLastLimboFreeSnapshotVersion(su.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,s)),r=r.insert(o,c),d=c,h=i,(0===(u=l).resumeToken.approximateByteSize()||d.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&a.push(n.Pi.updateTargetData(e,c))});let o=Zd(),l=lh();if(t.documentUpdates.forEach(s=>{t.resolvedLimboDocuments.has(s)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,s))}),a.push(function(e,t,n){let s=lh(),r=lh();return n.forEach(e=>s=s.add(e)),t.getEntries(e,s).next(e=>{let s=Zd();return n.forEach((n,i)=>{const a=e.get(n);i.isFoundDocument()!==a.isFoundDocument()&&(r=r.add(n)),i.isNoDocument()&&i.version.isEqual(su.min())?(t.removeEntry(n,i.readTime),s=s.insert(n,i)):!a.isValidDocument()||i.version.compareTo(a.version)>0||0===i.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(i),s=s.insert(n,i)):fc(bp,"Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",i.version)}),{ks:s,qs:r}})}(e,i,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!s.isEqual(su.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,s));a.push(t)}return cu.waitFor(a).next(()=>i.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Ms=r,e))}function jp(e,t){const n=Nc(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Cp(e,t,n){return p(this,null,function*(){const s=Nc(e),r=s.Ms.get(t),i=n?"readwrite":"readwrite-primary";try{n||(yield s.persistence.runTransaction("Release target",i,e=>s.persistence.referenceDelegate.removeTarget(e,r)))}catch(a){if(!uu(a))throw a;fc(bp,`Failed to update sequence numbers for target ${t}: ${a}`)}s.Ms=s.Ms.remove(t),s.xs.delete(r.target)})}function _p(e,t,n){const s=Nc(e);let r=su.min(),i=lh();return s.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const s=Nc(e),r=s.xs.get(n);return void 0!==r?cu.resolve(s.Ms.get(r)):s.Pi.getTargetData(t,n)}(s,e,zd(t)).next(t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{i=e})}).next(()=>s.Fs.getDocumentsMatchingQuery(e,t,n?r:su.min(),n?i:lh())).next(e=>(function(e,t,n){let s=e.Os.get(t)||su.min();n.forEach((e,t)=>{t.readTime.compareTo(s)>0&&(s=t.readTime)}),e.Os.set(t,s)}(s,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Qs:i})))}class kp{constructor(){this.activeTargetIds=ch}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ep{constructor(){this.Mo=new kp,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new kp,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Sp{Oo(e){}shutdown(){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ip="ConnectivityMonitor";class Tp{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fc(Ip,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fc(Ip,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let Ap=null;function Rp(){return null===Ap?Ap=268435456+Math.round(2147483648*Math.random()):Ap++,"0x"+Ap.toString(16)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const Dp="RestConnection",Pp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Lp{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Fu?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,t,n,s,r){const i=Rp(),a=this.zo(e,t.toUriEncodedString());fc(Dp,`Sending RPC '${e}' ${i}:`,a,n);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,s,r);const{host:l}=new URL(a),c=vn(l);return this.Jo(e,a,o,n,c).then(t=>(fc(Dp,`Received RPC '${e}' ${i}: `,t),t),t=>{throw xc(Dp,`RPC '${e}' ${i} failed with error: `,t,"url: ",a,"request:",n),t})}Ho(e,t,n,s,r,i){return this.Go(e,t,n,s,r)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+hc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Pp[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Op{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Mp="WebChannelConnection";class Up extends Lp{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,s,r){const i=Rp();return new Promise((r,a)=>{const o=new ec;o.setWithCredentials(!0),o.listenOnce(nc.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case sc.NO_ERROR:const t=o.getResponseJson();fc(Mp,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),r(t);break;case sc.TIMEOUT:fc(Mp,`RPC '${e}' ${i} timed out`),a(new Cc(jc.DEADLINE_EXCEEDED,"Request time out"));break;case sc.HTTP_ERROR:const n=o.getStatus();if(fc(Mp,`RPC '${e}' ${i} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(jc).indexOf(t)>=0?t:jc.UNKNOWN}(t.status);a(new Cc(e,t.message))}else a(new Cc(jc.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Cc(jc.UNAVAILABLE,"Connection failed."));break;default:vc(9055,{l_:e,streamId:i,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{fc(Mp,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(s);fc(Mp,`RPC '${e}' ${i} sending request:`,s),o.send(t,"POST",l,n,15)})}T_(e,t,n){const s=Rp(),r=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=oc(),a=ac(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=r.join("");fc(Mp,`Creating RPC '${e}' stream ${s}: ${c}`,o);const u=i.createWebChannel(c,o);this.I_(u);let d=!1,h=!1;const m=new Op({Yo:t=>{h?fc(Mp,`Not sending because RPC '${e}' stream ${s} is closed:`,t):(d||(fc(Mp,`Opening RPC '${e}' stream ${s} transport.`),u.open(),d=!0),fc(Mp,`RPC '${e}' stream ${s} sending:`,t),u.send(t))},Zo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return p(u,tc.EventType.OPEN,()=>{h||(fc(Mp,`RPC '${e}' stream ${s} transport opened.`),m.o_())}),p(u,tc.EventType.CLOSE,()=>{h||(h=!0,fc(Mp,`RPC '${e}' stream ${s} transport closed`),m.a_(),this.E_(u))}),p(u,tc.EventType.ERROR,t=>{h||(h=!0,xc(Mp,`RPC '${e}' stream ${s} transport errored. Name:`,t.name,"Message:",t.message),m.a_(new Cc(jc.UNAVAILABLE,"The operation could not be completed")))}),p(u,tc.EventType.MESSAGE,t=>{var n;if(!h){const r=t.data[0];wc(!!r,16349);const i=r,a=(null==i?void 0:i.error)||(null==(n=i[0])?void 0:n.error);if(a){fc(Mp,`RPC '${e}' stream ${s} received error:`,a);const t=a.status;let n=function(e){const t=Hh[e];if(void 0!==t)return Kh(t)}(t),r=a.message;void 0===n&&(n=jc.INTERNAL,r="Unknown error status: "+t+" with message "+a.message),h=!0,m.a_(new Cc(n,r)),u.close()}else fc(Mp,`RPC '${e}' stream ${s} received:`,r),m.u_(r)}}),p(a,ic.STAT_EVENT,t=>{t.stat===rc.PROXY?fc(Mp,`RPC '${e}' stream ${s} detected buffering proxy`):t.stat===rc.NOPROXY&&fc(Mp,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.__()},0),m}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Fp(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Vp(e){return new hm(e,!0)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class $p{constructor(e,t,n=1e3,s=1.5,r=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=s,this.R_=r,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&fc("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const zp="PersistentStream";class Bp{constructor(e,t,n,s,r,i,a,o){this.Mi=e,this.S_=n,this.b_=s,this.connection=r,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new $p(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}stop(){return p(this,null,function*(){this.x_()&&(yield this.close(0))})}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}k_(){return p(this,null,function*(){if(this.O_())return this.close(0)})}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return p(this,null,function*(){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===jc.RESOURCE_EXHAUSTED?(gc(t.toString()),gc("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===jc.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.r_(t)})}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.D_===t&&this.G_(e,n)},t=>{e(()=>{const e=new Cc(jc.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(()=>p(this,null,function*(){this.state=0,this.start()}))}z_(e){return fc(zp,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(fc(zp,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class qp extends Bp{constructor(e,t,n,s,r,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,i),this.serializer=r}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r="NO_CHANGE"===(s=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===s?1:"REMOVE"===s?2:"CURRENT"===s?3:"RESET"===s?4:vc(39313,{state:s}),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(wc(void 0===t||"string"==typeof t,58123),ku.fromBase64String(t||"")):(wc(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),ku.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&function(e){const t=void 0===e.code?jc.UNKNOWN:Kh(e.code);return new Cc(t,e.message||"")}(o);n=new rm(r,i,a,l||null)}else if("documentChange"in t){t.documentChange;const s=t.documentChange;s.document,s.document.name,s.document.updateTime;const r=Nm(e,s.document.name),i=xm(s.document.updateTime),a=s.document.createTime?xm(s.document.createTime):su.min(),o=new ld({mapValue:{fields:s.document.fields}}),l=ud.newFoundDocument(r,i,a,o),c=s.targetIds||[],u=s.removedTargetIds||[];n=new nm(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const s=t.documentDelete;s.document;const r=Nm(e,s.document),i=s.readTime?xm(s.readTime):su.min(),a=ud.newNoDocument(r,i),o=s.removedTargetIds||[];n=new nm([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const s=t.documentRemove;s.document;const r=Nm(e,s.document),i=s.removedTargetIds||[];n=new nm([],i,r,null)}else{if(!("filter"in t))return vc(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:s=0,unchangedNames:r}=e,i=new Gh(s,r),a=e.targetId;n=new sm(a,i)}}var s;return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return su.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?su.min():t.readTime?xm(t.readTime):su.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Cm(this.serializer),t.addTarget=function(e,t){let n;const s=t.target;if(n=Od(s)?{documents:Em(e,s)}:{query:Sm(e,s).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=fm(e,t.resumeToken);const s=mm(e,t.expectedCount);null!==s&&(n.expectedCount=s)}else if(t.snapshotVersion.compareTo(su.min())>0){n.readTime=pm(e,t.snapshotVersion.toTimestamp());const s=mm(e,t.expectedCount);null!==s&&(n.expectedCount=s)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return vc(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Cm(this.serializer),t.removeTarget=e,this.q_(t)}}class Gp extends Bp{constructor(e,t,n,s,r,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,s,i),this.serializer=r}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return wc(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,wc(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){wc(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(wc(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?xm(e.updateTime):xm(t);return n.isEqual(su.min())&&(n=xm(t)),new kh(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=xm(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Cm(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let n;if(t instanceof Lh)n={update:km(e,t.key,t.value)};else if(t instanceof Vh)n={delete:wm(e,t.key)};else if(t instanceof Oh)n={update:km(e,t.key,t.data),updateMask:Mm(t.fieldMask)};else{if(!(t instanceof $h))return vc(16599,{Vt:t.type});n={verify:wm(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof xh)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof bh)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof yh)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Nh)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw vc(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=(s=e,void 0!==(r=t.precondition).updateTime?{updateTime:gm(s,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:vc(27497))),n;var s,r}(this.serializer,e))};this.q_(t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Hp{}class Wp extends Hp{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Cc(jc.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.connection.Go(e,vm(t,n),s,r,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===jc.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Cc(jc.UNKNOWN,e.toString())})}Ho(e,t,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Ho(e,vm(t,n),s,i,a,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===jc.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Cc(jc.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Kp{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(gc(t),this.aa=!1):fc("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Qp="RemoteStore";class Jp{constructor(e,t,n,s,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=r,this.Aa.Oo(e=>{n.enqueueAndForget(()=>p(this,null,function*(){af(this)&&(fc(Qp,"Restarting streams for network reachability change."),yield function(e){return p(this,null,function*(){const t=Nc(e);t.Ea.add(4),yield Yp(t),t.Ra.set("Unknown"),t.Ea.delete(4),yield Xp(t)})}(this))}))}),this.Ra=new Kp(n,s)}}function Xp(e){return p(this,null,function*(){if(af(e))for(const t of e.da)yield t(!0)})}function Yp(e){return p(this,null,function*(){for(const t of e.da)yield t(!1)})}function Zp(e,t){const n=Nc(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),rf(n)?sf(n):Cf(n).O_()&&tf(n,t))}function ef(e,t){const n=Nc(e),s=Cf(n);n.Ia.delete(t),s.O_()&&nf(n,t),0===n.Ia.size&&(s.O_()?s.L_():af(n)&&n.Ra.set("Unknown"))}function tf(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(su.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Cf(e).Y_(t)}function nf(e,t){e.Va.Ue(t),Cf(e).Z_(t)}function sf(e){e.Va=new am({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Cf(e).start(),e.Ra.ua()}function rf(e){return af(e)&&!Cf(e).x_()&&e.Ia.size>0}function af(e){return 0===Nc(e).Ea.size}function of(e){e.Va=void 0}function lf(e){return p(this,null,function*(){e.Ra.set("Online")})}function cf(e){return p(this,null,function*(){e.Ia.forEach((t,n)=>{tf(e,t)})})}function uf(e,t){return p(this,null,function*(){of(e),rf(e)?(e.Ra.ha(t),sf(e)):e.Ra.set("Unknown")})}function df(e,t,n){return p(this,null,function*(){if(e.Ra.set("Online"),t instanceof rm&&2===t.state&&t.cause)try{yield function(e,t){return p(this,null,function*(){const n=t.cause;for(const s of t.targetIds)e.Ia.has(s)&&(yield e.remoteSyncer.rejectListen(s,n),e.Ia.delete(s),e.Va.removeTarget(s))})}(e,t)}catch(s){fc(Qp,"Failed to remove targets %s: %s ",t.targetIds.join(","),s),yield hf(e,s)}else if(t instanceof nm?e.Va.Ze(t):t instanceof sm?e.Va.st(t):e.Va.tt(t),!n.isEqual(su.min()))try{const t=yield wp(e.localStore);n.compareTo(t)>=0&&(yield function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,s)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.Ia.get(s);r&&e.Ia.set(s,r.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const s=e.Ia.get(t);if(!s)return;e.Ia.set(t,s.withResumeToken(ku.EMPTY_BYTE_STRING,s.snapshotVersion)),nf(e,t);const r=new Fm(s.target,t,n,s.sequenceNumber);tf(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n))}catch(r){fc(Qp,"Failed to raise snapshot:",r),yield hf(e,r)}})}function hf(e,t,n){return p(this,null,function*(){if(!uu(t))throw t;e.Ea.add(1),yield Yp(e),e.Ra.set("Offline"),n||(n=()=>wp(e.localStore)),e.asyncQueue.enqueueRetryable(()=>p(this,null,function*(){fc(Qp,"Retrying IndexedDB access"),yield n(),e.Ea.delete(1),yield Xp(e)}))})}function mf(e,t){return t().catch(n=>hf(e,n,t))}function pf(e){return p(this,null,function*(){const t=Nc(e),n=_f(t);let s=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:-1;for(;ff(t);)try{const e=yield jp(t.localStore,s);if(null===e){0===t.Ta.length&&n.L_();break}s=e.batchId,gf(t,e)}catch(r){yield hf(t,r)}xf(t)&&bf(t)})}function ff(e){return af(e)&&e.Ta.length<10}function gf(e,t){e.Ta.push(t);const n=_f(e);n.O_()&&n.X_&&n.ea(t.mutations)}function xf(e){return af(e)&&!_f(e).x_()&&e.Ta.length>0}function bf(e){_f(e).start()}function vf(e){return p(this,null,function*(){_f(e).ra()})}function yf(e){return p(this,null,function*(){const t=_f(e);for(const n of e.Ta)t.ea(n.mutations)})}function wf(e,t,n){return p(this,null,function*(){const s=e.Ta.shift(),r=Bh.from(s,t,n);yield mf(e,()=>e.remoteSyncer.applySuccessfulWrite(r)),yield pf(e)})}function Nf(e,t){return p(this,null,function*(){t&&_f(e).X_&&(yield function(e,t){return p(this,null,function*(){if(function(e){switch(e){case jc.OK:return vc(64938);case jc.CANCELLED:case jc.UNKNOWN:case jc.DEADLINE_EXCEEDED:case jc.RESOURCE_EXHAUSTED:case jc.INTERNAL:case jc.UNAVAILABLE:case jc.UNAUTHENTICATED:return!1;case jc.INVALID_ARGUMENT:case jc.NOT_FOUND:case jc.ALREADY_EXISTS:case jc.PERMISSION_DENIED:case jc.FAILED_PRECONDITION:case jc.ABORTED:case jc.OUT_OF_RANGE:case jc.UNIMPLEMENTED:case jc.DATA_LOSS:return!0;default:return vc(15467,{code:e})}}(n=t.code)&&n!==jc.ABORTED){const n=e.Ta.shift();_f(e).B_(),yield mf(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),yield pf(e)}var n})}(e,t)),xf(e)&&bf(e)})}function jf(e,t){return p(this,null,function*(){const n=Nc(e);n.asyncQueue.verifyOperationInProgress(),fc(Qp,"RemoteStore received new credentials");const s=af(n);n.Ea.add(3),yield Yp(n),s&&n.Ra.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),yield Xp(n)})}function Cf(e){return e.ma||(e.ma=function(e,t,n){const s=Nc(e);return s.sa(),new qp(t,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(e.datastore,e.asyncQueue,{Xo:lf.bind(null,e),t_:cf.bind(null,e),r_:uf.bind(null,e),H_:df.bind(null,e)}),e.da.push(t=>p(this,null,function*(){t?(e.ma.B_(),rf(e)?sf(e):e.Ra.set("Unknown")):(yield e.ma.stop(),of(e))}))),e.ma}function _f(e){return e.fa||(e.fa=function(e,t,n){const s=Nc(e);return s.sa(),new Gp(t,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:vf.bind(null,e),r_:Nf.bind(null,e),ta:yf.bind(null,e),na:wf.bind(null,e)}),e.da.push(t=>p(this,null,function*(){t?(e.fa.B_(),yield pf(e)):(yield e.fa.stop(),e.Ta.length>0&&(fc(Qp,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))}))),e.fa
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class kf{constructor(e,t,n,s,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=r,this.deferred=new _c,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,r){const i=Date.now()+n,a=new kf(e,t,i,s,r);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Cc(jc.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ef(e,t){if(gc("AsyncQueue",`${t}: ${e}`),uu(e))return new Cc(jc.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Sf{static emptySet(e){return new Sf(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Gc.comparator(t.key,n.key):(e,t)=>Gc.comparator(e.key,t.key),this.keyedMap=th(),this.sortedSet=new vu(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Sf))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,s=n.getNext().key;if(!e.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Sf;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class If{constructor(){this.ga=new vu(Gc.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):vc(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Tf{constructor(e,t,n,s,r,i,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=r,this.fromCache=i,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,s,r){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new Tf(e,t,Sf.emptySet(t),i,n,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Af{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Rf{constructor(){this.queries=Df(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=Nc(e),s=n.queries;n.queries=Df(),s.forEach((e,n)=>{for(const s of n.Sa)s.onError(t)})}(this,new Cc(jc.ABORTED,"Firestore shutting down"))}}function Df(){return new Xd(e=>Hd(e),Gd)}function Pf(e,t){return p(this,null,function*(){const n=Nc(e);let s=3;const r=t.query;let i=n.queries.get(r);i?!i.ba()&&t.Da()&&(s=2):(i=new Af,s=t.Da()?0:1);try{switch(s){case 0:i.wa=yield n.onListen(r,!0);break;case 1:i.wa=yield n.onListen(r,!1);break;case 2:yield n.onFirstRemoteStoreListen(r)}}catch(a){const e=Ef(a,`Initialization of query '${Wd(t.query)}' failed`);return void t.onError(e)}n.queries.set(r,i),i.Sa.push(t),t.va(n.onlineState),i.wa&&t.Fa(i.wa)&&Uf(n)})}function Lf(e,t){return p(this,null,function*(){const n=Nc(e),s=t.query;let r=3;const i=n.queries.get(s);if(i){const e=i.Sa.indexOf(t);e>=0&&(i.Sa.splice(e,1),0===i.Sa.length?r=t.Da()?0:1:!i.ba()&&t.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}})}function Of(e,t){const n=Nc(e);let s=!1;for(const r of t){const e=r.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(r)&&(s=!0);t.wa=r}}s&&Uf(n)}function Mf(e,t,n){const s=Nc(e),r=s.queries.get(t);if(r)for(const i of r.Sa)i.onError(n);s.queries.delete(t)}function Uf(e){e.Ca.forEach(e=>{e.next()})}var Ff,Vf;(Vf=Ff||(Ff={})).Ma="default",Vf.Cache="cache";class $f{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Tf(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Tf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ff.Cache}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zf{constructor(e){this.key=e}}class Bf{constructor(e){this.key=e}}class qf{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=lh(),this.mutatedKeys=lh(),this.eu=Qd(e),this.tu=new Sf(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new If,s=t?t.tu:this.tu;let r=t?t.mutatedKeys:this.mutatedKeys,i=s,a=!1;const o="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,l="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((e,t)=>{const c=s.get(e),u=Kd(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let m=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),m=!0):this.su(c,u)||(n.track({type:2,doc:u}),m=!0,(o&&this.eu(u,o)>0||l&&this.eu(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),m=!0):c&&!u&&(n.track({type:1,doc:c}),m=!0,(o||l)&&(a=!0)),m&&(u?(i=i.add(u),r=h?r.add(e):r.delete(e)):(i=i.delete(e),r=r.delete(e)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{tu:i,iu:n,Cs:a,mutatedKeys:r}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const r=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return vc(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),s=null!=s&&s;const a=t&&!s?this._u():[],o=0===this.Xa.size&&this.current&&!s?1:0,l=o!==this.Za;return this.Za=o,0!==i.length||l?{snapshot:new Tf(this.query,e.tu,r,i,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new If,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=lh(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Bf(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new zf(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=lh();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Tf.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const Gf="SyncEngine";class Hf{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Wf{constructor(e){this.key=e,this.hu=!1}}class Kf{constructor(e,t,n,s,r,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new Xd(e=>Hd(e),Gd),this.Iu=new Map,this.Eu=new Set,this.du=new vu(Gc.comparator),this.Au=new Map,this.Ru=new ip,this.Vu={},this.mu=new Map,this.fu=Wm.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}function Qf(e,t,n=!0){return p(this,null,function*(){const s=gg(e);let r;const i=s.Tu.get(t);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=yield Xf(s,t,n,!0),r})}function Jf(e,t){return p(this,null,function*(){const n=gg(e);yield Xf(n,t,!0,!1)})}function Xf(e,t,n,s){return p(this,null,function*(){const r=yield function(e,t){const n=Nc(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let s;return n.Pi.getTargetData(e,t).next(r=>r?(s=r,cu.resolve(s)):n.Pi.allocateTargetId(e).next(r=>(s=new Fm(t,r,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,s).next(()=>s))))}).then(e=>{const s=n.Ms.get(e.targetId);return(null===s||e.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}(e.localStore,zd(t)),i=r.targetId,a=e.sharedClientState.addLocalQueryTarget(i,n);let o;return s&&(o=yield function(e,t,n,s,r){return p(this,null,function*(){e.pu=(t,n,s)=>function(e,t,n,s){return p(this,null,function*(){let r=t.view.ru(n);r.Cs&&(r=yield _p(e.localStore,t.query,!1).then(({documents:e})=>t.view.ru(e,r)));const i=s&&s.targetChanges.get(t.targetId),a=s&&null!=s.targetMismatches.get(t.targetId),o=t.view.applyChanges(r,e.isPrimaryClient,i,a);return ug(e,t.targetId,o.au),o.snapshot})}(e,t,n,s);const i=yield _p(e.localStore,t,!0),a=new qf(t,i.Qs),o=a.ru(i.documents),l=tm.createSynthesizedTargetChangeForCurrentChange(n,s&&"Offline"!==e.onlineState,r),c=a.applyChanges(o,e.isPrimaryClient,l);ug(e,n,c.au);const u=new Hf(t,n,a);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot})}(e,t,i,"current"===a,r.resumeToken)),e.isPrimaryClient&&n&&Zp(e.remoteStore,r),o})}function Yf(e,t,n){return p(this,null,function*(){const s=Nc(e),r=s.Tu.get(t),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(e=>!Gd(e,t))),void s.Tu.delete(t);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Cp(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&ef(s.remoteStore,r.targetId),lg(s,r.targetId)}).catch(lu))):(lg(s,r.targetId),yield Cp(s.localStore,r.targetId,!0))})}function Zf(e,t){return p(this,null,function*(){const n=Nc(e),s=n.Tu.get(t),r=n.Iu.get(s.targetId);n.isPrimaryClient&&1===r.length&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),ef(n.remoteStore,s.targetId))})}function eg(e,t,n){return p(this,null,function*(){const s=function(e){const t=Nc(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=rg.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=ig.bind(null,t),t}(e);try{const e=yield function(e,t){const n=Nc(e),s=nu.now(),r=t.reduce((e,t)=>e.add(t.key),lh());let i,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=Zd(),l=lh();return n.Ns.getEntries(e,r).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(r=>{i=r;const a=[];for(const e of t){const t=Dh(e,i.get(e.key).overlayedDocument);null!=t&&a.push(new Oh(e.key,t,cd(t.value.mapValue),Eh.exists(!0)))}return n.mutationQueue.addMutationBatch(e,s,a,t)}).next(t=>{a=t;const s=t.applyToLocalDocumentSet(i,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,s)})}).then(()=>({batchId:a.batchId,changes:nh(i)}))}(s.localStore,t);s.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let s=e.Vu[e.currentUser.toKey()];s||(s=new vu(Oc)),s=s.insert(t,n),e.Vu[e.currentUser.toKey()]=s}(s,e.batchId,n),yield mg(s,e.changes),yield pf(s.remoteStore)}catch(r){const e=Ef(r,"Failed to persist write");n.reject(e)}})}function tg(e,t){return p(this,null,function*(){const n=Nc(e);try{const e=yield Np(n.localStore,t);t.targetChanges.forEach((e,t)=>{const s=n.Au.get(t);s&&(wc(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?s.hu=!0:e.modifiedDocuments.size>0?wc(s.hu,14607):e.removedDocuments.size>0&&(wc(s.hu,42227),s.hu=!1))}),yield mg(n,e,t)}catch(s){yield lu(s)}})}function ng(e,t,n){const s=Nc(e);if(s.isPrimaryClient&&0===n||!s.isPrimaryClient&&1===n){const e=[];s.Tu.forEach((n,s)=>{const r=s.view.va(t);r.snapshot&&e.push(r.snapshot)}),function(e,t){const n=Nc(e);n.onlineState=t;let s=!1;n.queries.forEach((e,n)=>{for(const r of n.Sa)r.va(t)&&(s=!0)}),s&&Uf(n)}(s.eventManager,t),e.length&&s.Pu.H_(e),s.onlineState=t,s.isPrimaryClient&&s.sharedClientState.setOnlineState(t)}}function sg(e,t,n){return p(this,null,function*(){const s=Nc(e);s.sharedClientState.updateQueryState(t,"rejected",n);const r=s.Au.get(t),i=r&&r.key;if(i){let e=new vu(Gc.comparator);e=e.insert(i,ud.newNoDocument(i,su.min()));const n=lh().add(i),r=new em(su.min(),new Map,new vu(Oc),e,n);yield tg(s,r),s.du=s.du.remove(i),s.Au.delete(t),hg(s)}else yield Cp(s.localStore,t,!1).then(()=>lg(s,t,n)).catch(lu)})}function rg(e,t){return p(this,null,function*(){const n=Nc(e),s=t.batch.batchId;try{const e=yield function(e,t){const n=Nc(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const s=t.batch.keys(),r=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,s){const r=n.batch,i=r.keys();let a=cu.resolve();return i.forEach(e=>{a=a.next(()=>s.getEntry(t,e)).next(t=>{const i=n.docVersions.get(e);wc(null!==i,48541),t.version.compareTo(i)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),s.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,r))}(n,e,t,r).next(()=>r.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,s,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=lh();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,s))})}(n.localStore,t);og(n,s,null),ag(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),yield mg(n,e)}catch(r){yield lu(r)}})}function ig(e,t,n){return p(this,null,function*(){const s=Nc(e);try{const e=yield function(e,t){const n=Nc(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let s;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(wc(null!==t,37113),s=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,s,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,s)).next(()=>n.localDocuments.getDocuments(e,s))})}(s.localStore,t);og(s,t,n),ag(s,t),s.sharedClientState.updateMutationState(t,"rejected",n),yield mg(s,e)}catch(r){yield lu(r)}})}function ag(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function og(e,t,n){const s=Nc(e);let r=s.Vu[s.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),s.Vu[s.currentUser.toKey()]=r}}function lg(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const s of e.Iu.get(t))e.Tu.delete(s),n&&e.Pu.yu(s,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||cg(e,t)})}function cg(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(ef(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),hg(e))}function ug(e,t,n){for(const s of n)s instanceof zf?(e.Ru.addReference(s.key,t),dg(e,s)):s instanceof Bf?(fc(Gf,"Document no longer in limbo: "+s.key),e.Ru.removeReference(s.key,t),e.Ru.containsKey(s.key)||cg(e,s.key)):vc(19791,{wu:s})}function dg(e,t){const n=t.key,s=n.path.canonicalString();e.du.get(n)||e.Eu.has(s)||(fc(Gf,"New document in limbo: "+n),e.Eu.add(s),hg(e))}function hg(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Gc(zc.fromString(t)),s=e.fu.next();e.Au.set(s,new Wf(n)),e.du=e.du.insert(n,s),Zp(e.remoteStore,new Fm(zd(Ud(n.path)),s,"TargetPurposeLimboResolution",du.ce))}}function mg(e,t,n){return p(this,null,function*(){const s=Nc(e),r=[],i=[],a=[];s.Tu.isEmpty()||(s.Tu.forEach((e,o)=>{a.push(s.pu(o,t,n).then(e=>{var t;if((e||n)&&s.isPrimaryClient){const r=e?!e.fromCache:null==(t=null==n?void 0:n.targetChanges.get(o.targetId))?void 0:t.current;s.sharedClientState.updateQueryState(o.targetId,r?"current":"not-current")}if(e){r.push(e);const t=fp.As(o.targetId,e);i.push(t)}}))}),yield Promise.all(a),s.Pu.H_(r),yield function(e,t){return p(this,null,function*(){const n=Nc(e);try{yield n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>cu.forEach(t,t=>cu.forEach(t.Es,s=>n.persistence.referenceDelegate.addReference(e,t.targetId,s)).next(()=>cu.forEach(t.ds,s=>n.persistence.referenceDelegate.removeReference(e,t.targetId,s)))))}catch(s){if(!uu(s))throw s;fc(bp,"Failed to update sequence numbers: "+s)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ms.get(t),s=e.snapshotVersion,r=e.withLastLimboFreeSnapshotVersion(s);n.Ms=n.Ms.insert(t,r)}}})}(s.localStore,i))})}function pg(e,t){return p(this,null,function*(){const n=Nc(e);if(!n.currentUser.isEqual(t)){fc(Gf,"User change. New user:",t.toKey());const e=yield yp(n.localStore,t);n.currentUser=t,r="'waitForPendingWrites' promise is rejected due to a user change.",(s=n).mu.forEach(e=>{e.forEach(e=>{e.reject(new Cc(jc.CANCELLED,r))})}),s.mu.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),yield mg(n,e.Ls)}var s,r})}function fg(e,t){const n=Nc(e),s=n.Au.get(t);if(s&&s.hu)return lh().add(s.key);{let e=lh();const s=n.Iu.get(t);if(!s)return e;for(const t of s){const s=n.Tu.get(t);e=e.unionWith(s.view.nu)}return e}}function gg(e){const t=Nc(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=tg.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=fg.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=sg.bind(null,t),t.Pu.H_=Of.bind(null,t.eventManager),t.Pu.yu=Mf.bind(null,t.eventManager),t}class xg{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(e){return p(this,null,function*(){this.serializer=Vp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),yield this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)})}Fu(e,t){return null}Mu(e,t){return null}vu(e){return function(e,t,n,s){return new vp(e,t,n,s)}(this.persistence,new xp,e.initialUser,this.serializer)}Cu(e){return new dp(mp.mi,this.serializer)}Du(e){return new Ep}terminate(){return p(this,null,function*(){var e,t;null==(e=this.gcScheduler)||e.stop(),null==(t=this.indexBackfillerScheduler)||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}xg.provider={build:()=>new xg};class bg extends xg{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){wc(this.persistence.referenceDelegate instanceof pp,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Xm(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?Hm.withCacheSize(this.cacheSizeBytes):Hm.DEFAULT;return new dp(e=>pp.mi(e,t),this.serializer)}}class vg{initialize(e,t){return p(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>ng(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=pg.bind(null,this.syncEngine),yield function(e,t){return p(this,null,function*(){const n=Nc(e);t?(n.Ea.delete(2),yield Xp(n)):t||(n.Ea.add(2),yield Yp(n),n.Ra.set("Unknown"))})}(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return new Rf}createDatastore(e){const t=Vp(e.databaseInfo.databaseId),n=(s=e.databaseInfo,new Up(s));var s;return function(e,t,n,s){return new Wp(e,t,n,s)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,s=e.asyncQueue,r=e=>ng(this.syncEngine,e,0),i=Tp.v()?new Tp:new Sp,new Jp(t,n,s,r,i);var t,n,s,r,i}createSyncEngine(e,t){return function(e,t,n,s,r,i,a){const o=new Kf(e,t,n,s,r,i);return a&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return p(this,null,function*(){var e,t;yield function(e){return p(this,null,function*(){const t=Nc(e);fc(Qp,"RemoteStore shutting down."),t.Ea.add(5),yield Yp(t),t.Aa.shutdown(),t.Ra.set("Unknown")})}(this.remoteStore),null==(e=this.datastore)||e.terminate(),null==(t=this.eventManager)||t.terminate()})}}vg.provider={build:()=>new vg};
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class yg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):gc("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const wg="FirestoreClient";class Ng{constructor(e,t,n,s,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=s,this.user=dc.UNAUTHENTICATED,this.clientId=Lc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,e=>p(this,null,function*(){fc(wg,"Received user=",e.uid),yield this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,e=>(fc(wg,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _c;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>p(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Ef(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}function jg(e,t){return p(this,null,function*(){e.asyncQueue.verifyOperationInProgress(),fc(wg,"Initializing OfflineComponentProvider");const n=e.configuration;yield t.initialize(n);let s=n.initialUser;e.setCredentialChangeListener(e=>p(this,null,function*(){s.isEqual(e)||(yield yp(t.localStore,e),s=e)})),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t})}function Cg(e,t){return p(this,null,function*(){e.asyncQueue.verifyOperationInProgress();const n=yield function(e){return p(this,null,function*(){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){fc(wg,"Using user provided OfflineComponentProvider");try{yield jg(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!("FirebaseError"===(n=r).name?n.code===jc.FAILED_PRECONDITION||n.code===jc.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code))throw r;xc("Error using user provided cache. Falling back to memory cache: "+r),yield jg(e,new xg)}}else fc(wg,"Using default OfflineComponentProvider"),yield jg(e,new bg(void 0));var n;return e._offlineComponents})}(e);fc(wg,"Initializing OnlineComponentProvider"),yield t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>jf(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>jf(t.remoteStore,n)),e._onlineComponents=t})}function _g(e){return p(this,null,function*(){return e._onlineComponents||(e._uninitializedComponentsProvider?(fc(wg,"Using user provided OnlineComponentProvider"),yield Cg(e,e._uninitializedComponentsProvider._online)):(fc(wg,"Using default OnlineComponentProvider"),yield Cg(e,new vg))),e._onlineComponents})}function kg(e){return p(this,null,function*(){const t=yield _g(e),n=t.eventManager;return n.onListen=Qf.bind(null,t.syncEngine),n.onUnlisten=Yf.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Jf.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Zf.bind(null,t.syncEngine),n})}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Eg(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const Sg=new Map,Ig="firestore.googleapis.com",Tg=!0;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ag{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Cc(jc.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ig,this.ssl=Tg}else this.host=e.host,this.ssl=null!=(t=e.ssl)?t:Tg;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Gm;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Cc(jc.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,s){if(!0===t&&!0===s)throw new Cc(jc.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Eg(null!=(n=e.experimentalLongPollingOptions)?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Cc(jc.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Cc(jc.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Cc(jc.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class Rg{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ag({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Cc(jc.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Cc(jc.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ag(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Ec;switch(e.type){case"firstParty":return new Ac(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Cc(jc.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return p(this,null,function*(){"notTerminated"===this._terminateTask?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Sg.get(e);t&&(fc("ComponentProvider","Removing Datastore"),Sg.delete(e),t.terminate())}(this),Promise.resolve()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Dg{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Dg(this.firestore,e,this._query)}}class Pg{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pg(this.firestore,e,this._key)}toJSON(){return{type:Pg._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Zc(t,Pg._jsonSchema))return new Pg(e,n||null,new Gc(zc.fromString(t.referencePath)))}}Pg._jsonSchemaVersion="firestore/documentReference/1.0",Pg._jsonSchema={type:Yc("string",Pg._jsonSchemaVersion),referencePath:Yc("string")};class Lg extends Dg{constructor(e,t,n){super(e,t,Ud(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pg(this.firestore,null,new Gc(e))}withConverter(e){return new Lg(this.firestore,e,this._path)}}function Og(e,t,...n){if(e=$n(e),Hc("collection","path",t),e instanceof Rg){const s=zc.fromString(t,...n);return Kc(s),new Lg(e,null,s)}{if(!(e instanceof Pg||e instanceof Lg))throw new Cc(jc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=e._path.child(zc.fromString(t,...n));return Kc(s),new Lg(e.firestore,null,s)}}function Mg(e,t,...n){if(e=$n(e),1===arguments.length&&(t=Lc.newId()),Hc("doc","path",t),e instanceof Rg){const s=zc.fromString(t,...n);return Wc(s),new Pg(e,null,new Gc(s))}{if(!(e instanceof Pg||e instanceof Lg))throw new Cc(jc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=e._path.child(zc.fromString(t,...n));return Wc(s),new Pg(e.firestore,e instanceof Lg?e.converter:null,new Gc(s))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ug="AsyncQueue";class Fg{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new $p(this,"async_queue_retry"),this._c=()=>{const e=Fp();e&&fc(Ug,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Fp();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Fp();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new _c;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}lc(){return p(this,null,function*(){if(0!==this.Xu.length){try{yield this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(Py){if(!uu(Py))throw Py;fc(Ug,"Operation failed with retryable error: "+Py)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}})}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,gc("INTERNAL UNHANDLED ERROR: ",Vg(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=kf.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(s),s}uc(){this.nc&&vc(47125,{Pc:Vg(this.nc)})}verifyOperationInProgress(){}Tc(){return p(this,null,function*(){let e;do{e=this.ac,yield e}while(e!==this.ac)})}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Vg(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class $g extends Rg{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new Fg,this._persistenceKey=(null==s?void 0:s.name)||"[DEFAULT]"}_terminate(){return p(this,null,function*(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fg(e),this._firestoreClient=void 0,yield e}})}}function zg(e){if(e._terminated)throw new Cc(jc.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){var t,n,s;const r=e._freezeSettings(),i=(a=e._databaseId,o=(null==(t=e._app)?void 0:t.options.appId)||"",l=e._persistenceKey,new Uu(a,o,l,(c=r).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Eg(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator));var a,o,l,c;e._componentsProvider||(null==(n=r.localCache)?void 0:n._offlineComponentProvider)&&(null==(s=r.localCache)?void 0:s._onlineComponentProvider)&&(e._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),e._firestoreClient=new Ng(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e),e._firestoreClient}class Bg{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bg(ku.fromBase64String(e))}catch(t){throw new Cc(jc.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Bg(ku.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bg._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Zc(e,Bg._jsonSchema))return Bg.fromBase64String(e.bytes)}}Bg._jsonSchemaVersion="firestore/bytes/1.0",Bg._jsonSchema={type:Yc("string",Bg._jsonSchemaVersion),bytes:Yc("string")};
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class qg{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Cc(jc.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qc(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Gg{constructor(e){this._methodName=e}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Hg{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Cc(jc.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Cc(jc.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Oc(this._lat,e._lat)||Oc(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Hg._jsonSchemaVersion}}static fromJSON(e){if(Zc(e,Hg._jsonSchema))return new Hg(e.latitude,e.longitude)}}Hg._jsonSchemaVersion="firestore/geoPoint/1.0",Hg._jsonSchema={type:Yc("string",Hg._jsonSchemaVersion),latitude:Yc("number"),longitude:Yc("number")};
/**
     * @license
     * Copyright 2024 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Wg{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Wg._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Zc(e,Wg._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new Wg(e.vectorValues);throw new Cc(jc.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Wg._jsonSchemaVersion="firestore/vectorValue/1.0",Wg._jsonSchema={type:Yc("string",Wg._jsonSchemaVersion),vectorValues:Yc("object")};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Kg=/^__.*__$/;class Qg{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Oh(e,this.data,this.fieldMask,t,this.fieldTransforms):new Lh(e,this.data,t,this.fieldTransforms)}}class Jg{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Oh(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Xg(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw vc(40011,{Ac:e})}}class Yg{constructor(e,t,n,s,r,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=s,void 0===r&&this.Rc(),this.fieldTransforms=r||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Yg(u(u({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null==(t=this.path)?void 0:t.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){var t;const n=null==(t=this.path)?void 0:t.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return px(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Xg(this.Ac)&&Kg.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Zg{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Vp(e)}Cc(e,t,n,s=!1){return new Yg({Ac:e,methodName:t,Dc:n,path:qc.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ex(e){const t=e._freezeSettings(),n=Vp(e._databaseId);return new Zg(e._databaseId,!!t.ignoreUndefinedProperties,n)}function tx(e,t,n,s,r,i={}){const a=e.Cc(i.merge||i.mergeFields?2:0,t,n,r);ux("Data must be an object, but it was:",a,s);const o=lx(s,a);let l,c;if(i.merge)l=new Cu(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const e=[];for(const s of i.mergeFields){const r=dx(t,s,n);if(!a.contains(r))throw new Cc(jc.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);fx(e,r)||e.push(r)}l=new Cu(e),c=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=a.fieldTransforms;return new Qg(new ld(o),l,c)}class nx extends Gg{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nx}}class sx extends Gg{_toFieldTransform(e){return new _h(e.path,new xh)}isEqual(e){return e instanceof sx}}class rx extends Gg{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Nh(e.serializer,hh(e.serializer,this.Fc));return new _h(e.path,t)}isEqual(e){return e instanceof rx&&this.Fc===e.Fc}}function ix(e,t,n,s){const r=e.Cc(1,t,n);ux("Data must be an object, but it was:",r,s);const i=[],a=ld.empty();xu(s,(e,s)=>{const o=mx(t,e,n);s=$n(s);const l=r.yc(o);if(s instanceof nx)i.push(o);else{const e=ox(s,l);null!=e&&(i.push(o),a.set(o,e))}});const o=new Cu(i);return new Jg(a,o,r.fieldTransforms)}function ax(e,t,n,s,r,i){const a=e.Cc(1,t,n),o=[dx(t,s,n)],l=[r];if(i.length%2!=0)throw new Cc(jc.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)o.push(dx(t,i[h])),l.push(i[h+1]);const c=[],u=ld.empty();for(let h=o.length-1;h>=0;--h)if(!fx(c,o[h])){const e=o[h];let t=l[h];t=$n(t);const n=a.yc(e);if(t instanceof nx)c.push(e);else{const s=ox(t,n);null!=s&&(c.push(e),u.set(e,s))}}const d=new Cu(c);return new Jg(u,d,a.fieldTransforms)}function ox(e,t){if(cx(e=$n(e)))return ux("Unsupported field value:",t,e),lx(e,t);if(e instanceof Gg)return function(e,t){if(!Xg(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let s=0;for(const r of e){let e=ox(r,t.wc(s));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),s++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=$n(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return hh(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=nu.fromDate(e);return{timestampValue:pm(t.serializer,n)}}if(e instanceof nu){const n=new nu(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:pm(t.serializer,n)}}if(e instanceof Hg)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Bg)return{bytesValue:fm(t.serializer,e._byteString)};if(e instanceof Pg){const n=t.databaseId,s=e.firestore._databaseId;if(!s.isEqual(n))throw t.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:bm(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Wg)return n=e,s=t,{mapValue:{fields:{[$u]:{stringValue:qu},[Gu]:{arrayValue:{values:n.toArray().map(e=>{if("number"!=typeof e)throw s.Sc("VectorValues must only contain numeric values.");return uh(s.serializer,e)})}}}}};var n,s;throw t.Sc(`Unsupported field value: ${Jc(e)}`)}(e,t)}function lx(e,t){const n={};return bu(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):xu(e,(e,s)=>{const r=ox(s,t.mc(e));null!=r&&(n[e]=r)}),{mapValue:{fields:n}}}function cx(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof nu||e instanceof Hg||e instanceof Bg||e instanceof Pg||e instanceof Gg||e instanceof Wg)}function ux(e,t,n){if(!cx(n)||!Qc(n)){const s=Jc(n);throw"an object"===s?t.Sc(e+" a custom object"):t.Sc(e+" "+s)}}function dx(e,t,n){if((t=$n(t))instanceof qg)return t._internalPath;if("string"==typeof t)return mx(e,t);throw px("Field path arguments must be of type string or ",e,!1,void 0,n)}const hx=new RegExp("[~\\*/\\[\\]]");function mx(e,t,n){if(t.search(hx)>=0)throw px(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new qg(...t.split("."))._internalPath}catch(s){throw px(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function px(e,t,n,s,r){const i=s&&!s.isEmpty(),a=void 0!==r;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${s}`),a&&(l+=` in document ${r}`),l+=")"),new Cc(jc.INVALID_ARGUMENT,o+e+l)}function fx(e,t){return e.some(e=>e.isEqual(t))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gx{constructor(e,t,n,s,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Pg(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new xx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(bx("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class xx extends gx{data(){return super.data()}}function bx(e,t){return"string"==typeof t?mx(e,t):t instanceof qg?t._internalPath:t._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class vx{}class yx extends vx{}function wx(e,t,...n){let s=[];t instanceof vx&&s.push(t),s=s.concat(n),function(e){const t=e.filter(e=>e instanceof Cx).length,n=e.filter(e=>e instanceof Nx).length;if(t>1||t>0&&n>0)throw new Cc(jc.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)e=r._apply(e);return e}class Nx extends yx{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Nx(e,t,n)}_apply(e){const t=this._parse(e);return Ax(e._query,t),new Dg(e.firestore,e.converter,Bd(e._query,t))}_parse(e){const t=ex(e.firestore),n=function(e,t,n,s,r,i,a){let o;if(r.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Cc(jc.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){Tx(a,i);const t=[];for(const n of a)t.push(Ix(s,e,n));o={arrayValue:{values:t}}}else o=Ix(s,e,a)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Tx(a,i),o=function(e,t,n,s=!1){return ox(n,e.Cc(s?4:3,t))}(n,t,a,"in"===i||"not-in"===i);return xd.create(r,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function jx(e,t,n){const s=t,r=bx("where",e);return Nx._create(r,s,n)}class Cx extends vx{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Cx(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:bd.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const s=t.getFlattenedFilters();for(const r of s)Ax(n,r),n=Bd(n,r)}(e._query,t),new Dg(e.firestore,e.converter,Bd(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class _x extends yx{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new _x(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Cc(jc.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Cc(jc.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pd(t,n)}(e._query,this._field,this._direction);return new Dg(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Md(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function kx(e,t="asc"){const n=t,s=bx("orderBy",e);return _x._create(s,n)}class Ex extends yx{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Ex(e,t,n)}_apply(e){return new Dg(e.firestore,e.converter,qd(e._query,this._limit,this._limitType))}}function Sx(e){return function(e,t){if(t<=0)throw new Cc(jc.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}("limit",e),Ex._create("limit",e,"F")}function Ix(e,t,n){if("string"==typeof(n=$n(n))){if(""===n)throw new Cc(jc.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vd(t)&&-1!==n.indexOf("/"))throw new Cc(jc.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=t.path.child(zc.fromString(n));if(!Gc.isDocumentKey(s))throw new Cc(jc.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return td(e,new Gc(s))}if(n instanceof Pg)return td(e,n._key);throw new Cc(jc.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jc(n)}.`)}function Tx(e,t){if(!Array.isArray(e)||0===e.length)throw new Cc(jc.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Ax(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Cc(jc.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Cc(jc.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Rx{convertValue(e,t="none"){switch(Hu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Iu(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Tu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw vc(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return xu(e,(e,s)=>{n[e]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,s;const r=null==(s=null==(n=null==(t=e.fields)?void 0:t[Gu].arrayValue)?void 0:n.values)?void 0:s.map(e=>Iu(e.doubleValue));return new Wg(r)}convertGeoPoint(e){return new Hg(Iu(e.latitude),Iu(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ou(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Mu(e));default:return null}}convertTimestamp(e){const t=Su(e);return new nu(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=zc.fromString(e);wc(Um(n),9688,{name:e});const s=new Vu(n.get(1),n.get(3)),r=new Gc(n.popFirst(5));return s.isEqual(t)||gc(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Dx(e,t,n){let s;return s=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,s}class Px{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Lx extends gx{constructor(e,t,n,s,r,i){super(e,t,n,s,i),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ox(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(bx("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Cc(jc.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Lx._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Lx._jsonSchemaVersion="firestore/documentSnapshot/1.0",Lx._jsonSchema={type:Yc("string",Lx._jsonSchemaVersion),bundleSource:Yc("string","DocumentSnapshot"),bundleName:Yc("string"),bundle:Yc("string")};class Ox extends Lx{data(e={}){return super.data(e)}}class Mx{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Px(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Ox(this._firestore,this._userDataWriter,n.key,n,new Px(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Cc(jc.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const s=new Ox(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Px(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:s,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const s=new Ox(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Px(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,i=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:Ux(t.type),doc:s,oldIndex:r,newIndex:i}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Cc(jc.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Mx._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Lc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),s.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Ux(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return vc(61501,{type:e})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fx(e){e=Xc(e,Pg);const t=Xc(e.firestore,$g);return function(e,t,n={}){const s=new _c;return e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return function(e,t,n,s,r){const i=new yg({next:o=>{i.Nu(),t.enqueueAndForget(()=>Lf(e,a));const l=o.docs.has(n);!l&&o.fromCache?r.reject(new Cc(jc.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&s&&"server"===s.source?r.reject(new Cc(jc.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(o)},error:e=>r.reject(e)}),a=new $f(Ud(n.path),i,{includeMetadataChanges:!0,qa:!0});return Pf(e,a)}(yield kg(e),e.asyncQueue,t,n,s)})),s.promise}(zg(t),e._key).then(n=>function(e,t,n){const s=n.docs.get(t._key),r=new Vx(e);return new Lx(e,r,t._key,s,new Px(n.hasPendingWrites,n.fromCache),t.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e,n))}Mx._jsonSchemaVersion="firestore/querySnapshot/1.0",Mx._jsonSchema={type:Yc("string",Mx._jsonSchemaVersion),bundleSource:Yc("string","QuerySnapshot"),bundleName:Yc("string"),bundle:Yc("string")};class Vx extends Rx{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pg(this.firestore,null,t)}}function $x(e){e=Xc(e,Dg);const t=Xc(e.firestore,$g),n=zg(t),s=new Vx(t);return function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Cc(jc.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query),function(e,t,n={}){const s=new _c;return e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return function(e,t,n,s,r){const i=new yg({next:n=>{i.Nu(),t.enqueueAndForget(()=>Lf(e,a)),n.fromCache&&"server"===s.source?r.reject(new Cc(jc.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:e=>r.reject(e)}),a=new $f(n,i,{includeMetadataChanges:!0,qa:!0});return Pf(e,a)}(yield kg(e),e.asyncQueue,t,n,s)})),s.promise}(n,e._query).then(n=>new Mx(t,s,e,n))}function zx(e,t,n){e=Xc(e,Pg);const s=Xc(e.firestore,$g),r=Dx(e.converter,t,n);return Hx(s,[tx(ex(s),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,Eh.none())])}function Bx(e,t,n,...s){e=Xc(e,Pg);const r=Xc(e.firestore,$g),i=ex(r);let a;return a="string"==typeof(t=$n(t))||t instanceof qg?ax(i,"updateDoc",e._key,t,n,s):ix(i,"updateDoc",e._key,t),Hx(r,[a.toMutation(e._key,Eh.exists(!0))])}function qx(e){return Hx(Xc(e.firestore,$g),[new Vh(e._key,Eh.none())])}function Gx(e,t){const n=Xc(e.firestore,$g),s=Mg(e),r=Dx(e.converter,t);return Hx(n,[tx(ex(e.firestore),"addDoc",s._key,r,null!==e.converter,{}).toMutation(s._key,Eh.exists(!1))]).then(()=>s)}function Hx(e,t){return function(e,t){const n=new _c;return e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return eg(yield function(e){return _g(e).then(e=>e.syncEngine)}(e),t,n)})),n.promise}(zg(e),t)}class Wx{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ex(e)}set(e,t,n){this._verifyNotCommitted();const s=Kx(e,this._firestore),r=Dx(s.converter,t,n),i=tx(this._dataReader,"WriteBatch.set",s._key,r,null!==s.converter,n);return this._mutations.push(i.toMutation(s._key,Eh.none())),this}update(e,t,n,...s){this._verifyNotCommitted();const r=Kx(e,this._firestore);let i;return i="string"==typeof(t=$n(t))||t instanceof qg?ax(this._dataReader,"WriteBatch.update",r._key,t,n,s):ix(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,Eh.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Kx(e,this._firestore);return this._mutations=this._mutations.concat(new Vh(t._key,Eh.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Cc(jc.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Kx(e,t){if((e=$n(e)).firestore!==t)throw new Cc(jc.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Qx(){return new sx("serverTimestamp")}function Jx(e){return new rx("increment",e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xx(e){return zg(e=Xc(e,$g)),new Wx(e,t=>Hx(e,t))}!function(e,t=!0){hc=rr,Zs(new zn("firestore",(e,{instanceIdentifier:n,options:s})=>{const r=e.getProvider("app").getImmediate(),i=new $g(new Ic(e.getProvider("auth-internal")),new Dc(r,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Cc(jc.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vu(e.options.projectId,t)}(r,n),r);return s=u({useFetchStreams:t},s),i._setSettings(s),i},"PUBLIC").setMultipleInstances(!0)),or(cc,uc,e),or(cc,uc,"esm2020")}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Yx="firebasestorage.googleapis.com";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Zx extends Tn{constructor(e,t,n=0){super(rb(e),`Firebase Storage: ${t} (${rb(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Zx.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rb(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var eb,tb,nb,sb;function rb(e){return"storage/"+e}function ib(e){return new Zx(eb.INVALID_ARGUMENT,e)}function ab(){return new Zx(eb.APP_DELETED,"The Firebase app was deleted.")}(tb=eb||(eb={})).UNKNOWN="unknown",tb.OBJECT_NOT_FOUND="object-not-found",tb.BUCKET_NOT_FOUND="bucket-not-found",tb.PROJECT_NOT_FOUND="project-not-found",tb.QUOTA_EXCEEDED="quota-exceeded",tb.UNAUTHENTICATED="unauthenticated",tb.UNAUTHORIZED="unauthorized",tb.UNAUTHORIZED_APP="unauthorized-app",tb.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",tb.INVALID_CHECKSUM="invalid-checksum",tb.CANCELED="canceled",tb.INVALID_EVENT_NAME="invalid-event-name",tb.INVALID_URL="invalid-url",tb.INVALID_DEFAULT_BUCKET="invalid-default-bucket",tb.NO_DEFAULT_BUCKET="no-default-bucket",tb.CANNOT_SLICE_BLOB="cannot-slice-blob",tb.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",tb.NO_DOWNLOAD_URL="no-download-url",tb.INVALID_ARGUMENT="invalid-argument",tb.INVALID_ARGUMENT_COUNT="invalid-argument-count",tb.APP_DELETED="app-deleted",tb.INVALID_ROOT_OPERATION="invalid-root-operation",tb.INVALID_FORMAT="invalid-format",tb.INTERNAL_ERROR="internal-error",tb.UNSUPPORTED_ENVIRONMENT="unsupported-environment";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class ob{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=ob.makeFromUrl(e,t)}catch(Py){return new ob(e,"")}if(""===n.path)return n;throw s=e,new Zx(eb.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.");var s}static makeFromUrl(e,t){let n=null;const s="([A-Za-z0-9.\\-_]+)",r=new RegExp("^gs://"+s+"(/(.*))?$","i");function i(e){e.path_=decodeURIComponent(e.path)}const a=t.replace(/[.]/g,"\\."),o=[{regex:r,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${s}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp(`^https?://${t===Yx?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${s}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:i}];for(let l=0;l<o.length;l++){const t=o[l],s=t.regex.exec(e);if(s){const e=s[t.indices.bucket];let r=s[t.indices.path];r||(r=""),n=new ob(e,r),t.postModify(n);break}}if(null==n)throw function(e){return new Zx(eb.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class lb{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cb(e,t,n,s){if(s<t)throw ib(`Invalid value for '${e}'. Expected ${t} or greater.`);if(s>n)throw ib(`Invalid value for '${e}'. Expected ${n} or less.`)}(sb=nb||(nb={}))[sb.NO_ERROR=0]="NO_ERROR",sb[sb.NETWORK_ERROR=1]="NETWORK_ERROR",sb[sb.ABORT=2]="ABORT";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class ub{constructor(e,t,n,s,r,i,a,o,l,c,u,d=!0,h=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=s,this.successCodes_=r,this.additionalRetryCodes_=i,this.callback_=a,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=d,this.isUsingEmulator=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new hb(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const s=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(s),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(s),this.pendingConnection_=null;const t=n.getErrorCode()===nb.NO_ERROR,r=n.getStatus();if(!t||
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){const n=e>=500&&e<600,s=-1!==[408,429].indexOf(e),r=-1!==t.indexOf(e);return n||s||r}(r,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===nb.ABORT;return void e(!1,new hb(!1,null,t))}const i=-1!==this.successCodes_.indexOf(r);e(!0,new hb(i,n))})},t=(e,t)=>{const n=this.resolve_,s=this.reject_,r=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(r,r.getResponse());!
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e){return void 0!==e}(e)?n():n(e)}catch(Py){s(Py)}else if(null!==r){const e=new Zx(eb.UNKNOWN,"An unknown error occurred, please check the error payload for server response.");e.serverResponse=r.getErrorText(),this.errorCallback_?s(this.errorCallback_(r,e)):s(e)}else t.canceled?s(this.appDelete_?ab():new Zx(eb.CANCELED,"User canceled the upload/download.")):s(new Zx(eb.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(0,new hb(!1,null,!0)):this.backoffId_=function(e,t,n){let s=1,r=null,i=null,a=!1,o=0;function l(){return 2===o}let c=!1;function u(...e){c||(c=!0,t.apply(null,e))}function d(t){r=setTimeout(()=>{r=null,e(m,l())},t)}function h(){i&&clearTimeout(i)}function m(e,...t){if(c)return void h();if(e)return h(),void u.call(null,e,...t);if(l()||a)return h(),void u.call(null,e,...t);let n;s<64&&(s*=2),1===o?(o=2,n=0):n=1e3*(s+Math.random()),d(n)}let p=!1;function f(e){p||(p=!0,h(),c||(null!==r?(e||(o=2),clearTimeout(r),d(0)):e||(o=1)))}return d(0),i=setTimeout(()=>{a=!0,f(!0)},n),f}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class hb{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function mb(e,t,n,s,r,i,a=!0,o=!1){const l=function(e){const t=encodeURIComponent;let n="?";for(const s in e)e.hasOwnProperty(s)&&(n=n+(t(s)+"=")+t(e[s])+"&");return n=n.slice(0,-1),n}(e.urlParams),c=e.url+l,u=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(u,i),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,s),new ub(c,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,a,o)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class pb{constructor(e,t){this._service=e,this._location=t instanceof ob?t:ob.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new pb(e,t)}get root(){const e=new ob(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new ob(this._location.bucket,e);return new pb(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Zx(eb.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function fb(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:ob.makeFromBucketSpec(n,e)}class gb{constructor(e,t,n,s,r,i=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=s,this._firebaseVersion=r,this._isUsingEmulator=i,this._bucket=null,this._host=Yx,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=s?ob.makeFromBucketSpec(s,this._host):fb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=ob.makeFromBucketSpec(this._url,e):this._bucket=fb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){cb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){cb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return p(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=yield e.getToken();if(null!==t)return t.accessToken}return null})}_getAppCheckToken(){return p(this,null,function*(){if(tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new pb(this,e)}_makeRequest(e,t,n,s,r=!0){if(this._deleted)return new lb(ab());{const i=mb(e,this._appId,n,s,t,this._firebaseVersion,r,this._isUsingEmulator);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}makeRequestWithTokens(e,t){return p(this,null,function*(){const[n,s]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,s).getPromise()})}}const xb="@firebase/storage",bb="0.14.0",vb="storage";function yb(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new gb(n,s,r,t,rr)}Zs(new zn(vb,yb,"PUBLIC").setMultipleInstances(!0)),or(xb,bb,""),or(xb,bb,"esm2020");const wb={apiKey:"AIzaSyDkPhYGNEdBtRdEeWwHCWfCFtLWqmGBTO8",authDomain:"hackathon-8b0e1.firebaseapp.com",projectId:"hackathon-8b0e1",storageBucket:"hackathon-8b0e1.firebasestorage.app",messagingSenderId:"523976123580",appId:"1:523976123580:web:1f781a5403c7aa6540dcb9",measurementId:"G-GQHD2SXYJ2"};let Nb,jb;try{Nb=ir(wb)}catch(Ly){if("app/duplicate-app"!==Ly.code)throw Ly;Nb=ar()}if("undefined"!=typeof window&&wb.measurementId)try{jb=function(e=ar()){const t=er(e=$n(e),ri);return t.isInitialized()?t.getImmediate():function(e,t={}){const n=er(e,ri);if(n.isInitialized()){const e=n.getImmediate();if(Dn(t,n.getOptions()))return e;throw oi.create("already-initialized")}return n.initialize({options:t})}(e)}(Nb)}catch(Oy){}const Cb=Kl(Nb),_b=new bo,kb=function(e){const t="object"==typeof e?e:ar(),n="string"==typeof e?e:Fu,s=er(t,"firestore").getImmediate({identifier:n});if(!s._initialized){const e=fn("firestore");e&&function(e,t,n,s={}){var r;e=Xc(e,Rg);const i=vn(t),a=e._getSettings(),o=d(u({},a),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${n}`;i&&(yn(`https://${l}`),Cn("Firestore",!0)),a.host!==Ig&&a.host!==l&&xc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=d(u({},a),{host:l,ssl:i,emulatorOptions:s});if(!Dn(c,o)&&(e._setSettings(c),s.mockUserToken)){let t,n;if("string"==typeof s.mockUserToken)t=s.mockUserToken,n=dc.MOCK_USER;else{t=wn(s.mockUserToken,null==(r=e._app)?void 0:r.options.projectId);const i=s.mockUserToken.sub||s.mockUserToken.user_id;if(!i)throw new Cc(jc.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new dc(i)}e._authCredentials=new Sc(new kc(t,n))}}(s,...e)}return s}(Nb);!function(e=ar(),t){const n=er(e=$n(e),vb).getImmediate({identifier:t}),s=fn("storage");s&&function(e,t,n,s={}){!function(e,t,n,s={}){e.host=`${t}:${n}`;const r=vn(t);r&&(yn(`https://${e.host}/b`),Cn("Storage",!0)),e._isUsingEmulator=!0,e._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(e._overrideAuthToken="string"==typeof i?i:wn(i,e.app.options.projectId))}(e,t,n,s)}(n,...s)}(Nb);const Eb=Object.freeze(Object.defineProperty({__proto__:null,auth:Cb,db:kb,googleProvider:_b,signInWithEmailAndPassword:Ao},Symbol.toStringTag,{value:"Module"})),Sb=f.createContext(),Ib=({children:t})=>{const[n,s]=f.useState(null),[r,i]=f.useState(!0),[a,o]=f.useState(null),[l,c]=f.useState(!1),[h,m]=f.useState(!1);f.useEffect(()=>{const t=Cb.onAuthStateChanged(t=>p(e,null,function*(){i(!0),o(null);try{if(t){const e=yield t.getIdToken(),n=Mg(kb,"users",t.uid),r=yield Fx(n),i=r.exists()?r.data():{};i.username&&i.phone&&i.birthDate||m(!0),s(d(u({},t),{role:i.role||"cliente",displayName:i.displayName||t.displayName,profileData:i,idToken:e})),localStorage.getItem(`tour-${t.uid}`)||c(!0)}else s(null),c(!1),m(!1)}catch(e){o("Erro ao carregar dados do usuário"),s(t)}finally{i(!1)}}));return()=>t()},[]);const g={user:n,loading:r,error:a,isAuthenticated:!!n,isAdmin:"admin"===(null==n?void 0:n.role),isPsychologist:"psicologo"===(null==n?void 0:n.role),isClient:"cliente"===(null==n?void 0:n.role),isFirstTime:l,needsProfileCompletion:h,markTourAsSeen:()=>p(e,null,function*(){if(n){localStorage.setItem(`tour-${n.uid}`,"true"),c(!1);try{const e=Mg(kb,"users",n.uid);yield zx(e,{hasSeenTour:!0},{merge:!0})}catch(e){}}})};return Ae.jsx(Sb.Provider,{value:g,children:t})},Tb=()=>{const e=f.useContext(Sb);if(!e)throw new Error("useAuth deve ser usado dentro de AuthProvider");return e},Ab=({onJoinRoom:t})=>{var n;const[s,r]=f.useState(""),[i,a]=f.useState(null),[o,l]=f.useState(!1);f.useState(!1);const{userProfile:c,loading:d}=(t=>{const[n,s]=f.useState(null),[r,i]=f.useState(!0),[a,o]=f.useState(null);return f.useEffect(()=>{t?p(e,null,function*(){var e;try{i(!0),o(null);const n=Mg(kb,"users",t),r=yield Fx(n);if(r.exists()){const t=r.data();s(u({id:r.id,name:t.name||t.username||"Usuário",username:t.username||t.name||"Usuário",email:t.email||"",profileImage:t.profileImage||null,bio:t.bio||"",createdAt:(null==(e=t.createdAt)?void 0:e.toDate())||new Date},t))}else s({id:t,name:"Usuário Anônimo",username:"Usuário Anônimo",email:"",profileImage:null,bio:"",createdAt:new Date})}catch(n){o("Erro ao carregar perfil do usuário"),s({id:t,name:"Usuário Anônimo",username:"Usuário Anônimo",email:"",profileImage:null,bio:"",createdAt:new Date})}finally{i(!1)}}):i(!1)},[t]),{userProfile:n,loading:r,error:a}})(null==i?void 0:i.uid);f.useEffect(()=>{const e=Lo(Cb,e=>{a(e||null)});return()=>e()},[]);const h=()=>p(e,null,function*(){try{l(!0),yield Co(Cb)}catch(Ly){alert("Erro ao fazer login. Tente novamente.")}finally{l(!1)}});return i?d?Ae.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center p-4",children:Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 max-w-md w-full border border-white/20 shadow-2xl text-center",children:[Ae.jsx("div",{className:"w-20 h-20 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:Ae.jsx("div",{className:"w-10 h-10 border-2 border-blue-400/30 border-t-blue-400 rounded-full animate-spin"})}),Ae.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Carregando..."}),Ae.jsx("p",{className:"text-blue-200 text-sm",children:"Buscando suas informações de perfil"})]})}):Ae.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center p-4",children:Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 max-w-md w-full border border-white/20 shadow-2xl",children:[Ae.jsxs("div",{className:"text-center mb-8",children:[Ae.jsx("div",{className:"w-20 h-20 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:Ae.jsx(b,{className:"w-10 h-10 text-blue-400"})}),Ae.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Chat em Tempo Real"}),Ae.jsx("p",{className:"text-blue-200 text-sm",children:"Conecte-se e converse com pessoas ao redor do mundo"})]}),Ae.jsx("div",{className:"bg-white/5 rounded-lg p-4 mb-6 border border-white/10",children:Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden bg-blue-500 flex items-center justify-center",children:(null==c?void 0:c.profileImage)?Ae.jsx("img",{src:c.profileImage,alt:c.name,className:"w-full h-full object-cover"}):Ae.jsx("span",{className:"text-white text-lg font-bold",children:(null==(n=null==c?void 0:c.name)?void 0:n.charAt(0).toUpperCase())||"U"})}),Ae.jsxs("div",{className:"flex-1",children:[Ae.jsx("p",{className:"text-white font-medium",children:(null==c?void 0:c.name)||"Usuário"}),Ae.jsx("p",{className:"text-blue-200 text-sm",children:i.isAnonymous?"Usuário Anônimo":(null==c?void 0:c.email)||"Sem email"})]}),Ae.jsx("button",{onClick:()=>Cb.signOut(),className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded-lg transition-colors",title:"Sair",children:Ae.jsx(y,{className:"w-4 h-4"})})]})}),Ae.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!s.trim())return void alert("Por favor, digite o nome da sala");if(!i)return void alert("Por favor, faça login primeiro");const n={user_id:i.uid,username:(null==c?void 0:c.name)||(null==c?void 0:c.username)||"Usuário Anônimo",name:(null==c?void 0:c.name)||(null==c?void 0:c.username)||"Usuário Anônimo",avatar:(null==c?void 0:c.profileImage)||null,email:(null==c?void 0:c.email)||i.email||"",isAnonymous:i.isAnonymous};t(s.trim(),n)},className:"space-y-6",children:[Ae.jsxs("div",{children:[Ae.jsxs("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:[Ae.jsx(w,{className:"w-4 h-4 inline mr-2"}),"Nome da Sala"]}),Ae.jsxs("div",{className:"flex space-x-2",children:[Ae.jsx("input",{type:"text",value:s,onChange:e=>r(e.target.value),placeholder:"Digite o nome da sala",className:"flex-1 bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-blue-200/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent",required:!0}),Ae.jsx("button",{type:"button",onClick:()=>{const e=Math.random().toString(36).substr(2,8);r(e)},className:"px-3 py-3 bg-blue-500/20 hover:bg-blue-500/30 text-blue-300 rounded-lg transition-colors border border-blue-400/30",title:"Gerar sala aleatória",children:"🎲"})]})]}),Ae.jsxs("button",{type:"submit",disabled:!s.trim(),className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 disabled:from-gray-500 disabled:to-gray-600 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 transform hover:scale-105 disabled:transform-none disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[Ae.jsx("span",{children:"Entrar na Sala"}),Ae.jsx(N,{className:"w-4 h-4"})]})]}),Ae.jsx("div",{className:"mt-8 text-center",children:Ae.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs text-blue-200/70",children:[Ae.jsxs("div",{children:[Ae.jsx("div",{className:"w-8 h-8 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-2",children:Ae.jsx("span",{className:"text-green-400",children:"🔒"})}),Ae.jsx("p",{children:"Salas Privadas"})]}),Ae.jsxs("div",{children:[Ae.jsx("div",{className:"w-8 h-8 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-2",children:Ae.jsx("span",{className:"text-blue-400",children:"⚡"})}),Ae.jsx("p",{children:"Tempo Real"})]}),Ae.jsxs("div",{children:[Ae.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-full flex items-center justify-center mx-auto mb-2",children:Ae.jsx("span",{className:"text-purple-400",children:"👥"})}),Ae.jsx("p",{children:"Múltiplos Usuários"})]})]})})]})}):Ae.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center p-4",children:Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 max-w-md w-full border border-white/20 shadow-2xl text-center",children:[Ae.jsx("div",{className:"w-20 h-20 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:Ae.jsx(b,{className:"w-10 h-10 text-blue-400"})}),Ae.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Chat em Tempo Real"}),Ae.jsx("p",{className:"text-blue-200 text-sm mb-8",children:"Faça login para começar a conversar"}),Ae.jsx("button",{onClick:h,disabled:o,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 disabled:from-gray-500 disabled:to-gray-600 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 transform hover:scale-105 disabled:transform-none disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:o?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),Ae.jsx("span",{children:"Conectando..."})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(v,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Entrar Anonimamente"})]})}),Ae.jsx("p",{className:"text-xs text-blue-200/70 mt-4",children:"Você pode entrar sem criar conta"})]})})},Rb=({roomId:t,currentUser:n,onLeaveRoom:s})=>{const[r,i]=f.useState([]),[a,o]=f.useState([]),[l,c]=f.useState(""),[h,m]=f.useState(!0),[g,x]=f.useState({}),v=f.useRef(null),w=f.useRef(null),{isConnected:N,connectionStatus:k,sendMessage:E,reconnect:S,error:I}=((e,t={})=>{const[n,s]=f.useState(!1),[r,i]=f.useState("disconnected"),[a,o]=f.useState(null),[l,c]=f.useState(null),u=f.useRef(null),d=f.useRef(null),h=f.useRef(null),{autoReconnect:m=!0,reconnectInterval:p=3e3,maxReconnectAttempts:g=5,pingInterval:x=3e4,onMessage:b,onOpen:v,onClose:y,onError:w}=t,N=f.useCallback(()=>{var t;if((null==(t=u.current)?void 0:t.readyState)!==WebSocket.OPEN)try{i("connecting"),c(null),u.current=new WebSocket(e),u.current.onopen=e=>{s(!0),i("connected"),c(null),x>0&&(h.current=setInterval(()=>{var e;(null==(e=u.current)?void 0:e.readyState)===WebSocket.OPEN&&u.current.send(JSON.stringify({type:"ping"}))},x)),null==v||v(e)},u.current.onmessage=e=>{try{const t=JSON.parse(e.data);o(t),null==b||b(t)}catch(t){c("Erro ao processar mensagem recebida")}},u.current.onclose=e=>{s(!1),i("disconnected"),h.current&&(clearInterval(h.current),h.current=null),null==y||y(e),m&&1e3!==e.code&&(i("reconnecting"),d.current=setTimeout(()=>{N()},p))},u.current.onerror=e=>{c("Erro na conexão WebSocket"),null==w||w(e)}}catch(n){c("Erro ao criar conexão WebSocket"),i("error")}},[e,m,p,x,b,v,y,w]),j=f.useCallback(()=>{u.current&&(d.current&&(clearTimeout(d.current),d.current=null),h.current&&(clearInterval(h.current),h.current=null),u.current.close(1e3,"Desconexão solicitada pelo usuário"),u.current=null,s(!1),i("disconnected"),c(null))},[]),C=f.useCallback(e=>{var t;if((null==(t=u.current)?void 0:t.readyState)!==WebSocket.OPEN)return c("WebSocket não está conectado"),!1;try{const t="string"==typeof e?e:JSON.stringify(e);return u.current.send(t),!0}catch(n){return c("Erro ao enviar mensagem"),!1}},[]),_=f.useCallback(()=>{j(),setTimeout(()=>{N()},1e3)},[N,j]);return f.useEffect(()=>(N(),()=>{j()}),[e,N,j]),f.useEffect(()=>()=>{d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)},[]),{isConnected:n,connectionStatus:r,lastMessage:a,error:l,connect:N,disconnect:j,sendMessage:C,reconnect:_,websocket:u.current}})("ws://localhost:8765",{onMessage:function(e){switch(e.type){case"connection_established":!function(){const e={type:"join_room",room_id:t,user_id:n.user_id,username:n.username,avatar:n.avatar};E(e)}();break;case"user_joined":!function(e){const{username:t,user_id:n,avatar:s,room_users:r}=e;T(`${t} entrou na conversa`),r&&(o(r),r.forEach(e=>{g[e.user_id]||A(e.user_id)}))}(e);break;case"user_left":!function(e){const{username:t,room_users:n}=e;T(`${t} saiu da conversa`),n&&o(n)}(e);break;case"receive_message":!function(e){const{user_id:t,username:s,message:r,timestamp:a,avatar:o,room_id:l}=e;if(t!==n.user_id){const e={id:`msg_${Date.now()}_${Math.random()}`,type:"received",user_id:t,username:s,message:r,timestamp:new Date(a),avatar:o};i(t=>[...t,e]),g[t]||A(t)}}(e);break;case"room_info":!function(e){const{users:t}=e;t&&(o(t),t.forEach(e=>{g[e.user_id]||A(e.user_id)}))}(e)}},onOpen:function(){},onClose:function(){},onError:function(e){}});function T(e){const t={id:`sys_${Date.now()}`,type:"system",message:e,timestamp:new Date};i(e=>[...e,t])}function A(t){return p(this,null,function*(){try{const n=yield(t=>p(e,null,function*(){var e;try{if(!t)return null;const n=Mg(kb,"users",t),s=yield Fx(n);if(s.exists()){const t=s.data();return u({id:s.id,name:t.name||t.username||"Usuário",username:t.username||t.name||"Usuário",email:t.email||"",profileImage:t.profileImage||null,bio:t.bio||"",createdAt:(null==(e=t.createdAt)?void 0:e.toDate())||new Date},t)}return null}catch(n){return null}}))(t);n&&x(e=>d(u({},e),{[t]:n}))}catch(n){}})}function R(){if(!l.trim()||!N)return;const e={type:"send_message",room_id:t,message:l.trim()};if(E(e)){const e={id:`own_${Date.now()}`,type:"sent",user_id:n.user_id,username:n.username,message:l.trim(),timestamp:new Date,avatar:n.avatar};i(t=>[...t,e]),c("")}}return f.useEffect(()=>{w.current&&w.current.focus()},[]),f.useEffect(()=>{v.current&&v.current.scrollIntoView({behavior:"smooth"})},[r]),Ae.jsxs("div",{className:"flex h-screen bg-gray-900",children:[h&&Ae.jsxs("div",{className:"w-64 bg-gray-800 border-r border-gray-700 flex flex-col",children:[Ae.jsx("div",{className:"p-4 border-b border-gray-700",children:Ae.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center",children:[Ae.jsx(j,{className:"w-5 h-5 mr-2"}),"Usuários Online (",a.length,")"]})}),Ae.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:a.map(e=>{const t=g[e.user_id],s=(null==t?void 0:t.name)||(null==t?void 0:t.username)||e.username||"Usuário",r=(null==t?void 0:t.profileImage)||e.avatar;return Ae.jsxs("div",{className:"flex items-center space-x-3 p-2 rounded-lg bg-gray-700/50",children:[Ae.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-blue-500 flex items-center justify-center",children:r?Ae.jsx("img",{src:r,alt:s,className:"w-full h-full object-cover"}):Ae.jsx("span",{className:"text-white text-sm font-bold",children:s.charAt(0).toUpperCase()})}),Ae.jsxs("div",{className:"flex-1 min-w-0",children:[Ae.jsx("p",{className:"text-white text-sm font-medium truncate",children:s}),Ae.jsx("p",{className:"text-gray-400 text-xs",children:e.user_id===n.user_id?"Você":"Online"})]})]},e.user_id)})})]}),Ae.jsxs("div",{className:"flex-1 flex flex-col",children:[Ae.jsxs("div",{className:"bg-gray-800 border-b border-gray-700 p-4 flex items-center justify-between",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx(b,{className:"w-6 h-6 text-blue-400"}),Ae.jsxs("div",{children:[Ae.jsxs("h2",{className:"text-xl font-semibold text-white",children:["Sala: ",t]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("div",{className:"w-2 h-2 rounded-full "+(N?"bg-green-400":"bg-red-400")}),Ae.jsx("span",{className:"text-sm "+(N?"text-green-400":"text-red-400"),children:"connected"===k?"Online":"connecting"===k?"Conectando...":"reconnecting"===k?"Reconectando...":"Offline"})]})]})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("button",{onClick:()=>m(!h),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:h?"Ocultar usuários":"Mostrar usuários",children:Ae.jsx(j,{className:"w-5 h-5"})}),Ae.jsx("button",{onClick:S,disabled:N,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50",title:"Reconectar",children:Ae.jsx(C,{className:"w-5 h-5"})}),Ae.jsx("button",{onClick:function(){E({type:"leave_room",room_id:t}),null==s||s()},className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded-lg transition-colors",title:"Sair da sala",children:Ae.jsx(y,{className:"w-5 h-5"})})]})]}),Ae.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[0===r.length?Ae.jsxs("div",{className:"text-center py-12",children:[Ae.jsx(b,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),Ae.jsx("p",{className:"text-gray-400 text-lg",children:"Nenhuma mensagem ainda"}),Ae.jsx("p",{className:"text-gray-500 text-sm",children:"Comece a conversa!"})]}):r.map(e=>{const t=g[e.user_id],n=(null==t?void 0:t.name)||(null==t?void 0:t.username)||e.username||"Usuário",s=(null==t?void 0:t.profileImage)||e.avatar;return Ae.jsx("div",{className:"flex "+("sent"===e.type?"justify-end":"justify-start"),children:"system"===e.type?Ae.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg px-4 py-2 max-w-md mx-auto",children:[Ae.jsx("p",{className:"text-yellow-300 text-sm text-center",children:e.message}),Ae.jsx("p",{className:"text-yellow-400/70 text-xs text-center mt-1",children:e.timestamp.toLocaleTimeString()})]}):Ae.jsxs("div",{className:"max-w-xs px-4 py-3 rounded-2xl relative "+("sent"===e.type?"bg-blue-500 text-white rounded-br-md":"bg-gray-700 text-white rounded-bl-md"),children:["received"===e.type&&Ae.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Ae.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden bg-gray-600",children:s?Ae.jsx("img",{src:s,alt:n,className:"w-full h-full object-cover"}):Ae.jsx("div",{className:"w-full h-full flex items-center justify-center text-white text-xs font-bold",children:n.charAt(0).toUpperCase()})}),Ae.jsx("span",{className:"text-xs text-gray-300 font-medium",children:n})]}),Ae.jsx("p",{className:"text-sm leading-relaxed",children:e.message}),Ae.jsxs("div",{className:"flex items-center justify-between mt-2",children:[Ae.jsx("span",{className:"text-xs "+("sent"===e.type?"text-blue-100":"text-gray-400"),children:e.timestamp.toLocaleTimeString()}),"sent"===e.type&&Ae.jsx("span",{className:"text-xs text-blue-200",children:"✓"})]}),Ae.jsx("div",{className:"absolute top-3 "+("sent"===e.type?"right-0 transform translate-x-full":"left-0 transform -translate-x-full"),children:Ae.jsx("div",{className:"w-0 h-0 border-8 border-transparent "+("sent"===e.type?"border-l-blue-500 border-r-0":"border-r-gray-700 border-l-0")})})]})},e.id)}),Ae.jsx("div",{ref:v})]}),Ae.jsxs("div",{className:"bg-gray-800 border-t border-gray-700 p-4",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("input",{ref:w,type:"text",value:l,onChange:e=>c(e.target.value),onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),R())},placeholder:"Digite sua mensagem...",disabled:!N,className:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),Ae.jsxs("button",{onClick:R,disabled:!l.trim()||!N,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-600 text-white px-6 py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[Ae.jsx(_,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Enviar"})]})]}),I&&Ae.jsx("div",{className:"mt-2 text-red-400 text-sm text-center",children:I})]})]})]})},Db=()=>{const[e,t]=f.useState(null),[n,s]=f.useState(null),r=(e,n)=>{t(e),s(n)};return e&&n?Ae.jsx(Rb,{roomId:e,currentUser:n,onLeaveRoom:()=>{t(null),s(null)}}):Ae.jsx(Ab,{onJoinRoom:r})},Pb={},Lb=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in Pb)return;Pb[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,n&&r.setAttribute("nonce",n),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},Ob=()=>{const[t,n]=f.useState({email:"",password:""}),[s,r]=f.useState(!1),[i,a]=f.useState(!1),[o,l]=f.useState("user"),[c,h]=f.useState(null),[m,g]=f.useState(null),x=e=>{n(d(u({},t),{[e.target.name]:e.target.value}))},b=xt(),v=()=>Ae.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(8)].map((e,t)=>Ae.jsx("div",{className:"absolute top-0 left-1/2 w-px h-full bg-gradient-to-b from-white/20 via-white/5 to-transparent transform-gpu origin-top",style:{transform:`translateX(-50%) rotate(${45*t}deg)`,animation:`pulse ${2+.5*t}s ease-in-out infinite alternate`}},t))});return Ae.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden text-white",children:[Ae.jsx(v,{}),Ae.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(15)].map((e,t)=>Ae.jsx("div",{className:"absolute w-1 h-1 bg-white/20 rounded-full animate-pulse",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:3*Math.random()+"s",animationDuration:2+2*Math.random()+"s"}},t))}),Ae.jsxs("div",{className:"relative w-full max-w-md z-10 animate-fade-in animate-slide-up",children:[Ae.jsx("button",{type:"button",onClick:()=>b("/"),className:"absolute -top-2 -left-2 p-2 text-white/80 hover:text-white transition-all duration-300 hover:scale-110 hover:rotate-12 group","aria-label":"Voltar para início",onMouseEnter:()=>g("back"),onMouseLeave:()=>g(null),children:Ae.jsx(k,{className:"w-6 h-6 transition-all duration-300 "+("back"===m?"drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]":"")})}),Ae.jsxs("div",{className:"text-center mb-6",children:[Ae.jsx("div",{className:"flex items-center justify-center mb-3",children:Ae.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/10 border border-white/20 flex items-center justify-center backdrop-blur-md hover:scale-110 hover:rotate-12 transition-all duration-500 hover:bg-white/20 hover:shadow-[0_0_20px_rgba(255,255,255,0.3)] group cursor-pointer overflow-hidden",children:Ae.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-8 h-8 object-contain group-hover:brightness-110 transition-all duration-300"})})}),Ae.jsx("h1",{className:"text-2xl font-semibold text-white mb-1 hover:text-white/90 transition-colors duration-300",children:"Sereno"}),Ae.jsx("p",{className:"text-white/60 text-sm hover:text-white/80 transition-colors duration-300",children:"Sua Rede de Apoio em Saúde Mental"})]}),Ae.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 shadow-2xl hover:bg-white/[0.07] hover:border-white/20 transition-all duration-500 hover:shadow-[0_20px_60px_rgba(255,255,255,0.1)] group",children:[Ae.jsxs("div",{className:"mb-4",children:[Ae.jsx("h2",{className:"text-xl font-light text-white mb-1 group-hover:text-white/95 transition-colors duration-300",children:"Bem-vindo de volta"}),Ae.jsx("p",{className:"text-white/60 text-sm group-hover:text-white/70 transition-colors duration-300",children:"Entre em sua conta para continuar"})]}),Ae.jsxs("div",{className:"mb-4",children:[Ae.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[Ae.jsx(E,{className:"w-3 h-3 text-white/40 animate-pulse"}),Ae.jsx("span",{className:"text-xs text-white/60",children:"Tipo de usuário:"}),Ae.jsx(E,{className:"w-3 h-3 text-white/40 animate-pulse",style:{animationDelay:"0.5s"}})]}),Ae.jsxs("div",{className:"flex bg-white/10 rounded-lg p-1 border border-white/20 hover:border-white/30 transition-all duration-300 hover:bg-white/15",children:[Ae.jsxs("button",{type:"button",onClick:()=>l("user"),className:"flex-1 flex items-center justify-center py-1.5 px-3 rounded-md transition-all duration-300 text-sm group "+("user"===o?"bg-white text-black shadow-lg scale-105 shadow-white/20":"text-white/70 hover:text-white hover:bg-white/10 hover:scale-105"),children:[Ae.jsx(S,{className:"w-3 h-3 mr-1.5 transition-all duration-300 "+("user"===o?"animate-bounce":"group-hover:scale-110")}),"Usuário"]}),Ae.jsxs("button",{type:"button",onClick:()=>l("psychologist"),className:"flex-1 flex items-center justify-center py-1.5 px-3 rounded-md transition-all duration-300 text-sm group "+("psychologist"===o?"bg-white text-black shadow-lg scale-105 shadow-white/20":"text-white/70 hover:text-white hover:bg-white/10 hover:scale-105"),children:[Ae.jsx(I,{className:"w-3 h-3 mr-1.5 transition-all duration-300 "+("psychologist"===o?"animate-pulse":"group-hover:scale-110")}),"Profissional"]})]})]}),Ae.jsxs("form",{onSubmit:n=>p(e,null,function*(){if(n.preventDefault(),t.email&&t.password){a(!0);try{(yield Ao(Cb,t.email,t.password)).user,alert("Login realizado com sucesso!"),b("/home")}catch(Ly){let t="Erro ao fazer login.";switch(Ly.code){case"auth/user-not-found":t="Usuário não encontrado.";break;case"auth/wrong-password":t="Senha incorreta.";break;case"auth/invalid-email":t="Email inválido.";break;case"auth/too-many-requests":t="Muitas tentativas. Tente novamente mais tarde.";break;default:t=Ly.message}alert(t)}finally{a(!1)}}else alert("Por favor, preencha todos os campos.")}),className:"space-y-4",children:[Ae.jsxs("div",{className:"space-y-1 group",children:[Ae.jsx("label",{htmlFor:"email",className:"block text-xs font-light text-white/80 group-hover:text-white/90 transition-colors duration-300",children:"E-mail"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50 transition-all duration-300 "+("email"===c?"text-white/80 scale-110":"group-hover:text-white/70")}),Ae.jsx("input",{type:"email",id:"email",name:"email",value:t.email,onChange:x,onFocus:()=>h("email"),onBlur:()=>h(null),className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300 text-sm hover:bg-black/60 hover:border-white/30 "+("email"===c?"scale-[1.02] shadow-[0_0_15px_rgba(255,255,255,0.1)]":""),placeholder:"seu@email.com",required:!0})]})]}),Ae.jsxs("div",{className:"space-y-1 group",children:[Ae.jsx("label",{htmlFor:"password",className:"block text-xs font-light text-white/80 group-hover:text-white/90 transition-colors duration-300",children:"Senha"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50 transition-all duration-300 "+("password"===c?"text-white/80 scale-110":"group-hover:text-white/70")}),Ae.jsx("input",{type:s?"text":"password",id:"password",name:"password",value:t.password,onChange:x,onFocus:()=>h("password"),onBlur:()=>h(null),className:"w-full pl-9 pr-10 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300 text-sm hover:bg-black/60 hover:border-white/30 "+("password"===c?"scale-[1.02] shadow-[0_0_15px_rgba(255,255,255,0.1)]":""),placeholder:"••••••••",required:!0}),Ae.jsx("button",{type:"button",onClick:()=>r(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white transition-all duration-300 hover:scale-110",children:s?Ae.jsx(R,{className:"w-4 h-4 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"}):Ae.jsx(D,{className:"w-4 h-4 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"})})]})]}),Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsxs("label",{className:"flex items-center group cursor-pointer",children:[Ae.jsx("input",{type:"checkbox",className:"w-3 h-3 rounded border-white/30 bg-black/40 text-white focus:ring-white/30 focus:ring-2 transition-all duration-300 hover:scale-110"}),Ae.jsx("span",{className:"ml-2 text-xs text-white/70 group-hover:text-white/90 transition-colors duration-300",children:"Lembrar de mim"})]}),Ae.jsx("button",{type:"button",onClick:()=>p(e,null,function*(){if(t.email)try{const{sendPasswordResetEmail:n}=yield Lb(()=>p(e,null,function*(){const{sendPasswordResetEmail:e}=yield Promise.resolve().then(()=>Jl);return{sendPasswordResetEmail:e}}),[]);yield n(Cb,t.email),alert("Email de redefinição enviado! Verifique sua caixa de entrada.")}catch(Ly){let t="Erro ao enviar email de redefinição.";switch(Ly.code){case"auth/user-not-found":t="Usuário não encontrado com este email.";break;case"auth/invalid-email":t="Email inválido.";break;case"auth/too-many-requests":t="Muitas tentativas. Tente novamente mais tarde.";break;default:t=Ly.message}alert(t)}else alert("Digite seu e-mail para receber o link de redefinição.")}),className:"text-xs text-white/80 hover:text-white transition-all duration-300 hover:scale-105 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.3)]",children:"Esqueceu a senha?"})]}),Ae.jsxs("button",{type:"submit",disabled:i,className:"w-full py-2.5 px-4 bg-white text-black hover:bg-white/90 disabled:bg-white/60 font-medium rounded-lg transition-all duration-300 transform hover:scale-[1.02] hover:shadow-[0_8px_30px_rgba(255,255,255,0.3)] disabled:scale-100 disabled:cursor-not-allowed shadow-lg text-sm group overflow-hidden relative",onMouseEnter:()=>g("submit"),onMouseLeave:()=>g(null),children:[Ae.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full transition-transform duration-1000 "+("submit"!==m||i?"":"translate-x-full")}),i?Ae.jsxs("div",{className:"flex items-center justify-center",children:[Ae.jsx("div",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin mr-2"}),"Entrando..."]}):Ae.jsx("span",{className:"relative z-10",children:"Entrar"})]})]}),"user"===o&&Ae.jsxs("div",{className:"mt-4 animate-fade-in",style:{animationDelay:"0.2s"},children:[Ae.jsxs("div",{className:"relative",children:[Ae.jsx("div",{className:"absolute inset-0 flex items-center",children:Ae.jsx("div",{className:"w-full border-t border-white/10"})}),Ae.jsx("div",{className:"relative flex justify-center text-xs",children:Ae.jsx("span",{className:"px-4 bg-black text-white/60",children:"ou continue com"})})]}),Ae.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:Ae.jsxs("button",{onClick:()=>p(e,null,function*(){a(!0);try{(yield dl(Cb,_b)).user,alert("Login com Google realizado com sucesso!"),b("/home")}catch(Ly){let t="Erro ao fazer login com Google.";switch(Ly.code){case"auth/popup-closed-by-user":t="Login cancelado pelo usuário.";break;case"auth/popup-blocked":t="Popup bloqueado pelo navegador. Permita popups para este site.";break;case"auth/cancelled-popup-request":t="Muitas tentativas de login. Aguarde um momento.";break;case"auth/account-exists-with-different-credential":t="Uma conta já existe com este email usando outro método de login.";break;default:t=Ly.message}alert(t)}finally{a(!1)}}),type:"button",className:"flex items-center justify-center py-1.5 px-4 border border-white/20 rounded-lg text-white/80 hover:text-white hover:border-white/30 transition-all duration-300 text-sm hover:scale-[1.02] hover:bg-white/5 hover:shadow-[0_4px_20px_rgba(255,255,255,0.1)] group relative overflow-hidden",onMouseEnter:()=>g("google"),onMouseLeave:()=>g(null),children:[Ae.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 via-white/20 to-white/10 opacity-0 transition-opacity duration-300 "+("google"===m?"opacity-100":"")}),Ae.jsxs("svg",{className:"w-4 h-4 mr-2 relative z-10 group-hover:scale-110 transition-transform duration-300",viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",children:[Ae.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.37c-.23 1.22-.93 2.25-1.98 2.94v2.45h3.2c1.87-1.72 2.97-4.25 2.97-7.4z",fill:"#4285F4"}),Ae.jsx("path",{d:"M12 23c2.7 0 4.96-.9 6.62-2.45l-3.2-2.45c-.9.6-2.06.96-3.42.96-2.63 0-4.85-1.77-5.64-4.15H3.01v2.6C4.65 20.98 8.06 23 12 23z",fill:"#34A853"}),Ae.jsx("path",{d:"M6.36 14.91c-.2-.6-.32-1.24-.32-1.91s.12-1.31.32-1.91V8.49H3.01A11 11 0 0 0 2 12c0 1.76.42 3.41 1.01 4.91l3.35-2z",fill:"#FBBC05"}),Ae.jsx("path",{d:"M12 5.27c1.47 0 2.8.51 3.84 1.5l2.88-2.88C16.94 2.23 14.7 1.32 12 1.32 8.06 1.32 4.65 3.34 3.01 6.09l3.35 2.6C7.15 7.31 9.37 5.27 12 5.27z",fill:"#EA4335"})]}),Ae.jsx("span",{className:"relative z-10",children:"Google"})]})})]}),"psychologist"===o&&Ae.jsx("div",{className:"mt-4 animate-fade-in",style:{animationDelay:"0.3s"},children:Ae.jsxs("div",{className:"bg-white/10 border border-white/20 rounded-lg p-3 text-center hover:bg-white/15 hover:border-white/30 transition-all duration-300 hover:scale-[1.02] hover:shadow-[0_0_20px_rgba(255,255,255,0.2)] group",children:[Ae.jsx(I,{className:"w-5 h-5 text-white mx-auto mb-1.5 group-hover:scale-110 group-hover:animate-pulse transition-transform duration-300"}),Ae.jsx("p",{className:"text-white text-xs font-medium group-hover:text-white transition-colors duration-300",children:"Login Profissional"}),Ae.jsx("p",{className:"text-white/80 text-xs group-hover:text-white transition-colors duration-300",children:"Psicólogos devem usar suas credenciais registradas"})]})}),Ae.jsx("div",{className:"mt-4 text-center",children:Ae.jsxs("p",{className:"text-white/70 text-sm",children:["Não tem uma conta?"," ",Ae.jsx("button",{onClick:()=>b("/register"),className:"text-white hover:text-white/80 font-medium transition-all duration-300 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.5)] hover:scale-105 inline-block",children:"Cadastre-se"})]})})]}),Ae.jsx("div",{className:"mt-6 text-center text-white/50 text-xs animate-fade-in",style:{animationDelay:"0.5s"},children:Ae.jsxs("p",{className:"hover:text-white/70 transition-colors duration-300 cursor-default",children:["Conecte-se, Entenda-se, ",Ae.jsx("span",{className:"text-white hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.3)] transition-all duration-300",children:"Evolua."})]})})]})]})},Mb=()=>{const[t,n]=f.useState("cliente"),[s,r]=f.useState({name:"",username:"",email:"",birthDate:"",phone:"",password:"",confirmPassword:"",crp:"",specialty:"",yearsExperience:"",acceptsOnline:!1,bio:""}),[i,a]=f.useState(!1),[o,l]=f.useState(!1),[c,h]=f.useState(!1),[m,g]=f.useState(null),x=xt(),b=e=>{const{name:t,value:n,type:i,checked:a}=e.target;r(d(u({},s),{[t]:"checkbox"===i?a:n}))};return Ae.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden text-white",children:[Ae.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(8)].map((e,t)=>Ae.jsx("div",{className:"absolute top-0 left-1/2 w-px h-full bg-gradient-to-b from-white/20 via-white/5 to-transparent transform-gpu origin-top",style:{transform:`translateX(-50%) rotate(${45*t}deg)`,animation:`pulse ${2+.5*t}s ease-in-out infinite alternate`}},t))}),Ae.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(15)].map((e,t)=>Ae.jsx("div",{className:"absolute w-1 h-1 bg-white/20 rounded-full animate-pulse",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:3*Math.random()+"s",animationDuration:2+2*Math.random()+"s"}},t))}),Ae.jsxs("div",{className:"relative w-full max-w-md z-10 animate-fade-in animate-slide-up",children:[Ae.jsx("button",{type:"button",onClick:()=>x("/"),className:"absolute -top-2 -left-2 p-2 text-white/80 hover:text-white transition-all duration-300 hover:scale-110 hover:rotate-12 group","aria-label":"Voltar para início",onMouseEnter:()=>g("back"),onMouseLeave:()=>g(null),children:Ae.jsx(k,{className:"w-6 h-6 transition-all duration-300 "+("back"===m?"drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]":"")})}),Ae.jsxs("div",{className:"text-center mb-6",children:[Ae.jsx("div",{className:"flex items-center justify-center mb-3",children:Ae.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/10 border border-white/20 flex items-center justify-center backdrop-blur-md hover:scale-110 hover:rotate-12 transition-all duration-500 hover:bg-white/20 hover:shadow-[0_0_20px_rgba(255,255,255,0.3)] group cursor-pointer",children:Ae.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-full h-full object-contain p-1",loading:"eager"})})}),Ae.jsx("h1",{className:"text-2xl font-semibold text-white mb-1 hover:text-white/90 transition-colors duration-300",children:"Sereno"}),Ae.jsx("p",{className:"text-white/60 text-sm hover:text-white/80 transition-colors duration-300",children:"Crie sua conta e comece hoje"})]}),Ae.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 shadow-2xl hover:bg-white/[0.07] hover:border-white/20 transition-all duration-500 hover:shadow-[0_20px_60px_rgba(255,255,255,0.1)] group",children:[Ae.jsxs("div",{className:"mb-4",children:[Ae.jsx("h2",{className:"text-xl font-light text-white mb-1 group-hover:text-white/95 transition-colors duration-300",children:"Criar Conta"}),Ae.jsx("p",{className:"text-white/60 text-sm group-hover:text-white/70 transition-colors duration-300",children:"Leva menos de 2 minutos"})]}),Ae.jsxs("div",{className:"mb-4",children:[Ae.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[Ae.jsx(E,{className:"w-3 h-3 text-white/40 animate-pulse"}),Ae.jsx("span",{className:"text-xs text-white/60",children:"Tipo de usuário:"}),Ae.jsx(E,{className:"w-3 h-3 text-white/40 animate-pulse",style:{animationDelay:"0.5s"}})]}),Ae.jsxs("div",{className:"flex bg-white/10 rounded-lg p-1 border border-white/20 hover:border-white/30 transition-all duration-300 hover:bg-white/15",children:[Ae.jsxs("button",{type:"button",onClick:()=>n("cliente"),className:"flex-1 flex items-center justify-center py-1.5 px-3 rounded-md transition-all duration-300 text-sm group "+("cliente"===t?"bg-white text-black shadow-lg scale-105 shadow-white/20":"text-white/70 hover:text-white hover:bg-white/10 hover:scale-105"),children:[Ae.jsx(S,{className:"w-3 h-3 mr-1.5 transition-all duration-300 group-hover:scale-110"}),"Cliente"]}),Ae.jsxs("button",{type:"button",onClick:()=>n("psicologo"),className:"flex-1 flex items-center justify-center py-1.5 px-3 rounded-md transition-all duration-300 text-sm group "+("psicologo"===t?"bg-white text-black shadow-lg scale-105 shadow-white/20":"text-white/70 hover:text-white hover:bg-white/10 hover:scale-105"),children:[Ae.jsx(I,{className:"w-3 h-3 mr-1.5 transition-all duration-300 group-hover:scale-110"}),"Psicólogo"]})]})]}),Ae.jsxs("form",{onSubmit:n=>p(e,null,function*(){if(n.preventDefault(),s.name&&s.username&&s.email&&s.birthDate&&s.phone&&s.password&&s.confirmPassword)if(s.password===s.confirmPassword)if(/^[a-zA-Z0-9_]{3,20}$/.test(s.username)){h(!0);try{const e=(yield To(Cb,s.email,s.password)).user;yield Ro(e,{displayName:s.name}),yield zx(Mg(kb,"users",e.uid),u({displayName:s.name,username:s.username.toLowerCase(),email:s.email,birthDate:s.birthDate,phone:s.phone,role:t,createdAt:Qx()},"psicologo"===t&&{crp:s.crp,specialty:s.specialty,yearsExperience:s.yearsExperience,acceptsOnline:s.acceptsOnline,bio:s.bio})),alert("Conta criada com sucesso!"),x("/connected")}catch(Ly){alert(Ly.message)}finally{h(!1)}}else alert("O username deve ter entre 3 e 20 caracteres e conter apenas letras, números e underscore (_).");else alert("As senhas não coincidem");else alert("Por favor, preencha todos os campos obrigatórios.")}),className:"space-y-4",children:[Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"name",className:"block text-xs font-light text-white/80",children:"Nome"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"text",id:"name",name:"name",value:s.name,onChange:b,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"Seu nome completo",required:!0})]})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"username",className:"block text-xs font-light text-white/80",children:"Username"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"text",id:"username",name:"username",value:s.username,onChange:b,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"seu_usuario",required:!0})]})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"email",className:"block text-xs font-light text-white/80",children:"E-mail"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:b,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"seu@email.com",required:!0})]})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"birthDate",className:"block text-xs font-light text-white/80",children:"Data de Nascimento"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"date",id:"birthDate",name:"birthDate",value:s.birthDate,onChange:b,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",required:!0})]})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"phone",className:"block text-xs font-light text-white/80",children:"Telefone"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"tel",id:"phone",name:"phone",value:s.phone,onChange:b,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"(11) 99999-9999",required:!0})]})]}),"psicologo"===t&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"crp",className:"block text-xs font-light text-white/80",children:"CRP"}),Ae.jsx("input",{type:"text",id:"crp",name:"crp",value:s.crp,onChange:b,className:"w-full px-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"CRP 00/00000",required:!0})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"specialty",className:"block text-xs font-light text-white/80",children:"Especialidade"}),Ae.jsx("input",{type:"text",id:"specialty",name:"specialty",value:s.specialty,onChange:b,className:"w-full px-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"Ex.: TCC, Ansiedade, Depressão",required:!0})]}),Ae.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"yearsExperience",className:"block text-xs font-light text-white/80",children:"Anos de experiência"}),Ae.jsx("input",{type:"number",id:"yearsExperience",name:"yearsExperience",value:s.yearsExperience,onChange:b,className:"w-full px-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"0",min:"0",required:!0})]}),Ae.jsxs("label",{className:"flex items-center justify-start gap-2 mt-5",children:[Ae.jsx("input",{type:"checkbox",name:"acceptsOnline",checked:s.acceptsOnline,onChange:b,className:"w-3 h-3 rounded border-white/30 bg-black/40 text-white focus:ring-white/30 focus:ring-2"}),Ae.jsx("span",{className:"text-xs text-white/80",children:"Atende online"})]})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"bio",className:"block text-xs font-light text-white/80",children:"Bio (opcional)"}),Ae.jsx("textarea",{id:"bio",name:"bio",rows:"2",value:s.bio,onChange:b,className:"w-full px-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"Fale brevemente sobre sua abordagem."})]})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"password",className:"block text-xs font-light text-white/80",children:"Senha"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:i?"text":"password",id:"password",name:"password",value:s.password,onChange:b,className:"w-full pl-9 pr-10 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"••••••••",required:!0}),Ae.jsx("button",{type:"button",onClick:()=>a(e=>!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white transition-colors",children:i?Ae.jsx(R,{className:"w-4 h-4"}):Ae.jsx(D,{className:"w-4 h-4"})})]})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"confirmPassword",className:"block text-xs font-light text-white/80",children:"Confirmar Senha"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:o?"text":"password",id:"confirmPassword",name:"confirmPassword",value:s.confirmPassword,onChange:b,className:"w-full pl-9 pr-10 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"••••••••",required:!0}),Ae.jsx("button",{type:"button",onClick:()=>l(e=>!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white transition-colors",children:o?Ae.jsx(R,{className:"w-4 h-4"}):Ae.jsx(D,{className:"w-4 h-4"})})]})]}),Ae.jsxs("button",{type:"submit",disabled:c,className:"w-full py-2.5 px-4 bg-white text-black hover:bg-white/90 disabled:bg-white/60 font-medium rounded-lg transition-all duration-300 transform hover:scale-[1.02] hover:shadow-[0_8px_30px_rgba(255,255,255,0.3)] disabled:scale-100 disabled:cursor-not-allowed shadow-lg text-sm group overflow-hidden relative",onMouseEnter:()=>g("submit"),onMouseLeave:()=>g(null),children:[Ae.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full transition-transform duration-1000 "+("submit"!==m||c?"":"translate-x-full")}),c?Ae.jsxs("div",{className:"flex items-center justify-center",children:[Ae.jsx("div",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin mr-2"}),"Criando..."]}):Ae.jsx("span",{className:"relative z-10",children:"Criar Conta"})]})]}),Ae.jsx("div",{className:"mt-4 text-center",children:Ae.jsxs("p",{className:"text-white/70 text-sm",children:["Já tem uma conta?"," ",Ae.jsx("button",{onClick:()=>x("/login"),className:"text-white hover:text-white/80 font-medium transition-all duration-300 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.5)] hover:scale-105 inline-block",children:"Fazer login"})]})})]}),Ae.jsx("div",{className:"mt-6 text-center text-white/50 text-xs animate-fade-in",style:{animationDelay:"0.5s"},children:Ae.jsxs("p",{className:"hover:text-white/70 transition-colors duration-300 cursor-default",children:["Conecte-se, Entenda-se, ",Ae.jsx("span",{className:"text-white hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.3)] transition-all duration-300",children:"Evolua."})]})})]})]})},Ub=()=>{const e=f.useRef(null),t=f.useRef(null),n=f.useRef(0),s=f.useCallback((e,t)=>{let n;return function(){const s=arguments,r=this;n||(e.apply(r,s),n=!0,setTimeout(()=>n=!1,t))}},[]),r=f.useCallback(()=>window.innerWidth<=768,[]);return f.useEffect(()=>{const t=e.current;if(!t)return;const i=t.getContext("2d");let a;const o=s(()=>{const e=window.devicePixelRatio||1,n=t.getBoundingClientRect();t.width=n.width*e,t.height=n.height*e,i.scale(e,e),t.style.width=n.width+"px",t.style.height=n.height+"px"},100);o(),window.addEventListener("resize",o,{passive:!0});const l=[],c=r()?25:50,u=r()?3:5;class d{constructor(){this.x=Math.random()*t.width,this.y=Math.random()*t.height,this.size=1.5*Math.random()+.5,this.speedX=(.3*Math.random()-.15)*(r()?.5:1),this.speedY=(.3*Math.random()-.15)*(r()?.5:1),this.opacity=.2*Math.random()+.05,this.connections=0}update(){this.x+=this.speedX,this.y+=this.speedY,this.x>t.width&&(this.x=0),this.x<0&&(this.x=t.width),this.y>t.height&&(this.y=0),this.y<0&&(this.y=t.height)}draw(){i.save(),i.globalAlpha=this.opacity,i.fillStyle="rgba(255, 255, 255, 0.6)",i.beginPath(),i.arc(this.x,this.y,this.size,0,2*Math.PI),i.fill(),i.restore()}}for(let e=0;e<c;e++)l.push(new d);const h=e=>{if(e-n.current<16)return void(a=requestAnimationFrame(h));n.current=e,i.clearRect(0,0,t.width,t.height);const s=i.createRadialGradient(t.width/2,t.height/2,0,t.width/2,t.height/2,t.width/2);s.addColorStop(0,"rgba(255, 255, 255, 0.015)"),s.addColorStop(1,"rgba(255, 255, 255, 0)"),i.fillStyle=s,i.fillRect(0,0,t.width,t.height),l.forEach(e=>{e.update(),e.draw(),e.connections=0}),l.forEach((e,t)=>{if(!(e.connections>=u))for(let n=t+1;n<l.length;n++){if(l[n].connections>=u)continue;const t=e.x-l[n].x,s=e.y-l[n].y,a=Math.sqrt(t*t+s*s);a<(r()?80:100)&&(i.save(),i.globalAlpha=((r()?80:100)-a)/(r()?80:100)*.08,i.strokeStyle="rgba(255, 255, 255, 0.2)",i.lineWidth=.3,i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(l[n].x,l[n].y),i.stroke(),i.restore(),e.connections++,l[n].connections++)}}),a=requestAnimationFrame(h)};return h(0),()=>{window.removeEventListener("resize",o),a&&cancelAnimationFrame(a)}},[]),f.useEffect(()=>{const e=()=>{document.hidden&&t.current&&cancelAnimationFrame(t.current)};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]),Ae.jsx("canvas",{ref:e,className:"fixed inset-0 pointer-events-none z-0",style:{opacity:.25,willChange:"transform",backfaceVisibility:"hidden"},"aria-hidden":"true"})},Fb=()=>{const e=xt(),[t,n]=f.useState(3);return f.useEffect(()=>{const t=setTimeout(()=>{e("/home")},3e3),s=setInterval(()=>{n(e=>e<=1?(clearInterval(s),0):e-1)},1e3);return()=>{clearTimeout(t),clearInterval(s)}},[e]),Ae.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden text-white",children:[Ae.jsx(Ub,{}),Ae.jsx("div",{className:"relative w-full max-w-lg z-10 text-center",children:Ae.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-8 shadow-2xl",children:[Ae.jsx("div",{className:"flex justify-center mb-6",children:Ae.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center",children:Ae.jsx(M,{className:"w-12 h-12 text-green-400"})})}),Ae.jsx("h1",{className:"text-3xl font-light mb-3 text-white",children:"Perfil Completo!"}),Ae.jsx("p",{className:"text-white/70 text-lg mb-6",children:"Seu perfil foi criado com sucesso. Bem-vindo ao Sereno!"}),Ae.jsxs("div",{className:"space-y-3 mb-8",children:[Ae.jsxs("div",{className:"flex items-center justify-center space-x-2 text-white/60",children:[Ae.jsx(S,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Perfil personalizado configurado"})]}),Ae.jsxs("div",{className:"flex items-center justify-center space-x-2 text-white/60",children:[Ae.jsx(E,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Pronto para explorar a plataforma"})]})]}),Ae.jsxs("div",{className:"text-center",children:[Ae.jsx("p",{className:"text-white/50 text-sm mb-2",children:"Redirecionando automaticamente em:"}),Ae.jsxs("div",{className:"text-2xl font-bold text-green-400 mb-4",children:[t," segundos"]})]}),Ae.jsx("button",{onClick:()=>e("/home"),className:"w-full py-3 px-6 bg-white text-black hover:bg-white/90 font-medium rounded-lg transition-all duration-200 transform hover:scale-[1.02] shadow-lg",children:"Ir para Home Agora"})]})})]})},Vb=[{id:"1",content:"Hoje foi um dia incrível! Consegui enfrentar uma situação que me causava muita ansiedade. A terapia está realmente fazendo diferença na minha vida. É incrível como pequenos passos podem levar a grandes mudanças! 💪✨",author:"Maria Silva",userId:"user1",avatar:null,createdAt:new Date("2024-01-15T10:00:00"),updatedAt:new Date("2024-01-15T10:00:00"),likes:["user2","user3"],commentCount:2,shares:1,tags:["ansiedade","terapia","progresso"],isAnonymous:!1,visibility:"public",isEdited:!1},{id:"2",content:"Estou me sentindo um pouco perdido ultimamente. Alguém mais já passou por isso? Às vezes parece que estou andando em círculos...",author:"João Santos",userId:"user2",avatar:null,createdAt:new Date("2024-01-15T09:30:00"),updatedAt:new Date("2024-01-15T09:30:00"),likes:["user1"],commentCount:1,shares:0,tags:["reflexão","apoio"],isAnonymous:!1,visibility:"public",isEdited:!1},{id:"3",content:"Dica do dia: respiração 4-7-8. Inspire por 4 segundos, segure por 7, expire por 8. Funciona muito bem para momentos de estresse! 🧘‍♀️",author:"Ana Costa",userId:"user3",avatar:null,createdAt:new Date("2024-01-15T09:00:00"),updatedAt:new Date("2024-01-15T09:00:00"),likes:["user1","user2","user4"],commentCount:0,shares:3,tags:["dica","respiração","estresse"],isAnonymous:!1,visibility:"public",isEdited:!1},{id:"4",content:"Post anônimo para testar funcionalidade",author:"Usuário Anônimo",userId:"user1",avatar:null,createdAt:new Date("2024-01-15T08:30:00"),updatedAt:new Date("2024-01-15T08:30:00"),likes:[],commentCount:0,shares:0,tags:["teste"],isAnonymous:!0,visibility:"anonymous",isEdited:!1}],$b=[{id:"user1",displayName:"Maria Silva",email:"maria@email.com",photoURL:null,role:"cliente",bio:"Em busca de equilíbrio mental e emocional",location:"São Paulo, SP",createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-15")},{id:"user2",displayName:"João Santos",email:"joao@email.com",photoURL:null,role:"cliente",bio:"Aprendendo a lidar com a ansiedade",location:"Rio de Janeiro, RJ",createdAt:new Date("2024-01-05"),updatedAt:new Date("2024-01-15")},{id:"user3",displayName:"Ana Costa",email:"ana@email.com",photoURL:null,role:"cliente",bio:"Psicóloga em formação, apaixonada por ajudar pessoas",location:"Belo Horizonte, MG",createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-15")}],zb=[{id:"1",postId:"1",authorId:"user2",authorName:"João Santos",authorAvatar:null,content:"Que ótimo que está se sentindo melhor! A terapia realmente faz diferença.",likes:[],createdAt:new Date("2024-01-15T10:05:00")},{id:"2",postId:"1",authorId:"user3",authorName:"Ana Costa",authorAvatar:null,content:"Continue assim! O progresso é gradual mas muito gratificante.",likes:["user1"],createdAt:new Date("2024-01-15T10:10:00")}],Bb={createUserProfile(e,t){return p(this,null,function*(){try{const n=Mg(kb,"users",e);return yield Bx(n,d(u({},t),{createdAt:Qx(),updatedAt:Qx()})),{success:!0,userId:e}}catch(Ly){throw Ly}})},getUserProfile(e){return p(this,null,function*(){try{const t=Mg(kb,"users",e),n=yield Fx(t);return n.exists()?u({id:n.id},n.data()):null}catch(Ly){return $b.find(t=>t.id===e)||null}})},updateUserProfile(e,t){return p(this,null,function*(){try{const n=Mg(kb,"users",e);return yield Bx(n,d(u({},t),{updatedAt:Qx()})),{success:!0}}catch(Ly){throw Ly}})},updateUserBasicProfile(e,t){return p(this,null,function*(){try{const n=Mg(kb,"users",e);return yield Bx(n,{displayName:t.displayName,username:t.username,bio:t.bio,phone:t.phone,birthDate:t.birthDate,updatedAt:Qx()}),{success:!0}}catch(Ly){throw Ly}})},getUsersByRole(e){return p(this,null,function*(){try{const t=wx(Og(kb,"users"),jx("role","==",e));return(yield $x(t)).docs.map(e=>u({id:e.id},e.data()))}catch(Ly){return $b.filter(t=>t.role===e)}})}},qb={createPost(e){return p(this,null,function*(){try{const t=Og(kb,"posts");return{success:!0,postId:(yield Gx(t,d(u({},e),{createdAt:Qx(),updatedAt:Qx(),likes:[],commentCount:0,shares:0,isEdited:!1}))).id}}catch(Ly){throw Ly}})},deletePost(e){return p(this,null,function*(){try{const t=Mg(kb,"posts",e),n=yield Fx(t);if(n.exists()){n.data(),yield qx(t);const s=wx(Og(kb,"comments"),jx("postId","==",e)),r=(yield $x(s)).docs.map(e=>qx(e.ref));return yield Promise.all(r),!0}return!1}catch(Ly){throw Ly}})},getPosts(e=20,t=0){return p(this,null,function*(){try{let t=wx(Og(kb,"posts"),kx("createdAt","desc"),Sx(e));const n=yield $x(t);return n.docs.map(e=>u({id:e.id},e.data())).filter(e=>"public"===e.visibility)}catch(Ly){return"failed-precondition"===Ly.code||Ly.code,Vb.filter(e=>"public"===e.visibility).slice(t,t+e)}})},getUserPosts(e,t=50){return p(this,null,function*(){try{let n=wx(Og(kb,"posts"),kx("createdAt","desc"),Sx(t));const s=yield $x(n);return s.docs.map(e=>u({id:e.id},e.data())).filter(t=>t.userId===e&&"public"===t.visibility&&!t.isAnonymous)}catch(Ly){return"failed-precondition"===Ly.code||Ly.code,Vb.filter(t=>t.userId===e&&"public"===t.visibility&&!t.isAnonymous).slice(0,t)}})},togglePostLike(e,t){return p(this,null,function*(){try{const n=Mg(kb,"posts",e),s=yield Fx(n);if(s.exists()){const r=s.data(),i=r.likes||[];if(i.includes(t))yield Bx(n,{likes:i.filter(e=>e!==t),updatedAt:Qx()});else if(yield Bx(n,{likes:[...i,t],updatedAt:Qx()}),r.userId!==t)try{yield Hb.createLikeNotification(e,r.userId,t,"Usuário")}catch(Ly){}return!0}return!1}catch(Ly){throw Ly}})}},Gb={recordMood(e,t){return p(this,null,function*(){try{const n=Og(kb,"moods");return{success:!0,moodId:(yield Gx(n,d(u({userId:e},t),{recordedAt:Qx()}))).id}}catch(Ly){throw Ly}})},getUserMoodHistory(e,t=30){return p(this,null,function*(){try{const n=wx(Og(kb,"moods"),kx("recordedAt","desc"),Sx(t)),s=yield $x(n);return s.docs.map(e=>u({id:e.id},e.data())).filter(t=>t.userId===e)}catch(Ly){return"failed-precondition"===Ly.code||Ly.code,[]}})},getMoodStats(e,t="week"){return p(this,null,function*(){try{const n=wx(Og(kb,"moods"),kx("recordedAt","desc")),s=(yield $x(n)).docs.map(e=>e.data()).filter(t=>t.userId===e),r=new Date;let i=[];if("week"===t){const e=new Date(r.getTime()-6048e5);i=s.filter(t=>{var n;return(null==(n=t.recordedAt)?void 0:n.toDate())>e})}else if("month"===t){const e=new Date(r.getTime()-2592e6);i=s.filter(t=>{var n;return(null==(n=t.recordedAt)?void 0:n.toDate())>e})}const a=i.reduce((e,t)=>e+(t.intensity||0),0),o=i.length>0?a/i.length:0;return{totalEntries:i.length,averageMood:Math.round(10*o)/10,period:t,moods:i}}catch(Ly){return"failed-precondition"===Ly.code||Ly.code,{totalEntries:0,averageMood:0,period:t,moods:[]}}})}},Hb={createNotification(e){return p(this,null,function*(){try{const t=Og(kb,"notifications");return{success:!0,notificationId:(yield Gx(t,d(u({},e),{createdAt:Qx(),read:!1}))).id}}catch(Ly){throw Ly}})},getUserNotifications(e,t=50){return p(this,null,function*(){try{const n=wx(Og(kb,"notifications"),kx("createdAt","desc"),Sx(t)),s=yield $x(n);return s.docs.map(e=>u({id:e.id},e.data())).filter(t=>t.recipientId===e)}catch(Ly){return"failed-precondition"===Ly.code||Ly.code,[]}})},markNotificationAsRead(e){return p(this,null,function*(){try{const t=Mg(kb,"notifications",e);return yield Bx(t,{read:!0,readAt:Qx()}),!0}catch(Ly){throw Ly}})},markAllNotificationsAsRead(e){return p(this,null,function*(){try{const t=wx(Og(kb,"notifications"),kx("createdAt","desc")),n=yield $x(t),s=Xx(kb);return n.docs.filter(t=>{const n=t.data();return n.recipientId===e&&!n.read}).forEach(e=>{s.update(e.ref,{read:!0,readAt:Qx()})}),yield s.commit(),!0}catch(Ly){return"failed-precondition"===Ly.code||"unimplemented"===Ly.code}})},deleteNotification(e){return p(this,null,function*(){try{const t=Mg(kb,"notifications",e);return yield qx(t),!0}catch(Ly){throw Ly}})},clearAllNotifications(e){return p(this,null,function*(){try{const t=wx(Og(kb,"notifications"),kx("createdAt","desc")),n=yield $x(t),s=Xx(kb);return n.docs.filter(t=>t.data().recipientId===e).forEach(e=>{s.delete(e.ref)}),yield s.commit(),!0}catch(Ly){return"failed-precondition"===Ly.code||"unimplemented"===Ly.code}})},createLikeNotification(e,t,n,s){return p(this,null,function*(){if(t!==n)try{yield this.createNotification({type:"like",title:"Curtida no seu post",message:`${s} curtiu seu post`,recipientId:t,senderId:n,senderName:s,postId:e,actionUrl:`/post/${e}`})}catch(Ly){}})},createCommentNotification(e,t,n,s,r){return p(this,null,function*(){if(t!==n)try{yield this.createNotification({type:"comment",title:"Novo comentário",message:`${s} comentou: "${r.substring(0,50)}${r.length>50?"...":""}"`,recipientId:t,senderId:n,senderName:s,postId:e,commentContent:r,actionUrl:`/post/${e}`})}catch(Ly){}})},createFollowNotification(e,t,n){return p(this,null,function*(){try{yield this.createNotification({type:"follow",title:"Novo seguidor",message:`${t} começou a te seguir`,recipientId:n,senderId:e,senderName:t,actionUrl:`/user-profile/${e}`})}catch(Ly){}})}},Wb={addComment(e,t){return p(this,null,function*(){try{const n=Og(kb,"comments"),s=yield Gx(n,d(u({postId:e},t),{createdAt:Qx(),likes:[],isHidden:!1,isReported:!1,reportedBy:[],reportReasons:[]})),r=Mg(kb,"posts",e),i=yield Fx(r);if(i.exists()){const n=i.data();if(yield Bx(r,{commentCount:Jx(1)}),n.userId!==t.userId)try{yield Hb.createCommentNotification(e,n.userId,t.userId,"Usuário",t.content)}catch(Ly){}}return{success:!0,commentId:s.id}}catch(Ly){throw Ly}})},editComment(e,t){return p(this,null,function*(){try{const n=Mg(kb,"comments",e);return yield Bx(n,{content:t,updatedAt:Qx(),isEdited:!0}),!0}catch(Ly){throw Ly}})},deleteComment(e){return p(this,null,function*(){try{const t=Mg(kb,"comments",e),n=yield Fx(t);if(n.exists()){const e=n.data();yield qx(t);const s=Mg(kb,"posts",e.postId);return yield Bx(s,{commentCount:Jx(-1)}),!0}return!1}catch(Ly){throw Ly}})},toggleCommentVisibility(e){return p(this,null,function*(){try{const t=Mg(kb,"comments",e),n=yield Fx(t);if(n.exists()){const e=n.data().isHidden||!1;return yield Bx(t,{isHidden:!e,updatedAt:Qx()}),!0}return!1}catch(Ly){throw Ly}})},reportComment(e,t){return p(this,null,function*(){var n;try{const s=Mg(kb,"comments",e),r=yield Fx(s);if(r.exists()){const e=r.data(),i=e.reportedBy||[],a=e.reportReasons||[];return yield Bx(s,{isReported:!0,reportedBy:[...i,null==(n=auth.currentUser)?void 0:n.uid],reportReasons:[...a,t],updatedAt:Qx()}),!0}return!1}catch(Ly){throw Ly}})},toggleCommentLike(e,t){return p(this,null,function*(){try{const n=Mg(kb,"comments",e),s=yield Fx(n);if(s.exists()){const e=s.data().likes||[];return e.includes(t)?yield Bx(n,{likes:e.filter(e=>e!==t),updatedAt:Qx()}):yield Bx(n,{likes:[...e,t],updatedAt:Qx()}),!0}return!1}catch(Ly){throw Ly}})},getPostComments(e,t=50){return p(this,null,function*(){try{const n=wx(Og(kb,"comments"),kx("createdAt","asc"),Sx(t)),s=yield $x(n);return s.docs.map(e=>u({id:e.id},e.data())).filter(t=>t.postId===e)}catch(Ly){return"failed-precondition"===Ly.code||Ly.code,zb.filter(t=>t.postId===e).slice(0,t)}})}},Kb={convertTimestamp:e=>e&&e.toDate?e.toDate():e,formatDate(e,t={}){return(e instanceof Date?e:this.convertTimestamp(e)).toLocaleDateString("pt-BR",u(u({},{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),t))},getRelativeTime(e){const t=new Date,n=e instanceof Date?e:this.convertTimestamp(e),s=t-n,r=Math.floor(s/6e4),i=Math.floor(s/36e5),a=Math.floor(s/864e5);return r<1?"Agora mesmo":r<60?`${r}m atrás`:i<24?`${i}h atrás`:a<7?`${a}d atrás`:this.formatDate(n,{year:"numeric",month:"short",day:"numeric"})}},Qb=()=>{const[t,n]=f.useState({username:"",birthDate:"",phone:"",bio:"",profilePhotoURL:"",bannerPhotoURL:""}),[s,r]=f.useState(!1),[i,a]=f.useState(null),[o,l]=f.useState(null),[c,h]=f.useState(null),[m,g]=f.useState(null),x=xt(),b=f.useRef(),v=f.useRef();f.useEffect(()=>{const t=Cb.onAuthStateChanged(t=>p(e,null,function*(){if(t){a(t);const e=Mg(kb,"users",t.uid),n=yield Fx(e);if(n.exists()){const e=n.data();if(l(e),e.username&&e.phone&&e.birthDate)return void x("/home")}}else x("/login")}));return()=>t()},[x]);const y=e=>{const{name:s,value:r}=e.target;n(d(u({},t),{[s]:r}))},w=(e,t)=>{const s=e.target.files[0];if(s){if(!s.type.startsWith("image/"))return void alert("Por favor, selecione apenas arquivos de imagem.");if(s.size>2097152)return void alert("A imagem deve ter no máximo 2MB para upload direto.");const e=new FileReader;e.onload=e=>{const s=e.target.result;"profile"===t?(n(e=>d(u({},e),{profilePhotoURL:s})),h(s)):(n(e=>d(u({},e),{bannerPhotoURL:s})),g(s))},e.readAsDataURL(s)}},N=e=>{"profile"===e?(n(e=>d(u({},e),{profilePhotoURL:""})),h(null)):(n(e=>d(u({},e),{bannerPhotoURL:""})),g(null))};return i?Ae.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden text-white",children:[Ae.jsx(Ub,{}),Ae.jsxs("div",{className:"relative w-full max-w-2xl z-10",children:[Ae.jsx("button",{type:"button",onClick:()=>{Cb.signOut(),x("/login")},className:"absolute -top-2 -left-2 p-2 text-white/80 hover:text-white transition-colors","aria-label":"Sair e voltar para login",children:Ae.jsx(k,{className:"w-6 h-6"})}),Ae.jsxs("div",{className:"text-center mb-6",children:[Ae.jsx("div",{className:"flex items-center justify-center mb-3",children:Ae.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/10 border border-white/20 flex items-center justify-center backdrop-blur-md",children:Ae.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-full h-full object-contain p-1",loading:"eager"})})}),Ae.jsx("h1",{className:"text-2xl font-semibold text-white mb-1",children:"Sereno"}),Ae.jsx("p",{className:"text-white/60 text-sm",children:"Complete seu perfil"})]}),Ae.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 shadow-2xl",children:[Ae.jsxs("div",{className:"mb-6",children:[Ae.jsxs("h2",{className:"text-xl font-light text-white mb-2",children:["Bem-vindo, ",i.displayName||i.email,"!"]}),Ae.jsx("p",{className:"text-white/60 text-sm",children:"Para continuar, precisamos de algumas informações adicionais"})]}),Ae.jsxs("form",{onSubmit:n=>p(e,null,function*(){if(n.preventDefault(),t.username&&t.birthDate&&t.phone)if(/^[a-zA-Z0-9_]{3,20}$/.test(t.username)){r(!0);try{const e=Mg(kb,"users",i.uid),n={username:t.username.toLowerCase(),birthDate:t.birthDate,phone:t.phone,bio:t.bio||"",profilePhotoURL:t.profilePhotoURL||(null==o?void 0:o.profilePhotoURL)||null,bannerPhotoURL:t.bannerPhotoURL||(null==o?void 0:o.bannerPhotoURL)||null,updatedAt:Qx(),createdAt:(null==o?void 0:o.createdAt)||Qx(),email:i.email,displayName:i.displayName||i.email,role:"cliente",isProfileComplete:!0};yield zx(e,n,{merge:!0});try{yield Hb.createNotification({type:"welcome",title:"Bem-vindo ao Sereno! 🎉",message:"Seu perfil foi criado com sucesso. Comece a explorar a plataforma e conectar-se com outros usuários.",recipientId:i.uid,senderId:"system",senderName:"Sereno",actionUrl:"/home"})}catch(Ly){}x("/connected")}catch(Ly){alert(`Erro ao salvar os dados: ${Ly.message}`)}finally{r(!1)}}else alert("O username deve ter entre 3 e 20 caracteres e conter apenas letras, números e underscore (_).");else alert("Por favor, preencha todos os campos obrigatórios.")}),className:"space-y-6",children:[Ae.jsxs("div",{className:"space-y-4",children:[Ae.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Fotos do Perfil (Opcional)"}),Ae.jsxs("div",{className:"space-y-2",children:[Ae.jsx("label",{className:"block text-sm font-light text-white/80",children:"Foto do Banner"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx("div",{className:"w-full h-32 bg-white/10 border-2 border-dashed border-white/20 rounded-lg flex items-center justify-center overflow-hidden",children:m?Ae.jsx("img",{src:m,alt:"Preview do banner",className:"w-full h-full object-cover"}):Ae.jsxs("div",{className:"text-center",children:[Ae.jsx(U,{className:"w-8 h-8 text-white/40 mx-auto mb-2"}),Ae.jsx("p",{className:"text-white/60 text-sm",children:"Clique para selecionar uma imagem"})]})}),Ae.jsx("button",{type:"button",onClick:()=>{var e;return null==(e=v.current)?void 0:e.click()},className:"absolute inset-0 w-full h-full bg-black/50 opacity-0 hover:opacity-100 transition-opacity flex items-center justify-center",children:Ae.jsx(F,{className:"w-6 h-6 text-white"})}),m&&Ae.jsx("button",{type:"button",onClick:()=>N("banner"),className:"absolute top-2 right-2 p-1 bg-red-500 hover:bg-red-600 rounded-full text-white transition-colors",children:Ae.jsx(V,{className:"w-4 h-4"})}),Ae.jsx("input",{ref:v,type:"file",accept:"image/*",onChange:e=>w(e,"banner"),className:"hidden"})]}),Ae.jsx("p",{className:"text-xs text-white/50",children:"Tamanho máximo: 2MB. Formatos: JPG, PNG, GIF"})]}),Ae.jsxs("div",{className:"space-y-2",children:[Ae.jsx("label",{className:"block text-sm font-light text-white/80",children:"Foto de Perfil"}),Ae.jsxs("div",{className:"flex items-center space-x-4",children:[Ae.jsxs("div",{className:"relative",children:[Ae.jsx("div",{className:"w-24 h-24 bg-white/10 border-2 border-dashed border-white/20 rounded-full flex items-center justify-center overflow-hidden",children:c?Ae.jsx("img",{src:c,alt:"Preview da foto de perfil",className:"w-full h-full object-cover"}):Ae.jsx(S,{className:"w-12 h-12 text-white/40"})}),Ae.jsx("button",{type:"button",onClick:()=>{var e;return null==(e=b.current)?void 0:e.click()},className:"absolute inset-0 w-full h-full bg-black/50 opacity-0 hover:opacity-100 transition-opacity flex items-center justify-center rounded-full",children:Ae.jsx($,{className:"w-6 h-6 text-white"})}),c&&Ae.jsx("button",{type:"button",onClick:()=>N("profile"),className:"absolute -top-1 -right-1 p-1 bg-red-500 hover:bg-red-600 rounded-full text-white transition-colors",children:Ae.jsx(V,{className:"w-3 h-3"})}),Ae.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:e=>w(e,"profile"),className:"hidden"})]}),Ae.jsx("div",{className:"flex-1",children:Ae.jsx("p",{className:"text-white/60 text-sm",children:"Selecione uma foto para seu perfil"})})]}),Ae.jsx("p",{className:"text-xs text-white/50",children:"Tamanho máximo: 2MB. Formatos: JPG, PNG, GIF"})]})]}),Ae.jsxs("div",{className:"space-y-4",children:[Ae.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Informações Básicas"}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"username",className:"block text-xs font-light text-white/80",children:"Username *"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"text",id:"username",name:"username",value:t.username,onChange:y,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"seu_username",required:!0,minLength:3,maxLength:20,pattern:"[a-zA-Z0-9_]{3,20}"})]}),Ae.jsx("p",{className:"text-xs text-white/50 mt-1",children:"3-20 caracteres, apenas letras, números e _"})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"birthDate",className:"block text-xs font-light text-white/80",children:"Data de Nascimento *"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"date",id:"birthDate",name:"birthDate",value:t.birthDate,onChange:y,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",required:!0})]})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"phone",className:"block text-xs font-light text-white/80",children:"Telefone *"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"tel",id:"phone",name:"phone",value:t.phone,onChange:y,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"(11) 99999-9999",required:!0})]})]}),Ae.jsxs("div",{className:"space-y-1",children:[Ae.jsx("label",{htmlFor:"bio",className:"block text-xs font-light text-white/80",children:"Biografia"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(z,{className:"absolute left-3 top-3 w-4 h-4 text-white/50"}),Ae.jsx("textarea",{id:"bio",name:"bio",value:t.bio,onChange:y,rows:3,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm resize-none",placeholder:"Conte um pouco sobre você...",maxLength:200})]}),Ae.jsxs("p",{className:"text-xs text-white/50 mt-1",children:[t.bio.length,"/200 caracteres"]})]})]}),Ae.jsx("button",{type:"submit",disabled:s,className:"w-full py-2.5 px-4 bg-white text-black hover:bg-white/90 disabled:bg-white/60 font-medium rounded-lg transition-all duration-200 transform hover:scale-[1.02] disabled:scale-100 disabled:cursor-not-allowed shadow-lg text-sm",children:s?"Salvando...":"Completar Perfil"})]}),Ae.jsx("div",{className:"mt-4 text-center",children:Ae.jsx("p",{className:"text-white/70 text-xs",children:"Estes dados são necessários para personalizar sua experiência"})})]}),Ae.jsx("div",{className:"mt-6 text-center text-white/50 text-xs",children:Ae.jsxs("p",{children:["Conecte-se, Entenda-se, ",Ae.jsx("span",{className:"text-white",children:"Evolua."})]})})]})]}):Ae.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Ae.jsx("div",{className:"text-white",children:"Carregando..."})})},Jb=()=>{const[t,n]=f.useState([]),[s,r]=f.useState(0),[i,a]=f.useState(!0),{user:o}=Tb(),l=()=>p(e,null,function*(){if(!(null==o?void 0:o.uid))return n([]),r(0),void a(!1);try{a(!0);const e=yield Hb.getUserNotifications(o.uid);n(e);const t=e.filter(e=>!e.read);r(t.length)}catch(Ly){n([]),r(0)}finally{a(!1)}});return f.useEffect(()=>{l()},[null==o?void 0:o.uid]),{notifications:t,unreadCount:s,loading:i,fetchNotifications:l,markAsRead:t=>p(e,null,function*(){try{yield Hb.markNotificationAsRead(t),n(e=>e.map(e=>e.id===t?d(u({},e),{read:!0}):e)),r(e=>Math.max(0,e-1))}catch(Ly){}}),markAllAsRead:()=>p(e,null,function*(){if(null==o?void 0:o.uid)try{yield Hb.markAllNotificationsAsRead(o.uid),n(e=>e.map(e=>d(u({},e),{read:!0}))),r(0)}catch(Ly){}}),deleteNotification:s=>p(e,null,function*(){try{yield Hb.deleteNotification(s),n(e=>e.filter(e=>e.id!==s));const e=t.find(e=>e.id===s);e&&!e.read&&r(e=>Math.max(0,e-1))}catch(Ly){}}),clearAllNotifications:()=>p(e,null,function*(){if(null==o?void 0:o.uid)try{yield Hb.clearAllNotifications(o.uid),n([]),r(0)}catch(Ly){}})}};function Xb(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Xb(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}const Yb=(e,t)=>{var n;if(0===e.length)return t.classGroupId;const s=e[0],r=t.nextPart.get(s),i=r?Yb(e.slice(1),r):void 0;if(i)return i;if(0===t.validators.length)return;const a=e.join("-");return null==(n=t.validators.find(({validator:e})=>e(a)))?void 0:n.classGroupId},Zb=/^\[(.+)\]$/,ev=e=>{if(Zb.test(e)){const t=Zb.exec(e)[1],n=null==t?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},tv=e=>{const{theme:t,prefix:n}=e,s={nextPart:new Map,validators:[]};return iv(Object.entries(e.classGroups),n).forEach(([e,n])=>{nv(n,s,e,t)}),s},nv=(e,t,n,s)=>{e.forEach(e=>{if("string"!=typeof e)return"function"==typeof e?rv(e)?void nv(e(s),t,n,s):void t.validators.push({validator:e,classGroupId:n}):void Object.entries(e).forEach(([e,r])=>{nv(r,sv(t,e),n,s)});(""===e?t:sv(t,e)).classGroupId=n})},sv=(e,t)=>{let n=e;return t.split("-").forEach(e=>{n.nextPart.has(e)||n.nextPart.set(e,{nextPart:new Map,validators:[]}),n=n.nextPart.get(e)}),n},rv=e=>e.isThemeGetter,iv=(e,t)=>t?e.map(([e,n])=>[e,n.map(e=>"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,n])=>[t+e,n])):e)]):e,av=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,s=new Map;const r=(r,i)=>{n.set(r,i),t++,t>e&&(t=0,s=n,n=new Map)};return{get(e){let t=n.get(e);return void 0!==t?t:void 0!==(t=s.get(e))?(r(e,t),t):void 0},set(e,t){n.has(e)?n.set(e,t):r(e,t)}}},ov=e=>{const{separator:t,experimentalParseClassName:n}=e,s=1===t.length,r=t[0],i=t.length,a=e=>{const n=[];let a,o=0,l=0;for(let d=0;d<e.length;d++){let c=e[d];if(0===o){if(c===r&&(s||e.slice(d,d+i)===t)){n.push(e.slice(l,d)),l=d+i;continue}if("/"===c){a=d;continue}}"["===c?o++:"]"===c&&o--}const c=0===n.length?e:e.substring(l),u=c.startsWith("!");return{modifiers:n,hasImportantModifier:u,baseClassName:u?c.substring(1):c,maybePostfixModifierPosition:a&&a>l?a-l:void 0}};return n?e=>n({className:e,parseClassName:a}):a},lv=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(e=>{"["===e[0]?(t.push(...n.sort(),e),n=[]):n.push(e)}),t.push(...n.sort()),t},cv=e=>u({cache:av(e.cacheSize),parseClassName:ov(e)},(e=>{const t=tv(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:e=>{const n=e.split("-");return""===n[0]&&1!==n.length&&n.shift(),Yb(n,t)||ev(e)},getConflictingClassGroupIds:(e,t)=>{const r=n[e]||[];return t&&s[e]?[...r,...s[e]]:r}}})(e)),uv=/\s+/;function dv(){let e,t,n=0,s="";for(;n<arguments.length;)(e=arguments[n++])&&(t=hv(e))&&(s&&(s+=" "),s+=t);return s}const hv=e=>{if("string"==typeof e)return e;let t,n="";for(let s=0;s<e.length;s++)e[s]&&(t=hv(e[s]))&&(n&&(n+=" "),n+=t);return n};function mv(e,...t){let n,s,r,i=function(o){const l=t.reduce((e,t)=>t(e),e());return n=cv(l),s=n.cache.get,r=n.cache.set,i=a,a(o)};function a(e){const t=s(e);if(t)return t;const i=((e,t)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:r}=t,i=[],a=e.trim().split(uv);let o="";for(let l=a.length-1;l>=0;l-=1){const e=a[l],{modifiers:t,hasImportantModifier:c,baseClassName:u,maybePostfixModifierPosition:d}=n(e);let h=Boolean(d),m=s(h?u.substring(0,d):u);if(!m){if(!h){o=e+(o.length>0?" "+o:o);continue}if(m=s(u),!m){o=e+(o.length>0?" "+o:o);continue}h=!1}const p=lv(t).join(":"),f=c?p+"!":p,g=f+m;if(i.includes(g))continue;i.push(g);const x=r(m,h);for(let n=0;n<x.length;++n){const e=x[n];i.push(f+e)}o=e+(o.length>0?" "+o:o)}return o})(e,n);return r(e,i),i}return function(){return i(dv.apply(null,arguments))}}const pv=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},fv=/^\[(?:([a-z-]+):)?(.+)\]$/i,gv=/^\d+\/\d+$/,xv=new Set(["px","full","screen"]),bv=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,vv=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,yv=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,wv=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Nv=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,jv=e=>_v(e)||xv.has(e)||gv.test(e),Cv=e=>Uv(e,"length",Fv),_v=e=>Boolean(e)&&!Number.isNaN(Number(e)),kv=e=>Uv(e,"number",_v),Ev=e=>Boolean(e)&&Number.isInteger(Number(e)),Sv=e=>e.endsWith("%")&&_v(e.slice(0,-1)),Iv=e=>fv.test(e),Tv=e=>bv.test(e),Av=new Set(["length","size","percentage"]),Rv=e=>Uv(e,Av,Vv),Dv=e=>Uv(e,"position",Vv),Pv=new Set(["image","url"]),Lv=e=>Uv(e,Pv,zv),Ov=e=>Uv(e,"",$v),Mv=()=>!0,Uv=(e,t,n)=>{const s=fv.exec(e);return!!s&&(s[1]?"string"==typeof t?s[1]===t:t.has(s[1]):n(s[2]))},Fv=e=>vv.test(e)&&!yv.test(e),Vv=()=>!1,$v=e=>wv.test(e),zv=e=>Nv.test(e),Bv=mv(()=>{const e=pv("colors"),t=pv("spacing"),n=pv("blur"),s=pv("brightness"),r=pv("borderColor"),i=pv("borderRadius"),a=pv("borderSpacing"),o=pv("borderWidth"),l=pv("contrast"),c=pv("grayscale"),u=pv("hueRotate"),d=pv("invert"),h=pv("gap"),m=pv("gradientColorStops"),p=pv("gradientColorStopPositions"),f=pv("inset"),g=pv("margin"),x=pv("opacity"),b=pv("padding"),v=pv("saturate"),y=pv("scale"),w=pv("sepia"),N=pv("skew"),j=pv("space"),C=pv("translate"),_=()=>["auto",Iv,t],k=()=>[Iv,t],E=()=>["",jv,Cv],S=()=>["auto",_v,Iv],I=()=>["","0",Iv],T=()=>[_v,Iv];return{cacheSize:500,separator:":",theme:{colors:[Mv],spacing:[jv,Cv],blur:["none","",Tv,Iv],brightness:T(),borderColor:[e],borderRadius:["none","","full",Tv,Iv],borderSpacing:k(),borderWidth:E(),contrast:T(),grayscale:I(),hueRotate:T(),invert:I(),gap:k(),gradientColorStops:[e],gradientColorStopPositions:[Sv,Cv],inset:_(),margin:_(),opacity:T(),padding:k(),saturate:T(),scale:T(),sepia:I(),skew:T(),space:k(),translate:k()},classGroups:{aspect:[{aspect:["auto","square","video",Iv]}],container:["container"],columns:[{columns:[Tv]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",Iv]}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[f]}],"inset-x":[{"inset-x":[f]}],"inset-y":[{"inset-y":[f]}],start:[{start:[f]}],end:[{end:[f]}],top:[{top:[f]}],right:[{right:[f]}],bottom:[{bottom:[f]}],left:[{left:[f]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ev,Iv]}],basis:[{basis:_()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Iv]}],grow:[{grow:I()}],shrink:[{shrink:I()}],order:[{order:["first","last","none",Ev,Iv]}],"grid-cols":[{"grid-cols":[Mv]}],"col-start-end":[{col:["auto",{span:["full",Ev,Iv]},Iv]}],"col-start":[{"col-start":S()}],"col-end":[{"col-end":S()}],"grid-rows":[{"grid-rows":[Mv]}],"row-start-end":[{row:["auto",{span:[Ev,Iv]},Iv]}],"row-start":[{"row-start":S()}],"row-end":[{"row-end":S()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Iv]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Iv]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal","start","end","center","between","around","evenly","stretch"]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[j]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[j]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Iv,t]}],"min-w":[{"min-w":[Iv,t,"min","max","fit"]}],"max-w":[{"max-w":[Iv,t,"none","full","min","max","fit","prose",{screen:[Tv]},Tv]}],h:[{h:[Iv,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Iv,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Iv,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Iv,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Tv,Cv]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",kv]}],"font-family":[{font:[Mv]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Iv]}],"line-clamp":[{"line-clamp":["none",_v,kv]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",jv,Iv]}],"list-image":[{"list-image":["none",Iv]}],"list-style-type":[{list:["none","disc","decimal",Iv]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","none","wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",jv,Cv]}],"underline-offset":[{"underline-offset":["auto",jv,Iv]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Iv]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Iv]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",Dv]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Rv]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Lv]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:["solid","dashed","dotted","double","none","hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["","solid","dashed","dotted","double","none"]}],"outline-offset":[{"outline-offset":[jv,Iv]}],"outline-w":[{outline:[jv,Cv]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:E()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[jv,Cv]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Tv,Ov]}],"shadow-color":[{shadow:[Mv]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Tv,Iv]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[v]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Iv]}],duration:[{duration:T()}],ease:[{ease:["linear","in","out","in-out",Iv]}],delay:[{delay:T()}],animate:[{animate:["none","spin","ping","pulse","bounce",Iv]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[y]}],"scale-x":[{"scale-x":[y]}],"scale-y":[{"scale-y":[y]}],rotate:[{rotate:[Ev,Iv]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Iv]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Iv]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Iv]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[jv,Cv,kv]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}});function qv(...e){return Bv(function(){for(var e,t,n=0,s="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Xb(e))&&(s&&(s+=" "),s+=t);return s}(e))}const Gv=f.forwardRef((e,t)=>{var n=e,{className:s,type:r="text",variant:i="default",size:a="default",error:o,label:l,helperText:c,leftIcon:d,rightIcon:m,onLeftIconClick:p,onRightIconClick:f}=n,g=h(n,["className","type","variant","size","error","label","helperText","leftIcon","rightIcon","onLeftIconClick","onRightIconClick"]);const x=qv("w-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-black",{default:"bg-black/50 border border-white/20 text-white placeholder-white/50 focus:border-white/50 focus:ring-white/50",glass:"bg-white/10 backdrop-blur-md border border-white/20 text-white placeholder-white/50 focus:border-white/50 focus:ring-white/50",filled:"bg-white/5 border border-white/10 text-white placeholder-white/50 focus:border-white/50 focus:ring-white/50",outline:"bg-transparent border-2 border-white/20 text-white placeholder-white/50 focus:border-white/50 focus:ring-white/50"}[i],{sm:"px-3 py-2 text-sm rounded-lg",default:"px-4 py-3 text-base rounded-xl",lg:"px-6 py-4 text-lg rounded-2xl"}[a],o?"border-red-500 focus:border-red-500 focus:ring-red-500":"",s),b=d&&p,v=m&&f;return Ae.jsxs("div",{className:"w-full",children:[l&&Ae.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:l}),Ae.jsxs("div",{className:"relative",children:[b&&Ae.jsx("button",{type:"button",onClick:p,className:"absolute left-3 top-1/2 transform -translate-y-1/2 p-1 text-white/50 hover:text-white/70 transition-colors focus:outline-none focus:ring-2 focus:ring-white/50 focus:ring-offset-2 focus:ring-offset-black rounded","aria-label":"Ação do ícone esquerdo",children:Ae.jsx(d,{className:"w-4 h-4"})}),Ae.jsx("input",u({type:r,className:qv(x,b&&"pl-10",v&&"pr-10"),ref:t},g)),v&&Ae.jsx("button",{type:"button",onClick:f,className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-1 text-white/50 hover:text-white/70 transition-colors focus:outline-none focus:ring-2 focus:ring-white/50 focus:ring-offset-2 focus:ring-offset-black rounded","aria-label":"Ação do ícone direito",children:Ae.jsx(m,{className:"w-4 h-4"})})]}),o&&Ae.jsx("p",{className:"mt-1 text-sm text-red-400",children:o}),c&&!o&&Ae.jsx("p",{className:"mt-1 text-sm text-white/50",children:c})]})});Gv.displayName="Input";const Hv=x.memo(({activeTab:t,setActiveTab:n,onStartTour:s})=>{const[r,i]=f.useState(!1),[a,o]=f.useState(!1),[l,c]=f.useState(""),{user:u,loading:d}=Tb(),{unreadCount:h}=Jb(),m=xt(),g=f.useRef(null),x=f.useRef(null),v=f.useRef(null),w=f.useCallback(()=>{i(e=>!e),o(!1)},[]),N=f.useCallback(()=>{o(e=>!e),i(!1)},[]),j=f.useCallback(()=>{i(!1),o(!1)},[]),_=f.useMemo(()=>[{name:"Início",tab:"home",icon:W},{name:"Chat",tab:"chat",icon:b},{name:"Diário",tab:"diary",icon:K},{name:"Humor",tab:"humor",icon:Q}],[null==u?void 0:u.role]),k=f.useCallback(e=>{m("home"===e?"/home":`/home/${e}`),j()},[m,j]),E=f.useCallback(()=>p(e,null,function*(){try{const{auth:t}=yield Lb(()=>p(e,null,function*(){const{auth:e}=yield Promise.resolve().then(()=>Eb);return{auth:e}}),void 0);yield t.signOut(),m("/login"),o(!1)}catch(Ly){alert("Erro ao sair. Tente novamente.")}}),[m]),I=f.useCallback(e=>{e.preventDefault(),l.trim()},[l]),T=f.useCallback(e=>{c(e.target.value)},[]);return f.useEffect(()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&x.current&&!x.current.contains(e.target)&&j()};return(r||a)&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[r,a,j]),f.useEffect(()=>{const e=e=>{"Escape"===e.key&&j()};return(r||a)&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[r,a,j]),f.useEffect(()=>(document.body.style.overflow=r?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[r]),d?Ae.jsx("header",{className:"glass-header sticky top-0 z-50",children:Ae.jsx("div",{className:"container-responsive",children:Ae.jsxs("div",{className:"flex items-center justify-between h-16",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("span",{className:"text-white/70",children:"Carregando..."})]})})}):Ae.jsx("header",{className:"glass-header sticky top-0 z-30 animation-initial animate-slide-in-top",children:Ae.jsxs("div",{className:"container-responsive",children:[Ae.jsxs("div",{className:"flex items-center justify-between h-16",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("button",{className:"show-mobile btn-icon group",onClick:w,"aria-label":"Abrir menu de navegação","aria-expanded":r,"aria-controls":"mobile-menu",children:r?Ae.jsx(V,{className:"w-5 h-5"}):Ae.jsx(B,{className:"w-5 h-5"})}),Ae.jsxs("button",{onClick:()=>m("/home"),className:"logo-button group","aria-label":"Ir para página inicial",children:[Ae.jsx("div",{className:"logo-container",children:Ae.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"logo-image group-hover:scale-105",loading:"eager",width:"48",height:"48"})}),Ae.jsx("span",{className:"logo-text group-hover:text-white/90 mr-10",children:"Sereno"})]}),Ae.jsx("div",{className:"search-container ml-8",children:Ae.jsx("form",{onSubmit:I,className:"relative",children:Ae.jsx(Gv,{ref:v,type:"text",placeholder:"Pesquisar posts, grupos, pessoas...",value:l,onChange:T,variant:"glass",size:"sm",radius:"xl",className:"w-80",leftIcon:q,onLeftIconClick:()=>I({preventDefault:()=>{}}),"aria-label":"Pesquisar na plataforma"})})})]}),Ae.jsxs("div",{className:"flex items-center space-x-4",children:[Ae.jsxs("div",{className:"show-desktop flex items-center space-x-5",children:[_.map(e=>Ae.jsx("button",{onClick:()=>k(e.tab),className:"btn-icon group "+(t===e.tab?"btn-icon-active":""),"aria-label":`Navegar para ${e.name}`,"aria-current":t===e.tab?"page":void 0,children:Ae.jsx(e.icon,{className:"w-5 h-5","aria-hidden":"true"})},e.name)),Ae.jsxs("button",{onClick:()=>k("notifications"),className:"btn-icon group "+("notifications"===t?"btn-icon-active":""),"aria-label":"Ver notificações","aria-current":"notifications"===t?"page":void 0,children:[Ae.jsx(G,{className:"w-5 h-5","aria-hidden":"true"}),h>0&&Ae.jsx("span",{className:"badge","aria-label":`${h} notificação${h>1?"s":""} não lida${h>1?"s":""}`,children:h})]}),Ae.jsx("button",{onClick:()=>k("settings"),className:"btn-icon group "+("settings"===t?"btn-icon-active":""),"aria-label":"Configurações","aria-current":"settings"===t?"page":void 0,children:Ae.jsx(C,{className:"w-5 h-5","aria-hidden":"true"})}),Ae.jsx("button",{onClick:s,className:"btn-icon group",title:"Iniciar tour do aplicativo","aria-label":"Iniciar tour do aplicativo",children:Ae.jsx(H,{className:"w-5 h-5","aria-hidden":"true"})})]}),u?Ae.jsxs("div",{className:"relative",ref:x,children:[Ae.jsx("div",{className:"flex items-center space-x-3",children:Ae.jsxs("button",{className:"flex items-center space-x-3 text-white/70 hover:text-white trans",onClick:N,"aria-label":"Menu do usuário","aria-expanded":a,"aria-haspopup":"true",children:[Ae.jsx(S,{className:"w-5 h-5","aria-hidden":"true"}),Ae.jsx("span",{className:"hide-mobile text-sm font-light",children:u.displayName||"Usuário"})]})}),a&&Ae.jsxs("div",{className:"dropdown-menu",role:"menu",children:[Ae.jsxs("button",{onClick:()=>{m("/home/profile"),o(!1)},className:"dropdown-item",role:"menuitem","aria-label":"Ver meu perfil",children:[Ae.jsx(S,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Meu Perfil"]}),Ae.jsxs("button",{onClick:()=>{m("/home/settings"),o(!1)},className:"dropdown-item",role:"menuitem","aria-label":"Configurações do perfil",children:[Ae.jsx(C,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Configurações do Perfil"]}),Ae.jsxs("button",{onClick:E,className:"dropdown-item",role:"menuitem","aria-label":"Sair da conta",children:[Ae.jsx(y,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Sair"]})]})]}):Ae.jsx("button",{onClick:()=>m("/login"),className:"btn-primary","aria-label":"Fazer login",children:"Login"})]})]}),r&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"mobile-menu-overlay",onClick:j}),Ae.jsx("div",{id:"mobile-menu",ref:g,className:"mobile-menu-sidebar",role:"menu","aria-label":"Menu de navegação móvel",children:Ae.jsxs("div",{className:"flex flex-col space-y-4",children:[_.map(e=>Ae.jsxs("button",{onClick:()=>k(e.tab),className:"mobile-menu-item "+(t===e.tab?"text-white":""),role:"menuitem","aria-label":`Navegar para ${e.name}`,"aria-current":t===e.tab?"page":void 0,children:[Ae.jsx(e.icon,{className:"w-6 h-6","aria-hidden":"true"}),Ae.jsx("span",{children:e.name})]},e.name)),Ae.jsxs("button",{onClick:()=>k("notifications"),className:"mobile-menu-item "+("notifications"===t?"text-white":""),role:"menuitem","aria-label":"Ver notificações","aria-current":"notifications"===t?"page":void 0,children:[Ae.jsx(G,{className:"w-6 h-6","aria-hidden":"true"}),Ae.jsx("span",{children:"Notificações"}),h>0&&Ae.jsx("span",{className:"badge-large",children:h})]}),Ae.jsxs("button",{onClick:()=>k("settings"),className:"mobile-menu-item "+("settings"===t?"text-white":""),role:"menuitem","aria-label":"Configurações","aria-current":"settings"===t?"page":void 0,children:[Ae.jsx(C,{className:"w-6 h-6","aria-hidden":"true"}),Ae.jsx("span",{children:"Configurações"})]}),u&&Ae.jsxs("button",{onClick:()=>k("profile"),className:"mobile-menu-item "+("profile"===t?"text-white":""),role:"menuitem","aria-label":"Meu perfil","aria-current":"profile"===t?"page":void 0,children:[Ae.jsx(S,{className:"w-6 h-6","aria-hidden":"true"}),Ae.jsx("span",{children:"Meu Perfil"})]}),Ae.jsxs("button",{onClick:s,className:"mobile-menu-item",role:"menuitem","aria-label":"Ajuda e tour do aplicativo",children:[Ae.jsx(H,{className:"w-6 h-6","aria-hidden":"true"}),Ae.jsx("span",{children:"Ajuda e Tour"})]}),u?Ae.jsxs("button",{onClick:E,className:"flex items-center mt-4 px-4 py-2 bg-white text-black rounded-md hover:bg-gray-100 trans",role:"menuitem","aria-label":"Sair da conta",children:[Ae.jsx(y,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),"Sair"]}):Ae.jsx("button",{onClick:()=>m("/login"),className:"mt-4 px-4 py-2 bg-white text-black rounded-md hover:bg-white/90 transition-all ",role:"menuitem","aria-label":"Fazer login",children:"Login"})]})})]})]})})});Hv.displayName="Header";const Wv=({trigger:e,duration:t=3e3})=>{const n=f.useRef(null),s=f.useRef([]),r=f.useRef(null);return f.useEffect(()=>{if(!e)return;const i=n.current,a=i.getContext("2d"),o=()=>{i.width=window.innerWidth,i.height=window.innerHeight};o(),window.addEventListener("resize",o);const l=["#667eea","#764ba2","#f093fb","#4facfe","#00f2fe","#43e97b","#38f9d7"];class c{constructor(){this.x=Math.random()*i.width,this.y=-10,this.w=10*Math.random()+5,this.h=5*Math.random()+2,this.rotation=360*Math.random(),this.rotationSpeed=10*Math.random()-5,this.speedX=6*Math.random()-3,this.speedY=3*Math.random()+2,this.gravity=.1,this.color=l[Math.floor(Math.random()*l.length)],this.opacity=1,this.fadeSpeed=.02*Math.random()+.01}update(){this.x+=this.speedX,this.y+=this.speedY,this.speedY+=this.gravity,this.rotation+=this.rotationSpeed,this.opacity-=this.fadeSpeed,(this.x>i.width||this.x<0)&&(this.speedX*=-.8),this.y>i.height&&(this.speedY*=-.6,this.y=i.height)}draw(){a.save(),a.translate(this.x,this.y),a.rotate(this.rotation*Math.PI/180),a.globalAlpha=this.opacity,a.fillStyle=this.color,a.fillRect(-this.w/2,-this.h/2,this.w,this.h),a.restore()}isDead(){return this.opacity<=0||this.y>i.height+50}}s.current=[];for(let e=0;e<150;e++)s.current.push(new c);const u=()=>{a.clearRect(0,0,i.width,i.height),s.current=s.current.filter(e=>(e.update(),e.draw(),!e.isDead())),s.current.length>0&&(r.current=requestAnimationFrame(u))};u();const d=setTimeout(()=>{r.current&&cancelAnimationFrame(r.current)},t);return()=>{window.removeEventListener("resize",o),r.current&&cancelAnimationFrame(r.current),clearTimeout(d)}},[e,t]),Ae.jsx("canvas",{ref:n,className:"fixed inset-0 pointer-events-none z-50",style:{background:"transparent"}})},Kv=({setActiveTab:e})=>{const t=xt(),[n,s]=f.useState(0),r=[{id:1,name:"Ansiedade",icon:"🧘",memberCount:1250,description:"Compartilhe experiências e dicas para lidar com ansiedade"},{id:2,name:"Apoio para Depressão",icon:"🌱",memberCount:980,description:"Um espaço seguro para falar sobre depressão"},{id:3,name:"Meditação Diária",icon:"🕯️",memberCount:750,description:"Pratique meditação em grupo"},{id:4,name:"Relacionamentos",icon:"💝",memberCount:650,description:"Discussões sobre relacionamentos saudáveis"},{id:5,name:"Autoestima",icon:"⭐",memberCount:820,description:"Construindo confiança e amor próprio"}],[i,a]=x.useState([]),[o,l]=x.useState(!1),c=e=>{a(t=>[...t,e]),s(e=>e+1)},u=e=>{a(t=>t.filter(t=>t!==e))},d=(h=5,[...r].sort((e,t)=>t.memberCount-e.memberCount).slice(0,h));var h;return o?Ae.jsx("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6",children:Ae.jsxs("div",{className:"flex items-center justify-center py-8",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("span",{className:"ml-3 text-white/70",children:"Carregando..."})]})}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(Wv,{trigger:n}),Ae.jsxs("div",{className:"space-y-6 animation-initial animate-fade-in-left animation-delay-100",children:[Ae.jsxs("div",{className:"text-center section-header",children:[Ae.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Comunidades Sugeridas"}),Ae.jsx("p",{className:"text-white/70 text-sm",children:"Descubra grupos que podem te interessar"})]}),Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6 community-card",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Ae.jsx(J,{className:"w-5 h-5 text-white trending-icon"}),Ae.jsx("h3",{className:"text-lg font-medium text-white",children:"Em Alta"})]}),Ae.jsx("div",{className:"space-y-4",children:d.slice(0,3).map(e=>{const t=i.includes(e.id);return Ae.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/10",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("div",{className:"w-10 h-10 rounded-full bg-white flex items-center justify-center text-black font-bold text-lg community-icon",children:e.icon}),Ae.jsxs("div",{children:[Ae.jsx("h4",{className:"font-medium text-white text-sm",children:e.name}),Ae.jsxs("p",{className:"text-white/60 text-xs",children:[e.memberCount.toLocaleString()," membros"]})]})]}),Ae.jsx("button",{onClick:()=>t?u(e.id):c(e.id),className:"w-8 h-8 rounded-full flex items-center justify-center transition-all duration-200 cursor-pointer "+(t?"bg-white hover:bg-gray-100 check-button":"bg-white hover:bg-gray-100 plus-button"),title:t?"Sair da comunidade":"Entrar na comunidade",children:t?Ae.jsx(X,{className:"w-4 h-4 text-black"}):Ae.jsx(Y,{className:"w-4 h-4 text-black"})})]},e.id)})})]}),Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6 community-card",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Ae.jsx(E,{className:"w-5 h-5 text-white sparkles-icon"}),Ae.jsx("h3",{className:"text-lg font-medium text-white",children:"Novidades"})]}),Ae.jsx("div",{className:"space-y-4",children:r.filter(e=>!i.includes(e.id)).slice(0,2).map(e=>Ae.jsxs("div",{className:"p-3 bg-white/5 rounded-lg border border-white/10",children:[Ae.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[Ae.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center text-black font-bold text-sm community-icon",children:e.icon}),Ae.jsx("h4",{className:"font-medium text-white text-sm",children:e.name})]}),Ae.jsx("p",{className:"text-white/60 text-xs mb-3 line-clamp-2",children:e.description}),Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsxs("span",{className:"text-white/50 text-xs",children:[e.memberCount," membros"]}),Ae.jsx("button",{onClick:()=>c(e.id),className:"w-8 h-8 rounded-full bg-white hover:bg-white/90 flex items-center justify-center transition-all duration-200 cursor-pointer plus-button",title:"Entrar na comunidade",children:Ae.jsx(Y,{className:"w-4 h-4 text-black"})})]})]},e.id))})]}),i.length>0&&Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6 community-card",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Ae.jsx(j,{className:"w-5 h-5 text-white users-icon"}),Ae.jsx("h3",{className:"text-lg font-medium text-white",children:"Suas Comunidades"})]}),Ae.jsx("div",{className:"space-y-3",children:i.slice(0,3).map(e=>{const t=r.find(t=>t.id===e);return t?Ae.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white/5 rounded-lg",children:[Ae.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center text-black font-bold text-sm community-icon",children:t.icon}),Ae.jsxs("div",{className:"flex-1",children:[Ae.jsx("h4",{className:"font-medium text-white text-sm",children:t.name}),Ae.jsxs("p",{className:"text-white/60 text-xs",children:[t.memberCount," membros"]})]}),Ae.jsx("button",{onClick:()=>u(t.id),className:"w-8 h-8 rounded-full bg-white hover:bg-gray-100 flex items-center justify-center transition-all duration-200 cursor-pointer check-button",title:"Sair da comunidade",children:Ae.jsx(X,{className:"w-4 h-4 text-black"})})]},t.id):null})}),i.length>3&&Ae.jsx("div",{className:"text-center pt-3",children:Ae.jsxs("button",{className:"px-4 py-2 text-white hover:text-gray-300 transition-colors text-sm",children:["Ver Todas (",i.length,")"]})})]}),Ae.jsx("div",{className:"text-center",children:Ae.jsx("button",{onClick:()=>t("/home/groups"),className:"w-full px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white font-medium transition-all duration-200 explore-button",children:"Explorar Mais Comunidades"})})]})]})},Qv=({onOpenHumorTab:t})=>{const{user:n}=Tb(),[s,r]=f.useState([{day:"Seg",mood:0,energy:0},{day:"Ter",mood:0,energy:0},{day:"Qua",mood:0,energy:0},{day:"Qui",mood:0,energy:0},{day:"Sex",mood:0,energy:0},{day:"Sáb",mood:0,energy:0},{day:"Dom",mood:0,energy:0}]),[i,a]=f.useState(5),[o,l]=f.useState(5),[c,u]=f.useState(5),d=f.useRef(null),[h,m]=f.useState(!1);return f.useEffect(()=>{p(e,null,function*(){if(!n)return;const e=yield Gb.getUserMoodHistory(n.uid,7),t=[0,0,0,0,0,0,0].map((t,n)=>{const s=["Seg","Ter","Qua","Qui","Sex","Sáb","Dom"][n],r=e.filter(e=>{var t;const s=(null==(t=e.recordedAt)?void 0:t.toDate)?e.recordedAt.toDate():new Date(e.recordedAt);return s&&s.getDay()===(n+1)%7});return{day:s,mood:r.length?Math.round(r.reduce((e,t)=>e+(t.intensity||0),0)/r.length):0,energy:r.length?Math.round(r.reduce((e,t)=>e+(t.energy||0),0)/r.length):0}});r(t)})},[n]),Ae.jsxs("div",{className:"space-y-6 animation-initial animate-fade-in-right animation-delay-200",children:[Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Ae.jsx(L,{className:"w-5 h-5 text-gray-400"}),Ae.jsx("h2",{className:"text-lg font-semibold text-white",children:"Check-in Diário"})]}),Ae.jsxs("div",{className:"space-y-6",children:[Ae.jsxs("div",{className:"space-y-2",children:[Ae.jsxs("div",{className:"flex justify-between items-center",children:[Ae.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Intensidade"}),Ae.jsxs("span",{className:"text-sm text-gray-400",children:[i,"/10"]})]}),Ae.jsx("input",{type:"range",min:"0",max:"10",value:i,onChange:e=>a(parseInt(e.target.value)),className:"w-full"})]}),Ae.jsxs("div",{className:"space-y-2",children:[Ae.jsxs("div",{className:"flex justify-between items-center",children:[Ae.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Energia"}),Ae.jsxs("span",{className:"text-sm text-gray-400",children:[o,"/10"]})]}),Ae.jsx("input",{type:"range",min:"0",max:"10",value:o,onChange:e=>l(parseInt(e.target.value)),className:"w-full"})]}),Ae.jsxs("div",{className:"space-y-2",children:[Ae.jsxs("div",{className:"flex justify-between items-center",children:[Ae.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Estabilidade"}),Ae.jsxs("span",{className:"text-sm text-gray-400",children:[c,"/10"]})]}),Ae.jsx("input",{type:"range",min:"0",max:"10",value:c,onChange:e=>u(parseInt(e.target.value)),className:"w-full"})]}),Ae.jsx("button",{onClick:()=>p(e,null,function*(){if(n)try{const e={intensity:i,energy:o,stability:c,notes:"Check-in diário",tags:["daily","checkin"]};yield Gb.recordMood(n.uid,e),alert("Check-in salvo com sucesso!"),navigate("/home/humor");const t=yield Gb.getUserMoodHistory(n.uid,7),s=["Seg","Ter","Qua","Qui","Sex","Sáb","Dom"].map((e,n)=>{const s=t.filter(e=>{var t;const s=(null==(t=e.recordedAt)?void 0:t.toDate)?e.recordedAt.toDate():new Date(e.recordedAt);return s&&s.getDay()===(n+1)%7});return{day:e,mood:s.length?Math.round(s.reduce((e,t)=>e+(t.intensity||0),0)/s.length):0,energy:s.length?Math.round(s.reduce((e,t)=>e+(t.energy||0),0)/s.length):0}});r(s)}catch(Ly){alert("Erro ao salvar check-in. Tente novamente.")}else alert("Usuário não autenticado")}),className:"w-full bg-gradient-to-r from-white to-gray-200 text-black text-sm font-medium py-3 px-4 rounded-xl hover:from-gray-200 hover:to-gray-300 transform hover:scale-105 transition-all duration-200",children:"Salvar Check-in"})]})]}),Ae.jsxs("div",{ref:d,className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl transition "+(h?"ring-2 ring-white/50":""),children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-12",children:[Ae.jsx(J,{className:"w-5 h-5 text-gray-400"}),Ae.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tendência Semanal"})]}),Ae.jsxs("div",{className:"space-y-4",children:[Ae.jsx("div",{className:"flex items-end justify-between h-32 px-2",children:s.map((e,t)=>Ae.jsxs("div",{className:"flex flex-col items-center flex-1",children:[Ae.jsxs("div",{className:"relative w-full max-w-[20px] flex flex-col items-center space-y-1",children:[Ae.jsx("div",{className:"w-full bg-gradient-to-t from-gray-400/70 to-gray-300/70 rounded-sm transition-all duration-500 hover:from-gray-400 hover:to-gray-300",style:{height:e.energy/10*80+"px",minHeight:"8px"}}),Ae.jsx("div",{className:"w-full bg-gradient-to-t from-white/70 to-gray-200/70 rounded-sm transition-all duration-500 hover:from-white hover:to-gray-200",style:{height:e.mood/10*80+"px",minHeight:"8px"}})]}),Ae.jsx("span",{className:"text-xs text-gray-400 font-medium",children:e.day})]},t))}),Ae.jsxs("div",{className:"flex items-center justify-center space-x-4 pt-4 border-t border-gray-700/30",children:[Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-white to-gray-200 rounded-sm"}),Ae.jsx("span",{className:"text-xs text-gray-400",children:"Humor"})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-gray-400 to-gray-500 rounded-sm"}),Ae.jsx("span",{className:"text-xs text-gray-400",children:"Energia"})]})]})]})]})]})},Jv=()=>{const e=f.useRef(null);return f.useEffect(()=>{const t=e.current,n=t.getContext("2d");let s;const r=()=>{t.width=window.innerWidth,t.height=window.innerHeight};r(),window.addEventListener("resize",r);const i=[];class a{constructor(e,t,n,s,r){this.y=e,this.amplitude=t,this.frequency=n,this.speed=s,this.color=r,this.offset=0,this.opacity=.1}update(){this.offset+=this.speed}draw(){n.beginPath(),n.moveTo(0,this.y);for(let s=0;s<=t.width;s+=2){const e=this.y+Math.sin((s+this.offset)*this.frequency)*this.amplitude;n.lineTo(s,e)}n.lineTo(t.width,t.height),n.lineTo(0,t.height),n.closePath();const e=n.createLinearGradient(0,this.y-this.amplitude,0,this.y+this.amplitude);e.addColorStop(0,`${this.color}00`),e.addColorStop(.5,`${this.color}${Math.floor(255*this.opacity).toString(16).padStart(2,"0")}`),e.addColorStop(1,`${this.color}00`),n.fillStyle=e,n.fill()}}i.push(new a(.3*t.height,30,.02,.5,"#ffffff")),i.push(new a(.6*t.height,40,.015,.3,"#ffffff")),i.push(new a(.8*t.height,25,.025,.7,"#ffffff"));const o=()=>{n.clearRect(0,0,t.width,t.height),i.forEach(e=>{e.update(),e.draw()}),s=requestAnimationFrame(o)};return o(),()=>{window.removeEventListener("resize",r),cancelAnimationFrame(s)}},[]),Ae.jsx("canvas",{ref:e,className:"fixed inset-0 pointer-events-none z-0 animation-initial animate-fade-in-scale animation-delay-600",style:{background:"transparent"}})},Xv=({message:e,type:t="info",duration:n=5e3,onClose:s,isVisible:r=!0})=>{const[i,a]=f.useState(!1);f.useEffect(()=>{if(r){a(!0);const e=setTimeout(()=>{o()},n);return()=>clearTimeout(e)}},[r,n]);const o=()=>{a(!1),setTimeout(()=>{null==s||s()},300)};return r?Ae.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full transform transition-all duration-300 ease-out "+(i?"translate-x-0 opacity-100 scale-100":"translate-x-full opacity-0 scale-95"),children:Ae.jsx("div",{className:`${(()=>{switch(t){case"success":return"bg-green-500/20 border-green-500/30";case"error":return"bg-red-500/20 border-red-500/30";case"warning":return"bg-yellow-500/20 border-yellow-500/30";default:return"bg-blue-500/20 border-blue-500/30"}})()} backdrop-blur-xl border rounded-xl p-4 shadow-2xl`,children:Ae.jsxs("div",{className:"flex items-start space-x-3",children:[Ae.jsx("div",{className:"flex-shrink-0",children:(()=>{switch(t){case"success":return Ae.jsx(M,{className:"w-5 h-5 text-green-400"});case"error":return Ae.jsx(ee,{className:"w-5 h-5 text-red-400"});case"warning":return Ae.jsx(ee,{className:"w-5 h-5 text-yellow-400"});default:return Ae.jsx(Z,{className:"w-5 h-5 text-blue-400"})}})()}),Ae.jsx("div",{className:"flex-1 min-w-0",children:Ae.jsx("p",{className:"text-white text-sm leading-relaxed",children:e})}),Ae.jsx("button",{onClick:o,className:"flex-shrink-0 p-1 text-white/60 hover:text-white transition-colors rounded-full hover:bg-white/10",children:Ae.jsx(V,{className:"w-4 h-4"})})]})})}):null},Yv=({isOpen:e,onClose:t,userRole:n="cliente",isFirstTime:s=!1})=>{const[r,i]=f.useState(0),[a,o]=f.useState(new Set),[l,c]=f.useState(!1),u=[{id:"welcome",title:"Bem-vindo ao Sereno! 🎉",description:"Vamos te ajudar a conhecer as principais funcionalidades do aplicativo para sua saúde mental.",icon:W,position:"center"},{id:"home",title:"Página Inicial",description:"Aqui você encontra posts da comunidade, grupos sugeridos e um resumo do seu humor diário.",icon:W,position:"center"},{id:"chat",title:"Chat e Suporte",description:"Conecte-se com psicólogos ou converse com outros usuários da comunidade para apoio emocional.",icon:b,position:"center"},{id:"diary",title:"Diário Interativo",description:"Registre seus pensamentos, sentimentos e reflexões diárias com prompts guiados.",icon:K,position:"center"},{id:"humor",title:"Rastreador de Humor",description:"Monitore seu humor diário, visualize tendências e receba insights sobre seu bem-estar emocional.",icon:Q,position:"center"},{id:"sessions",title:"psicologo"===n?"Gerenciar Sessões":"Agendar Sessões",description:"psicologo"===n?"Gerencie sua agenda, visualize sessões agendadas e configure sua disponibilidade.":"Encontre psicólogos disponíveis e agende sessões de terapia online ou presencial.",icon:L,position:"center"},{id:"notifications",title:"Notificações",description:"Mantenha-se atualizado com mensagens, lembretes de sessões e atividades da comunidade.",icon:G,position:"center"},{id:"settings",title:"Configurações",description:"Personalize seu perfil, gerencie notificações e configure suas preferências de privacidade.",icon:C,position:"center"},{id:"community",title:"Comunidade",description:"Participe de grupos de apoio, compartilhe experiências e conecte-se com pessoas que passam por situações similares.",icon:j,position:"center"}];f.useEffect(()=>{e&&(i(0),o(new Set),c(!1))},[e]);const d=()=>{c(!0),setTimeout(()=>{t()},600)};if(!e)return null;const h=u[r],m=h.icon,p=r===u.length-1,g=(r+1)/u.length*100;return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:`fixed inset-0 z-40 transition-all duration-800 ${s?"bg-black":"bg-black/80 backdrop-blur-sm"} ${l?"background-fade-out":"background-fade-in"}`}),Ae.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:Ae.jsxs("div",{className:"bg-black/95 border border-white/10 rounded-2xl p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto "+(l?"tour-modal-out":"tour-modal-in"),children:[Ae.jsxs("div",{className:"mb-6",children:[Ae.jsxs("div",{className:"flex items-center justify-between text-sm text-white/60 mb-2",children:[Ae.jsxs("span",{children:["Passo ",r+1," de ",u.length]}),Ae.jsxs("span",{children:[Math.round(g),"%"]})]}),Ae.jsx("div",{className:"w-full bg-white/10 rounded-full h-2",children:Ae.jsx("div",{className:"bg-white h-2 rounded-full transition-all duration-300",style:{width:`${g}%`}})})]}),Ae.jsxs("div",{className:"text-center mb-8",children:[Ae.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6",children:Ae.jsx(m,{className:"w-10 h-10 text-black"})}),Ae.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:h.title}),Ae.jsx("p",{className:"text-white/80 text-lg leading-relaxed",children:h.description})]}),Ae.jsx("div",{className:"flex justify-center space-x-2 mb-8",children:u.map((e,t)=>{return Ae.jsx("button",{onClick:()=>i(t),className:"w-3 h-3 rounded-full transition-all duration-300 "+(t===r?"bg-white scale-125":(n=e.id,a.has(n)?"bg-white":"bg-white/20 hover:bg-white/40"))},e.id);var n})}),Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsx("button",{onClick:()=>{d()},className:"text-white/60 hover:text-white transition-colors text-sm",children:"Pular tour"}),Ae.jsxs("div",{className:"flex space-x-3",children:[r>0&&Ae.jsxs("button",{onClick:()=>{r>0&&i(r-1)},className:"flex items-center space-x-2 px-4 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-all duration-300",children:[Ae.jsx(te,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Anterior"})]}),p?Ae.jsxs("button",{onClick:()=>{o(e=>new Set([...e,u[r].id])),d()},className:"flex items-center space-x-2 px-6 py-2 bg-white text-black rounded-lg hover:bg-gray-100 transition-all duration-300",children:[Ae.jsx(X,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Começar a usar"})]}):Ae.jsxs("button",{onClick:()=>{r<u.length-1&&(o(e=>new Set([...e,u[r].id])),i(r+1))},className:"flex items-center space-x-2 px-6 py-2 bg-white text-black rounded-lg hover:bg-gray-100 transition-all duration-300",children:[Ae.jsx("span",{children:"Próximo"}),Ae.jsx(ne,{className:"w-4 h-4"})]})]})]}),Ae.jsx("button",{onClick:d,className:"absolute top-4 right-4 text-white/60 hover:text-white transition-colors p-2",children:Ae.jsx(V,{className:"w-5 h-5"})})]})})]})};function Zv({children:e,showSidebars:t=!0}){const[n,s]=f.useState(!1),[r,i]=f.useState(!1),[a,o]=f.useState(!1),{user:l,isFirstTime:c,markTourAsSeen:u}=Tb(),d=xt(),h=pt(),m=(()=>{const e=h.pathname;return"/home"===e?"home":"/home/profile"===e?"profile":"/home/sessions"===e?"sessions":"/home/diary"===e?"diary":"/home/humor"===e?"humor":"/home/chat"===e||e.startsWith("/home/chat/")?"chat":"/home/groups"===e?"groups":"/home/notifications"===e?"notifications":"/home/settings"===e?"settings":"home"})();f.useEffect(()=>{c&&l&&s(!0)},[c,l]),f.useEffect(()=>{if(c&&l){const e=setTimeout(()=>{o(!0)},2e3);return()=>clearTimeout(e)}},[c,l]);const g=e=>{d("home"===e?"/home":`/home/${e}`)};return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(Jv,{}),Ae.jsxs("div",{className:"min-h-screen bg-black lg:pb-8 pb-20",children:[Ae.jsx(Hv,{activeTab:m,setActiveTab:g,onStartTour:()=>{s(!0)}}),Ae.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Ae.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:t?"home"===m?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("aside",{className:"lg:col-span-3",children:Ae.jsx("div",{className:"sticky top-24",children:Ae.jsx(Kv,{setActiveTab:g})})}),Ae.jsx("section",{className:"lg:col-span-6 space-y-8",children:e}),Ae.jsx("aside",{className:"lg:col-span-3",children:Ae.jsx("div",{className:"sticky top-24",children:Ae.jsx(Qv,{})})})]}):"profile"===m?Ae.jsx("section",{className:"lg:col-span-12",children:Ae.jsx("div",{className:"max-w-6xl mx-auto",children:e})}):Ae.jsx("section",{className:"lg:col-span-12",children:Ae.jsx("div",{className:"max-w-4xl mx-auto",children:e})}):null})}),Ae.jsx(Yv,{isOpen:n,onClose:()=>p(this,null,function*(){s(!1),c&&(i(!0),yield u())}),userRole:(null==l?void 0:l.role)||"cliente",isFirstTime:c}),Ae.jsx(Xv,{message:"Bem-vindo ao Sereno! 🎉 Estamos felizes em tê-lo conosco nesta jornada de autoconhecimento e bem-estar.",type:"success",duration:8e3,isVisible:a,onClose:()=>{o(!1)}})]})]})}const ey=e=>{const t=((e=1e3)=>{const[t,n]=f.useState(new Date);return f.useEffect(()=>{const t=setInterval(()=>{n(new Date)},e);return()=>clearInterval(t)},[e]),t})(6e4),n=f.useMemo(()=>{const n=t.getHours(),s=e||"Usuário";return n<12?{text:`Bom dia, ${s}!`,icon:se,period:"morning"}:n<18?{text:`Boa tarde, ${s}!`,icon:se,period:"afternoon"}:{text:`Boa noite, ${s}!`,icon:re,period:"evening"}},[t,e]);return d(u({},n),{currentTime:t,formattedDate:t.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})},ty=x.forwardRef((e,t)=>{var n=e,{className:s,variant:r="default",padding:i="md",hover:a=!1,children:o}=n,l=h(n,["className","variant","padding","hover","children"]);const c=a?"hover:bg-white/10 hover:border-white/20 hover:scale-[1.02]":"";return Ae.jsx("div",d(u({ref:t,className:qv("rounded-2xl transition-all duration-300",{default:"bg-white/5 border border-white/10",glass:"bg-white/10 backdrop-blur-md border border-white/20",elevated:"bg-white/5 border border-white/10 shadow-2xl",bordered:"bg-transparent border-2 border-white/20"}[r],{none:"",sm:"p-4",md:"p-6",lg:"p-8"}[i],c,s)},l),{children:o}))});ty.displayName="Card";const ny=x.forwardRef((e,t)=>{var n=e,{className:s}=n,r=h(n,["className"]);return Ae.jsx("div",u({ref:t,className:qv("flex flex-col space-y-1.5 pb-4",s)},r))}),sy=x.forwardRef((e,t)=>{var n=e,{className:s}=n,r=h(n,["className"]);return Ae.jsx("h3",u({ref:t,className:qv("text-lg font-semibold leading-none tracking-tight text-white",s)},r))}),ry=x.forwardRef((e,t)=>{var n=e,{className:s}=n,r=h(n,["className"]);return Ae.jsx("p",u({ref:t,className:qv("text-sm text-white/70",s)},r))}),iy=x.forwardRef((e,t)=>{var n=e,{className:s}=n,r=h(n,["className"]);return Ae.jsx("div",u({ref:t,className:qv("pt-0",s)},r))}),ay=x.forwardRef((e,t)=>{var n=e,{className:s}=n,r=h(n,["className"]);return Ae.jsx("div",u({ref:t,className:qv("flex items-center pt-4",s)},r))});ty.Header=ny,ty.Title=sy,ty.Description=ry,ty.Content=iy,ty.Footer=ay;const oy=x.memo(({showWelcomeMessage:t=!1})=>{f.useState(0);const[n,s]=f.useState(!0),{user:r}=Tb(),i=xt(),{text:a,icon:o,formattedDate:l}=ey((null==r?void 0:r.username)||(null==r?void 0:r.displayName));f.useEffect(()=>{if(t){s(!0);const e=setTimeout(()=>{s(!1)},1500);return()=>clearTimeout(e)}},[t]);const[c,u]=f.useState(!1);f.useEffect(()=>{if(t&&n){const e=setTimeout(()=>{u(!0)},1e3);return()=>clearTimeout(e)}u(!1)},[t,n]);const[d,h]=f.useState(null),[m,g]=f.useState(!1),x=f.useMemo(()=>[{frase:"A jornada de mil milhas começa com um único passo.",autor:"Lao Tzu"},{frase:"A felicidade não é algo pronto. Ela vem das suas próprias ações.",autor:"Dalai Lama"},{frase:"Cada dia é uma nova oportunidade para ser melhor.",autor:"Desconhecido"},{frase:"A mente é como um paraquedas. Só funciona quando está aberta.",autor:"Frank Zappa"},{frase:"O bem-estar começa com a aceitação de quem você é.",autor:"Desconhecido"}],[]),b=f.useCallback(()=>p(e,null,function*(){g(!0);try{yield new Promise(e=>setTimeout(e,500));const e=Math.floor(Math.random()*x.length);h(x[e])}catch(Oy){h(null)}finally{g(!1)}}),[x]);f.useEffect(()=>{b()},[b]);const v=f.useMemo(()=>[{name:"Dr. Alberto Mendes",specialty:"Especialista em Terapia Cognitivo-Comportamental",experience:"15 anos",initials:"DR."},{name:"Dra. Clara Ribeiro",specialty:"Especialista em Psicologia Analítica",experience:"10 anos",initials:"DRA."}],[]),y=f.useCallback(()=>{b()},[b]),w=f.useCallback(e=>{const t=encodeURIComponent(e).toLowerCase().replace(/%20/g,"-");i(`/user/${t}`)},[i]),N=f.useCallback(()=>{},[]);return Ae.jsxs(ty,{variant:"glass",padding:"lg",className:"mb-8 animation-initial animate-fade-in-up",children:[n&&Ae.jsx(ty.Header,{children:Ae.jsxs("div",{className:"text-center mb-6 animation-initial animate-fade-in-up animation-delay-100 "+(t&&c?"welcome-greeting-fade-out":""),children:[Ae.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[Ae.jsx(o,{className:"w-6 h-6 text-gray-400","aria-hidden":"true"}),Ae.jsx("h2",{className:"text-2xl font-bold text-white",children:a})]}),Ae.jsx("time",{className:"text-gray-400",dateTime:(new Date).toISOString(),children:l})]})}),Ae.jsxs(ty.Content,{children:[Ae.jsx(ty,{variant:"glass",padding:"lg",className:"mb-6 animation-initial animate-fade-in-up animation-delay-200",children:Ae.jsxs("div",{onKeyDown:N,tabIndex:0,role:"region","aria-label":"Mensagem motivacional","aria-live":"polite",children:[Ae.jsx("div",{className:"text-center min-h-[100px] flex flex-col justify-center",children:m?Ae.jsx("div",{className:"text-white/70",children:"Carregando frase..."}):d?Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("blockquote",{className:"text-white text-lg leading-relaxed mb-3",children:['"',d.frase,'"']}),Ae.jsxs("cite",{className:"text-gray-300 text-sm font-medium not-italic",children:["- ",d.autor]})]}):Ae.jsx("div",{className:"text-white/70",children:"Não foi possível carregar a frase agora."})}),Ae.jsx("div",{className:"flex items-center justify-center mt-6",children:Ae.jsx("button",{onClick:y,className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors focus-ring","aria-label":"Atualizar frase",children:"Nova frase"})}),Ae.jsxs("div",{className:"text-center mt-4",children:[Ae.jsx("p",{className:"text-sm text-gray-300",children:"Ajudando na construção da sua própria história!"}),Ae.jsx("div",{className:"flex justify-center space-x-1 mt-2",role:"img","aria-label":"Corações de apoio",children:[...Array(3)].map((e,t)=>Ae.jsx(ie,{className:"w-4 h-4 text-gray-400 fill-current","aria-hidden":"true"},t))})]})]})}),Ae.jsxs(ty,{variant:"glass",padding:"lg",children:[Ae.jsx(ty.Header,{children:Ae.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Psicólogos Recomendados"})}),Ae.jsx(ty.Content,{children:Ae.jsx("div",{className:"space-y-4",children:v.map(e=>Ae.jsxs("article",{className:"card-user",children:[Ae.jsx("div",{className:"avatar-large",children:Ae.jsx("span",{className:"text-xl font-bold text-white",children:e.initials})}),Ae.jsxs("div",{className:"flex-1",children:[Ae.jsx("h3",{className:"text-lg font-semibold text-white",children:e.name}),Ae.jsx("p",{className:"text-gray-300 text-sm",children:e.specialty}),Ae.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:["Experiência: ",e.experience]})]}),Ae.jsx("button",{onClick:()=>w(e.name),className:"btn-primary focus-ring","aria-label":`Ver perfil de ${e.name}`,children:"Ver Perfil"})]},e.name))})})]})]})]})});oy.displayName="WelcomeScreen";const ly=()=>{const[t,n]=f.useState([]),[s,r]=f.useState(!0),[i,a]=f.useState(null),[o,l]=f.useState(!0),{user:c}=Tb(),h=f.useCallback(()=>p(e,null,function*(){try{r(!0),a(null);const e=yield qb.getPosts(20),t=e.map(e=>d(u({},e),{createdAt:Kb.convertTimestamp(e.createdAt),updatedAt:e.updatedAt?Kb.convertTimestamp(e.updatedAt):void 0}));n(t),l(20===e.length)}catch(e){a(e instanceof Error?e.message:"Erro ao carregar posts")}finally{r(!1)}}),[]),m=f.useCallback(()=>p(e,null,function*(){if(!s&&o)try{r(!0);const e=yield qb.getPosts(20,t.length);if(0===e.length)return void l(!1);const s=e.map(e=>d(u({},e),{createdAt:Kb.convertTimestamp(e.createdAt),updatedAt:e.updatedAt?Kb.convertTimestamp(e.updatedAt):void 0}));n(e=>[...e,...s]),l(20===e.length)}catch(e){a(e instanceof Error?e.message:"Erro ao carregar mais posts")}finally{r(!1)}}),[s,o,t.length]),g=f.useCallback(t=>p(e,null,function*(){if(!c)throw new Error("Usuário não autenticado");try{const e=yield qb.createPost(t);if(e.success){const s=d(u({id:e.postId},t),{createdAt:new Date,likes:[],commentCount:0,shares:0,isEdited:!1});return n(e=>[s,...e]),!0}return!1}catch(e){throw e}}),[c]),x=f.useCallback(t=>p(e,null,function*(){if(!c)throw new Error("Usuário não autenticado");try{return!!(yield qb.deletePost(t))&&(n(e=>e.filter(e=>e.id!==t)),!0)}catch(e){throw e}}),[c]),b=f.useCallback(t=>p(e,null,function*(){if(!c)return!1;try{const e=yield qb.togglePostLike(t,c.uid);return e&&n(e=>e.map(e=>{if(e.id===t){const t=e.likes.includes(c.uid)?e.likes.filter(e=>e!==c.uid):[...e.likes,c.uid];return d(u({},e),{likes:t})}return e})),e}catch(e){return!1}}),[c]),v=f.useCallback(e=>{if(!c)return!1;const n=t.find(t=>t.id===e);return!!n&&n.likes.includes(c.uid)},[t,c]),y=f.useCallback((t,s)=>p(e,null,function*(){if(!c)throw new Error("Usuário não autenticado");try{const e={authorId:c.uid,authorName:c.displayName||c.email||"Usuário",authorAvatar:c.photoURL,content:s.trim()},r=yield Wb.addComment(t,e);return r.success?(n(e=>e.map(e=>e.id===t?d(u({},e),{commentCount:e.commentCount+1}):e)),r.commentId):null}catch(e){throw e}}),[c]),w=f.useCallback(t=>p(e,null,function*(){try{return(yield Wb.getPostComments(t)).map(e=>d(u({},e),{createdAt:Kb.convertTimestamp(e.createdAt)}))}catch(e){throw e}}),[]);return f.useEffect(()=>{h()},[h]),{posts:t,loading:s,error:i,hasMore:o,loadMorePosts:m,createPost:g,deletePost:x,togglePostLike:b,isPostLiked:v,addComment:y,getPostComments:w,refreshPosts:h}},cy=({onPostCreated:t,onCancel:n,isModal:s=!1})=>{const{user:r}=Tb(),{createPost:i}=ly(),[a,o]=f.useState(""),[l,c]=f.useState(""),[u,d]=f.useState(!1),[h,m]=f.useState("public"),[g,x]=f.useState(!1),[b,v]=f.useState(""),y=f.useRef(null);return Ae.jsxs("div",{className:s?"":"bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6",children:[!s&&Ae.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Compartilhe algo..."}),Ae.jsxs("form",{onSubmit:n=>p(e,null,function*(){if(n.preventDefault(),a.trim()){x(!0),v("");try{const e={content:a.trim(),tags:l.trim()?l.trim().split(",").map(e=>e.trim().replace("#","")):[],isAnonymous:"anonymous"===h,visibility:h,userId:r.uid,author:u?"Usuário Anônimo":r.displayName||r.email||"Usuário",avatar:u?null:r.photoURL};(yield i(e))&&(o(""),c(""),d(!1),m("public"),t&&t(e))}catch(e){v("Erro ao criar post. Tente novamente.")}finally{x(!1)}}else v("Por favor, escreva algo para postar.")}),className:"space-y-4",children:[Ae.jsxs("div",{children:[Ae.jsx("textarea",{value:a,onChange:e=>o(e.target.value),placeholder:"O que você gostaria de compartilhar hoje?",className:"w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30",rows:4,maxLength:500}),Ae.jsx("div",{className:"flex justify-between items-center mt-2",children:Ae.jsxs("span",{className:"text-xs text-white/50",children:[a.length,"/500 caracteres"]})})]}),Ae.jsxs("div",{children:[Ae.jsxs("div",{className:"relative",children:[Ae.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Adicione tags (separadas por vírgula)",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30"})]}),Ae.jsx("p",{className:"text-xs text-white/50 mt-1",children:"Ex: ansiedade, terapia, bem-estar"})]}),Ae.jsxs("div",{className:"space-y-3",children:[Ae.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Visibilidade do Post"}),Ae.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"public",label:"Público",icon:Ae.jsx(D,{className:"w-4 h-4"})},{value:"private",label:"Privado",icon:Ae.jsx(R,{className:"w-4 h-4"})},{value:"anonymous",label:"Anônimo",icon:Ae.jsx(R,{className:"w-4 h-4"})}].map(e=>Ae.jsxs("button",{type:"button",onClick:()=>{return t=e.value,m(t),void d("anonymous"===t);var t},className:"p-3 rounded-lg border transition-all duration-200 flex flex-col items-center space-y-2 "+(h===e.value?"border-white/50 bg-white/20 text-white":"border-white/20 bg-white/5 text-white/70 hover:bg-white/10 hover:text-white"),children:[e.icon,Ae.jsx("span",{className:"text-xs font-medium",children:e.label})]},e.value))}),Ae.jsx("p",{className:"text-xs text-white/60",children:(()=>{switch(h){case"public":default:return"Todos podem ver este post";case"private":return"Apenas você pode ver este post";case"anonymous":return"Post anônimo, não aparecerá no seu perfil"}})()})]}),b&&Ae.jsx("div",{className:"text-red-400 text-sm bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-2",children:b}),Ae.jsxs("div",{className:"flex items-center justify-between pt-4",children:[Ae.jsxs("div",{className:"flex items-center space-x-4",children:[Ae.jsx("button",{type:"button",onClick:()=>{var e;return null==(e=y.current)?void 0:e.click()},className:"p-2 text-white/50 hover:text-white transition-colors rounded-full hover:bg-white/10",disabled:g,children:Ae.jsx(U,{className:"w-5 h-5"})}),Ae.jsx("input",{ref:y,type:"file",accept:"image/*",className:"hidden",onChange:()=>{}})]}),Ae.jsxs("div",{className:"flex items-center space-x-3",children:[s&&n&&Ae.jsx("button",{type:"button",onClick:()=>{n&&n()},className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors",disabled:g,children:"Cancelar"}),Ae.jsx("button",{type:"submit",disabled:g||!a.trim(),className:"px-6 py-2 bg-white text-black rounded-lg font-medium transition-all duration-200 transform hover:scale-[1.02] disabled:bg-white/30 disabled:scale-100 disabled:cursor-not-allowed flex items-center space-x-2",children:g?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"}),Ae.jsx("span",{children:"Postando..."})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(_,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Postar"})]})})]})]})]})]})},uy=({postId:t})=>{const[n,s]=f.useState(""),[r,i]=f.useState(!1),[a,o]=f.useState(null),[l,c]=f.useState(null),[h,m]=f.useState(null),[g,x]=f.useState(""),[b,v]=f.useState(null),[y,w]=f.useState(""),N=f.useRef(null),{user:j}=Tb(),{comments:C,loading:k,error:E,addComment:I,editComment:T,deleteComment:A,toggleCommentLike:D,isCommentLiked:P,hideComment:L,reportComment:O}=(t=>{const[n,s]=f.useState([]),[r,i]=f.useState(!0),[a,o]=f.useState(null),[l,c]=f.useState(!0),{user:h}=Tb(),m=f.useCallback(()=>p(e,null,function*(){if(t)try{i(!0),o(null);const e=yield Wb.getPostComments(t,50),n=e.map(e=>d(u({},e),{createdAt:Kb.convertTimestamp(e.createdAt),updatedAt:e.updatedAt?Kb.convertTimestamp(e.updatedAt):void 0}));s(n),c(50===e.length)}catch(e){o(e instanceof Error?e.message:"Erro ao carregar comentários")}finally{i(!1)}}),[t]),g=f.useCallback((n,r=!1)=>p(e,null,function*(){if(!h||!t)throw new Error("Usuário não autenticado ou post não especificado");try{const e={authorId:h.uid,authorName:r?"Usuário Anônimo":h.displayName||h.email||"Usuário",authorAvatar:r?null:h.photoURL,content:n.trim(),isAnonymous:r},i=yield Wb.addComment(t,e);if(i.success){const n=d(u({id:i.commentId,postId:t},e),{likes:[],createdAt:new Date,isHidden:!1,isReported:!1});return s(e=>[n,...e]),i.commentId}return null}catch(e){throw e}}),[h,t]),x=f.useCallback((t,n)=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield Wb.editComment(t,n))&&(s(e=>e.map(e=>e.id===t?d(u({},e),{content:n,isEdited:!0,updatedAt:new Date}):e)),!0)}catch(e){throw e}}),[h]),b=f.useCallback(t=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield Wb.deleteComment(t))&&(s(e=>e.filter(e=>e.id!==t)),!0)}catch(e){throw e}}),[h]),v=f.useCallback(t=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield Wb.toggleCommentVisibility(t))&&(s(e=>e.map(e=>e.id===t?d(u({},e),{isHidden:!e.isHidden}):e)),!0)}catch(e){throw e}}),[h]),y=f.useCallback((t,n)=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield Wb.reportComment(t,n))&&(s(e=>e.map(e=>e.id===t?d(u({},e),{isReported:!0,reportedBy:[...e.reportedBy||[],h.uid],reportReasons:[...e.reportReasons||[],n]}):e)),!0)}catch(e){throw e}}),[h]),w=f.useCallback(t=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield Wb.toggleCommentLike(t,h.uid))&&(s(e=>e.map(e=>{if(e.id===t){const t=e.likes.includes(h.uid);return d(u({},e),t?{likes:e.likes.filter(e=>e!==h.uid)}:{likes:[...e.likes,h.uid]})}return e})),!0)}catch(e){throw e}}),[h]),N=f.useCallback(e=>{if(!h)return!1;const t=n.find(t=>t.id===e);return!!t&&t.likes.includes(h.uid)},[h,n]);return f.useEffect(()=>{m()},[m]),{comments:n,loading:r,error:a,hasMore:l,loadMoreComments:m,addComment:g,editComment:x,deleteComment:b,hideComment:v,reportComment:y,toggleCommentLike:w,isCommentLiked:N,refreshComments:m}})(t),M=e=>{const t=new Date-e,n=Math.floor(t/6e4),s=Math.floor(t/36e5),r=Math.floor(t/864e5);return n<1?"Agora mesmo":n<60?`${n}m atrás`:s<24?`${s}h atrás`:r<7?`${r}d atrás`:e.toLocaleDateString("pt-BR")},U=e=>j&&(e.authorId===j.uid||"admin"===j.role),F=e=>j&&(e.authorId===j.uid||"admin"===j.role),V=e=>j&&e.authorId!==j.uid;return f.useEffect(()=>{const e=e=>{a&&!e.target.closest(".comment-menu")&&o(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[a]),k?Ae.jsxs("div",{className:"text-center text-white/50 py-8",children:[Ae.jsx("div",{className:"loading-spinner mx-auto mb-4"}),"Carregando comentários..."]}):E?Ae.jsxs("div",{className:"text-center text-red-400 py-8",children:["Erro ao carregar comentários: ",E]}):Ae.jsxs("div",{className:"space-y-6",children:[Ae.jsx("div",{className:"bg-white/5 rounded-lg p-4",children:Ae.jsx("form",{onSubmit:t=>p(e,null,function*(){t.preventDefault(),n.trim()&&(yield I(n,r))&&(s(""),i(!1))}),className:"space-y-3",children:Ae.jsxs("div",{className:"flex items-start space-x-3",children:[Ae.jsx("div",{className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:(null==j?void 0:j.photoURL)?Ae.jsx("img",{src:j.photoURL,alt:j.displayName,className:"w-8 h-8 rounded-full"}):Ae.jsx(S,{className:"w-4 h-4 text-white/70"})}),Ae.jsxs("div",{className:"flex-1 min-w-0",children:[Ae.jsx("textarea",{ref:N,value:n,onChange:e=>s(e.target.value),placeholder:"Adicione um comentário...",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30",rows:3}),Ae.jsxs("div",{className:"flex items-center justify-between mt-2",children:[Ae.jsxs("label",{className:"flex items-center space-x-2 text-sm text-white/70 cursor-pointer",children:[Ae.jsx("input",{type:"checkbox",checked:r,onChange:e=>i(e.target.checked),className:"w-4 h-4 rounded border-white/30 bg-white/10 text-white focus:ring-white/30"}),Ae.jsx("span",{children:"Comentar anonimamente"})]}),Ae.jsxs("button",{type:"submit",disabled:!n.trim(),className:"flex items-center space-x-2 px-4 py-2 bg-white text-black rounded-lg font-medium transition-all duration-200 transform hover:scale-[1.02] disabled:bg-white/30 disabled:scale-100 disabled:cursor-not-allowed",children:[Ae.jsx(_,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Comentar"})]})]})]})]})})}),Ae.jsx("div",{className:"space-y-4",children:0===C.length?Ae.jsx("div",{className:"text-center text-white/50 py-8",children:"Nenhum comentário ainda. Seja o primeiro a comentar!"}):C.map(t=>{var n;return Ae.jsx("div",{className:"bg-white/5 rounded-lg p-4 "+(t.isHidden?"opacity-50":""),children:Ae.jsxs("div",{className:"flex items-start space-x-3",children:[Ae.jsx("div",{className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:t.authorAvatar?Ae.jsx("img",{src:t.authorAvatar,alt:t.authorName,className:"w-8 h-8 rounded-full"}):Ae.jsx(S,{className:"w-4 h-4 text-white/70"})}),Ae.jsxs("div",{className:"flex-1 min-w-0",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("h5",{className:"font-medium text-white",children:t.authorName}),t.isAnonymous&&Ae.jsx("span",{className:"text-xs bg-white/20 text-white/70 px-2 py-1 rounded-full",children:"Anônimo"}),Ae.jsx("span",{className:"text-xs text-white/50",children:M(t.createdAt)}),t.isEdited&&Ae.jsx("span",{className:"text-xs text-white/30",children:"(editado)"})]}),Ae.jsxs("div",{className:"relative comment-menu",children:[Ae.jsx("button",{onClick:()=>o(a===t.id?null:t.id),className:"p-1 text-white/50 hover:text-white transition-colors rounded-full hover:bg-white/10",children:Ae.jsx(ae,{className:"w-4 h-4"})}),a===t.id&&Ae.jsx("div",{className:"absolute right-0 top-8 bg-white/10 backdrop-blur-lg border border-white/20 rounded-lg shadow-xl z-10 min-w-[160px]",children:Ae.jsxs("div",{className:"py-1",children:[U(t)&&Ae.jsxs("button",{onClick:()=>{m(t.id),x(t.content),o(null)},className:"w-full px-4 py-2 text-left text-white hover:bg-white/20 transition-colors flex items-center space-x-2",children:[Ae.jsx(oe,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Editar"})]}),U(t)&&Ae.jsxs("button",{onClick:()=>{return n=t.id,p(e,null,function*(){window.confirm("Tem certeza que deseja deletar este comentário?")&&(yield A(n))&&o(null)});var n},className:"w-full px-4 py-2 text-left text-red-400 hover:bg-red-500/20 transition-colors flex items-center space-x-2",children:[Ae.jsx(le,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Deletar"})]}),F(t)&&Ae.jsxs("button",{onClick:()=>{return n=t.id,p(e,null,function*(){(yield L(n))&&o(null)});var n},className:"w-full px-4 py-2 text-left text-white hover:bg-white/20 transition-colors flex items-center space-x-2",children:[Ae.jsx(R,{className:"w-4 h-4"}),Ae.jsx("span",{children:t.isHidden?"Mostrar":"Ocultar"})]}),V(t)&&Ae.jsxs("button",{onClick:()=>v(t.id),className:"w-full px-4 py-2 text-left text-orange-400 hover:bg-orange-500/20 transition-colors flex items-center space-x-2",children:[Ae.jsx(ce,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Reportar"})]})]})})]})]}),h===t.id?Ae.jsxs("div",{className:"space-y-3",children:[Ae.jsx("textarea",{value:g,onChange:e=>x(e.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30",rows:3}),Ae.jsxs("div",{className:"flex space-x-2",children:[Ae.jsx("button",{onClick:()=>{return n=t.id,p(e,null,function*(){g.trim()&&(yield T(n,g))&&(m(null),x(""))});var n},className:"px-3 py-1 bg-white text-black rounded-lg text-sm font-medium hover:bg-white/90 transition-colors",children:"Salvar"}),Ae.jsx("button",{onClick:()=>{m(null),x("")},className:"px-3 py-1 bg-white/10 text-white rounded-lg text-sm font-medium hover:bg-white/20 transition-colors",children:"Cancelar"})]})]}):Ae.jsx("p",{className:"text-white/90 leading-relaxed",children:t.content}),Ae.jsxs("div",{className:"flex items-center space-x-4 mt-3",children:[Ae.jsxs("button",{onClick:()=>{return n=t.id,p(e,null,function*(){yield D(n)});var n},className:"flex items-center space-x-1 transition-colors "+(P(t.id)?"text-red-400":"text-white/50 hover:text-white"),children:[Ae.jsx(ie,{className:"w-4 h-4 "+(P(t.id)?"fill-current":"")}),Ae.jsx("span",{className:"text-sm",children:(null==(n=t.likes)?void 0:n.length)||0})]}),Ae.jsxs("button",{onClick:()=>c(l===t.id?null:t.id),className:"flex items-center space-x-1 text-white/50 hover:text-white transition-colors",children:[Ae.jsx(ue,{className:"w-4 h-4"}),Ae.jsx("span",{className:"text-sm",children:"Responder"})]})]}),l===t.id&&Ae.jsx("div",{className:"mt-3 pl-6 border-l-2 border-white/20",children:Ae.jsxs("div",{className:"flex items-start space-x-3",children:[Ae.jsx("div",{className:"w-6 h-6 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:(null==j?void 0:j.photoURL)?Ae.jsx("img",{src:j.photoURL,alt:j.displayName,className:"w-6 h-6 rounded-full"}):Ae.jsx(S,{className:"w-3 h-3 text-white/70"})}),Ae.jsxs("div",{className:"flex-1",children:[Ae.jsx("textarea",{placeholder:"Responder ao comentário...",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30",rows:2}),Ae.jsxs("div",{className:"flex items-center justify-between mt-2",children:[Ae.jsxs("label",{className:"flex items-center space-x-2 text-sm text-white/70 cursor-pointer",children:[Ae.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-white/30 bg-white/10 text-white focus:ring-white/30"}),Ae.jsx("span",{children:"Responder anonimamente"})]}),Ae.jsx("button",{className:"px-3 py-1 bg-white text-black rounded-lg text-sm font-medium hover:bg-white/90 transition-colors",children:"Responder"})]})]})]})})]})]})},t.id)})}),b&&Ae.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-xl p-6 max-w-md w-full",children:[Ae.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Ae.jsx(ee,{className:"w-6 h-6 text-orange-400"}),Ae.jsx("h3",{className:"text-xl font-medium text-white",children:"Reportar Comentário"})]}),Ae.jsx("p",{className:"text-white/70 mb-4",children:"Por favor, informe o motivo pelo qual está reportando este comentário:"}),Ae.jsx("textarea",{value:y,onChange:e=>w(e.target.value),placeholder:"Descreva o motivo do report...",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 mb-4",rows:3}),Ae.jsxs("div",{className:"flex space-x-3",children:[Ae.jsx("button",{onClick:()=>{v(null),w("")},className:"flex-1 px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors",children:"Cancelar"}),Ae.jsx("button",{onClick:()=>{return t=b,p(e,null,function*(){y.trim()?(yield O(t,y))&&(v(null),w(""),o(null)):alert("Por favor, informe o motivo do report.")});var t},className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors",children:"Reportar"})]})]})})]})},dy=()=>{xt();const{user:t}=Tb(),[n,s]=f.useState(null),[r,i]=f.useState(null);f.useState(new Set);const{posts:a,loading:o,error:l,hasMore:c,loadMorePosts:u,togglePostLike:d,isPostLiked:h,deletePost:m}=ly(),g=e=>{if(!e)return"Agora mesmo";const t=new Date,n=e.toDate?e.toDate():new Date(e),s=t-n,r=Math.floor(s/6e4),i=Math.floor(s/36e5),a=Math.floor(s/864e5);return r<1?"Agora mesmo":r<60?`${r}m atrás`:i<24?`${i}h atrás`:a<7?`${a}d atrás`:n.toLocaleDateString("pt-BR")};return o&&0===a.length?Ae.jsxs("div",{className:"flex items-center justify-center py-20",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("span",{className:"ml-3 text-white/70",children:"Carregando posts..."})]}):l&&0===a.length?Ae.jsxs("div",{className:"text-center py-20",children:[Ae.jsx("div",{className:"w-24 h-24 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:Ae.jsx(ce,{className:"w-12 h-12 text-red-400"})}),Ae.jsx("h3",{className:"text-xl text-white/60 mb-2",children:"Erro ao carregar posts"}),Ae.jsx("p",{className:"text-white/40 mb-6",children:l}),Ae.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-colors",children:"Tentar novamente"})]}):0===a.length?Ae.jsxs("div",{className:"text-center py-20",children:[Ae.jsx("div",{className:"w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4",children:Ae.jsx(MessageCircle,{className:"w-12 h-12 text-white/30"})}),Ae.jsx("h3",{className:"text-xl text-white/60 mb-2",children:"Nenhum post ainda"}),Ae.jsx("p",{className:"text-white/40",children:"Seja o primeiro a compartilhar algo!"})]}):Ae.jsxs("div",{className:"space-y-6",children:[a.map(a=>{var o,l,c;return Ae.jsxs("article",{className:"bg-white/5 border border-white/10 rounded-xl p-6 hover:bg-white/10 transition-all",children:[Ae.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg",children:a.isAnonymous?"?":(null==(o=a.author)?void 0:o.charAt(0))||"U"}),Ae.jsxs("div",{children:[Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("h3",{className:"text-white font-semibold",children:a.isAnonymous?"Usuário Anônimo":a.author}),a.isAnonymous&&Ae.jsx("span",{className:"px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full",children:"Anônimo"}),"private"===a.visibility&&Ae.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full",children:"Privado"})]}),Ae.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/60",children:[Ae.jsx(de,{className:"w-3 h-3"}),Ae.jsx("span",{children:g(a.createdAt)}),a.isEdited&&Ae.jsx("span",{className:"text-xs text-white/40",children:"(editado)"})]})]})]}),t&&(a.userId===t.uid||"admin"===t.role)&&Ae.jsxs("div",{className:"relative",children:[Ae.jsx("button",{onClick:()=>s(n===a.id?null:a.id),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:Ae.jsx(ae,{className:"w-4 h-4 text-white/60"})}),n===a.id&&Ae.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white/10 backdrop-blur-xl border border-white/20 rounded-lg shadow-xl z-10",children:[Ae.jsxs("button",{onClick:()=>(a.id,void s(null)),className:"w-full px-4 py-2 text-left text-white hover:bg-white/10 flex items-center space-x-2 rounded-t-lg",children:[Ae.jsx(oe,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Editar"})]}),Ae.jsxs("button",{onClick:()=>{return t=a.id,p(e,null,function*(){if(window.confirm("Tem certeza que deseja deletar este post?")){i(t);try{(yield m(t))&&s(null)}catch(e){}finally{i(null)}}});var t},disabled:r===a.id,className:"w-full px-4 py-2 text-left text-red-400 hover:bg-red-500/20 flex items-center space-x-2 rounded-b-lg disabled:opacity-50",children:[Ae.jsx(le,{className:"w-4 h-4"}),Ae.jsx("span",{children:r===a.id?"Deletando...":"Deletar"})]})]})]})]}),Ae.jsxs("div",{className:"mb-4",children:[Ae.jsx("p",{className:"text-white/90 text-lg leading-relaxed mb-3",children:a.content}),a.tags&&a.tags.length>0&&Ae.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map((e,t)=>Ae.jsxs("span",{className:"px-3 py-1 bg-blue-500/20 text-blue-400 text-sm rounded-full border border-blue-500/30",children:["#",e]},t))})]}),Ae.jsx("div",{className:"flex items-center justify-between text-sm text-white/60 mb-4",children:Ae.jsx("div",{className:"flex items-center space-x-4",children:Ae.jsxs("span",{children:[(null==(l=a.likes)?void 0:l.length)||0," curtidas"]})})}),Ae.jsx("div",{className:"flex items-center justify-between pt-4 border-t border-white/10",children:Ae.jsx("div",{className:"flex items-center space-x-6",children:Ae.jsxs("button",{onClick:()=>{return n=a.id,p(e,null,function*(){t&&(yield d(n))});var n},disabled:!t,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all ${h(a.id)?"bg-red-500/20 text-red-400 border border-red-500/30":"text-white/70 hover:text-white hover:bg-white/10"} ${t?"":"opacity-50 cursor-not-allowed"}`,children:[Ae.jsx(ie,{className:"w-5 h-5 "+(h(a.id)?"fill-current":"")}),Ae.jsx("span",{className:"font-medium",children:h(a.id)?"Curtido":"Curtir"}),(null==(c=a.likes)?void 0:c.length)>0&&Ae.jsxs("span",{className:"text-sm",children:["(",a.likes.length,")"]})]})})})]},a.id)}),c&&Ae.jsx("div",{className:"text-center",children:Ae.jsx("button",{onClick:u,disabled:o,className:"px-8 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-colors disabled:opacity-50",children:o?"Carregando...":"Carregar mais posts"})})]})};function hy(){return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(oy,{}),Ae.jsx(cy,{}),Ae.jsx(dy,{})]})}const my=()=>{const[e,t]=f.useState(""),[n,s]=f.useState(""),r=[];return Ae.jsxs("div",{className:"space-y-6 animation-initial animate-fade-in-up animation-delay-100",children:[Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Ae.jsx(K,{className:"w-6 h-6 text-gray-400"}),Ae.jsx("h2",{className:"text-xl font-semibold text-white",children:"Diário Interativo"})]}),Ae.jsxs("div",{className:"mb-4",children:[Ae.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Escolha uma reflexão para começar:"}),Ae.jsx("div",{className:"space-y-2",children:["Como você se sentiu hoje?","Qual foi o melhor momento do seu dia?","O que você gostaria de melhorar amanhã?","Por que você está grato hoje?","Que desafio você enfrentou hoje?"].map((e,t)=>Ae.jsx("button",{onClick:()=>s(e),className:"w-full text-left p-3 rounded-lg transition-all duration-200 "+(n===e?"bg-white/10 border border-white/20 text-white":"bg-gray-800/30 hover:bg-gray-700/30 text-gray-300"),children:Ae.jsx("span",{className:"text-sm",children:e})},t))})]}),Ae.jsxs("div",{className:"space-y-4",children:[n&&Ae.jsx("div",{className:"bg-white/10 border border-white/20 rounded-lg p-3",children:Ae.jsx("p",{className:"text-gray-300 text-sm font-medium",children:n})}),Ae.jsx("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:"Escreva seus pensamentos e sentimentos aqui...",className:"w-full bg-gray-800/50 border border-gray-600/50 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-200 min-h-[120px]"}),Ae.jsx("div",{className:"flex justify-end",children:Ae.jsxs("button",{onClick:()=>{e.trim()&&n&&(t(""),s(""))},disabled:!e.trim()||!n,className:"bg-gradient-to-r from-white to-gray-200 text-black px-6 py-2 rounded-lg font-medium hover:from-gray-200 hover:to-gray-300 transform hover:scale-105 transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[Ae.jsx(_,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Salvar Reflexão"})]})})]})]}),Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Reflexões Recentes"}),Ae.jsx("div",{className:"space-y-3",children:0===r.length?Ae.jsxs("div",{className:"text-center py-12",children:[Ae.jsx(K,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Ae.jsx("h3",{className:"text-lg font-medium text-white/70 mb-2",children:"Nenhuma reflexão ainda"}),Ae.jsx("p",{className:"text-white/50",children:"Comece escrevendo sua primeira reflexão acima"})]}):r.map((e,t)=>Ae.jsx("button",{className:"w-full bg-white/5 border border-gray-200/20 rounded-lg p-4 hover:bg-white/10 hover:border-gray-300/20 transition-all duration-200 group",children:Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("span",{className:"text-2xl",children:e.mood}),Ae.jsxs("div",{className:"text-left",children:[Ae.jsx("p",{className:"text-sm font-medium text-white",children:e.date}),Ae.jsx("p",{className:"text-xs text-gray-400 truncate max-w-[200px]",children:e.preview})]})]}),Ae.jsx(ne,{className:"w-5 h-5 text-gray-400 group-hover:text-white transition-colors duration-200"})]})},t))})]})]})};function py(){return Ae.jsx(my,{})}const fy=()=>{const[t,n]=f.useState(""),[s,r]=f.useState(""),[i,a]=f.useState("track"),[o,l]=f.useState(null),[c,u]=f.useState([]),[d,h]=f.useState(!1),[m,g]=f.useState(""),[x,b]=f.useState("week"),v=[],y=[],w=Array.from({length:31},(e,t)=>({day:t+1,mood:null,intensity:null}));f.useEffect(()=>{p(e,null,function*(){try{const e=Cb.currentUser;if(e){const t=Mg(kb,"users",e.uid),n=yield Fx(t);n.exists()&&l(n.data())}}catch(Ly){}}),u(v)},[]);const N=e=>{switch(e){case"happy":return"bg-green-500";case"sad":return"bg-blue-500";case"angry":return"bg-red-500";case"fear":return"bg-yellow-500";case"peace":return"bg-purple-500";case"love":return"bg-pink-500";default:return"bg-gray-500"}},j=e=>{switch(e){case"happy":return"😊";case"sad":return"😔";case"angry":return"😡";case"fear":return"😰";case"peace":return"😌";case"love":return"❤️";default:return"😐"}};return Ae.jsxs("div",{className:"min-h-screen bg-black py-8 animation-initial animate-fade-in-up animation-delay-100",children:[Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(he,{className:"w-6 h-6 text-gray-400"}),Ae.jsx("h2",{className:"text-xl font-semibold text-white",children:"Rastreador de Humor"})]}),Ae.jsxs("button",{onClick:()=>h(!d),className:"bg-white/10 border border-white/30 text-white px-4 py-2 rounded-lg hover:bg-white/20 transition-all duration-300 text-sm",children:[Ae.jsx(Y,{className:"w-4 h-4 inline mr-2"}),"Registrar Humor"]})]}),Ae.jsxs("div",{className:"flex space-x-1 bg-white/5 rounded-lg p-1",children:[Ae.jsx("button",{onClick:()=>a("track"),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 "+("track"===i?"bg-white text-black":"text-white/70 hover:text-white"),children:"Rastreamento"}),Ae.jsx("button",{onClick:()=>a("history"),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 "+("history"===i?"bg-white text-black":"text-white/70 hover:text-white"),children:"Histórico"}),Ae.jsx("button",{onClick:()=>a("analytics"),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 "+("analytics"===i?"bg-white text-black":"text-white/70 hover:text-white"),children:"Análises"})]})]}),d&&Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ae.jsx("h3",{className:"text-lg font-semibold text-white",children:"Registrar Humor"}),Ae.jsx("button",{onClick:()=>h(!1),className:"text-white/50 hover:text-white",children:"✕"})]}),Ae.jsxs("div",{className:"space-y-6",children:[Ae.jsxs("div",{children:[Ae.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Escolha uma Opção:"}),Ae.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{emoji:"😊",label:"Feliz",value:"happy"},{emoji:"😔",label:"Triste",value:"sad"},{emoji:"😡",label:"Raiva",value:"angry"},{emoji:"😰",label:"Medo",value:"fear"},{emoji:"😌",label:"Paz",value:"peace"},{emoji:"❤️",label:"Amor",value:"love"}].map(e=>Ae.jsxs("button",{onClick:()=>n(e.value),className:"flex flex-col items-center space-y-2 p-3 rounded-xl transition-all duration-200 "+(t===e.value?"bg-white/10 border border-white/20 scale-105":"bg-gray-800/30 hover:bg-gray-700/30 hover:scale-105"),children:[Ae.jsx("span",{className:"text-2xl",children:e.emoji}),Ae.jsx("span",{className:"text-xs text-gray-300",children:e.label})]},e.value))})]}),Ae.jsxs("div",{children:[Ae.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Principal Causa:"}),Ae.jsx("div",{className:"grid grid-cols-3 gap-2",children:["Sono","Eu Mesmo(a)","Família","Saúde","Amizades","Estudos","Lazer","Trabalho","Relação","Luto","Finanças","Outras"].map(e=>Ae.jsx("button",{onClick:()=>r(e),className:"p-2 rounded-lg text-xs transition-all duration-200 "+(s===e?"bg-white/10 border border-white/20 text-white":"bg-gray-800/30 hover:bg-gray-700/30 text-gray-300"),children:e},e))})]}),Ae.jsx("button",{onClick:()=>{t&&s&&(h(!1),n(""),r(""))},disabled:!t||!s,className:"w-full bg-gradient-to-r from-white to-gray-200 text-black py-3 px-4 rounded-xl font-medium hover:from-gray-200 hover:to-gray-300 transform hover:scale-105 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"REGISTRAR"})]})]}),"track"===i&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Ae.jsx("h3",{className:"text-lg font-semibold text-white",children:"Janeiro de 2024"}),Ae.jsxs("div",{className:"flex space-x-2",children:[Ae.jsx("button",{className:"p-1 text-gray-400 hover:text-white",children:"‹"}),Ae.jsx("button",{className:"p-1 text-gray-400 hover:text-white",children:"›"})]})]}),Ae.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["D","S","T","Q","Q","S","S"].map((e,t)=>Ae.jsx("div",{className:"text-center text-xs text-gray-400 p-2",children:e},`${e}-${t}`))}),Ae.jsx("div",{className:"grid grid-cols-7 gap-1",children:w.map(e=>Ae.jsxs("button",{className:"aspect-square flex flex-col items-center justify-center text-sm rounded-lg transition-all duration-200 "+(e.mood?`${N(e.mood)} text-white`:"text-gray-300 hover:bg-gray-700/30"),children:[Ae.jsx("span",{className:"text-xs",children:e.day}),e.mood&&Ae.jsxs("span",{className:"text-xs opacity-75",children:[e.intensity,"/10"]})]},e.day))})]}),Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Resumo da Semana"}),Ae.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Ae.jsxs("div",{className:"text-center p-4 bg-white/5 rounded-lg",children:[Ae.jsx("div",{className:"text-2xl mb-2",children:"😊"}),Ae.jsx("div",{className:"text-white font-medium",children:"Humor Médio"}),Ae.jsx("div",{className:"text-white/70 text-sm",children:"0/10"})]}),Ae.jsxs("div",{className:"text-center p-4 bg-white/5 rounded-lg",children:[Ae.jsx("div",{className:"text-2xl mb-2",children:"📊"}),Ae.jsx("div",{className:"text-white font-medium",children:"Entradas"}),Ae.jsx("div",{className:"text-white/70 text-sm",children:"0 esta semana"})]})]})]})]}),"history"===i&&Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ae.jsx("h3",{className:"text-lg font-semibold text-white",children:"Histórico de Humor"}),Ae.jsxs("div",{className:"flex space-x-3",children:[Ae.jsxs("div",{className:"relative",children:[Ae.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50 w-4 h-4"}),Ae.jsx("input",{type:"text",placeholder:"Pesquisar entradas...",value:m,onChange:e=>g(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg pl-10 pr-4 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 text-sm"})]}),Ae.jsxs("select",{value:x,onChange:e=>b(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/30 text-sm",children:[Ae.jsx("option",{value:"week",children:"Esta semana"}),Ae.jsx("option",{value:"month",children:"Este mês"}),Ae.jsx("option",{value:"year",children:"Este ano"})]})]})]}),Ae.jsx("div",{className:"space-y-4",children:0===c.length?Ae.jsxs("div",{className:"text-center py-12",children:[Ae.jsx(he,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Ae.jsx("h3",{className:"text-lg font-medium text-white/70 mb-2",children:"Nenhuma entrada de humor"}),Ae.jsx("p",{className:"text-white/50",children:"Comece registrando seu humor usando o botão acima"})]}):c.map(e=>Ae.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${N(e.mood)}`,children:Ae.jsx("span",{className:"text-xl",children:j(e.mood)})}),Ae.jsxs("div",{children:[Ae.jsx("h4",{className:"font-medium text-white",children:e.cause}),Ae.jsx("p",{className:"text-sm text-white/70",children:e.notes}),Ae.jsxs("div",{className:"flex items-center space-x-2 text-xs text-white/50 mt-1",children:[Ae.jsx(de,{className:"w-3 h-3"}),Ae.jsx("span",{children:e.date.toLocaleDateString("pt-BR")}),Ae.jsx("span",{children:"•"}),Ae.jsxs("span",{children:["Intensidade: ",e.intensity,"/10"]})]})]})]}),Ae.jsxs("div",{className:"flex space-x-2",children:[Ae.jsx("button",{className:"text-white/50 hover:text-white p-1",children:Ae.jsx(oe,{className:"w-4 h-4"})}),Ae.jsx("button",{className:"text-white/50 hover:text-white p-1",children:Ae.jsx(le,{className:"w-4 h-4"})})]})]})},e.id))})]}),"analytics"===i&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsx("div",{className:"flex items-center justify-between mb-4",children:Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(Q,{className:"w-5 h-5 text-gray-400"}),Ae.jsx("h3",{className:"text-lg font-semibold text-white",children:"Estatísticas Mensais"})]})}),Ae.jsx("div",{className:"space-y-3",children:0===y.length?Ae.jsxs("div",{className:"text-center py-8",children:[Ae.jsx(Q,{className:"w-12 h-12 text-white/30 mx-auto mb-3"}),Ae.jsx("p",{className:"text-white/50",children:"Nenhuma estatística disponível"}),Ae.jsx("p",{className:"text-white/30 text-sm",children:"Registre seu humor para ver análises"})]}):y.map((e,t)=>Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("div",{className:`w-4 h-4 rounded ${e.color}`}),Ae.jsx("span",{className:"text-sm text-gray-300",children:e.mood})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsxs("span",{className:"text-sm text-gray-400",children:[e.percentage,"%"]}),"up"===e.trend?Ae.jsx(J,{className:"w-4 h-4 text-green-400"}):Ae.jsx(me,{className:"w-4 h-4 text-red-400"})]})]},t))})]}),Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Metas e Insights"}),Ae.jsx("div",{className:"space-y-4",children:0===y.length?Ae.jsxs("div",{className:"text-center py-8",children:[Ae.jsx(pe,{className:"w-12 h-12 text-white/30 mx-auto mb-3"}),Ae.jsx("p",{className:"text-white/50",children:"Nenhuma meta definida"}),Ae.jsx("p",{className:"text-white/30 text-sm",children:"Comece registrando seu humor para definir metas"})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white/5 rounded-lg",children:[Ae.jsx(pe,{className:"w-5 h-5 text-blue-400"}),Ae.jsxs("div",{children:[Ae.jsx("div",{className:"text-white font-medium",children:"Meta: 7 dias consecutivos"}),Ae.jsx("div",{className:"text-white/70 text-sm",children:"Progresso: 0/7 dias"})]})]}),Ae.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white/5 rounded-lg",children:[Ae.jsx(fe,{className:"w-5 h-5 text-yellow-400"}),Ae.jsxs("div",{children:[Ae.jsx("div",{className:"text-white font-medium",children:"Melhor humor da semana"}),Ae.jsx("div",{className:"text-white/70 text-sm",children:"Nenhuma entrada ainda"})]})]})]})})]})]})]})},gy=new class{uploadProfilePhoto(e,t){return p(this,null,function*(){if(!e)throw new Error("Arquivo inválido");if(!t)throw new Error("ID de usuário ausente");try{const n=yield this.fileToBase64(e),s=`profile_${t}_${Date.now()}`,r=Mg(kb,"users",t);return yield Bx(r,{profilePhotoId:s,profilePhotoData:n,updatedAt:new Date}),{imageId:s,success:!0}}catch(Ly){throw new Error(`Falha no upload: ${Ly.message}`)}})}uploadBannerPhoto(e,t){return p(this,null,function*(){if(!e)throw new Error("Arquivo inválido");if(!t)throw new Error("ID de usuário ausente");try{const n=yield this.fileToBase64(e),s=`banner_${t}_${Date.now()}`,r=Mg(kb,"users",t);return yield Bx(r,{bannerPhotoId:s,bannerPhotoData:n,updatedAt:new Date}),{imageId:s,success:!0}}catch(Ly){throw new Error(`Falha no upload: ${Ly.message}`)}})}replaceProfilePhoto(e,t,n=null){return p(this,null,function*(){try{return(yield this.uploadProfilePhoto(e,t)).imageId}catch(Ly){throw Ly}})}replaceBannerPhoto(e,t,n=null){return p(this,null,function*(){try{return(yield this.uploadBannerPhoto(e,t)).imageId}catch(Ly){throw Ly}})}deleteProfilePhoto(e,t){return p(this,null,function*(){try{const t=Mg(kb,"users",e);return yield Bx(t,{profilePhotoId:null,profilePhotoData:null,updatedAt:new Date}),!0}catch(Ly){throw Ly}})}deleteBannerPhoto(e,t){return p(this,null,function*(){try{const t=Mg(kb,"users",e);return yield Bx(t,{bannerPhotoId:null,bannerPhotoData:null,updatedAt:new Date}),!0}catch(Ly){throw Ly}})}getImageFromFirestore(e,t){return p(this,null,function*(){try{const n=Mg(kb,"users",t),s=yield Fx(n);if(s.exists()){const t=s.data();if(e===t.profilePhotoId)return t.profilePhotoData;if(e===t.bannerPhotoId)return t.bannerPhotoData}return null}catch(Ly){return null}})}getUserImages(e){return p(this,null,function*(){try{const t=Mg(kb,"users",e),n=yield Fx(t);if(n.exists()){const e=n.data();return{profilePhotoURL:e.profilePhotoData||null,bannerPhotoURL:e.bannerPhotoData||null,profilePhotoId:e.profilePhotoId||null,bannerPhotoId:e.bannerPhotoId||null}}return{profilePhotoURL:null,bannerPhotoURL:null,profilePhotoId:null,bannerPhotoId:null}}catch(Ly){return{profilePhotoURL:null,bannerPhotoURL:null,profilePhotoId:null,bannerPhotoId:null}}})}fileToBase64(e){return new Promise((t,n)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=()=>t(s.result),s.onerror=e=>n(e)})}validateFileSize(e,t){const n=1024*t*1024;if(e.size>n)throw new Error(`Arquivo muito grande. Máximo permitido: ${t}MB`);return!0}validateFileType(e){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(e.type))throw new Error("Tipo de arquivo não suportado. Use apenas imagens (JPEG, PNG, GIF, WebP)");return!0}},xy=()=>{var t,n,s,r,i;const{user:a,loading:o}=Tb(),{createPost:l,deletePost:c}=ly(),[h,m]=f.useState(!1),[g,x]=f.useState(!1),[b,v]=f.useState([]),[y,w]=f.useState(!0),[N,j]=f.useState({displayName:"",username:"",bio:"",phone:"",birthDate:""}),C=f.useRef(null),_=f.useRef(null),[k,E]=f.useState(null),[I,T]=f.useState(null),{profilePhoto:A,bannerPhoto:R,loading:D,loadUserImages:M,updateImage:U}=(t=>{const[n,s]=f.useState(null),[r,i]=f.useState(null),[a,o]=f.useState(!1),[l,c]=f.useState(null),u=f.useCallback(()=>p(e,null,function*(){if(t){o(!0),c(null);try{const e=yield gy.getUserImages(t);s(e.profilePhotoURL),i(e.bannerPhotoURL)}catch(e){c(e.message)}finally{o(!1)}}}),[t]),d=f.useCallback((n,s,r=null)=>p(e,null,function*(){if(!t||!n)return null;try{let e;return gy.validateFileType(n),"profilePhoto"===s?gy.validateFileSize(n,2):"bannerPhoto"===s&&gy.validateFileSize(n,5),"profilePhoto"===s?e=yield gy.replaceProfilePhoto(n,t,r):"bannerPhoto"===s&&(e=yield gy.replaceBannerPhoto(n,t,r)),yield u(),e}catch(e){throw e}}),[t,u]),h=f.useCallback(()=>{s(null),i(null),c(null)},[]);return f.useEffect(()=>{t&&u()},[t,u]),{profilePhoto:n,bannerPhoto:r,loading:a,error:l,loadUserImages:u,updateImage:d,clearImages:h}})(null==a?void 0:a.uid);f.useEffect(()=>{a&&p(e,null,function*(){w(!0);try{const e=yield qb.getUserPosts(a.uid);v(e)}catch(Ly){alert("Erro ao carregar posts do perfil. Tente novamente.")}finally{w(!1)}})},[a]),f.useEffect(()=>{var e,t,n,s,r;a&&(j({displayName:a.displayName||(null==(e=a.profileData)?void 0:e.displayName)||"",username:(null==(t=a.profileData)?void 0:t.username)||"",bio:(null==(n=a.profileData)?void 0:n.bio)||"",phone:(null==(s=a.profileData)?void 0:s.phone)||"",birthDate:(null==(r=a.profileData)?void 0:r.birthDate)||""}),M())},[a,M]),f.useEffect(()=>{a&&!h&&p(e,null,function*(){try{const e=yield Bb.getUserProfile(a.uid);e&&j({displayName:e.displayName||"",username:e.username||"",bio:e.bio||"",phone:e.phone||"",birthDate:e.birthDate||""})}catch(Ly){}})},[a,h]);const F=()=>{x(!0)},B=e=>{if(!e)return"";let t;if(e&&"object"==typeof e&&e.toDate)t=e.toDate();else if(e instanceof Date)t=e;else{if("string"!=typeof e&&"number"!=typeof e)return"Data inválida";t=new Date(e)}if(isNaN(t.getTime()))return"Data inválida";const n=new Date-t,s=Math.floor(n/6e4),r=Math.floor(n/36e5),i=Math.floor(n/864e5);return s<1?"Agora mesmo":s<60?`${s}m atrás`:r<24?`${r}h atrás`:i<7?`${i}d atrás`:t.toLocaleDateString("pt-BR")};return o||D?Ae.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("div",{className:"text-white ml-3",children:"Carregando perfil..."})]}):a?Ae.jsxs("div",{className:"min-h-screen bg-black relative",children:[Ae.jsxs("div",{className:"relative h-64 bg-gradient-to-r from-blue-600 to-purple-600",children:[(I||R)&&Ae.jsx("img",{src:I||R,alt:"Banner",className:"w-full h-full object-cover"}),Ae.jsx("div",{className:"absolute inset-0 bg-black/20"}),h&&Ae.jsxs("button",{onClick:()=>{var e;null==(e=_.current)||e.click()},className:"absolute top-4 right-4 px-4 py-2 bg-white/20 backdrop-blur-sm rounded-lg text-white hover:bg-white/30 transition-colors flex items-center space-x-2",children:[Ae.jsx($,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Alterar Banner"})]})]}),Ae.jsx("div",{className:"relative -mt-20 px-8",children:Ae.jsxs("div",{className:"relative",children:[Ae.jsx("div",{className:"w-40 h-40 rounded-full border-4 border-white bg-white/10 flex items-center justify-center overflow-hidden",children:k||A?Ae.jsx("img",{src:k||A,alt:"Foto de perfil",className:"w-full h-full object-cover"}):Ae.jsx(S,{className:"w-20 h-20 text-white/50"})}),h&&Ae.jsx("button",{onClick:()=>{var e;null==(e=C.current)||e.click()},className:"absolute bottom-2 right-2 w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white/30 transition-colors",children:Ae.jsx($,{className:"w-6 h-6 text-white"})})]})}),Ae.jsx("div",{className:"px-8 pb-8",children:Ae.jsxs("div",{className:"flex items-start justify-between mb-6",children:[Ae.jsx("div",{className:"flex-1",children:h?Ae.jsxs("div",{className:"space-y-4",children:[Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Nome"}),Ae.jsx("input",{type:"text",value:N.displayName,onChange:e=>j(t=>d(u({},t),{displayName:e.target.value})),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:"Seu nome"})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Username"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"text",value:N.username,onChange:e=>j(t=>d(u({},t),{username:e.target.value})),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:"seu_username"})]})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Biografia"}),Ae.jsx("textarea",{value:N.bio,onChange:e=>j(t=>d(u({},t),{bio:e.target.value})),rows:3,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 resize-none",placeholder:"Conte um pouco sobre você..."})]}),Ae.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Telefone"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"tel",value:N.phone,onChange:e=>j(t=>d(u({},t),{phone:e.target.value})),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:"(11) 99999-9999"})]})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Data de Nascimento"}),Ae.jsxs("div",{className:"relative",children:[Ae.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Ae.jsx("input",{type:"date",value:N.birthDate,onChange:e=>j(t=>d(u({},t),{birthDate:e.target.value})),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"})]})]})]}),Ae.jsxs("div",{className:"flex space-x-3",children:[Ae.jsxs("button",{onClick:()=>p(e,null,function*(){var e,t,n,s;try{if(k||I){if(k)try{const n=null==(e=C.current)?void 0:e.files[0];if(n){const e=null==(t=null==a?void 0:a.profileData)?void 0:t.profilePhotoId;yield U(n,"profilePhoto",e)}}catch(Ly){return void alert("Erro ao atualizar foto de perfil. Tente novamente.")}if(I)try{const e=null==(n=_.current)?void 0:n.files[0];if(e){const t=null==(s=null==a?void 0:a.profileData)?void 0:s.bannerPhotoId;yield U(e,"bannerPhoto",t)}}catch(Ly){return void alert("Erro ao substituir banner. Tente novamente.")}}try{yield Bb.updateUserBasicProfile(a.uid,N)}catch(Ly){return void alert("Erro ao atualizar dados do perfil. Tente novamente.")}m(!1),E(null),T(null)}catch(Ly){alert("Erro ao salvar perfil. Tente novamente.")}}),className:"px-6 py-2 bg-white text-black rounded-lg font-medium hover:bg-white/90 transition-colors flex items-center space-x-2",children:[Ae.jsx(ge,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Salvar"})]}),Ae.jsx("button",{onClick:()=>{var e,t,n,s,r;j({displayName:(null==a?void 0:a.displayName)||(null==(e=null==a?void 0:a.profileData)?void 0:e.displayName)||"",username:(null==(t=null==a?void 0:a.profileData)?void 0:t.username)||"",bio:(null==(n=null==a?void 0:a.profileData)?void 0:n.bio)||"",phone:(null==(s=null==a?void 0:a.profileData)?void 0:s.phone)||"",birthDate:(null==(r=null==a?void 0:a.profileData)?void 0:r.birthDate)||""}),m(!1),E(null),T(null),M()},className:"px-6 py-2 bg-white/10 text-white rounded-lg font-medium hover:bg-white/20 transition-colors",children:"Cancelar"})]})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:(null==a?void 0:a.displayName)||(null==(t=null==a?void 0:a.profileData)?void 0:t.displayName)||"Usuário"}),Ae.jsxs("p",{className:"text-white/80 text-lg mb-3",children:["@",(null==(n=null==a?void 0:a.profileData)?void 0:n.username)||"usuario"]}),Ae.jsx("p",{className:"text-white/70 mb-3",children:(null==(s=null==a?void 0:a.profileData)?void 0:s.bio)||"Nenhuma biografia adicionada"}),Ae.jsxs("div",{className:"flex items-center space-x-6 text-sm text-white/60",children:[(null==(r=null==a?void 0:a.profileData)?void 0:r.phone)&&Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(O,{className:"w-4 h-4"}),Ae.jsx("span",{children:a.profileData.phone})]}),(null==(i=null==a?void 0:a.profileData)?void 0:i.birthDate)&&Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(L,{className:"w-4 h-4"}),Ae.jsx("span",{children:(e=>{if(!e)return"Data não disponível";try{let t;if(e&&"object"==typeof e&&e.toDate)t=e.toDate();else if(e instanceof Date)t=e;else{if("string"!=typeof e&&"number"!=typeof e)return"Data inválida";t=new Date(e)}return isNaN(t.getTime())?"Data inválida":t.toLocaleDateString("pt-BR",{year:"numeric",month:"long",day:"numeric"})}catch(Ly){return"Data inválida"}})(a.profileData.birthDate)})]})]})]})}),!h&&Ae.jsxs("button",{onClick:()=>{m(!0)},className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-colors flex items-center space-x-2",children:[Ae.jsx(oe,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Editar Perfil"})]})]})}),Ae.jsxs("div",{className:"px-8 pb-8",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ae.jsx("h2",{className:"text-2xl font-bold text-white",children:"Posts"}),Ae.jsxs("button",{onClick:F,className:"px-6 py-3 bg-white hover:bg-gray-100 text-black rounded-lg font-medium transition-colors flex items-center space-x-2",children:[Ae.jsx(Y,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Criar Post"})]})]}),y?Ae.jsxs("div",{className:"text-center py-16",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("p",{className:"text-white/60 mt-4",children:"Carregando posts..."})]}):0===b.length?Ae.jsxs("div",{className:"text-center py-16",children:[Ae.jsx("div",{className:"w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4",children:Ae.jsx(z,{className:"w-12 h-12 text-white/30"})}),Ae.jsx("h3",{className:"text-xl text-white/60 mb-2",children:"Nenhum post ainda"}),Ae.jsx("p",{className:"text-white/40 mb-6",children:"Seus posts públicos aparecerão aqui. Posts anônimos não são exibidos no perfil."}),Ae.jsxs("button",{onClick:F,className:"px-6 py-3 bg-white hover:bg-gray-100 text-black rounded-lg font-medium transition-colors flex items-center space-x-2 mx-auto",children:[Ae.jsx(Y,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Criar Primeiro Post"})]})]}):Ae.jsx("div",{className:"space-y-6",children:b.map(t=>Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6",children:[Ae.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center",children:t.avatar?Ae.jsx("img",{src:t.avatar,alt:t.author,className:"w-10 h-10 rounded-full"}):Ae.jsx(S,{className:"w-5 h-5 text-white/70"})}),Ae.jsxs("div",{children:[Ae.jsx("h4",{className:"font-medium text-white",children:t.author}),Ae.jsx("p",{className:"text-sm text-white/50",children:B(t.createdAt)})]})]}),Ae.jsx("button",{onClick:()=>{return n=t.id,p(e,null,function*(){if(window.confirm("Tem certeza que deseja deletar este post?"))try{(yield c(n))&&v(e=>e.filter(e=>e.id!==n))}catch(Ly){}});var n},className:"p-2 text-white/50 hover:text-red-400 transition-colors rounded-full hover:bg-white/10",children:Ae.jsx(le,{className:"w-4 h-4"})})]}),Ae.jsx("p",{className:"text-white/90 leading-relaxed mb-4",children:t.content}),t.tags&&t.tags.length>0&&Ae.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((e,t)=>Ae.jsx("span",{className:"inline-flex items-center space-x-1 bg-white/10 text-white/70 px-3 py-1 rounded-full text-sm",children:Ae.jsxs("span",{children:["#",e]})},t))})]},t.id))})]}),g&&Ae.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ae.jsx("h3",{className:"text-xl font-medium text-white",children:"Criar Novo Post"}),Ae.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:Ae.jsx(V,{className:"w-5 h-5 text-white/70"})})]}),Ae.jsx(cy,{onPostCreated:t=>p(e,null,function*(){try{if(yield l(t)){x(!1);try{const e=yield qb.getUserPosts(a.uid);v(e)}catch(Ly){const n=d(u({id:Date.now().toString()},t),{createdAt:new Date,likes:[],commentCount:0,shares:0,isEdited:!1});v(e=>[n,...e])}}}catch(Ly){}}),onCancel:()=>x(!1),isModal:!0})]})}),Ae.jsx("input",{ref:C,type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t)try{gy.validateFileType(t),gy.validateFileSize(t,2);const e=new FileReader;e.onload=e=>{E(e.target.result)},e.readAsDataURL(t)}catch(Ly){alert(Ly.message),e.target.value=""}},className:"hidden"}),Ae.jsx("input",{ref:_,type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t)try{gy.validateFileType(t),gy.validateFileSize(t,5);const e=new FileReader;e.onload=e=>{T(e.target.result)},e.readAsDataURL(t)}catch(Ly){alert(Ly.message),e.target.value=""}},className:"hidden"})]}):Ae.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Ae.jsxs("div",{className:"text-center",children:[Ae.jsx("div",{className:"w-24 h-24 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:Ae.jsx(S,{className:"w-12 h-12 text-red-400"})}),Ae.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Usuário não autenticado"}),Ae.jsx("p",{className:"text-white/60",children:"Faça login para acessar seu perfil"})]})})},by=()=>{const{userId:t}=bt(),n=xt(),{user:s}=Tb();f.useState(null);const[r,i]=f.useState(null),[a,o]=f.useState([]),[l,c]=f.useState(!0),[h,m]=f.useState(!1),[g,x]=f.useState(!1),[v,y]=f.useState(!1),[w,N]=f.useState(""),[j,C]=f.useState(""),[_,E]=f.useState(!1),[I,T]=f.useState({displayName:"",bio:"",location:"",website:"",birthDate:""});f.useEffect(()=>{p(e,null,function*(){try{const e=Cb.currentUser;let s=t||(null==e?void 0:e.uid);if(!s)return void n("/login");let r=s,a=null;const l=Mg(kb,"users",s),c=yield Fx(l);if(c.exists())r=s,a=c.data();else if(t){const e=wx(Og(kb,"users"),jx("username","==",t)),n=yield $x(e);if(!n.empty){const e=n.docs[0];r=e.id,a=e.data()}}if(E((null==e?void 0:e.uid)===r),a)i(a),T({displayName:a.displayName||"",bio:a.bio||"",location:a.location||"",website:a.website||"",birthDate:a.birthDate||""});else if(t){const e=decodeURIComponent(t).replace(/-/g," ");i({displayName:e,username:t}),T(t=>d(u({},t),{displayName:e})),r=t}const h=wx(Og(kb,"posts"),jx("userId","==",r),kx("createdAt","desc")),m=(yield $x(h)).docs.map(e=>u({id:e.id},e.data()));o(m)}catch(e){N("Erro ao carregar dados do perfil")}finally{c(!1)}})},[t,n]);const A=e=>{const{name:t,value:n}=e.target;T(e=>d(u({},e),{[t]:n}))},R=e=>e?new Date(e).toLocaleDateString("pt-BR",{year:"numeric",month:"long",day:"numeric"}):"",D=e=>{if(!e)return"";const t=new Date(e),n=new Date,s=Math.floor((n-t)/36e5);return s<1?"Agora mesmo":s<24?`${s}h`:s<48?"Ontem":t.toLocaleDateString("pt-BR",{day:"numeric",month:"short"})};return l?Ae.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Ae.jsx("div",{className:"text-white",children:"Carregando perfil..."})}):Ae.jsxs("div",{className:"min-h-screen bg-black text-white",children:[Ae.jsx("div",{className:"bg-black/95 backdrop-blur-sm border-b border-white/10 sticky top-0 z-50",children:Ae.jsx("div",{className:"max-w-2xl mx-auto px-4",children:Ae.jsxs("div",{className:"flex items-center justify-between h-16",children:[Ae.jsxs("button",{onClick:()=>n(-1),className:"flex items-center space-x-2 text-white/70 hover:text-white transition-colors",children:[Ae.jsx(k,{className:"w-5 h-5"}),Ae.jsx("span",{children:"Voltar"})]}),Ae.jsx("h1",{className:"text-xl font-light",children:"Perfil"}),Ae.jsx("div",{className:"w-20"})]})})}),Ae.jsxs("div",{className:"max-w-2xl mx-auto",children:[w&&Ae.jsx("div",{className:"mx-4 mt-4 p-4 bg-red-500/20 border border-red-500/30 rounded-xl text-red-300",children:w}),j&&Ae.jsx("div",{className:"mx-4 mt-4 p-4 bg-green-500/20 border border-green-500/30 rounded-xl text-green-300",children:j}),Ae.jsx("div",{className:"relative h-48 bg-white",children:_&&Ae.jsxs("label",{className:"absolute top-4 right-4 bg-black/50 hover:bg-black/70 p-2 rounded-full cursor-pointer transition-all duration-300 backdrop-blur-md",children:[Ae.jsx("input",{type:"file",accept:"image/*",onChange:t=>p(e,null,function*(){if(t.target.files[0]){y(!0);try{C("Banner atualizado com sucesso!")}catch(e){N("Erro ao fazer upload do banner")}finally{y(!1)}}}),className:"hidden",disabled:v}),v?Ae.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):Ae.jsx(U,{className:"w-5 h-5 text-white"})]})}),Ae.jsxs("div",{className:"px-4 -mt-16 relative z-10",children:[Ae.jsxs("div",{className:"relative inline-block",children:[Ae.jsx("div",{className:"w-32 h-32 rounded-full bg-white/10 border-4 border-black overflow-hidden",children:(null==r?void 0:r.photoURL)?Ae.jsx("img",{src:r.photoURL,alt:"Foto de perfil",className:"w-full h-full object-cover"}):Ae.jsx(S,{className:"w-full h-full text-white/50 p-8"})}),_&&Ae.jsxs("label",{className:"absolute bottom-0 right-0 bg-black/50 hover:bg-black/70 p-2 rounded-full cursor-pointer transition-all duration-300 backdrop-blur-md",children:[Ae.jsx("input",{type:"file",accept:"image/*",onChange:t=>p(e,null,function*(){var e,n;const r=t.target.files[0];if(r){x(!0);try{const t=null==(e=null==s?void 0:s.backend)?void 0:e.id,i=(null==s?void 0:s.idToken)||(yield null==(n=Cb.currentUser)?void 0:n.getIdToken());if(!t)throw new Error("Usuário do backend não identificado");yield gy.uploadProfilePhoto(r,t,i),C("Foto de perfil atualizada com sucesso!")}catch(i){N("Erro ao fazer upload da foto")}finally{x(!1)}}}),className:"hidden",disabled:g}),g?Ae.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):Ae.jsx($,{className:"w-5 h-5 text-white"})]})]}),_&&Ae.jsx("div",{className:"flex justify-end mt-4",children:h?Ae.jsxs("div",{className:"flex space-x-2",children:[Ae.jsxs("button",{onClick:()=>p(e,null,function*(){try{N(""),C("");const e=Cb.currentUser;if(!e)return;const t=Mg(kb,"users",e.uid);yield Bx(t,d(u({},I),{updatedAt:new Date})),C("Perfil atualizado com sucesso!"),m(!1),i(e=>u(u({},e),I))}catch(e){N("Erro ao atualizar perfil. Tente novamente.")}}),className:"bg-white text-black px-4 py-2 rounded-full font-medium hover:bg-white/90 transition-all duration-300 flex items-center space-x-2",children:[Ae.jsx(ge,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Salvar"})]}),Ae.jsxs("button",{onClick:()=>m(!1),className:"bg-transparent border border-white/30 text-white px-4 py-2 rounded-full font-medium hover:bg-white/10 transition-all duration-300 flex items-center space-x-2",children:[Ae.jsx(V,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Cancelar"})]})]}):Ae.jsxs("button",{onClick:()=>m(!0),className:"bg-transparent border border-white/30 text-white px-4 py-2 rounded-full font-medium hover:bg-white/10 transition-all duration-300 flex items-center space-x-2",children:[Ae.jsx(oe,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Editar perfil"})]})}),Ae.jsxs("div",{className:"mt-4",children:[Ae.jsx("h2",{className:"text-2xl font-bold",children:h?Ae.jsx("input",{type:"text",name:"displayName",value:I.displayName,onChange:A,className:"bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 w-full",placeholder:"Seu nome"}):(null==r?void 0:r.displayName)||"Usuário"}),Ae.jsxs("p",{className:"text-white/70 mt-1",children:["@",(null==r?void 0:r.username)||"usuario"]}),h?Ae.jsx("textarea",{name:"bio",value:I.bio,onChange:A,rows:3,className:"mt-4 bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 w-full resize-none",placeholder:"Conte um pouco sobre você..."}):Ae.jsx("p",{className:"text-white mt-4",children:(null==r?void 0:r.bio)||"Nenhuma biografia adicionada"}),Ae.jsx("div",{className:"mt-4 space-y-2",children:h?Ae.jsxs(Ae.Fragment,{children:[Ae.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Ae.jsx(xe,{className:"w-4 h-4"}),Ae.jsx("input",{type:"text",name:"location",value:I.location,onChange:A,className:"bg-transparent border-none text-white/70 placeholder-white/50 focus:outline-none focus:ring-0 flex-1",placeholder:"Adicionar localização"})]}),Ae.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Ae.jsx(be,{className:"w-4 h-4"}),Ae.jsx("input",{type:"url",name:"website",value:I.website,onChange:A,className:"bg-transparent border-none text-white/70 placeholder-white/50 focus:outline-none focus:ring-0 flex-1",placeholder:"Adicionar website"})]}),Ae.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Ae.jsx(L,{className:"w-4 h-4"}),Ae.jsx("input",{type:"date",name:"birthDate",value:I.birthDate,onChange:A,className:"bg-transparent border-none text-white/70 placeholder-white/50 focus:outline-none focus:ring-0 flex-1"})]})]}):Ae.jsxs(Ae.Fragment,{children:[(null==r?void 0:r.location)&&Ae.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Ae.jsx(xe,{className:"w-4 h-4"}),Ae.jsx("span",{children:r.location})]}),(null==r?void 0:r.website)&&Ae.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Ae.jsx(be,{className:"w-4 h-4"}),Ae.jsx("a",{href:r.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline",children:r.website})]}),(null==r?void 0:r.birthDate)&&Ae.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Ae.jsx(L,{className:"w-4 h-4"}),Ae.jsxs("span",{children:["Nascido em ",R(r.birthDate)]})]})]})}),Ae.jsxs("div",{className:"mt-4 text-white/70",children:["Entrou em ",R(null==r?void 0:r.createdAt)]})]})]}),Ae.jsxs("div",{className:"mt-8 border-t border-white/10",children:[Ae.jsx("div",{className:"px-4 py-4",children:Ae.jsx("h3",{className:"text-xl font-bold",children:"Posts"})}),0===a.length?Ae.jsxs("div",{className:"px-4 py-8 text-center",children:[Ae.jsx("p",{className:"text-white/50",children:"Nenhum post ainda"}),Ae.jsx("p",{className:"text-white/30 text-sm mt-2",children:"Quando você postar algo, aparecerá aqui"})]}):Ae.jsx("div",{className:"space-y-0",children:a.map(e=>Ae.jsx("div",{className:"border-b border-white/10 p-4 hover:bg-white/5 transition-colors",children:Ae.jsxs("div",{className:"flex space-x-3",children:[Ae.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full flex items-center justify-center flex-shrink-0",children:(null==r?void 0:r.photoURL)?Ae.jsx("img",{src:r.photoURL,alt:"",className:"w-full h-full rounded-full object-cover"}):Ae.jsx(S,{className:"w-6 h-6 text-white/50"})}),Ae.jsxs("div",{className:"flex-1 min-w-0",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[Ae.jsx("span",{className:"font-bold text-white",children:(null==r?void 0:r.displayName)||"Usuário"}),Ae.jsxs("span",{className:"text-white/50",children:["@",(null==r?void 0:r.username)||"usuario"]}),Ae.jsx("span",{className:"text-white/50",children:"•"}),Ae.jsx("span",{className:"text-white/50",children:D(e.createdAt)})]}),Ae.jsx("p",{className:"text-white mb-3",children:e.content}),e.image&&Ae.jsx("div",{className:"mb-3 rounded-xl overflow-hidden",children:Ae.jsx("img",{src:e.image,alt:"",className:"w-full max-h-96 object-cover"})}),Ae.jsxs("div",{className:"flex items-center space-x-8 text-white/50",children:[Ae.jsxs("button",{className:"flex items-center space-x-2 hover:text-blue-400 transition-colors",children:[Ae.jsx(b,{className:"w-5 h-5"}),Ae.jsx("span",{children:e.commentCount||0})]}),Ae.jsxs("button",{className:"flex items-center space-x-2 hover:text-red-400 transition-colors",children:[Ae.jsx(ie,{className:"w-5 h-5"}),Ae.jsx("span",{children:Array.isArray(e.likes)?e.likes.length:0})]}),Ae.jsx("button",{className:"flex items-center space-x-2 hover:text-green-400 transition-colors",children:Ae.jsx(ve,{className:"w-5 h-5"})})]})]})]})},e.id))})]})]})]})},vy=()=>{const{groupId:t}=bt(),n=xt(),[s,r]=f.useState(null),[i,a]=f.useState([]),[o,l]=f.useState(!0),[c,h]=f.useState(null),[m,g]=f.useState(null),[x,v]=f.useState(!1),[y,w]=f.useState(!1),[N,_]=f.useState(!1),[E,S]=f.useState(!1),[I,T]=f.useState(""),[A,R]=f.useState(""),[D,P]=f.useState("all"),O={id:t,name:"Ansiedade & Estresse",description:"Um grupo de apoio para pessoas que lidam com ansiedade e estresse no dia a dia. Compartilhe suas experiências, receba apoio e aprenda estratégias de enfrentamento.",avatar:null,memberCount:1247,postCount:89,createdAt:new Date("2024-01-15"),rules:["Respeite todos os membros","Mantenha as discussões focadas no tema do grupo","Não compartilhe informações pessoais de outros","Seja gentil e acolhedor","Reporte comportamentos inadequados"],tags:["ansiedade","estresse","saúde mental","apoio","bem-estar"],privacy:"public",category:"Saúde Mental",location:"Online",meetingSchedule:"Toda quarta-feira às 20h",admins:["admin1","admin2"],members:["user1","user2","user3"]},M=[{id:1,author:{id:"user1",name:"Maria Santos",avatar:null},content:"Hoje foi um dia difícil no trabalho. A ansiedade estava muito alta durante uma reunião importante. Alguém tem alguma técnica de respiração que funcione bem para vocês?",timestamp:new Date(Date.now()-18e5),likes:12,comments:8,liked:!1,tags:["ansiedade","trabalho","técnicas"]},{id:2,author:{id:"user2",name:"João Silva",avatar:null},content:"Queria compartilhar uma vitória pessoal: consegui fazer uma apresentação em público sem ter um ataque de pânico! A terapia e os exercícios de mindfulness estão funcionando. Obrigado a todos pelo apoio!",timestamp:new Date(Date.now()-72e5),likes:45,comments:15,liked:!0,tags:["vitória","mindfulness","terapia"]},{id:3,author:{id:"user3",name:"Ana Costa",avatar:null},content:"Alguém já experimentou meditação guiada? Estou pensando em começar mas não sei por onde começar. Alguma recomendação de app ou canal no YouTube?",timestamp:new Date(Date.now()-144e5),likes:8,comments:12,liked:!1,tags:["meditação","dicas","apps"]}];f.useEffect(()=>{p(e,null,function*(){try{const e=auth.currentUser;if(!e)return void n("/login");h(e);const t=doc(db,"users",e.uid),s=yield getDoc(t);if(s.exists()){const t=s.data();g(t),v(O.members.includes(e.uid)),w(O.admins.includes(e.uid))}r(O),a(M)}catch(Ly){}finally{l(!1)}})},[t,n]);const U=i.filter(e=>{const t=e.content.toLowerCase().includes(A.toLowerCase())||e.author.name.toLowerCase().includes(A.toLowerCase()),n="all"===D||"popular"===D&&(Array.isArray(e.likes)?e.likes.length:0)>10||"recent"===D&&e.timestamp>new Date(Date.now()-864e5);return t&&n});return o?Ae.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Ae.jsx("div",{className:"text-white",children:"Carregando grupo..."})}):Ae.jsxs("div",{className:"min-h-screen bg-black text-white",children:[Ae.jsx("div",{className:"bg-black/95 backdrop-blur-sm border-b border-white/10 sticky top-0 z-50",children:Ae.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:Ae.jsxs("div",{className:"flex items-center justify-between h-16",children:[Ae.jsxs("button",{onClick:()=>n("/home"),className:"flex items-center space-x-2 text-white/70 hover:text-white transition-colors",children:[Ae.jsx(k,{className:"w-5 h-5"}),Ae.jsx("span",{children:"Voltar"})]}),Ae.jsx("h1",{className:"text-xl font-light",children:s.name}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[y&&Ae.jsx("button",{onClick:()=>S(!0),className:"text-white/70 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",children:Ae.jsx(C,{className:"w-5 h-5"})}),Ae.jsx("button",{className:"text-white/70 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",children:Ae.jsx(ae,{className:"w-5 h-5"})})]})]})})}),Ae.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[Ae.jsx("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-8 mb-8 backdrop-blur-md",children:Ae.jsxs("div",{className:"flex flex-col lg:flex-row items-start space-y-6 lg:space-y-0 lg:space-x-8",children:[Ae.jsx("div",{className:"w-32 h-32 rounded-2xl bg-white/10 border border-white/20 flex items-center justify-center flex-shrink-0",children:s.avatar?Ae.jsx("img",{src:s.avatar,alt:s.name,className:"w-full h-full object-cover rounded-2xl"}):Ae.jsx(j,{className:"w-16 h-16 text-white/50"})}),Ae.jsx("div",{className:"flex-1",children:Ae.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Ae.jsxs("div",{children:[Ae.jsx("h2",{className:"text-3xl font-light mb-2",children:s.name}),Ae.jsx("p",{className:"text-white/70 text-lg mb-4",children:s.description}),Ae.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:s.tags.map((e,t)=>Ae.jsxs("span",{className:"bg-white/10 px-3 py-1 rounded-full text-sm text-white/80",children:["#",e]},t))}),Ae.jsxs("div",{className:"flex items-center space-x-6 text-sm text-white/60",children:[Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(j,{className:"w-4 h-4"}),Ae.jsxs("span",{children:[s.memberCount," membros"]})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(b,{className:"w-4 h-4"}),Ae.jsxs("span",{children:[s.postCount," posts"]})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(L,{className:"w-4 h-4"}),Ae.jsxs("span",{children:["Criado em ",s.createdAt.toLocaleDateString("pt-BR")]})]})]})]}),Ae.jsxs("div",{className:"flex flex-col space-y-3",children:[x?Ae.jsxs("button",{onClick:()=>p(e,null,function*(){try{v(!1),r(e=>d(u({},e),{memberCount:e.memberCount-1}))}catch(Ly){}}),className:"bg-red-600/20 border border-red-500/30 text-red-300 px-6 py-2 rounded-xl font-light hover:bg-red-600/30 transition-all duration-300",children:[Ae.jsx(ye,{className:"w-4 h-4 inline mr-2"}),"Sair do Grupo"]}):Ae.jsxs("button",{onClick:()=>_(!0),className:"bg-white text-black px-6 py-2 rounded-xl font-light hover:bg-white/90 transition-all duration-300",children:[Ae.jsx(we,{className:"w-4 h-4 inline mr-2"}),"Entrar no Grupo"]}),Ae.jsxs("button",{className:"bg-white/10 border border-white/30 text-white px-6 py-2 rounded-xl font-light hover:bg-white/20 transition-all duration-300",children:[Ae.jsx(ve,{className:"w-4 h-4 inline mr-2"}),"Compartilhar"]})]})]})})]})}),Ae.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:[Ae.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-md",children:[Ae.jsx("h3",{className:"text-xl font-light mb-4",children:"Regras do Grupo"}),Ae.jsx("ul",{className:"space-y-2 text-sm text-white/80",children:s.rules.map((e,t)=>Ae.jsxs("li",{className:"flex items-start space-x-2",children:[Ae.jsx("span",{className:"text-white/50 mt-1",children:"•"}),Ae.jsx("span",{children:e})]},t))})]}),Ae.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-md",children:[Ae.jsx("h3",{className:"text-xl font-light mb-4",children:"Encontros"}),Ae.jsxs("div",{className:"space-y-3 text-sm text-white/80",children:[Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(L,{className:"w-4 h-4 text-white/50"}),Ae.jsx("span",{children:s.meetingSchedule})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(xe,{className:"w-4 h-4 text-white/50"}),Ae.jsx("span",{children:s.location})]})]})]}),Ae.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-md",children:[Ae.jsx("h3",{className:"text-xl font-light mb-4",children:"Estatísticas"}),Ae.jsxs("div",{className:"space-y-3 text-sm text-white/80",children:[Ae.jsxs("div",{className:"flex justify-between",children:[Ae.jsx("span",{children:"Membros ativos:"}),Ae.jsx("span",{className:"text-white",children:"1,247"})]}),Ae.jsxs("div",{className:"flex justify-between",children:[Ae.jsx("span",{children:"Posts esta semana:"}),Ae.jsx("span",{className:"text-white",children:"23"})]}),Ae.jsxs("div",{className:"flex justify-between",children:[Ae.jsx("span",{children:"Novos membros:"}),Ae.jsx("span",{className:"text-white",children:"+12"})]})]})]})]}),Ae.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-md",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ae.jsx("h3",{className:"text-xl font-light",children:"Discussões"}),Ae.jsxs("div",{className:"flex items-center space-x-4",children:[Ae.jsxs("div",{className:"relative",children:[Ae.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50 w-4 h-4"}),Ae.jsx("input",{type:"text",placeholder:"Pesquisar posts...",value:A,onChange:e=>R(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg pl-10 pr-4 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 text-sm"})]}),Ae.jsxs("select",{value:D,onChange:e=>P(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/30 text-sm",children:[Ae.jsx("option",{value:"all",children:"Todos"}),Ae.jsx("option",{value:"recent",children:"Recentes"}),Ae.jsx("option",{value:"popular",children:"Populares"})]})]})]}),x&&Ae.jsxs("div",{className:"bg-white/5 border border-white/20 rounded-xl p-4 mb-6",children:[Ae.jsx("textarea",{placeholder:"Compartilhe algo com o grupo...",value:I,onChange:e=>T(e.target.value),rows:3,className:"w-full bg-transparent border-none text-white placeholder-white/50 focus:outline-none resize-none"}),Ae.jsxs("div",{className:"flex items-center justify-between mt-3",children:[Ae.jsx("div",{className:"text-xs text-white/50",children:"Use #hashtags para categorizar seu post"}),Ae.jsx("button",{onClick:()=>p(e,null,function*(){if(I.trim())try{const e={id:Date.now(),author:{id:c.uid,name:(null==m?void 0:m.displayName)||c.displayName||"Usuário",avatar:c.photoURL},content:I,timestamp:new Date,likes:0,comments:0,liked:!1,tags:[]};a(t=>[e,...t]),T(""),r(e=>d(u({},e),{postCount:e.postCount+1}))}catch(Ly){}}),disabled:!I.trim(),className:"bg-white text-black px-4 py-2 rounded-lg font-light hover:bg-white/90 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:"Publicar"})]})]}),Ae.jsx("div",{className:"space-y-4",children:0===U.length?Ae.jsxs("div",{className:"text-center py-12",children:[Ae.jsx(b,{className:"w-16 h-16 text-white/20 mx-auto mb-4"}),Ae.jsx("p",{className:"text-white/50 text-lg",children:"Nenhum post encontrado"}),Ae.jsx("p",{className:"text-white/30 text-sm mt-2",children:A||"all"!==D?"Tente ajustar os filtros de busca":"Seja o primeiro a iniciar uma discussão!"})]}):U.map(e=>Ae.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 backdrop-blur-md",children:Ae.jsxs("div",{className:"flex items-start space-x-3",children:[Ae.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:e.author.avatar?Ae.jsx("img",{src:e.author.avatar,alt:"",className:"w-full h-full rounded-full"}):Ae.jsx("span",{className:"text-white/70",children:e.author.name.charAt(0)})}),Ae.jsxs("div",{className:"flex-1 min-w-0",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Ae.jsx("span",{className:"font-medium text-white",children:e.author.name}),Ae.jsxs("span",{className:"text-white/50 text-sm",children:[e.timestamp.toLocaleDateString("pt-BR")," às ",e.timestamp.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]}),Ae.jsx("p",{className:"text-white/90 mb-3 leading-relaxed",children:e.content}),e.tags.length>0&&Ae.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:e.tags.map((e,t)=>Ae.jsxs("span",{className:"bg-white/10 px-2 py-1 rounded-full text-xs text-white/60",children:["#",e]},t))}),Ae.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[Ae.jsxs("button",{onClick:()=>{return t=e.id,void a(e=>e.map(e=>e.id===t?d(u({},e),{liked:!e.liked,likes:e.liked?Array.isArray(e.likes)?e.likes.filter(e=>"current-user"!==e):[]:Array.isArray(e.likes)?[...e.likes,"current-user"]:["current-user"]}):e));var t},className:"flex items-center space-x-1 transition-colors "+(e.liked?"text-red-400":"text-white/60 hover:text-white"),children:[Ae.jsx(ie,{className:"w-4 h-4 "+(e.liked?"fill-current":"")}),Ae.jsx("span",{children:Array.isArray(e.likes)?e.likes.length:0})]}),Ae.jsxs("button",{className:"flex items-center space-x-1 text-white/60 hover:text-white transition-colors",children:[Ae.jsx(b,{className:"w-4 h-4"}),Ae.jsx("span",{children:e.commentCount||0})]}),Ae.jsx("button",{className:"text-white/60 hover:text-white transition-colors",children:Ae.jsx(ve,{className:"w-4 h-4"})})]})]})]})},e.id))})]})]}),N&&Ae.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:Ae.jsxs("div",{className:"bg-black/95 border border-white/10 rounded-2xl p-6 max-w-md w-full",children:[Ae.jsx("h3",{className:"text-xl font-light mb-4",children:"Entrar no Grupo"}),Ae.jsxs("p",{className:"text-white/70 mb-6",children:['Você está prestes a entrar no grupo "',s.name,'". Ao entrar, você concorda em seguir as regras do grupo e manter um ambiente respeitoso.']}),Ae.jsxs("div",{className:"flex space-x-3",children:[Ae.jsx("button",{onClick:()=>p(e,null,function*(){try{v(!0),_(!1),r(e=>d(u({},e),{memberCount:e.memberCount+1}))}catch(Ly){}}),className:"bg-white text-black px-4 py-2 rounded-xl font-light hover:bg-white/90 transition-all duration-300 flex-1",children:"Entrar no Grupo"}),Ae.jsx("button",{onClick:()=>_(!1),className:"bg-transparent border border-white/30 text-white px-4 py-2 rounded-xl font-light hover:bg-white/10 transition-all duration-300",children:"Cancelar"})]})]})}),E&&Ae.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:Ae.jsxs("div",{className:"bg-black/95 border border-white/10 rounded-2xl p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ae.jsx("h3",{className:"text-xl font-light",children:"Configurações do Grupo"}),Ae.jsx("button",{onClick:()=>S(!1),className:"text-white/50 hover:text-white transition-colors",children:Ae.jsx(V,{className:"w-5 h-5"})})]}),Ae.jsxs("div",{className:"space-y-6",children:[Ae.jsxs("div",{children:[Ae.jsx("h4",{className:"text-lg font-light mb-3",children:"Informações Básicas"}),Ae.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm mb-2",children:"Nome do Grupo"}),Ae.jsx("input",{type:"text",defaultValue:s.name,className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm mb-2",children:"Categoria"}),Ae.jsx("input",{type:"text",defaultValue:s.category,className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"})]})]})]}),Ae.jsxs("div",{children:[Ae.jsx("h4",{className:"text-lg font-light mb-3",children:"Descrição"}),Ae.jsx("textarea",{defaultValue:s.description,rows:3,className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 resize-none"})]}),Ae.jsxs("div",{children:[Ae.jsx("h4",{className:"text-lg font-light mb-3",children:"Regras"}),Ae.jsxs("div",{className:"space-y-2",children:[s.rules.map((e,t)=>Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("input",{type:"text",defaultValue:e,className:"flex-1 bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"}),Ae.jsx("button",{className:"text-red-400 hover:text-red-300 p-1",children:Ae.jsx(le,{className:"w-4 h-4"})})]},t)),Ae.jsx("button",{className:"text-white/70 hover:text-white text-sm",children:"+ Adicionar regra"})]})]}),Ae.jsxs("div",{className:"flex space-x-3",children:[Ae.jsx("button",{className:"bg-white text-black px-4 py-2 rounded-xl font-light hover:bg-white/90 transition-all duration-300 flex-1",children:"Salvar Alterações"}),Ae.jsx("button",{onClick:()=>S(!1),className:"bg-transparent border border-white/30 text-white px-4 py-2 rounded-xl font-light hover:bg-white/10 transition-all duration-300",children:"Cancelar"})]})]})]})})]})},yy=()=>{const[t,n]=f.useState([]),[s,r]=f.useState([]),[i,a]=f.useState(""),[o,l]=f.useState("all"),[c,h]=f.useState(!1),[m,g]=f.useState(0);Tb(),f.useEffect(()=>{const e=[{id:"1",name:"Ansiedade e Bem-estar",description:"Grupo de apoio para pessoas que lidam com ansiedade. Compartilhe experiências e aprenda técnicas de relaxamento.",memberCount:127,maxMembers:200,isPrivate:!1,category:"Saúde Mental",tags:["ansiedade","bem-estar","apoio"],createdAt:"2024-01-15",lastActivity:"2024-01-20",isMember:!1,isFeatured:!0,rating:4.8},{id:"2",name:"Psicólogos em Ação",description:"Comunidade exclusiva para psicólogos trocarem experiências e discutirem casos clínicos.",memberCount:45,maxMembers:100,isPrivate:!0,category:"Profissional",tags:["psicologia","casos clínicos","profissional"],createdAt:"2024-01-10",lastActivity:"2024-01-19",isMember:!0,isFeatured:!1,rating:4.9},{id:"3",name:"Meditação e Mindfulness",description:"Aprenda técnicas de meditação e mindfulness para melhorar sua saúde mental e qualidade de vida.",memberCount:89,maxMembers:150,isPrivate:!1,category:"Bem-estar",tags:["meditação","mindfulness","bem-estar"],createdAt:"2024-01-12",lastActivity:"2024-01-18",isMember:!1,isFeatured:!0,rating:4.7},{id:"4",name:"Depressão - Juntos Somos Mais Fortes",description:"Espaço seguro para compartilhar experiências sobre depressão e encontrar apoio mútuo.",memberCount:203,maxMembers:300,isPrivate:!1,category:"Saúde Mental",tags:["depressão","apoio","comunidade"],createdAt:"2024-01-05",lastActivity:"2024-01-21",isMember:!1,isFeatured:!0,rating:4.9},{id:"5",name:"Relacionamentos Saudáveis",description:"Discussões sobre como construir e manter relacionamentos saudáveis e equilibrados.",memberCount:156,maxMembers:250,isPrivate:!1,category:"Relacionamentos",tags:["relacionamentos","saudável","comunicação"],createdAt:"2024-01-08",lastActivity:"2024-01-20",isMember:!1,isFeatured:!1,rating:4.6}],t=e.filter(e=>e.isMember);n(e),r(t)},[]);const x=f.useCallback(()=>p(e,null,function*(){}),[]),b=f.useCallback(()=>p(e,null,function*(){}),[]),v=f.useCallback(t=>p(e,null,function*(){t.preventDefault();try{const e=d(u({},y),{id:Date.now().toString(),memberCount:1,isMember:!0,category:"Personalizado",tags:[],createdAt:(new Date).toISOString().split("T")[0],lastActivity:(new Date).toISOString().split("T")[0],isFeatured:!1,rating:0});n(t=>[e,...t]),r(t=>[e.id,...t]),h(!1),w({name:"",description:"",isPrivate:!1,maxMembers:50}),g(e=>e+1)}catch(Ly){}}),[y]),[y,w]=f.useState({name:"",description:"",isPrivate:!1,maxMembers:50}),N=t.filter(e=>{const t=e.name.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase()),n="all"===o||"public"===o&&!e.isPrivate||"private"===o&&e.isPrivate||"member"===o&&e.isMember||"featured"===o&&e.isFeatured;return t&&n}),j=t.filter(e=>e.isFeatured);return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(Wv,{trigger:m}),Ae.jsx("div",{className:"min-h-screen bg-black py-8 animation-initial animate-fade-in-up animation-delay-100",children:Ae.jsxs("div",{className:"max-w-7xl mx-auto",children:[Ae.jsxs("div",{className:"mb-8 text-center",children:[Ae.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2 section-header",children:"Explorar Grupos da Comunidade"}),Ae.jsx("p",{className:"text-lg text-gray-600",children:"Conecte-se com pessoas que compartilham interesses similares e participe de grupos de apoio"})]}),j.length>0&&Ae.jsxs("div",{className:"mb-8",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Ae.jsx(Ne,{className:"w-6 h-6 text-yellow-500"}),Ae.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Grupos em Destaque"})]}),Ae.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(e=>Ae.jsx(wy,{group:e,onJoin:x,onLeave:b,isUserGroup:e.isMember,isFeatured:!0},e.id))})]}),Ae.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-8",children:[Ae.jsx("div",{className:"flex-1",children:Ae.jsx(Gv,{type:"text",placeholder:"Pesquisar grupos...",value:i,onChange:e=>a(e.target.value),leftIcon:q,className:"w-full"})}),Ae.jsxs("div",{className:"flex gap-2",children:[Ae.jsxs("select",{value:o,onChange:e=>l(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[Ae.jsx("option",{value:"all",children:"Todos os Grupos"}),Ae.jsx("option",{value:"featured",children:"Em Destaque"}),Ae.jsx("option",{value:"public",children:"Grupos Públicos"}),Ae.jsx("option",{value:"private",children:"Grupos Privados"}),Ae.jsx("option",{value:"member",children:"Meus Grupos"})]}),Ae.jsxs("button",{onClick:()=>h(!0),className:"btn-primary flex items-center gap-2",children:[Ae.jsx(Y,{className:"w-5 h-5"}),"Criar Grupo"]})]})]}),s.length>0&&Ae.jsxs("div",{className:"mb-8",children:[Ae.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 section-header",children:"Meus Grupos"}),Ae.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>{const n=t.find(t=>t.id===e);return n?Ae.jsx(wy,{group:n,onLeave:b,isUserGroup:!0},n.id):null})})]}),Ae.jsxs("div",{children:[Ae.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 section-header",children:"member"===o?"Meus Grupos":"Todos os Grupos"}),Ae.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(e=>Ae.jsx(wy,{group:e,onJoin:x,onLeave:b,isUserGroup:e.isMember},e.id))})]}),c&&Ae.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Ae.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[Ae.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Criar Novo Grupo"}),Ae.jsxs("form",{onSubmit:v,className:"space-y-4",children:[Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Grupo"}),Ae.jsx(Gv,{type:"text",value:y.name,onChange:e=>w(t=>d(u({},t),{name:e.target.value})),placeholder:"Digite o nome do grupo",required:!0})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição"}),Ae.jsx("textarea",{value:y.description,onChange:e=>w(t=>d(u({},t),{description:e.target.value})),placeholder:"Descreva o propósito do grupo",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",required:!0})]}),Ae.jsx("div",{className:"flex items-center gap-4",children:Ae.jsxs("label",{className:"flex items-center",children:[Ae.jsx("input",{type:"checkbox",checked:y.isPrivate,onChange:e=>w(t=>d(u({},t),{isPrivate:e.target.checked})),className:"mr-2"}),"Grupo Privado"]})}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Máximo de Membros"}),Ae.jsx(Gv,{type:"number",value:y.maxMembers,onChange:e=>w(t=>d(u({},t),{maxMembers:parseInt(e.target.value)})),min:"2",max:"1000"})]}),Ae.jsxs("div",{className:"flex gap-3 pt-4",children:[Ae.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),Ae.jsx("button",{type:"submit",className:"flex-1 btn-primary",children:"Criar Grupo"})]})]})]})})]})})]})},wy=({group:e,onJoin:t,onLeave:n,isUserGroup:s,isFeatured:r=!1})=>Ae.jsx(ty,{className:"group hover:shadow-lg transition-all duration-300",children:Ae.jsxs("div",{className:"p-6",children:[Ae.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Ae.jsxs("div",{className:"flex items-center gap-2",children:[Ae.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center",children:Ae.jsx(j,{className:"w-5 h-5 text-black"})}),Ae.jsxs("div",{children:[Ae.jsx("h3",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:e.name}),Ae.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.isPrivate?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(A,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Privado"})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(je,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Público"})]}),r&&Ae.jsx(Ne,{className:"w-4 h-4 text-yellow-500"})]})]})]}),e.isMember&&Ae.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:"Membro"})]}),Ae.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3",children:e.description}),Ae.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[Ae.jsxs("span",{children:[e.memberCount,"/",e.maxMembers," membros"]}),Ae.jsxs("div",{className:"flex items-center gap-2",children:[Ae.jsx(Ne,{className:"w-4 h-4 text-yellow-500"}),Ae.jsx("span",{children:e.rating})]})]}),Ae.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:e.tags.slice(0,3).map((e,t)=>Ae.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e},t))}),Ae.jsx("div",{className:"flex gap-2",children:s?Ae.jsx("button",{onClick:()=>n(e.id),className:"flex-1 px-4 py-2 border border-red-300 text-red-700 rounded-lg hover:bg-red-50 transition-colors",children:"Sair do Grupo"}):Ae.jsx("button",{onClick:()=>t(e.id),className:"flex-1 btn-primary",children:"Entrar no Grupo"})})]})}),Ny=()=>{var e;const t=xt(),[n,s]=f.useState([]),[r,i]=f.useState([]),[a,o]=f.useState(""),[l,c]=f.useState("all"),[u,d]=f.useState("popular"),[h,m]=f.useState(!0),[p,g]=f.useState([]),x=[{id:1,name:"Ansiedade ",description:"Um espaço seguro para compartilhar experiências sobre ansiedade e encontrar apoio mútuo. Dicas, técnicas de respiração e muito mais.",icon:"🧘",memberCount:1250,category:"mental-health",isPrivate:!1,createdAt:new Date(2023,5,15),tags:["ansiedade","bem-estar","respiração","mindfulness"],lastActivity:new Date(Date.now()-72e5),moderators:["Dr. Ana Silva","Psic. Carlos Santos"],rules:["Seja respeitoso","Não dê conselhos médicos","Compartilhe experiências pessoais"]},{id:2,name:"Apoio Emocional",description:"Comunidade de apoio para pessoas que lidam com depressão. Aqui você não está sozinho(a).",icon:"🌱",memberCount:980,category:"mental-health",isPrivate:!1,createdAt:new Date(2023,4,10),tags:["depressão","apoio","suporte","recovery"],lastActivity:new Date(Date.now()-36e5),moderators:["Dra. Maria Costa"],rules:["Ambiente seguro","Sem julgamentos","Apoio mútuo"]},{id:3,name:"Meditação Diária",description:"Pratique meditação em grupo e compartilhe suas experiências de mindfulness.",icon:"🕯️",memberCount:750,category:"wellness",isPrivate:!1,createdAt:new Date(2023,3,20),tags:["meditação","mindfulness","paz","relaxamento"],lastActivity:new Date(Date.now()-108e5),moderators:["Mestre João"],rules:["Prática diária","Compartilhe experiências","Respeite o silêncio"]},{id:4,name:"Relacionamentos Saudáveis",description:"Discussões sobre relacionamentos, comunicação e desenvolvimento pessoal.",icon:"💝",memberCount:650,category:"relationships",isPrivate:!1,createdAt:new Date(2023,6,5),tags:["relacionamentos","comunicação","amor","família"],lastActivity:new Date(Date.now()-18e5),moderators:["Terapeuta Ana"],rules:["Respeito mútuo","Sem ataques pessoais","Compartilhe com responsabilidade"]},{id:5,name:"Autoestima e Confiança",description:"Construindo amor próprio e confiança juntos. Exercícios práticos e apoio.",icon:"⭐",memberCount:820,category:"self-improvement",isPrivate:!1,createdAt:new Date(2023,2,12),tags:["autoestima","confiança","amor próprio","crescimento"],lastActivity:new Date(Date.now()-27e5),moderators:["Coach Laura"],rules:["Positividade","Sem comparações","Celebre conquistas"]},{id:6,name:"Pais e Filhos",description:"Comunidade para pais compartilharem experiências na criação dos filhos.",icon:"👨‍👩‍👧‍👦",memberCount:1100,category:"family",isPrivate:!1,createdAt:new Date(2023,1,8),tags:["paternidade","filhos","educação","família"],lastActivity:new Date(Date.now()-12e5),moderators:["Psic. Infantil Maria"],rules:["Experiências construtivas","Sem julgamentos","Apoio parental"]},{id:7,name:"Carreira e Burnout",description:"Discussões sobre vida profissional, estresse no trabalho e equilíbrio.",icon:"💼",memberCount:890,category:"career",isPrivate:!1,createdAt:new Date(2023,7,18),tags:["carreira","burnout","trabalho","estresse"],lastActivity:new Date(Date.now()-144e5),moderators:["Coach Pedro"],rules:["Confidencialidade","Apoio profissional","Sem spam"]},{id:8,name:"Grupo VIP - Terapia",description:"Grupo privado para discussões mais profundas sobre terapia e crescimento.",icon:"🔒",memberCount:45,category:"therapy",isPrivate:!0,createdAt:new Date(2023,0,25),tags:["terapia","privado","crescimento","suporte"],lastActivity:new Date(Date.now()-36e5),moderators:["Dr. Ricardo"],rules:["Máxima confidencialidade","Aprovação necessária","Compromisso sério"]}],b=[{id:"all",name:"Todas",icon:je},{id:"mental-health",name:"Saúde Mental",icon:"🧠"},{id:"wellness",name:"Bem-estar",icon:"🌿"},{id:"relationships",name:"Relacionamentos",icon:"💕"},{id:"self-improvement",name:"Desenvolvimento",icon:"📈"},{id:"family",name:"Família",icon:"👨‍👩‍👧‍👦"},{id:"career",name:"Carreira",icon:"💼"},{id:"therapy",name:"Terapia",icon:"🔒"}];f.useEffect(()=>{setTimeout(()=>{s(x),i(x),m(!1)},1e3)},[]),f.useEffect(()=>{let e=n;switch("all"!==l&&(e=e.filter(e=>e.category===l)),a&&(e=e.filter(e=>e.name.toLowerCase().includes(a.toLowerCase())||e.description.toLowerCase().includes(a.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(a.toLowerCase())))),u){case"popular":e.sort((e,t)=>t.memberCount-e.memberCount);break;case"recent":e.sort((e,t)=>t.lastActivity-e.lastActivity);break;case"alphabetical":e.sort((e,t)=>e.name.localeCompare(t.name))}i(e)},[n,l,a,u]);const v=e=>{const t=new Date,n=Math.floor((t-e)/6e4);return n<60?`${n}m atrás`:n<1440?`${Math.floor(n/60)}h atrás`:`${Math.floor(n/1440)}d atrás`};return h?Ae.jsx("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:Ae.jsxs("div",{className:"flex items-center justify-center py-12",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("span",{className:"ml-3 text-white/70",children:"Carregando comunidades..."})]})}):Ae.jsxs("div",{className:"min-h-screen bg-black py-8 animation-initial animate-fade-in-up animation-delay-100",children:[Ae.jsx("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:Ae.jsxs("div",{className:"flex items-center space-x-4",children:[Ae.jsx("button",{onClick:()=>t(-1),className:"p-2 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg transition-colors",children:Ae.jsx(k,{className:"w-5 h-5 text-white"})}),Ae.jsxs("div",{children:[Ae.jsx("h1",{className:"text-3xl font-bold text-white",children:"Explorar Comunidades"}),Ae.jsx("p",{className:"text-white/70",children:"Encontre grupos que combinam com seus interesses"})]})]})}),Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6",children:[Ae.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[Ae.jsxs("div",{className:"flex-1 relative",children:[Ae.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/50"}),Ae.jsx("input",{type:"text",placeholder:"Buscar comunidades, tags, temas...",value:a,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),Ae.jsx("div",{className:"flex items-center space-x-4",children:Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(Ce,{className:"w-5 h-5 text-white/70"}),Ae.jsxs("select",{value:u,onChange:e=>d(e.target.value),className:"bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[Ae.jsx("option",{value:"popular",children:"Mais Populares"}),Ae.jsx("option",{value:"recent",children:"Recentes"}),Ae.jsx("option",{value:"alphabetical",children:"A-Z"})]})]})})]}),Ae.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:b.map(e=>Ae.jsxs("button",{onClick:()=>c(e.id),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all "+(l===e.id?"bg-blue-600 text-white":"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white"),children:[Ae.jsx("span",{className:"mr-2",children:"string"==typeof e.icon?e.icon:"🌐"}),e.name]},e.id))})]}),Ae.jsx("div",{className:"flex items-center justify-between",children:Ae.jsxs("div",{children:[Ae.jsxs("h2",{className:"text-xl font-semibold text-white",children:[r.length," comunidades encontradas"]}),Ae.jsxs("p",{className:"text-white/60 text-sm",children:["all"!==l&&`Categoria: ${null==(e=b.find(e=>e.id===l))?void 0:e.name}`,a&&` • Busca: "${a}"`]})]})}),Ae.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(e=>{const t=p.includes(e.id);return Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6 hover:bg-white/15 transition-all duration-200",children:[Ae.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("div",{className:"w-12 h-12 rounded-full bg-white flex items-center justify-center text-2xl",children:e.icon}),Ae.jsxs("div",{children:[Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("h3",{className:"font-bold text-white text-lg",children:e.name}),e.isPrivate&&Ae.jsx(A,{className:"w-4 h-4 text-yellow-400"})]}),Ae.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/60",children:[Ae.jsx(j,{className:"w-4 h-4"}),Ae.jsxs("span",{children:[e.memberCount.toLocaleString()," membros"]})]})]})]}),Ae.jsx("button",{onClick:()=>{e.id},className:"w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200 cursor-pointer bg-white hover:bg-gray-100",title:t?"Sair da comunidade":"Entrar na comunidade",children:t?Ae.jsx(X,{className:"w-5 h-5 text-black"}):Ae.jsx(Y,{className:"w-5 h-5 text-black"})})]}),Ae.jsx("p",{className:"text-white/80 text-sm leading-relaxed mb-4 line-clamp-3",children:e.description}),Ae.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.tags.slice(0,3).map((e,t)=>Ae.jsxs("span",{className:"px-2 py-1 bg-white/10 rounded-full text-xs text-white/70 border border-white/20",children:["#",e]},t)),e.tags.length>3&&Ae.jsxs("span",{className:"px-2 py-1 bg-white/5 rounded-full text-xs text-white/50",children:["+",e.tags.length-3]})]}),Ae.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-white/10",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 text-xs text-white/50",children:[Ae.jsx(de,{className:"w-3 h-3"}),Ae.jsx("span",{children:v(e.lastActivity)})]}),Ae.jsxs("div",{className:"flex items-center space-x-1 text-xs text-white/50",children:[Ae.jsx(Ne,{className:"w-3 h-3"}),Ae.jsx("span",{children:"Moderado"})]})]}),Ae.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[Ae.jsx("p",{className:"text-xs text-white/50 mb-1",children:"Moderadores:"}),Ae.jsx("div",{className:"flex flex-wrap gap-1",children:e.moderators.map((e,t)=>Ae.jsx("span",{className:"text-xs text-white bg-white/10 px-2 py-1 rounded",children:e},t))})]})]},e.id)})}),0===r.length&&Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-12 text-center",children:[Ae.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),Ae.jsx("h3",{className:"text-xl font-medium text-white mb-2",children:"Nenhuma comunidade encontrada"}),Ae.jsx("p",{className:"text-white/70 mb-6",children:"Tente ajustar seus filtros ou termo de busca"}),Ae.jsx("button",{onClick:()=>{o(""),c("all")},className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Limpar Filtros"})]}),Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6 text-center",children:[Ae.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Não encontrou o que procura?"}),Ae.jsx("p",{className:"text-white/70 mb-4",children:"Sugira uma nova comunidade ou entre em contato conosco"}),Ae.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[Ae.jsx("button",{className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:"Sugerir Comunidade"}),Ae.jsx("button",{className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 text-white rounded-lg font-medium transition-colors",children:"Entrar em Contato"})]})]})]})},jy=()=>{const[t,n]=f.useState(null),s=xt(),[r,i]=f.useState("available"),[a,o]=f.useState(""),[l,c]=f.useState("all"),u=[{id:1,therapist:"Dra. Ana Silva",date:"2024-01-15",time:"14:00",duration:"50 min",type:"Online",status:"confirmed"},{id:2,therapist:"Dr. Carlos Santos",date:"2024-01-18",time:"10:00",duration:"50 min",type:"Presencial",status:"pending"}];f.useEffect(()=>{p(e,null,function*(){try{const e=Cb.currentUser;if(e){const t=Mg(kb,"users",e.uid),s=yield Fx(t);s.exists()&&n(s.data())}}catch(Ly){}})},[]);const d=[{id:1,name:"Dra. Ana Silva",specialty:"Psicóloga Clínica",crp:"06/123456",rating:4.9,reviews:127,experience:"8 anos",acceptsOnline:!0,location:"São Paulo, SP",avatar:null,bio:"Especialista em ansiedade, depressão e estresse. Trabalho com abordagem cognitivo-comportamental e mindfulness.",availability:[{day:"Segunda",time:"14:00 - 18:00"},{day:"Terça",time:"09:00 - 17:00"},{day:"Quarta",time:"14:00 - 18:00"},{day:"Quinta",time:"09:00 - 17:00"},{day:"Sexta",time:"14:00 - 18:00"}],price:"R$ 150,00",sessionType:"Online/Presencial"},{id:2,name:"Dr. Carlos Santos",specialty:"Psicólogo",crp:"06/789012",rating:4.8,reviews:89,experience:"12 anos",acceptsOnline:!0,location:"Rio de Janeiro, RJ",avatar:null,bio:"Especialista em TDAH, autismo e desenvolvimento infantil. Abordagem humanista e integrativa.",availability:[{day:"Segunda",time:"08:00 - 16:00"},{day:"Terça",time:"08:00 - 16:00"},{day:"Quarta",time:"08:00 - 16:00"},{day:"Quinta",time:"08:00 - 16:00"},{day:"Sexta",time:"08:00 - 16:00"}],price:"R$ 180,00",sessionType:"Online/Presencial"},{id:3,name:"Dra. Maria Costa",specialty:"Psicóloga Especialista",crp:"06/345678",rating:4.7,reviews:156,experience:"15 anos",acceptsOnline:!1,location:"Belo Horizonte, MG",avatar:null,bio:"Especialista em trauma, TEPT e EMDR. Abordagem psicodinâmica e técnicas de reprocessamento.",availability:[{day:"Segunda",time:"13:00 - 19:00"},{day:"Terça",time:"13:00 - 19:00"},{day:"Quarta",time:"13:00 - 19:00"},{day:"Quinta",time:"13:00 - 19:00"},{day:"Sexta",time:"13:00 - 19:00"}],price:"R$ 200,00",sessionType:"Presencial"}].filter(e=>{const t=e.name.toLowerCase().includes(a.toLowerCase())||e.specialty.toLowerCase().includes(a.toLowerCase())||e.bio.toLowerCase().includes(a.toLowerCase()),n="all"===l||"online"===l&&e.acceptsOnline||"presencial"===l&&!e.acceptsOnline;return t&&n});return Ae.jsx("div",{className:"min-h-screen bg-black py-8 animation-initial animate-fade-in-up animation-delay-100",children:Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx(I,{className:"w-6 h-6 text-gray-400"}),Ae.jsx("h2",{className:"text-xl font-semibold text-white",children:"Sessões de Terapia"})]}),Ae.jsxs("button",{className:"bg-white/10 border border-white/30 text-white px-4 py-2 rounded-lg hover:bg-white/20 transition-all duration-300 text-sm",children:[Ae.jsx(Y,{className:"w-4 h-4 inline mr-2"}),"Nova Sessão"]})]}),Ae.jsxs("div",{className:"flex space-x-1 mb-6 bg-white/5 rounded-lg p-1",children:[Ae.jsx("button",{onClick:()=>i("available"),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 "+("available"===r?"bg-white text-black":"text-white/70 hover:text-white"),children:"Terapeutas Disponíveis"}),Ae.jsx("button",{onClick:()=>i("scheduled"),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 "+("scheduled"===r?"bg-white text-black":"text-white/70 hover:text-white"),children:"Sessões Agendadas"})]}),"available"===r?Ae.jsxs("div",{className:"space-y-4",children:[Ae.jsxs("div",{className:"flex space-x-3",children:[Ae.jsxs("div",{className:"relative flex-1",children:[Ae.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50 w-4 h-4"}),Ae.jsx("input",{type:"text",placeholder:"Pesquisar terapeutas...",value:a,onChange:e=>o(e.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg pl-10 pr-4 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"})]}),Ae.jsxs("select",{value:l,onChange:e=>c(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/30",children:[Ae.jsx("option",{value:"all",children:"Todos"}),Ae.jsx("option",{value:"online",children:"Online"}),Ae.jsx("option",{value:"presencial",children:"Presencial"})]})]}),Ae.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:d.map(e=>Ae.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 hover:bg-white/10 transition-all duration-200",children:Ae.jsxs("div",{className:"flex items-start space-x-4",children:[Ae.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.avatar?Ae.jsx("img",{src:e.avatar,alt:"",className:"w-full h-full rounded-full"}):Ae.jsx(S,{className:"w-8 h-8 text-white/70"})}),Ae.jsxs("div",{className:"flex-1 min-w-0",children:[Ae.jsxs("div",{className:"flex items-start justify-between mb-2",children:[Ae.jsxs("div",{children:[Ae.jsx("h3",{className:"font-medium text-white text-lg",children:e.name}),Ae.jsx("p",{className:"text-white/70 text-sm",children:e.specialty}),Ae.jsxs("p",{className:"text-white/50 text-xs",children:["CRP: ",e.crp]})]}),Ae.jsxs("div",{className:"text-right",children:[Ae.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[Ae.jsx(Ne,{className:"w-4 h-4 text-yellow-400 fill-current"}),Ae.jsx("span",{className:"text-white text-sm",children:e.rating}),Ae.jsxs("span",{className:"text-white/50 text-xs",children:["(",e.reviews,")"]})]}),Ae.jsx("p",{className:"text-white/70 text-sm",children:e.price})]})]}),Ae.jsx("p",{className:"text-white/80 text-sm mb-3",children:e.bio}),Ae.jsxs("div",{className:"flex items-center space-x-4 text-xs text-white/60 mb-3",children:[Ae.jsxs("div",{className:"flex items-center space-x-1",children:[Ae.jsx(de,{className:"w-3 h-3"}),Ae.jsx("span",{children:e.experience})]}),Ae.jsxs("div",{className:"flex items-center space-x-1",children:[Ae.jsx(xe,{className:"w-3 h-3"}),Ae.jsx("span",{children:e.location})]}),Ae.jsxs("div",{className:"flex items-center space-x-1",children:[e.acceptsOnline?Ae.jsx(_e,{className:"w-3 h-3 text-green-400"}):Ae.jsx(O,{className:"w-3 h-3 text-blue-400"}),Ae.jsx("span",{children:e.sessionType})]})]}),Ae.jsxs("div",{className:"flex space-x-2",children:[Ae.jsx("button",{onClick:()=>s("/user/"+encodeURIComponent(e.name).toLowerCase().replace(/%20/g,"-")),className:"bg-white/10 border border-white/30 text-white px-4 py-2 rounded-lg hover:bg-white/20 transition-all duration-300 text-sm",children:"Ver Perfil"}),Ae.jsx("button",{className:"bg-white text-black px-4 py-2 rounded-lg hover:bg-white/90 transition-all duration-300 text-sm",children:"Agendar"})]})]})]})},e.id))})]}):Ae.jsx("div",{className:"space-y-4",children:0===u.length?Ae.jsxs("div",{className:"text-center py-8",children:[Ae.jsx(L,{className:"w-16 h-16 text-white/20 mx-auto mb-4"}),Ae.jsx("p",{className:"text-white/50 text-lg",children:"Nenhuma sessão agendada"}),Ae.jsx("p",{className:"text-white/30 text-sm mt-2",children:"Agende sua primeira sessão com um terapeuta"})]}):u.map(e=>Ae.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full flex items-center justify-center",children:Ae.jsx(S,{className:"w-6 h-6 text-white/70"})}),Ae.jsxs("div",{children:[Ae.jsx("h3",{className:"font-medium text-white",children:e.therapist}),Ae.jsxs("div",{className:"flex items-center space-x-4 text-sm text-white/70",children:[Ae.jsxs("span",{children:[e.date," às ",e.time]}),Ae.jsx("span",{children:"•"}),Ae.jsx("span",{children:e.duration}),Ae.jsx("span",{children:"•"}),Ae.jsx("span",{children:e.type})]})]})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("confirmed"===e.status?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"),children:"confirmed"===e.status?"Confirmada":"Pendente"}),Ae.jsx("button",{className:"bg-white/10 border border-white/30 text-white p-2 rounded-lg hover:bg-white/20 transition-all duration-300",children:Ae.jsx(N,{className:"w-4 h-4"})})]})]})},e.id))})]})})},Cy=()=>{const{roomCode:e}=bt(),t=xt(),n=pt(),[s,r]=f.useState(""),i=f.useRef(null),[a,o]=f.useState([]),{user:l}=Tb(),[c,h]=f.useState(""),[m,p]=f.useState(null),[g,x]=f.useState(""),[v,y]=f.useState(""),[w,N]=f.useState("all"),[C,E]=f.useState("conversas"),[I,T]=f.useState(null),[A,R]=f.useState(!1),[D,P]=f.useState({name:"",description:"",category:"saude-mental",isPrivate:!1,maxMembers:100}),L=[],O=[],M=[];f.useEffect(()=>{e&&(r(e),p(e),h(e))},[e,n.pathname]);const U=f.useCallback(()=>{const e=null==l?void 0:l.uid;if(!e||!s)return null;const[t,n]=[e,s].sort();return`${t}_${n}`},[null==l?void 0:l.uid,s]);f.useEffect(()=>{const e=U();if(!e)return;const t=()=>{try{const n=`ws://localhost:8000/ws/chat/${e}/`,s=new WebSocket(n);i.current=s;const r=setTimeout(()=>{s.readyState===WebSocket.CONNECTING&&s.close()},5e3);s.onopen=function(e){clearTimeout(r),s.send(JSON.stringify({type:"connection_test",message:"Teste de conexão"}))},s.onmessage=function(e){try{const t=JSON.parse(e.data);if("connection_established"===t.type)return;if("connection_test_response"===t.type)return;"chat_message"===t.type&&t.message&&(t.is_own||o(e=>[...e,{id:Date.now()+Math.random(),message:t.message,isOwn:!1,user:t.user_name||"Usuário",user_id:t.user_id,user_avatar:t.user_avatar,time:(new Date).toLocaleTimeString(),status:"delivered"}])),t.type}catch(Ly){}},s.onclose=function(e){clearTimeout(r),i.current=null,setTimeout(()=>{U()&&t()},3e3)},s.onerror=function(e){clearTimeout(r),i.current=null}}catch(Ly){i.current=null}};return t(),()=>{i.current&&i.current.readyState===WebSocket.OPEN&&i.current.close()}},[U]),f.useEffect(()=>{if(s){const e=document.querySelector("#chat-message-input");e&&e.focus()}},[s]),f.useEffect(()=>{const e=document.querySelector("#chat-message-input");e&&(e.onkeyup=function(e){"Enter"===e.key&&B()})},[s]);const F=e=>{switch(e){case"sent":return Ae.jsx(de,{className:"w-3 h-3 text-white/40"});case"delivered":return Ae.jsx(X,{className:"w-3 h-3 text-white/60"});case"read":return Ae.jsx(Ee,{className:"w-3 h-3 text-blue-400"});default:return null}},$=M.filter(e=>{const t=e.name.toLowerCase().includes(v.toLowerCase())||e.lastMessage.toLowerCase().includes(v.toLowerCase()),n="all"===w||e.type===w;return t&&n}),z=O.filter(e=>{const t=e.name.toLowerCase().includes(v.toLowerCase())||e.description.toLowerCase().includes(v.toLowerCase()),n="all"===w||e.category===w;return t&&n});M.find(e=>e.id===m),L.find(e=>e.id===m);const B=()=>{if(!g.trim())return;const e={id:Date.now()+Math.random(),message:g.trim(),isOwn:!0,user:"Você",time:(new Date).toLocaleTimeString(),status:"sent"};o(t=>[...t,e]);const t=i.current;if(t&&t.readyState===WebSocket.OPEN)try{const n={type:"chat_message",message:g.trim()};t.send(JSON.stringify(n)),o(t=>t.map(t=>t.id===e.id?d(u({},t),{status:"delivered"}):t))}catch(Ly){}x("")},G=()=>{R(!1)},H=(e,t,n)=>Ae.jsxs("button",{onClick:()=>E(e),className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 "+(C===e?"bg-white/20 text-white":"bg-white/10 text-white/70 hover:text-white"),children:[Ae.jsx(n,{className:"w-4 h-4"}),Ae.jsx("span",{children:t})]});return Ae.jsxs("div",{className:"w-full",children:[Ae.jsxs(ty,{variant:"glass",padding:"lg",children:[Ae.jsxs(ty.Header,{children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Ae.jsx(b,{className:"w-6 h-6 text-gray-400"}),Ae.jsx("h2",{className:"text-xl font-semibold text-white",children:e?`Chat - Sala: ${e}`:"Conversas em Tempo Real"}),e&&Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsxs("span",{className:"text-sm text-green-400 bg-green-400/10 px-2 py-1 rounded-full",children:["URL: /home/chat/",e]}),Ae.jsx("button",{onClick:()=>{fetch("http://localhost:8000/").then(()=>{}).catch(()=>{})},className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"Testar Backend"})]})]}),Ae.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Ae.jsx(Gv,{type:"text",placeholder:"Digite o código da sala (ex: sala1208)",value:c,onChange:e=>h(e.target.value),variant:"glass",size:"sm",className:"flex-1"}),Ae.jsx("button",{onClick:()=>{if(!c.trim())return;const e=c.trim();t(`/home/chat/${e}`,{replace:!0}),r(e),p(e)},disabled:!c.trim(),className:"px-3 py-2 bg-white text-black rounded-lg disabled:opacity-50",children:"Entrar"})]}),Ae.jsx("div",{className:"flex items-center justify-between mb-4",children:Ae.jsxs("div",{className:"flex items-center space-x-4",children:[H("conversas","Conversas",b),H("psicologos","Psicólogos",S),H("grupos","Grupos",j)]})})]}),Ae.jsxs(ty.Content,{children:[Ae.jsxs("div",{className:"flex space-x-3 mb-4",children:[Ae.jsx("div",{className:"relative flex-1",children:Ae.jsx(Gv,{type:"text",placeholder:"conversas"===C?"Pesquisar conversas...":"psicologos"===C?"Pesquisar psicólogos...":"Pesquisar grupos...",value:v,onChange:e=>y(e.target.value),variant:"glass",size:"sm",leftIcon:q,onLeftIconClick:()=>{},className:"w-full"})}),Ae.jsxs("select",{value:w,onChange:e=>N(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/30",children:[Ae.jsx("option",{value:"all",children:"Todas"}),"conversas"===C&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("option",{value:"psychologist",children:"Psicólogos"}),Ae.jsx("option",{value:"support",children:"Apoio"})]}),"grupos"===C&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("option",{value:"saude-mental",children:"Saúde Mental"}),Ae.jsx("option",{value:"bem-estar",children:"Bem-estar"}),Ae.jsx("option",{value:"familia",children:"Família"})]})]})]}),"conversas"===C&&Ae.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:0===M.length?Ae.jsxs("div",{className:"text-center py-12",children:[Ae.jsx(b,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Ae.jsx("h3",{className:"text-lg font-medium text-white/70 mb-2",children:"Nenhuma conversa"}),Ae.jsx("p",{className:"text-white/50",children:"Comece uma conversa com psicólogos ou outros usuários"})]}):$.map(e=>Ae.jsx("button",{onClick:()=>p(e.id),className:"w-full p-4 rounded-xl border transition-all duration-200 text-left "+(m===e.id?"bg-white/20 border-white/30":"bg-white/5 border-white/10 hover:bg-white/10"),children:Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsxs("div",{className:"relative",children:[Ae.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full flex items-center justify-center",children:e.avatar?Ae.jsx("img",{src:e.avatar,alt:"",className:"w-full h-full rounded-full"}):Ae.jsx(S,{className:"w-6 h-6 text-white/70"})}),Ae.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-black "+("online"===e.status?"bg-green-400":"bg-gray-400")})]}),Ae.jsxs("div",{className:"flex-1 min-w-0",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-1",children:[Ae.jsx("h3",{className:"font-medium text-white truncate",children:e.name}),Ae.jsx("span",{className:"text-xs text-white/50",children:e.time})]}),Ae.jsx("p",{className:"text-sm text-white/70 truncate",children:e.lastMessage}),e.unread>0&&Ae.jsxs("div",{className:"flex items-center justify-between mt-2",children:[Ae.jsx("span",{className:"text-xs text-blue-400",children:"psychologist"===e.type?"Profissional":"Apoio"}),Ae.jsx("span",{className:"bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:e.unread})]})]})]})},e.id))}),"psicologos"===C&&Ae.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:0===L.length?Ae.jsxs("div",{className:"col-span-2 text-center py-12",children:[Ae.jsx(S,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Ae.jsx("h3",{className:"text-lg font-medium text-white/70 mb-2",children:"Nenhum psicólogo disponível"}),Ae.jsx("p",{className:"text-white/50",children:"Em breve teremos profissionais disponíveis para atendimento"})]}):L.map(e=>Ae.jsxs("button",{onClick:()=>{return t=e.id,p(t),void r(t);var t},className:"p-4 rounded-xl border transition-all duration-200 text-left "+(m===e.id?"bg-white/20 border-white/30":"bg-white/5 border-white/10 hover:bg-white/10"),children:[Ae.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[Ae.jsx("div",{className:"w-12 h-12 bg-gray-700 rounded-full flex items-center justify-center text-2xl",children:e.avatar}),Ae.jsxs("div",{className:"text-left",children:[Ae.jsx("h3",{className:"font-medium text-white",children:e.name}),Ae.jsx("p",{className:"text-sm text-gray-400",children:e.specialty})]})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),Ae.jsx("span",{className:"text-xs text-gray-400",children:"Online"}),Ae.jsxs("span",{className:"text-xs text-gray-400",children:["• ⭐ ",e.rating]})]})]},e.id))}),"grupos"===C&&Ae.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[Ae.jsxs("button",{onClick:()=>{R(!0),P({name:"",description:"",category:"saude-mental",isPrivate:!1,maxMembers:100})},className:"w-full p-4 rounded-xl border-2 border-dashed border-white/20 hover:border-white/40 hover:bg-white/5 transition-all duration-200 text-center group",children:[Ae.jsxs("div",{className:"flex items-center justify-center space-x-2 text-white/70 group-hover:text-white",children:[Ae.jsx(Y,{className:"w-5 h-5"}),Ae.jsx("span",{className:"font-medium",children:"Crie Seu Grupo"})]}),Ae.jsx("p",{className:"text-sm text-white/50 mt-1",children:"Comece uma nova comunidade de apoio"})]}),0===O.length?Ae.jsxs("div",{className:"text-center py-12",children:[Ae.jsx(j,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Ae.jsx("h3",{className:"text-lg font-medium text-white/70 mb-2",children:"Nenhum grupo criado"}),Ae.jsx("p",{className:"text-white/50",children:"Seja o primeiro a criar um grupo de apoio"})]}):z.map(e=>Ae.jsx("button",{onClick:()=>(e=>{T(e),p(null)})(e),className:"w-full p-4 rounded-xl border transition-all duration-200 text-left "+((null==I?void 0:I.id)===e.id?"bg-white/20 border-white/30":"bg-white/5 border-white/10 hover:bg-white/10"),children:Ae.jsxs("div",{className:"flex items-start space-x-3",children:[Ae.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full flex items-center justify-center text-2xl",children:e.avatar}),Ae.jsxs("div",{className:"flex-1 min-w-0",children:[Ae.jsxs("div",{className:"flex items-center justify-between mb-1",children:[Ae.jsx("h3",{className:"font-medium text-white truncate",children:e.name}),Ae.jsx("span",{className:"text-xs text-white/50",children:e.lastActivity})]}),Ae.jsx("p",{className:"text-sm text-white/70 mb-2",children:e.description}),Ae.jsxs("div",{className:"flex items-center justify-between text-xs text-white/50",children:[Ae.jsxs("div",{className:"flex items-center space-x-4",children:[Ae.jsxs("span",{className:"flex items-center space-x-1",children:[Ae.jsx(j,{className:"w-3 h-3"}),Ae.jsxs("span",{children:[e.memberCount," membros"]})]}),Ae.jsxs("span",{className:"flex items-center space-x-1",children:[Ae.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),Ae.jsxs("span",{children:[e.onlineCount," online"]})]})]}),Ae.jsx("span",{className:"px-2 py-1 bg-white/10 rounded-full text-xs",children:"saude-mental"===e.category?"Saúde Mental":"bem-estar"===e.category?"Bem-estar":"Família"})]})]})]})},e.id))]})]})]}),(s||e)&&Ae.jsxs(ty,{variant:"glass",className:"overflow-hidden mt-4",children:[Ae.jsx("div",{className:"bg-white/5 p-4 border-b border-white/10",children:Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("button",{onClick:()=>{p(null),T(null),r(""),t("/home/chat",{replace:!0})},className:"p-1 hover:bg-white/10 rounded-lg transition-colors focus-ring","aria-label":"Voltar para lista",children:Ae.jsx(k,{className:"w-5 h-5 text-white"})}),Ae.jsx("div",{className:"w-10 h-10 bg-white/10 rounded-full flex items-center justify-center",children:Ae.jsx(S,{className:"w-5 h-5 text-white"})}),Ae.jsxs("div",{children:[Ae.jsx("h3",{className:"font-medium text-white",children:"Conversa"}),Ae.jsxs("p",{className:"text-sm text-white/70",children:["Sala: ",e||s]}),Ae.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[Ae.jsx("div",{className:"w-2 h-2 rounded-full "+(i.current&&i.current.readyState===WebSocket.OPEN?"bg-green-400":"bg-yellow-400")}),Ae.jsx("span",{className:"text-xs "+(i.current&&i.current.readyState===WebSocket.OPEN?"text-green-400":"text-yellow-400"),children:i.current&&i.current.readyState===WebSocket.OPEN?"Online (Tempo Real)":"Conectando..."}),(!i.current||i.current.readyState!==WebSocket.OPEN)&&Ae.jsx("button",{onClick:()=>{if(U()){const e=new Event("reconnect");window.dispatchEvent(e)}},className:"text-xs text-blue-400 hover:text-blue-300 underline",children:"Reconectar"})]})]})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("button",{onClick:()=>{o(e=>e.filter(e=>e.isOwn))},className:"text-xs bg-orange-500/20 text-orange-300 px-2 py-1 rounded hover:bg-orange-500/30 transition-colors",title:"Limpar mensagens de outros usuários",children:"🧹 Limpar Outros"}),Ae.jsx("button",{onClick:()=>{o([])},className:"text-xs bg-red-500/20 text-red-300 px-2 py-1 rounded hover:bg-red-500/30 transition-colors",title:"Limpar todas as mensagens",children:"🗑️ Limpar Tudo"})]})]})}),Ae.jsx("div",{id:"chat-log",className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:a.length>0?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"text-center text-xs text-white/50 mb-4",children:a.filter(e=>!e.isOwn).length>0&&Ae.jsxs("div",{className:"space-y-3",children:[Ae.jsxs("span",{className:"bg-blue-500/20 text-blue-300 px-3 py-2 rounded-full",children:["💬 ",a.filter(e=>!e.isOwn).length," mensagem(ns) de outros usuários"]}),Ae.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[Ae.jsx("h4",{className:"text-white/70 text-xs font-medium mb-2",children:"👥 Usuários na sala:"}),Ae.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:Array.from(new Set(a.filter(e=>!e.isOwn).map(e=>e.user_id))).map((e,t)=>{var n;const s=a.find(t=>t.user_id===e&&!t.isOwn);return Ae.jsxs("div",{className:"flex items-center space-x-2 bg-white/10 px-3 py-2 rounded-full",children:[Ae.jsx("div",{className:"w-6 h-6 rounded-full overflow-hidden bg-white/20",children:(null==s?void 0:s.user_avatar)?Ae.jsx("img",{src:s.user_avatar,alt:s.user,className:"w-full h-full object-cover"}):Ae.jsx("div",{className:"w-full h-full flex items-center justify-center text-white/70 text-sm font-bold",children:(null==(n=null==s?void 0:s.user)?void 0:n.charAt(0).toUpperCase())||"U"})}),Ae.jsx("span",{className:"text-xs text-white/80 font-medium",children:null==s?void 0:s.user}),Ae.jsxs("span",{className:"text-xs text-white/50",children:["(",a.filter(t=>t.user_id===e&&!t.isOwn).length," msg)"]})]},e)})})]})]})}),a.map(e=>Ae.jsxs("div",{className:`flex ${e.isOwn?"justify-end":"justify-start"} mb-4`,children:[!e.isOwn&&Ae.jsxs("div",{className:"flex flex-col items-center mr-3",children:[Ae.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-white/10 border-2 border-white/20",children:e.user_avatar?Ae.jsx("img",{src:e.user_avatar,alt:e.user,className:"w-full h-full object-cover"}):Ae.jsx("div",{className:"w-full h-full flex items-center justify-center text-white/70 text-lg font-bold",children:e.user.charAt(0).toUpperCase()})}),Ae.jsx("span",{className:"text-xs text-white/60 mt-1 max-w-20 truncate",children:e.user})]}),Ae.jsxs("div",{className:"max-w-xs px-4 py-3 rounded-2xl relative "+(e.isOwn?"bg-blue-500 text-white rounded-br-md":"bg-white/10 text-white rounded-bl-md"),children:[Ae.jsx("p",{className:"text-sm leading-relaxed",children:e.message}),Ae.jsxs("div",{className:"flex items-center justify-between mt-2",children:[Ae.jsx("span",{className:"text-xs "+(e.isOwn?"text-blue-100":"text-white/50"),children:e.time}),e.isOwn&&F(e.status)]}),Ae.jsx("div",{className:"absolute top-3 "+(e.isOwn?"right-0 transform translate-x-full":"left-0 transform -translate-x-full"),children:Ae.jsx("div",{className:"w-0 h-0 border-8 border-transparent "+(e.isOwn?"border-l-blue-500 border-r-0":"border-r-white/10 border-l-0")})})]}),e.isOwn&&Ae.jsxs("div",{className:"flex flex-col items-center ml-3",children:[Ae.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-blue-400 border-2 border-blue-300",children:Ae.jsx("div",{className:"w-full h-full flex items-center justify-center text-white text-lg font-bold",children:"Você"})}),Ae.jsx("span",{className:"text-xs text-white/60 mt-1",children:"Você"})]})]},e.id))]}):Ae.jsxs("div",{className:"text-center py-8",children:[Ae.jsx(b,{className:"w-12 h-12 text-white/30 mx-auto mb-3"}),Ae.jsx("p",{className:"text-white/50",children:"Nenhuma mensagem ainda"}),Ae.jsx("p",{className:"text-sm text-white/30",children:"Comece a conversa!"})]})}),Ae.jsx("div",{className:"p-4 border-t border-white/10",children:Ae.jsxs("div",{className:"flex items-center space-x-2",children:[Ae.jsx("button",{className:"p-2 text-white/50 hover:text-white hover:bg-white/10 rounded-lg transition-colors focus-ring",children:Ae.jsx(ke,{className:"w-5 h-5"})}),Ae.jsx(Gv,{type:"text",value:g,onChange:e=>x(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),B())},placeholder:"Digite sua mensagem...",variant:"glass",size:"sm",className:"flex-1",id:"chat-message-input"}),Ae.jsx("button",{id:"chat-message-submit",onClick:()=>{B()},disabled:!g.trim(),className:"p-2 bg-white text-black rounded-lg hover:bg-white/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus-ring","aria-label":"Enviar mensagem",children:Ae.jsx(_,{className:"w-5 h-5"})})]})})]}),A&&Ae.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Ae.jsxs(ty,{variant:"glass",padding:"lg",className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[Ae.jsx(ty.Header,{children:Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsx("h3",{className:"text-xl font-semibold text-white",children:"Criar Novo Grupo"}),Ae.jsx("button",{onClick:G,className:"p-1 hover:bg-white/10 rounded-lg transition-colors",children:Ae.jsx(V,{className:"w-5 h-5 text-white"})})]})}),Ae.jsx(ty.Content,{children:Ae.jsxs("div",{className:"space-y-4",children:[Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Nome do Grupo *"}),Ae.jsx(Gv,{value:D.name,onChange:e=>P(d(u({},D),{name:e.target.value})),placeholder:"Ex: Ansiedade & Bem-estar",variant:"glass",size:"sm"})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Descrição *"}),Ae.jsx("textarea",{value:D.description,onChange:e=>P(d(u({},D),{description:e.target.value})),placeholder:"Descreva o propósito do grupo",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 resize-none",rows:3})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Categoria"}),Ae.jsxs("select",{value:D.category,onChange:e=>P(d(u({},D),{category:e.target.value})),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/30",children:[Ae.jsx("option",{value:"saude-mental",children:"Saúde Mental"}),Ae.jsx("option",{value:"bem-estar",children:"Bem-estar"}),Ae.jsx("option",{value:"familia",children:"Família"})]})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Número Máximo de Membros"}),Ae.jsx("input",{type:"number",value:D.maxMembers,onChange:e=>P(d(u({},D),{maxMembers:parseInt(e.target.value)||100})),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:"100",min:"1",max:"1000"})]}),Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("input",{type:"checkbox",id:"isPrivate",checked:D.isPrivate,onChange:e=>P(d(u({},D),{isPrivate:e.target.checked})),className:"w-4 h-4 text-blue-400 focus:ring-blue-400 border-white/20 rounded"}),Ae.jsx("label",{htmlFor:"isPrivate",className:"text-sm text-white/70",children:"Grupo Privado (apenas membros convidados podem entrar)"})]})]})}),Ae.jsx(ty.Footer,{children:Ae.jsxs("div",{className:"flex space-x-3",children:[Ae.jsx("button",{onClick:G,className:"flex-1 px-4 py-2 bg-white/10 text-white rounded-lg hover:bg-white/20 transition-colors",children:"Cancelar"}),Ae.jsx("button",{onClick:()=>{D.name.trim()&&D.description.trim()?G():alert("Por favor, preencha todos os campos obrigatórios.")},disabled:!D.name.trim()||!D.description.trim(),className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Criar Grupo"})]})})]})})]})},_y=()=>{const t=xt(),{user:n}=Tb(),[s,r]=f.useState("profile"),[i,a]=f.useState(!0),[o,l]=f.useState(!1),[c,h]=f.useState(""),[m,g]=f.useState(""),[x,b]=f.useState(!1),[v,y]=f.useState(""),[w,N]=f.useState(!1),[j,_]=f.useState({username:"",displayName:"",bio:"",location:"",website:"",language:"pt-BR"}),[k,E]=f.useState({emailNotifications:!0,pushNotifications:!0,messageNotifications:!0,groupNotifications:!0,sessionReminders:!0,moodReminders:!0,weeklyReports:!1}),[I,T]=f.useState({profileVisibility:"public",showEmail:!1,showPhone:!1,allowMessages:!0,allowFriendRequests:!0,showOnlineStatus:!0,dataSharing:!1}),[A,R]=f.useState({theme:"dark",fontSize:"medium",compactMode:!1,animations:!0});f.useEffect(()=>{p(e,null,function*(){var e;try{if(a(!0),n){const t=n.profileData||{};_({username:t.username||(null==(e=n.displayName)?void 0:e.toLowerCase().replace(/\s+/g,"."))||"",displayName:n.displayName||t.displayName||"",bio:t.bio||"",location:t.location||"",website:t.website||"",language:t.language||"pt-BR"}),E({emailNotifications:void 0===t.emailNotifications||t.emailNotifications,pushNotifications:void 0===t.pushNotifications||t.pushNotifications,messageNotifications:void 0===t.messageNotifications||t.messageNotifications,groupNotifications:void 0===t.groupNotifications||t.groupNotifications,sessionReminders:void 0===t.sessionReminders||t.sessionReminders,moodReminders:void 0===t.moodReminders||t.moodReminders,weeklyReports:t.weeklyReports||!1}),T({profileVisibility:t.profileVisibility||"public",showEmail:t.showEmail||!1,showPhone:t.showPhone||!1,allowMessages:void 0===t.allowMessages||t.allowMessages,allowFriendRequests:void 0===t.allowFriendRequests||t.allowFriendRequests,showOnlineStatus:void 0===t.showOnlineStatus||t.showOnlineStatus,dataSharing:t.dataSharing||!1}),R({theme:t.theme||"dark",fontSize:t.fontSize||"medium",compactMode:t.compactMode||!1,animations:void 0===t.animations||t.animations})}}catch(t){g("Erro ao carregar configurações")}finally{a(!1)}})},[n]);const D=(e,t,n)=>{switch(e){case"profile":_(e=>d(u({},e),{[t]:n}));break;case"notifications":E(e=>d(u({},e),{[t]:n}));break;case"privacy":T(e=>d(u({},e),{[t]:n}));break;case"appearance":R(e=>d(u({},e),{[t]:n}))}};return i?Ae.jsx("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:Ae.jsxs("div",{className:"flex items-center justify-center py-12",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("span",{className:"ml-3 text-white/70",children:"Carregando configurações..."})]})}):n?Ae.jsxs("div",{className:"min-h-screen bg-black py-8 animation-initial animate-fade-in-up animation-delay-100",children:[Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Ae.jsx(C,{className:"w-6 h-6 text-gray-400"}),Ae.jsx("h2",{className:"text-xl font-semibold text-white",children:"Configurações"})]}),Ae.jsx("div",{className:"flex space-x-1 bg-white/5 rounded-lg p-1",children:[{id:"profile",name:"Perfil",icon:S},{id:"notifications",name:"Notificações",icon:G},{id:"privacy",name:"Privacidade",icon:Se},{id:"appearance",name:"Aparência",icon:Ie},{id:"account",name:"Conta",icon:le}].map(e=>{const t=e.icon;return Ae.jsxs("button",{onClick:()=>r(e.id),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 flex items-center justify-center space-x-2 "+(s===e.id?"bg-white text-black":"text-white/70 hover:text-white"),children:[Ae.jsx(t,{className:"w-4 h-4"}),Ae.jsx("span",{children:e.name})]},e.id)})})]}),c&&Ae.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-xl p-4 text-green-300",children:c}),m&&Ae.jsx("div",{className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 text-red-300",children:m}),"profile"===s&&Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configurações do Perfil"}),Ae.jsxs("div",{className:"space-y-6",children:[Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Username da Plataforma"}),Ae.jsx("input",{type:"text",value:j.username,onChange:e=>D("profile","username",e.target.value.toLowerCase()),placeholder:"Digite seu username",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all"}),Ae.jsx("p",{className:"text-white/50 text-xs mt-1",children:"Este será seu identificador único na plataforma"})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Nome de Exibição"}),Ae.jsx("input",{type:"text",value:j.displayName,onChange:e=>D("profile","displayName",e.target.value),placeholder:"Digite seu nome completo",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all"})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Biografia"}),Ae.jsx("textarea",{value:j.bio,onChange:e=>D("profile","bio",e.target.value),rows:"3",placeholder:"Conte um pouco sobre você...",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all resize-none"})]}),Ae.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Localização"}),Ae.jsx("input",{type:"text",value:j.location,onChange:e=>D("profile","location",e.target.value),placeholder:"Ex: São Paulo, SP",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all"})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Website"}),Ae.jsx("input",{type:"url",value:j.website,onChange:e=>D("profile","website",e.target.value),placeholder:"https://seusite.com",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all"})]})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Idioma"}),Ae.jsxs("select",{value:j.language,onChange:e=>D("profile","language",e.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white focus:ring-2 focus:ring-white focus:border-transparent transition-all",children:[Ae.jsx("option",{value:"pt-BR",children:"Português (Brasil)"}),Ae.jsx("option",{value:"en-US",children:"English (US)"}),Ae.jsx("option",{value:"es-ES",children:"Español"})]})]}),Ae.jsx("div",{className:"flex justify-end",children:Ae.jsx("button",{onClick:()=>p(e,null,function*(){try{l(!0),g(""),h(""),yield new Promise(e=>setTimeout(e,1e3)),h("Configurações de perfil salvas com sucesso!"),setTimeout(()=>h(""),3e3)}catch(e){g("Erro ao salvar configurações")}finally{l(!1)}}),disabled:o,className:"px-6 py-3 bg-white hover:bg-gray-100 disabled:bg-gray-800 disabled:cursor-not-allowed text-black rounded-lg font-medium transition-colors flex items-center space-x-2",children:o?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"loading-spinner-small"}),Ae.jsx("span",{children:"Salvando..."})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(ge,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Salvar Perfil"})]})})})]})]}),"notifications"===s&&Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configurações de Notificação"}),Ae.jsxs("div",{className:"space-y-6",children:[[{key:"emailNotifications",label:"Notificações por Email",description:"Receber notificações importantes por email"},{key:"pushNotifications",label:"Notificações Push",description:"Receber notificações no dispositivo"},{key:"messageNotifications",label:"Mensagens",description:"Notificar sobre novas mensagens"},{key:"groupNotifications",label:"Atividade em Grupos",description:"Notificar sobre atividades nos grupos"},{key:"sessionReminders",label:"Lembretes de Sessão",description:"Lembrar sobre sessões agendadas"},{key:"moodReminders",label:"Lembretes de Humor",description:"Lembrar de registrar seu humor diário"},{key:"weeklyReports",label:"Relatórios Semanais",description:"Receber resumo semanal de atividades"}].map(e=>Ae.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-lg",children:[Ae.jsxs("div",{children:[Ae.jsx("h4",{className:"text-white font-medium",children:e.label}),Ae.jsx("p",{className:"text-white/60 text-sm",children:e.description})]}),Ae.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[Ae.jsx("input",{type:"checkbox",checked:k[e.key],onChange:t=>D("notifications",e.key,t.target.checked),className:"sr-only peer"}),Ae.jsx("div",{className:"w-11 h-6 bg-white/20 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},e.key)),Ae.jsx("div",{className:"flex justify-end",children:Ae.jsx("button",{onClick:()=>p(e,null,function*(){try{l(!0),g(""),h(""),yield new Promise(e=>setTimeout(e,1e3)),h("Configurações de notificação salvas com sucesso!"),setTimeout(()=>h(""),3e3)}catch(e){g("Erro ao salvar configurações")}finally{l(!1)}}),disabled:o,className:"px-6 py-3 bg-white hover:bg-gray-100 disabled:bg-gray-800 disabled:cursor-not-allowed text-black rounded-lg font-medium transition-colors flex items-center space-x-2",children:o?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"loading-spinner-small"}),Ae.jsx("span",{children:"Salvando..."})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(ge,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Salvar Notificações"})]})})})]})]}),"privacy"===s&&Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configurações de Privacidade"}),Ae.jsxs("div",{className:"space-y-6",children:[Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Visibilidade do Perfil"}),Ae.jsxs("select",{value:I.profileVisibility,onChange:e=>D("privacy","profileVisibility",e.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white focus:ring-2 focus:ring-white focus:border-transparent transition-all",children:[Ae.jsx("option",{value:"public",children:"Público"}),Ae.jsx("option",{value:"friends",children:"Apenas Amigos"}),Ae.jsx("option",{value:"private",children:"Privado"})]})]}),[{key:"showEmail",label:"Mostrar Email",description:"Permitir que outros vejam seu email"},{key:"showPhone",label:"Mostrar Telefone",description:"Permitir que outros vejam seu telefone"},{key:"allowMessages",label:"Permitir Mensagens",description:"Permitir que outros te enviem mensagens"},{key:"allowFriendRequests",label:"Permitir Solicitações",description:"Permitir solicitações de amizade"},{key:"showOnlineStatus",label:"Mostrar Status Online",description:"Mostrar quando você está online"},{key:"dataSharing",label:"Compartilhar Dados",description:"Permitir compartilhamento de dados para pesquisas"}].map(e=>Ae.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-lg",children:[Ae.jsxs("div",{children:[Ae.jsx("h4",{className:"text-white font-medium",children:e.label}),Ae.jsx("p",{className:"text-white/60 text-sm",children:e.description})]}),Ae.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[Ae.jsx("input",{type:"checkbox",checked:I[e.key],onChange:t=>D("privacy",e.key,t.target.checked),className:"sr-only peer"}),Ae.jsx("div",{className:"w-11 h-6 bg-white/20 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},e.key)),Ae.jsx("div",{className:"flex justify-end",children:Ae.jsx("button",{onClick:()=>p(e,null,function*(){try{l(!0),g(""),h(""),yield new Promise(e=>setTimeout(e,1e3)),h("Configurações de privacidade salvas com sucesso!"),setTimeout(()=>h(""),3e3)}catch(e){g("Erro ao salvar configurações")}finally{l(!1)}}),disabled:o,className:"px-6 py-3 bg-white hover:bg-gray-100 disabled:bg-gray-800 disabled:cursor-not-allowed text-black rounded-lg font-medium transition-colors flex items-center space-x-2",children:o?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"loading-spinner-small"}),Ae.jsx("span",{children:"Salvando..."})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(ge,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Salvar Privacidade"})]})})})]})]}),"appearance"===s&&Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configurações de Aparência"}),Ae.jsxs("div",{className:"space-y-6",children:[Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Tema"}),Ae.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"dark",label:"Escuro",description:"Tema padrão escuro"},{value:"light",label:"Claro",description:"Tema claro (em breve)"},{value:"auto",label:"Automático",description:"Seguir sistema"}].map(e=>Ae.jsxs("button",{onClick:()=>D("appearance","theme",e.value),className:"p-4 rounded-lg border transition-all "+(A.theme===e.value?"border-blue-500 bg-blue-500/10":"border-white/20 bg-white/5 hover:bg-white/10"),children:[Ae.jsx("div",{className:"text-white font-medium",children:e.label}),Ae.jsx("div",{className:"text-white/60 text-xs",children:e.description})]},e.value))})]}),Ae.jsxs("div",{children:[Ae.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Tamanho da Fonte"}),Ae.jsxs("select",{value:A.fontSize,onChange:e=>D("appearance","fontSize",e.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white focus:ring-2 focus:ring-white focus:border-transparent transition-all",children:[Ae.jsx("option",{value:"small",children:"Pequeno"}),Ae.jsx("option",{value:"medium",children:"Médio"}),Ae.jsx("option",{value:"large",children:"Grande"})]})]}),[{key:"compactMode",label:"Modo Compacto",description:"Interface mais densa com menos espaçamento"},{key:"animations",label:"Animações",description:"Habilitar animações da interface"}].map(e=>Ae.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-lg",children:[Ae.jsxs("div",{children:[Ae.jsx("h4",{className:"text-white font-medium",children:e.label}),Ae.jsx("p",{className:"text-white/60 text-sm",children:e.description})]}),Ae.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[Ae.jsx("input",{type:"checkbox",checked:A[e.key],onChange:t=>D("appearance",e.key,t.target.checked),className:"sr-only peer"}),Ae.jsx("div",{className:"w-11 h-6 bg-white/20 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},e.key)),Ae.jsx("div",{className:"flex justify-end",children:Ae.jsx("button",{onClick:()=>p(e,null,function*(){try{l(!0),g(""),h(""),yield new Promise(e=>setTimeout(e,1e3)),h("Configurações de aparência salvas com sucesso!"),setTimeout(()=>h(""),3e3)}catch(e){g("Erro ao salvar configurações")}finally{l(!1)}}),disabled:o,className:"px-6 py-3 bg-white hover:bg-gray-100 disabled:bg-gray-800 disabled:cursor-not-allowed text-black rounded-lg font-medium transition-colors flex items-center space-x-2",children:o?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"loading-spinner-small"}),Ae.jsx("span",{children:"Salvando..."})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(ge,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Salvar Aparência"})]})})})]})]}),"account"===s&&Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Ae.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configurações da Conta"}),Ae.jsx("div",{className:"space-y-6",children:Ae.jsxs("div",{className:"border border-red-500/30 rounded-xl p-6 bg-red-500/5",children:[Ae.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Ae.jsx(le,{className:"w-6 h-6 text-red-400"}),Ae.jsx("h4",{className:"text-lg font-semibold text-red-400",children:"Zona de Perigo"})]}),Ae.jsx("p",{className:"text-white/70 mb-4",children:"As ações abaixo são irreversíveis e resultarão na perda permanente de todos os seus dados."}),Ae.jsx("div",{className:"space-y-4",children:Ae.jsxs("div",{className:"p-4 bg-red-500/10 rounded-lg border border-red-500/20",children:[Ae.jsx("h5",{className:"font-medium text-red-300 mb-2",children:"Excluir Conta Permanentemente"}),Ae.jsx("p",{className:"text-white/60 text-sm mb-4",children:"Esta ação irá:"}),Ae.jsxs("ul",{className:"text-white/60 text-sm space-y-1 mb-4",children:[Ae.jsx("li",{children:"• Deletar todos os seus dados pessoais"}),Ae.jsx("li",{children:"• Remover todos os seus posts e comentários"}),Ae.jsx("li",{children:"• Excluir seu perfil e configurações"}),Ae.jsx("li",{children:"• Encerrar sua conta de autenticação"}),Ae.jsxs("li",{children:["• ",Ae.jsx("strong",{children:"Esta ação não pode ser desfeita"})]})]}),Ae.jsxs("button",{onClick:()=>{b(!0),y(""),g("")},className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors flex items-center space-x-2",children:[Ae.jsx(le,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Excluir Minha Conta"})]})]})})]})})]}),x&&Ae.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Ae.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 max-w-md w-full border border-red-500/30",children:[Ae.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Ae.jsx("div",{className:"w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center",children:Ae.jsx(le,{className:"w-6 h-6 text-red-400"})}),Ae.jsxs("div",{children:[Ae.jsx("h3",{className:"text-xl font-semibold text-white",children:"Excluir Conta"}),Ae.jsx("p",{className:"text-white/60 text-sm",children:"Esta ação é irreversível"})]})]}),Ae.jsxs("div",{className:"space-y-4 mb-6",children:[Ae.jsxs("div",{className:"p-4 bg-red-500/10 rounded-lg border border-red-500/20",children:[Ae.jsxs("p",{className:"text-white/70 text-sm",children:[Ae.jsx("strong",{children:"Atenção:"})," Ao excluir sua conta, você perderá permanentemente:"]}),Ae.jsxs("ul",{className:"text-white/60 text-sm mt-2 space-y-1",children:[Ae.jsx("li",{children:"• Todos os seus posts e comentários"}),Ae.jsx("li",{children:"• Seu perfil e configurações"}),Ae.jsx("li",{children:"• Histórico de atividades"}),Ae.jsx("li",{children:"• Dados de sessões e humor"})]})]}),Ae.jsxs("div",{children:[Ae.jsxs("label",{className:"block text-white/70 text-sm font-medium mb-2",children:["Digite ",Ae.jsx("strong",{children:"EXCLUIR"})," para confirmar:"]}),Ae.jsx("input",{type:"text",value:v,onChange:e=>y(e.target.value),placeholder:"EXCLUIR",className:"w-full px-4 py-3 bg-white/5 border border-red-500/30 rounded-lg text-white placeholder-white/30 focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"})]})]}),m&&Ae.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm",children:m}),Ae.jsxs("div",{className:"flex space-x-3",children:[Ae.jsx("button",{onClick:()=>{b(!1),y(""),g("")},className:"flex-1 px-4 py-3 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors",children:"Cancelar"}),Ae.jsx("button",{onClick:()=>p(e,null,function*(){if("EXCLUIR"===v)try{if(N(!0),g(""),!(null==n?void 0:n.uid))throw new Error("Usuário não autenticado");const e=Mg(kb,"users",n.uid);yield qx(e);const s=Cb.currentUser;s&&(yield Oo(s)),t("/login")}catch(e){g("Erro ao excluir conta. Tente novamente.")}finally{N(!1)}else g("Digite EXCLUIR para confirmar a exclusão da conta")}),disabled:w||"EXCLUIR"!==v,className:"flex-1 px-4 py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center space-x-2",children:w?Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"loading-spinner-small"}),Ae.jsx("span",{children:"Excluindo..."})]}):Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(le,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Excluir Conta"})]})})]})]})})]}):Ae.jsxs("div",{className:"text-center py-20",children:[Ae.jsx("div",{className:"w-24 h-24 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:Ae.jsx(ee,{className:"w-12 h-12 text-red-400"})}),Ae.jsx("h3",{className:"text-xl text-white/60 mb-2",children:"Usuário não autenticado"}),Ae.jsx("p",{className:"text-white/40 mb-6",children:"Faça login para acessar as configurações"}),Ae.jsx("button",{onClick:()=>t("/login"),className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-colors",children:"Ir para Login"})]})},ky=()=>{const{postId:t}=bt(),n=xt(),[s,r]=f.useState(null),[i,a]=f.useState(!0),[o,l]=f.useState(null),[c,h]=f.useState(null),[m,g]=f.useState(!1),[x,v]=f.useState(!1);f.useState(null);const{togglePostLike:y,isPostLiked:N,deletePost:j}=ly();return f.useEffect(()=>{p(e,null,function*(){var e,s;try{a(!0);const i=Cb.currentUser;if(!i)return void n("/login");l(i);const o=Mg(kb,"users",i.uid),c=yield Fx(o);if(c.exists()){const e=c.data();h(e)}const m=Mg(kb,"posts",t),p=yield Fx(m);if(!p.exists())return void n("/home");{const t=p.data(),n=d(u({id:p.id},t),{createdAt:(null==(e=t.createdAt)?void 0:e.toDate())||new Date,updatedAt:null==(s=t.updatedAt)?void 0:s.toDate()});r(n),v(n.userId===i.uid)}}catch(Ly){n("/home")}finally{a(!1)}})},[t,n]),i?Ae.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("div",{className:"text-white ml-3",children:"Carregando post..."})]}):s?Ae.jsxs("div",{className:"min-h-screen bg-black text-white",children:[Ae.jsx("div",{className:"bg-white/10 backdrop-blur-sm border-b border-white/10 sticky top-0 z-10",children:Ae.jsx("div",{className:"max-w-4xl mx-auto px-4 py-4",children:Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsxs("button",{onClick:()=>n("/home"),className:"flex items-center space-x-2 text-white/70 hover:text-white transition-colors",children:[Ae.jsx(k,{className:"w-5 h-5"}),Ae.jsx("span",{children:"Voltar"})]}),x&&Ae.jsxs("div",{className:"relative",children:[Ae.jsx("button",{onClick:()=>g(!m),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:Ae.jsx(ae,{className:"w-5 h-5"})}),m&&Ae.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg shadow-lg py-1 z-20 min-w-[120px]",children:[Ae.jsxs("button",{onClick:()=>{g(!1)},className:"w-full text-left px-3 py-2 text-sm text-white hover:bg-white/10 flex items-center space-x-2",children:[Ae.jsx(oe,{className:"w-3 h-3"}),Ae.jsx("span",{children:"Editar"})]}),Ae.jsxs("button",{onClick:()=>{g(!1),window.confirm("Tem certeza que deseja deletar este post?")&&p(e,null,function*(){if(s)try{(yield j(s.id))&&n("/home")}catch(Ly){}})},className:"w-full text-left px-3 py-2 text-sm text-red-400 hover:bg-red-500/10 flex items-center space-x-2",children:[Ae.jsx(le,{className:"w-3 h-3"}),Ae.jsx("span",{children:"Deletar"})]})]})]})]})})}),Ae.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6 mb-8",children:[Ae.jsxs("div",{className:"flex items-start space-x-4 mb-6",children:[Ae.jsx("div",{className:"w-12 h-12 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:s.avatar?Ae.jsx("img",{src:s.avatar,alt:s.author,className:"w-12 h-12 rounded-full"}):Ae.jsx(S,{className:"w-6 h-6 text-white/70"})}),Ae.jsxs("div",{className:"flex-1 min-w-0",children:[Ae.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[Ae.jsx("h3",{className:"font-semibold text-white",children:s.author}),s.isAnonymous&&Ae.jsx("span",{className:"text-xs bg-white/20 text-white/70 px-2 py-1 rounded-full",children:"Anônimo"})]}),Ae.jsxs("div",{className:"flex items-center space-x-4 text-sm text-white/50",children:[Ae.jsxs("div",{className:"flex items-center space-x-1",children:[Ae.jsx(de,{className:"w-3 h-3"}),Ae.jsx("span",{children:(e=>{const t=new Date-e,n=Math.floor(t/6e4),s=Math.floor(t/36e5),r=Math.floor(t/864e5);return n<1?"Agora mesmo":n<60?`${n}m atrás`:s<24?`${s}h atrás`:r<7?`${r}d atrás`:e.toLocaleDateString("pt-BR")})(s.createdAt)})]}),s.isEdited&&Ae.jsx("span",{className:"text-white/30",children:"(editado)"})]})]})]}),Ae.jsx("div",{className:"mb-6",children:Ae.jsx("p",{className:"text-white/90 text-lg leading-relaxed whitespace-pre-wrap",children:s.content})}),s.tags&&s.tags.length>0&&Ae.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:s.tags.map((e,t)=>Ae.jsxs("span",{className:"inline-flex items-center space-x-1 bg-white/10 text-white/70 px-3 py-1 rounded-full text-sm",children:[Ae.jsx(w,{className:"w-3 h-3"}),Ae.jsx("span",{children:e})]},t))}),Ae.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-white/10",children:[Ae.jsxs("div",{className:"flex items-center space-x-6",children:[Ae.jsxs("button",{onClick:()=>p(e,null,function*(){s&&(yield y(s.id))}),className:"flex items-center space-x-2 transition-colors "+(N(s.id)?"text-red-400":"text-white/50 hover:text-white"),children:[Ae.jsx(ie,{className:"w-5 h-5 "+(N(s.id)?"fill-current":"")}),Ae.jsx("span",{children:Array.isArray(s.likes)?s.likes.length:0})]}),Ae.jsxs("div",{className:"flex items-center space-x-2 text-white/50",children:[Ae.jsx(b,{className:"w-5 h-5"}),Ae.jsx("span",{children:s.commentCount||0})]}),Ae.jsxs("button",{className:"flex items-center space-x-2 text-white/50 hover:text-white transition-colors",children:[Ae.jsx(ve,{className:"w-5 h-5"}),Ae.jsx("span",{children:s.shares||0})]})]}),Ae.jsx("button",{className:"text-white/50 hover:text-white transition-colors",children:Ae.jsx(ce,{className:"w-5 h-5"})})]})]}),Ae.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6",children:[Ae.jsxs("h4",{className:"text-white font-semibold text-lg mb-6",children:["Comentários (",s.commentCount||0,")"]}),Ae.jsx(uy,{postId:t})]})]})]}):Ae.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Ae.jsx("div",{className:"text-white",children:"Post não encontrado"})})},Ey=()=>{const{notifications:e,unreadCount:t,loading:n,markAsRead:s,markAllAsRead:r,deleteNotification:i,clearAllNotifications:a}=Jb(),[o,l]=f.useState(!1),c=e=>{if(!e)return"Agora mesmo";const t=new Date,n=e.toDate?e.toDate():new Date(e),s=Math.floor((t-n)/6e4);if(s<1)return"Agora mesmo";if(s<60)return`${s}m atrás`;const r=Math.floor(s/60);if(r<24)return`${r}h atrás`;const i=Math.floor(r/24);return i<7?`${i}d atrás`:n.toLocaleDateString("pt-BR")};return n?Ae.jsxs("div",{className:"flex items-center justify-center h-64",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("span",{className:"ml-3 text-white/70",children:"Carregando notificações..."})]}):0===e.length?Ae.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[Ae.jsx(G,{className:"w-16 h-16 text-white/30 mb-4"}),Ae.jsx("h3",{className:"text-xl font-semibold text-white/70 mb-2",children:"Nenhuma notificação"}),Ae.jsx("p",{className:"text-white/50",children:"Você está em dia com tudo!"})]}):Ae.jsxs("div",{className:"space-y-4",children:[Ae.jsxs("div",{className:"flex items-center justify-between",children:[Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx(G,{className:"w-6 h-6 text-white"}),Ae.jsxs("h2",{className:"text-xl font-semibold text-white",children:["Notificações",t>0&&Ae.jsx("span",{className:"ml-2 px-2 py-1 bg-red-500 text-white text-sm rounded-full",children:t})]})]}),Ae.jsxs("div",{className:"flex items-center space-x-2",children:[t>0&&Ae.jsxs("button",{onClick:r,className:"px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 rounded-lg text-blue-400 transition-colors flex items-center space-x-2",children:[Ae.jsx(X,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Marcar todas como lidas"})]}),Ae.jsxs("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded-lg text-red-400 transition-colors flex items-center space-x-2",children:[Ae.jsx(le,{className:"w-4 h-4"}),Ae.jsx("span",{children:"Limpar todas"})]})]})]}),Ae.jsx("div",{className:"space-y-3",children:e.map(e=>{const{icon:t,color:n}=(e=>{switch(e){case"like":return{icon:ie,color:"text-red-400"};case"comment":return{icon:b,color:"text-blue-400"};case"follow":return{icon:we,color:"text-green-400"};case"session":return{icon:L,color:"text-yellow-400"};case"mood":return{icon:ie,color:"text-pink-400"};case"diary":return{icon:K,color:"text-purple-400"};case"welcome":return{icon:G,color:"text-blue-400"};default:return{icon:G,color:"text-gray-400"}}})(e.type);return Ae.jsx("div",{className:"p-4 rounded-lg border transition-all "+(e.read?"bg-white/5 border-white/10 text-white/70":"bg-blue-500/10 border-blue-500/30 text-white"),children:Ae.jsxs("div",{className:"flex items-start space-x-3",children:[Ae.jsx("div",{className:`p-2 rounded-lg bg-white/10 ${n}`,children:Ae.jsx(t,{className:"w-5 h-5"})}),Ae.jsx("div",{className:"flex-1 min-w-0",children:Ae.jsxs("div",{className:"flex items-start justify-between",children:[Ae.jsxs("div",{className:"flex-1",children:[Ae.jsx("p",{className:"font-medium mb-1",children:e.title}),Ae.jsx("p",{className:"text-sm opacity-80 mb-2",children:e.message}),Ae.jsx("span",{className:"text-xs opacity-60",children:c(e.createdAt)})]}),Ae.jsxs("div",{className:"flex items-center space-x-2 ml-3",children:[!e.read&&Ae.jsx("button",{onClick:()=>s(e.id),className:"p-1 hover:bg-white/10 rounded transition-colors",title:"Marcar como lida",children:Ae.jsx(X,{className:"w-4 h-4"})}),Ae.jsx("button",{onClick:()=>i(e.id),className:"p-1 hover:bg-red-500/20 rounded transition-colors text-red-400",title:"Deletar notificação",children:Ae.jsx(le,{className:"w-4 h-4"})})]})]})})]})},e.id)})}),o&&Ae.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:Ae.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md mx-4",children:[Ae.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Limpar todas as notificações?"}),Ae.jsx("p",{className:"text-white/70 mb-6",children:"Esta ação não pode ser desfeita. Todas as notificações serão removidas permanentemente."}),Ae.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.jsx("button",{onClick:()=>l(!1),className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors",children:"Cancelar"}),Ae.jsx("button",{onClick:()=>{a(),l(!1)},className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:"Limpar todas"})]})]})})]})},Sy=({children:e})=>{const{user:t,loading:n}=Tb();return n?Ae.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("div",{className:"text-white ml-3",children:"Carregando..."})]}):t?e:Ae.jsx(It,{to:"/login",replace:!0})},Iy=({children:e})=>{const{user:t,loading:n,needsProfileCompletion:s}=Tb();return n?Ae.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("div",{className:"text-white ml-3",children:"Carregando..."})]}):t?s?Ae.jsx(It,{to:"/complete-profile",replace:!0}):e:Ae.jsx(It,{to:"/login",replace:!0})},Ty=[{path:"/",element:Ae.jsx(Db,{}),public:!0,title:"Sereno - Início"},{path:"/login",element:Ae.jsx(Ob,{}),public:!0,title:"Sereno - Login"},{path:"/register",element:Ae.jsx(Mb,{}),public:!0,title:"Sereno - Registro"},{path:"/connected",element:Ae.jsx(Fb,{}),public:!0,title:"Sereno - Conectado"},{path:"/complete-profile",element:Ae.jsx(Sy,{children:Ae.jsx(Qb,{})}),protected:!0,title:"Sereno - Completar Perfil",category:"profile"},{path:"/home",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(hy,{})})}),protected:!0,title:"Sereno - Home",category:"main"},{path:"/home/profile",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(xy,{})})}),protected:!0,title:"Sereno - Meu Perfil",category:"main"},{path:"/home/sessions",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(jy,{})})}),protected:!0,title:"Sereno - Sessões de Terapia",category:"main"},{path:"/home/diary",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(py,{})})}),protected:!0,title:"Sereno - Diário Interativo",category:"main"},{path:"/home/humor",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(fy,{})})}),protected:!0,title:"Sereno - Rastreador de Humor",category:"main"},{path:"/home/chat/:roomCode",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(Cy,{})})}),protected:!0,title:"Sereno - Chat ao Vivo",category:"main"},{path:"/home/chat",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(Cy,{})})}),protected:!0,title:"Sereno - Chat ao Vivo",category:"main"},{path:"/home/groups",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(yy,{})})}),protected:!0,title:"Sereno - Grupos",category:"main"},{path:"/home/notifications",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(Ey,{})})}),protected:!0,title:"Sereno - Notificações",category:"main"},{path:"/home/settings",element:Ae.jsx(Iy,{children:Ae.jsx(Zv,{children:Ae.jsx(_y,{})})}),protected:!0,title:"Sereno - Configurações",category:"main"},{path:"/profile",element:Ae.jsx(Iy,{children:Ae.jsx(xy,{})}),protected:!0,title:"Sereno - Meu Perfil",category:"main"},{path:"/profile/:userId",element:Ae.jsx(Iy,{children:Ae.jsx(xy,{})}),protected:!0,title:"Sereno - Perfil",category:"main"},{path:"/user/:userId",element:Ae.jsx(Iy,{children:Ae.jsx(by,{})}),protected:!0,title:"Sereno - Perfil do Usuário",category:"main"},{path:"/welcome-tour",element:Ae.jsx(Iy,{children:Ae.jsx(Yv,{})}),protected:!0,title:"Sereno - Tour de Boas-vindas",category:"main"},{path:"/groups",element:Ae.jsx(Iy,{children:Ae.jsx(yy,{})}),protected:!0,title:"Sereno - Grupos",category:"community"},{path:"/explore",element:Ae.jsx(Iy,{children:Ae.jsx(Ny,{})}),protected:!0,title:"Sereno - Explorar Comunidades",category:"community"},{path:"/community/:communityId",element:Ae.jsx(Iy,{children:Ae.jsx(vy,{})}),protected:!0,title:"Sereno - Comunidade",category:"community"},{path:"/humor-tracker",element:Ae.jsx(Iy,{children:Ae.jsx(fy,{})}),protected:!0,title:"Sereno - Rastreador de Humor",category:"mental-health"},{path:"/therapy-sessions",element:Ae.jsx(Iy,{children:Ae.jsx(jy,{})}),protected:!0,title:"Sereno - Sessões de Terapia",category:"mental-health"},{path:"/live-chat",element:Ae.jsx(Iy,{children:Ae.jsx(Cy,{})}),protected:!0,title:"Sereno - Chat ao Vivo",category:"communication"},{path:"/chat/:roomCode",element:Ae.jsx(Iy,{children:Ae.jsx(Cy,{})}),protected:!0,title:"Sereno - Chat",category:"communication"},{path:"/post/:postId",element:Ae.jsx(Iy,{children:Ae.jsx(ky,{})}),protected:!0,title:"Sereno - Post",category:"communication"},{path:"/settings",element:Ae.jsx(Iy,{children:Ae.jsx(_y,{})}),protected:!0,title:"Sereno - Configurações",category:"settings"},{path:"/notifications",element:Ae.jsx(Iy,{children:Ae.jsx(Ey,{})}),protected:!0,title:"Sereno - Notificações",category:"settings"},{path:"*",element:Ae.jsx(It,{to:"/",replace:!0}),public:!0,title:"Sereno - Página não encontrada"}],Ay=document.getElementById("root"),Ry=Ay?Te(Ay):null;function Dy(){const{user:e,loading:t}=Tb();return t?Ae.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Ae.jsx("div",{className:"loading-spinner"}),Ae.jsx("div",{className:"text-white ml-3",children:"Carregando..."})]}):Ae.jsx(Rt,{children:Ty.map(e=>Ae.jsx(Tt,{path:e.path,element:e.element},e.path))})}Ry&&Ry.render(Ae.jsx(f.StrictMode,{children:Ae.jsx(en,{children:Ae.jsx(Ib,{children:Ae.jsx(Dy,{})})})}))}},function(){return Ae||(0,Te[s(Te)[0]])((Ae={exports:{}}).exports,Ae),Ae.exports});export default Re();
