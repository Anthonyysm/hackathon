var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertyNames,n=Object.getOwnPropertySymbols,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=Reflect.get,c=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,d=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&c(e,s,t[s]);if(n)for(var s of n(t))o.call(t,s)&&c(e,s,t[s]);return e},u=(e,r)=>t(e,s(r)),h=(e,t)=>{var s={};for(var r in e)a.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&n)for(var r of n(e))t.indexOf(r)<0&&o.call(e,r)&&(s[r]=e[r]);return s},m=(e,t,s)=>l(i(e),s,t),p=(e,t,s)=>new Promise((r,n)=>{var i=e=>{try{o(s.next(e))}catch(t){n(t)}},a=e=>{try{o(s.throw(e))}catch(t){n(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,a);o((s=s.apply(e,t)).next())});import{r as f,a as g,R as x}from"./vendor-DtX1tuCI.js";import{X as v,M as b,H as w,S as y,Q as N,a as j,b as C,P as k,c as S,I as E,F as _,T,L as I,U as A,d as D,B as P,e as R,f as L,A as O,g as M,h as U,C as F,i as V,j as z,k as $,l as B,m as q,n as H,o as G,G as W,p as K,q as Q,r as J,s as Y,t as Z,u as ee,v as te,w as se,x as re,y as ne,z as ie,D as ae,E as oe,J as le,K as ce,N as de,O as ue,R as he,V as me,W as pe,Y as fe,Z as ge,_ as xe,$ as ve,a0 as be,a1 as we,a2 as ye,a3 as Ne,a4 as je,a5 as Ce,a6 as ke,a7 as Se,a8 as Ee,a9 as _e,aa as Te,ab as Ie,ac as Ae,ad as De,ae as Pe,af as Re,ag as Le,ah as Oe,ai as Me,aj as Ue,ak as Fe,al as Ve,am as ze,an as $e,ao as Be,ap as qe}from"./icons-ClAbeBfc.js";import{R as He,T as Ge,P as We,M as Ke}from"./plasma-CZgGTPYz.js";var Qe,Je,Ye=(Qe={"assets/js/index-4qdnsIMH.js"(e){!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var t={exports:{}},s={},r=f,n=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,s){var r,i={},c=null,d=null;for(r in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:n,type:e,key:c,ref:d,props:i,_owner:o.current}}s.Fragment=i,s.jsx=c,s.jsxs=c,t.exports=s;var Qe,Je=t.exports,Ye=g;Qe=Ye.createRoot,Ye.hydrateRoot;
/**
     * react-router v7.8.2
     *
     * Copyright (c) Remix Software Inc.
     *
     * This source code is licensed under the MIT license found in the
     * LICENSE.md file in the root directory of this source tree.
     *
     * @license MIT
     */
var Xe="popstate";function Ze(e={}){return function(e,t,s,r={}){let{window:n=document.defaultView,v5Compat:i=!1}=r,a=n.history,o="POP",l=null,c=h();function h(){return(a.state||{idx:null}).idx}function m(){o="POP";let e=h(),t=null==e?null:e-c;c=e,l&&l({action:o,location:x.location,delta:t})}function p(e,t){o="PUSH";let s=rt(x.location,e,t);c=h()+1;let r=st(s,c),d=x.createHref(s);try{a.pushState(r,"",d)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;n.location.assign(d)}i&&l&&l({action:o,location:x.location,delta:1})}function f(e,t){o="REPLACE";let s=rt(x.location,e,t);c=h();let r=st(s,c),n=x.createHref(s);a.replaceState(r,"",n),i&&l&&l({action:o,location:x.location,delta:0})}function g(e){return function(e,t=!1){let s="http://localhost";"undefined"!=typeof window&&(s="null"!==window.location.origin?window.location.origin:window.location.href),et(s,"No window.location.(origin|href) available to create URL");let r="string"==typeof e?e:nt(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=s+r),new URL(r,s)}(e)}null==c&&(c=0,a.replaceState(u(d({},a.state),{idx:c}),""));let x={get action(){return o},get location(){return e(n,a)},listen(e){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(Xe,m),l=e,()=>{n.removeEventListener(Xe,m),l=null}},createHref:e=>t(n,e),createURL:g,encodeLocation(e){let t=g(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:p,replace:f,go:e=>a.go(e)};return x}(function(e,t){let{pathname:s,search:r,hash:n}=e.location;return rt("",{pathname:s,search:r,hash:n},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:nt(t)},0,e)}function et(e,t){if(!1===e||null==e)throw new Error(t)}function tt(e,t){if(!e)try{throw new Error(t)}catch(s){}}function st(e,t){return{usr:e.state,key:e.key,idx:t}}function rt(e,t,s=null,r){return u(d({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?it(t):t),{state:s,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function nt({pathname:e="/",search:t="",hash:s=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),s&&"#"!==s&&(e+="#"===s.charAt(0)?s:"#"+s),e}function it(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substring(s),e=e.substring(0,s));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function at(e,t,s="/"){return function(e,t,s,r){let n="string"==typeof t?it(t):t,i=ft(n.pathname||"/",s);if(null==i)return null;let a=ot(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s]);return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(a);let o=null;for(let l=0;null==o&&l<a.length;++l){let e=pt(i);o=ht(a[l],e,r)}return o}(e,t,s,!1)}function ot(e,t=[],s=[],r="",n=!1){let i=(e,i,a=n,o)=>{let l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&a)return;et(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length)}let c=bt([r,l.relativePath]),d=s.concat(l);e.children&&e.children.length>0&&(et(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),ot(e.children,t,d,c,a)),(null!=e.path||e.index)&&t.push({path:c,score:ut(c,e.index),routesMeta:d})};return e.forEach((e,t)=>{var s;if(""!==e.path&&(null==(s=e.path)?void 0:s.includes("?")))for(let r of lt(e.path))i(e,t,!0,r);else i(e,t)}),t}function lt(e){let t=e.split("/");if(0===t.length)return[];let[s,...r]=t,n=s.endsWith("?"),i=s.replace(/\?$/,"");if(0===r.length)return n?[i,""]:[i];let a=lt(r.join("/")),o=[];return o.push(...a.map(e=>""===e?i:[i,e].join("/"))),n&&o.push(...a),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var ct=/^:[\w-]+$/,dt=e=>"*"===e;function ut(e,t){let s=e.split("/"),r=s.length;return s.some(dt)&&(r+=-2),t&&(r+=2),s.filter(e=>!dt(e)).reduce((e,t)=>e+(ct.test(t)?3:""===t?1:10),r)}function ht(e,t,s=!1){let{routesMeta:r}=e,n={},i="/",a=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===i?t:t.slice(i.length)||"/",d=mt({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&s&&!r[r.length-1].route.index&&(d=mt({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(n,d.params),a.push({params:n,pathname:bt([i,d.pathname]),pathnameBase:wt(bt([i,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(i=bt([i,d.pathnameBase]))}return a}function mt(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,r]=function(e,t=!1,s=!0){tt("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(r.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");e.endsWith("*")?(r.push({paramName:"*"}),n+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?n+="\\/*$":""!==e&&"/"!==e&&(n+="(?:(?=\\/|$))");let i=new RegExp(n,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),n=t.match(s);if(!n)return null;let i=n[0],a=i.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:r.reduce((e,{paramName:t,isOptional:s},r)=>{if("*"===t){let e=o[r]||"";a=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const n=o[r];return e[t]=s&&!n?void 0:(n||"").replace(/%2F/g,"/"),e},{}),pathname:i,pathnameBase:a,pattern:e}}function pt(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return tt(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function ft(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,r=e.charAt(s);return r&&"/"!==r?null:e.slice(s)||"/"}function gt(e,t,s,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function xt(e){let t=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t.map((e,s)=>s===t.length-1?e.pathname:e.pathnameBase)}function vt(e,t,s,r=!1){let n;"string"==typeof e?n=it(e):(n=d({},e),et(!n.pathname||!n.pathname.includes("?"),gt("?","pathname","search",n)),et(!n.pathname||!n.pathname.includes("#"),gt("#","pathname","hash",n)),et(!n.search||!n.search.includes("#"),gt("#","search","hash",n)));let i,a=""===e||""===n.pathname,o=a?"/":n.pathname;if(null==o)i=s;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=function(e,t="/"){let{pathname:s,search:r="",hash:n=""}="string"==typeof e?it(e):e,i=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:i,search:yt(r),hash:Nt(n)}}(n,i),c=o&&"/"!==o&&o.endsWith("/"),u=(a||"."===o)&&s.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}var bt=e=>e.join("/").replace(/\/\/+/g,"/"),wt=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),yt=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Nt=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"",jt=["POST","PUT","PATCH","DELETE"];new Set(jt);var Ct=["GET",...jt];new Set(Ct);var kt=f.createContext(null);kt.displayName="DataRouter";var St=f.createContext(null);St.displayName="DataRouterState",f.createContext(!1);var Et=f.createContext({isTransitioning:!1});Et.displayName="ViewTransition",f.createContext(new Map).displayName="Fetchers",f.createContext(null).displayName="Await";var _t=f.createContext(null);_t.displayName="Navigation";var Tt=f.createContext(null);Tt.displayName="Location";var It=f.createContext({outlet:null,matches:[],isDataRoute:!1});It.displayName="Route";var At=f.createContext(null);function Dt(){return null!=f.useContext(Tt)}function Pt(){return et(Dt(),"useLocation() may be used only in the context of a <Router> component."),f.useContext(Tt).location}At.displayName="RouteError";var Rt="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Lt(e){f.useContext(_t).static||f.useLayoutEffect(e)}function Ot(){let{isDataRoute:e}=f.useContext(It);return e?function(){let{router:e}=function(e){let t=f.useContext(kt);return et(t,qt(e)),t}("useNavigate"),t=Ht("useNavigate"),s=f.useRef(!1);return Lt(()=>{s.current=!0}),f.useCallback((r,...n)=>p(this,[r,...n],function*(r,n={}){tt(s.current,Rt),s.current&&("number"==typeof r?e.navigate(r):yield e.navigate(r,d({fromRouteId:t},n)))}),[e,t])}():function(){et(Dt(),"useNavigate() may be used only in the context of a <Router> component.");let e=f.useContext(kt),{basename:t,navigator:s}=f.useContext(_t),{matches:r}=f.useContext(It),{pathname:n}=Pt(),i=JSON.stringify(xt(r)),a=f.useRef(!1);return Lt(()=>{a.current=!0}),f.useCallback((r,o={})=>{if(tt(a.current,Rt),!a.current)return;if("number"==typeof r)return void s.go(r);let l=vt(r,JSON.parse(i),n,"path"===o.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:bt([t,l.pathname])),(o.replace?s.replace:s.push)(l,o.state,o)},[t,s,i,n,e])}()}function Mt(){let{matches:e}=f.useContext(It),t=e[e.length-1];return t?t.params:{}}function Ut(e,{relative:t}={}){let{matches:s}=f.useContext(It),{pathname:r}=Pt(),n=JSON.stringify(xt(s));return f.useMemo(()=>vt(e,JSON.parse(n),r,"path"===t),[e,n,r,t])}function Ft(e,t,s,r,n){var i;et(Dt(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=f.useContext(_t),{matches:o}=f.useContext(It),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",h=l?l.pathnameBase:"/",m=l&&l.route;{let e=m&&m.path||"";Wt(u,!m||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let p,g=Pt();if(t){let e="string"==typeof t?it(t):t;et("/"===h||(null==(i=e.pathname)?void 0:i.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${e.pathname}" was given in the \`location\` prop.`),p=e}else p=g;let x=p.pathname||"/",v=x;if("/"!==h){let e=h.replace(/^\//,"").split("/");v="/"+x.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=at(e,{pathname:v});tt(m||null!=b,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),tt(null==b||void 0!==b[b.length-1].route.element||void 0!==b[b.length-1].route.Component||void 0!==b[b.length-1].route.lazy,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=function(e,t=[],s=null,r=null){if(null==e){if(!s)return null;if(s.errors)e=s.matches;else{if(0!==t.length||s.initialized||!(s.matches.length>0))return null;e=s.matches}}let n=e,i=null==s?void 0:s.errors;if(null!=i){let e=n.findIndex(e=>e.route.id&&void 0!==(null==i?void 0:i[e.route.id]));et(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),n=n.slice(0,Math.min(n.length,e+1))}let a=!1,o=-1;if(s)for(let l=0;l<n.length;l++){let e=n[l];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(o=l),e.route.id){let{loaderData:t,errors:r}=s,i=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){a=!0,n=o>=0?n.slice(0,o+1):[n[0]];break}}}return n.reduceRight((e,l,c)=>{let d,u=!1,h=null,m=null;s&&(d=i&&l.route.id?i[l.route.id]:void 0,h=l.route.errorElement||zt,a&&(o<0&&0===c?(Wt("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),u=!0,m=null):o===c&&(u=!0,m=l.route.hydrateFallbackElement||null)));let p=t.concat(n.slice(0,c+1)),g=()=>{let t;return t=d?h:u?m:l.route.Component?f.createElement(l.route.Component,null):l.route.element?l.route.element:e,f.createElement(Bt,{match:l,routeContext:{outlet:e,matches:p,isDataRoute:null!=s},children:t})};return s&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?f.createElement($t,{location:s.location,revalidation:s.revalidation,component:h,error:d,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0},unstable_onError:r}):g()},null)}(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:bt([h,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:bt([h,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,s,r);return t&&w?f.createElement(Tt.Provider,{value:{location:d({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:"POP"}},w):w}function Vt(){let e=function(){var e;let t=f.useContext(At),s=function(e){let t=f.useContext(St);return et(t,qt(e)),t}("useRouteError"),r=Ht("useRouteError");return void 0!==t?t:null==(e=s.errors)?void 0:e[r]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},a=null;return a=f.createElement(f.Fragment,null,f.createElement("p",null,"💿 Hey developer 👋"),f.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",f.createElement("code",{style:i},"ErrorBoundary")," or"," ",f.createElement("code",{style:i},"errorElement")," prop on your route.")),f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},t),s?f.createElement("pre",{style:n},s):null,a)}f.createContext(null);var zt=f.createElement(Vt,null),$t=class extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError&&this.props.unstable_onError(e,t)}render(){return void 0!==this.state.error?f.createElement(It.Provider,{value:this.props.routeContext},f.createElement(At.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Bt({routeContext:e,match:t,children:s}){let r=f.useContext(kt);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),f.createElement(It.Provider,{value:e},s)}function qt(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ht(e){let t=function(e){let t=f.useContext(It);return et(t,qt(e)),t}(e),s=t.matches[t.matches.length-1];return et(s.route.id,`${e} can only be used on routes that contain a unique "id"`),s.route.id}var Gt={};function Wt(e,t,s){t||Gt[e]||(Gt[e]=!0,tt(!1,s))}function Kt({to:e,replace:t,state:s,relative:r}){et(Dt(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=f.useContext(_t);tt(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=f.useContext(It),{pathname:a}=Pt(),o=Ot(),l=vt(e,xt(i),a,"path"===r),c=JSON.stringify(l);return f.useEffect(()=>{o(JSON.parse(c),{replace:t,state:s,relative:r})},[o,c,r,t,s]),null}function Qt(e){et(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Jt({basename:e="/",children:t=null,location:s,navigationType:r="POP",navigator:n,static:i=!1}){et(!Dt(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=e.replace(/^\/*/,"/"),o=f.useMemo(()=>({basename:a,navigator:n,static:i,future:{}}),[a,n,i]);"string"==typeof s&&(s=it(s));let{pathname:l="/",search:c="",hash:d="",state:u=null,key:h="default"}=s,m=f.useMemo(()=>{let e=ft(l,a);return null==e?null:{location:{pathname:e,search:c,hash:d,state:u,key:h},navigationType:r}},[a,l,c,d,u,h,r]);return tt(null!=m,`<Router basename="${a}"> is not able to match the URL "${l}${c}${d}" because it does not start with the basename, so the <Router> won't render anything.`),null==m?null:f.createElement(_t.Provider,{value:o},f.createElement(Tt.Provider,{children:t,value:m}))}function Yt({children:e,location:t}){return Ft(Xt(e),t)}function Xt(e,t=[]){let s=[];return f.Children.forEach(e,(e,r)=>{if(!f.isValidElement(e))return;let n=[...t,r];if(e.type===f.Fragment)return void s.push.apply(s,Xt(e.props.children,n));et(e.type===Qt,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),et(!e.props.index||!e.props.children,"An index route cannot have child routes.");let i={id:e.props.id||n.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Xt(e.props.children,n)),s.push(i)}),s}f.memo(function({routes:e,future:t,state:s,unstable_onError:r}){return Ft(e,void 0,s,r,t)});var Zt="get",es="application/x-www-form-urlencoded";function ts(e){return null!=e&&"string"==typeof e.tagName}var ss=null,rs=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ns(e){return null==e||rs.has(e)?e:(tt(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${es}"`),null)}function is(e,t){let s,r,n,i,a;if(ts(o=e)&&"form"===o.tagName.toLowerCase()){let a=e.getAttribute("action");r=a?ft(a,t):null,s=e.getAttribute("method")||Zt,n=ns(e.getAttribute("enctype"))||es,i=new FormData(e)}else if(function(e){return ts(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return ts(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||a.getAttribute("action");if(r=o?ft(o,t):null,s=e.getAttribute("formmethod")||a.getAttribute("method")||Zt,n=ns(e.getAttribute("formenctype"))||ns(a.getAttribute("enctype"))||es,i=new FormData(a,e),!function(){if(null===ss)try{new FormData(document.createElement("form"),0),ss=!1}catch(e){ss=!0}return ss}()){let{name:t,type:s,value:r}=e;if("image"===s){let e=t?`${t}.`:"";i.append(`${e}x`,"0"),i.append(`${e}y`,"0")}else t&&i.append(t,r)}}else{if(ts(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=Zt,r=null,n=es,a=e}var o;return i&&"text/plain"===n&&(a=i,i=void 0),{action:r,method:s.toLowerCase(),encType:n,formData:i,body:a}}function as(e,t){if(!1===e||null==e)throw new Error(t)}function os(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function ls(e,t,s){return p(this,null,function*(){return function(e,t){let s=new Set;return new Set(t),e.reduce((e,t)=>{let r=JSON.stringify(function(e){let t={},s=Object.keys(e).sort();for(let r of s)t[r]=e[r];return t}(t));return s.has(r)||(s.add(r),e.push({key:r,link:t})),e},[])}((yield Promise.all(e.map(e=>p(this,null,function*(){let r=t.routes[e.route.id];if(r){let e=yield function(e,t){return p(this,null,function*(){if(e.id in t)return t[e.id];try{let s=yield import(e.module);return t[e.id]=s,s}catch(s){return window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}})}(r,s);return e.links?e.links():[]}return[]})))).flat(1).filter(os).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?u(d({},e),{rel:"prefetch",as:"style"}):u(d({},e),{rel:"prefetch"})))})}function cs(e,t,s,r,n,i){let a=(e,t)=>!s[t]||e.route.id!==s[t].route.id,o=(e,t)=>{var r;return s[t].pathname!==e.pathname||(null==(r=s[t].route.path)?void 0:r.endsWith("*"))&&s[t].params["*"]!==e.params["*"]};return"assets"===i?t.filter((e,t)=>a(e,t)||o(e,t)):"data"===i?t.filter((t,i)=>{var l;let c=r.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(a(t,i)||o(t,i))return!0;if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:(null==(l=s[0])?void 0:l.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof r)return r}return!0}):[]}function ds(e,t,{includeHydrateFallback:s}={}){return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let n=[r.module];return r.clientActionModule&&(n=n.concat(r.clientActionModule)),r.clientLoaderModule&&(n=n.concat(r.clientLoaderModule)),s&&r.hydrateFallbackModule&&(n=n.concat(r.hydrateFallbackModule)),r.imports&&(n=n.concat(r.imports)),n}).flat(1),[...new Set(r)];var r}function us(){let e=f.useContext(kt);return as(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var hs=f.createContext(void 0);function ms(){let e=f.useContext(hs);return as(e,"You must render this element inside a <HydratedRouter> element"),e}function ps(e,t){return s=>{e&&e(s),s.defaultPrevented||t(s)}}function fs(e){var t=e,{page:s}=t,r=h(t,["page"]);let{router:n}=us(),i=f.useMemo(()=>at(n.routes,s,n.basename),[n.routes,s,n.basename]);return i?f.createElement(gs,d({page:s,matches:i},r)):null}function gs(e){var t=e,{page:s,matches:r}=t,n=h(t,["page","matches"]);let i=Pt(),{manifest:a,routeModules:o}=ms(),{basename:l}=us(),{loaderData:c,matches:u}=function(){let e=f.useContext(St);return as(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}(),m=f.useMemo(()=>cs(s,r,u,a,i,"data"),[s,r,u,a,i]),p=f.useMemo(()=>cs(s,r,u,a,i,"assets"),[s,r,u,a,i]),g=f.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let e=new Set,t=!1;if(r.forEach(s=>{var r;let n=a.routes[s.route.id];n&&n.hasLoader&&(!m.some(e=>e.route.id===s.route.id)&&s.route.id in c&&(null==(r=o[s.route.id])?void 0:r.shouldRevalidate)||n.hasClientLoader?t=!0:e.add(s.route.id))}),0===e.size)return[];let n=function(e,t,s){let r="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname=`_root.${s}`:t&&"/"===ft(r.pathname,t)?r.pathname=`${t.replace(/\/$/,"")}/_root.${s}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${s}`,r}(s,l,"data");return t&&e.size>0&&n.searchParams.set("_routes",r.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[n.pathname+n.search]},[l,c,i,a,m,r,s,o]),x=f.useMemo(()=>ds(p,a),[p,a]),v=function(e){let{manifest:t,routeModules:s}=ms(),[r,n]=f.useState([]);return f.useEffect(()=>{let r=!1;return ls(e,t,s).then(e=>{r||n(e)}),()=>{r=!0}},[e,t,s]),r}(p);return f.createElement(f.Fragment,null,g.map(e=>f.createElement("link",d({key:e,rel:"prefetch",as:"fetch",href:e},n))),x.map(e=>f.createElement("link",d({key:e,rel:"modulepreload",href:e},n))),v.map(({key:e,link:t})=>f.createElement("link",d({key:e,nonce:n.nonce},t))))}function xs(...e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}hs.displayName="FrameworkContext";var vs="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{vs&&(window.__reactRouterVersion="7.8.2")}catch(xN){}function bs({basename:e,children:t,window:s}){let r=f.useRef();null==r.current&&(r.current=Ze({window:s,v5Compat:!0}));let n=r.current,[i,a]=f.useState({action:n.action,location:n.location}),o=f.useCallback(e=>{f.startTransition(()=>a(e))},[a]);return f.useLayoutEffect(()=>n.listen(o),[n,o]),f.createElement(Jt,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:n})}var ws=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ys=f.forwardRef(function(e,t){var s=e,{onClick:r,discover:n="render",prefetch:i="none",relative:a,reloadDocument:o,replace:l,state:c,target:m,to:p,preventScrollReset:g,viewTransition:x}=s,v=h(s,["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"]);let b,{basename:w}=f.useContext(_t),y="string"==typeof p&&ws.test(p),N=!1;if("string"==typeof p&&y&&(b=p,vs))try{let e=new URL(window.location.href),t=p.startsWith("//")?new URL(e.protocol+p):new URL(p),s=ft(t.pathname,w);t.origin===e.origin&&null!=s?p=s+t.search+t.hash:N=!0}catch(xN){tt(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let j=function(e,{relative:t}={}){et(Dt(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:r}=f.useContext(_t),{hash:n,pathname:i,search:a}=Ut(e,{relative:t}),o=i;return"/"!==s&&(o="/"===i?s:bt([s,i])),r.createHref({pathname:o,search:a,hash:n})}(p,{relative:a}),[C,k,S]=function(e,t){let s=f.useContext(hs),[r,n]=f.useState(!1),[i,a]=f.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:d,onTouchStart:u}=t,h=f.useRef(null);f.useEffect(()=>{if("render"===e&&a(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{a(e.isIntersecting)})},{threshold:.5});return h.current&&e.observe(h.current),()=>{e.disconnect()}}},[e]),f.useEffect(()=>{if(r){let e=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(e)}}},[r]);let m=()=>{n(!0)},p=()=>{n(!1),a(!1)};return s?"intent"!==e?[i,h,{}]:[i,h,{onFocus:ps(o,m),onBlur:ps(l,p),onMouseEnter:ps(c,m),onMouseLeave:ps(d,p),onTouchStart:ps(u,m)}]:[!1,h,{}]}(i,v),E=function(e,{target:t,replace:s,state:r,preventScrollReset:n,relative:i,viewTransition:a}={}){let o=Ot(),l=Pt(),c=Ut(e,{relative:i});return f.useCallback(d=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(d,t)){d.preventDefault();let t=void 0!==s?s:nt(l)===nt(c);o(e,{replace:t,state:r,preventScrollReset:n,relative:i,viewTransition:a})}},[l,o,c,s,r,t,e,n,i,a])}(p,{replace:l,state:c,target:m,preventScrollReset:g,relative:a,viewTransition:x}),_=f.createElement("a",u(d(d({},v),S),{href:b||j,onClick:N||o?r:function(e){r&&r(e),e.defaultPrevented||E(e)},ref:xs(t,k),target:m,"data-discover":y||"render"!==n?void 0:"true"}));return C&&!y?f.createElement(f.Fragment,null,_,f.createElement(fs,{page:j})):_});function Ns(e){let t=f.useContext(kt);return et(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}ys.displayName="Link",f.forwardRef(function(e,t){var s=e,{"aria-current":r="page",caseSensitive:n=!1,className:i="",end:a=!1,style:o,to:l,viewTransition:c,children:m}=s,p=h(s,["aria-current","caseSensitive","className","end","style","to","viewTransition","children"]);let g=Ut(l,{relative:p.relative}),x=Pt(),v=f.useContext(St),{navigator:b,basename:w}=f.useContext(_t),y=null!=v&&function(e,{relative:t}={}){let s=f.useContext(Et);et(null!=s,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Ns("useViewTransitionState"),n=Ut(e,{relative:t});if(!s.isTransitioning)return!1;let i=ft(s.currentLocation.pathname,r)||s.currentLocation.pathname,a=ft(s.nextLocation.pathname,r)||s.nextLocation.pathname;return null!=mt(n.pathname,a)||null!=mt(n.pathname,i)}(g)&&!0===c,N=b.encodeLocation?b.encodeLocation(g).pathname:g.pathname,j=x.pathname,C=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(j=j.toLowerCase(),C=C?C.toLowerCase():null,N=N.toLowerCase()),C&&w&&(C=ft(C,w)||C);const k="/"!==N&&N.endsWith("/")?N.length-1:N.length;let S,E=j===N||!a&&j.startsWith(N)&&"/"===j.charAt(k),_=null!=C&&(C===N||!a&&C.startsWith(N)&&"/"===C.charAt(N.length)),T={isActive:E,isPending:_,isTransitioning:y},I=E?r:void 0;S="function"==typeof i?i(T):[i,E?"active":null,_?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let A="function"==typeof o?o(T):o;return f.createElement(ys,u(d({},p),{"aria-current":I,className:S,ref:t,style:A,to:l,viewTransition:c}),"function"==typeof m?m(T):m)}).displayName="NavLink",f.forwardRef((e,t)=>{var s=e,{discover:r="render",fetcherKey:n,navigate:i,reloadDocument:a,replace:o,state:l,method:c=Zt,action:m,onSubmit:g,relative:x,preventScrollReset:v,viewTransition:b}=s,w=h(s,["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"]);let y=function(){let{router:e}=Ns("useSubmit"),{basename:t}=f.useContext(_t),s=Ht("useRouteId");return f.useCallback((r,...n)=>p(this,[r,...n],function*(r,n={}){let{action:i,method:a,encType:o,formData:l,body:c}=is(r,t);if(!1===n.navigate){let t=n.fetcherKey||`__${String(++js)}__`;yield e.fetch(t,s,n.action||i,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||a,formEncType:n.encType||o,flushSync:n.flushSync})}else yield e.navigate(n.action||i,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||a,formEncType:n.encType||o,replace:n.replace,state:n.state,fromRouteId:s,flushSync:n.flushSync,viewTransition:n.viewTransition})}),[e,t,s])}(),N=function(e,{relative:t}={}){let{basename:s}=f.useContext(_t),r=f.useContext(It);et(r,"useFormAction must be used inside a RouteContext");let[n]=r.matches.slice(-1),i=d({},Ut(e||".",{relative:t})),a=Pt();if(null==e){i.search=a.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let s=e.toString();i.search=s?`?${s}`:""}}return e&&"."!==e||!n.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),"/"!==s&&(i.pathname="/"===i.pathname?s:bt([s,i.pathname])),nt(i)}(m,{relative:x}),j="get"===c.toLowerCase()?"get":"post",C="string"==typeof m&&ws.test(m);return f.createElement("form",u(d({ref:t,method:j,action:N,onSubmit:a?g:e=>{if(g&&g(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,s=(null==t?void 0:t.getAttribute("formmethod"))||c;y(t||e.currentTarget,{fetcherKey:n,method:s,navigate:i,replace:o,state:l,relative:x,preventScrollReset:v,viewTransition:b})}},w),{"data-discover":C||"render"!==r?void 0:"true"}))}).displayName="Form";var js=0,Cs={};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ks=function(e){const t=[];let s=0;for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);n<128?t[s++]=n:n<2048?(t[s++]=n>>6|192,t[s++]=63&n|128):55296==(64512&n)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(n=65536+((1023&n)<<10)+(1023&e.charCodeAt(++r)),t[s++]=n>>18|240,t[s++]=n>>12&63|128,t[s++]=n>>6&63|128,t[s++]=63&n|128):(t[s++]=n>>12|224,t[s++]=n>>6&63|128,t[s++]=63&n|128)}return t},Ss={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let n=0;n<e.length;n+=3){const t=e[n],i=n+1<e.length,a=i?e[n+1]:0,o=n+2<e.length,l=o?e[n+2]:0,c=t>>2,d=(3&t)<<4|a>>4;let u=(15&a)<<2|l>>6,h=63&l;o||(h=64,i||(u=64)),r.push(s[c],s[d],s[u],s[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(ks(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let s=0,r=0;for(;s<e.length;){const n=e[s++];if(n<128)t[r++]=String.fromCharCode(n);else if(n>191&&n<224){const i=e[s++];t[r++]=String.fromCharCode((31&n)<<6|63&i)}else if(n>239&&n<365){const i=((7&n)<<18|(63&e[s++])<<12|(63&e[s++])<<6|63&e[s++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[s++],a=e[s++];t[r++]=String.fromCharCode((15&n)<<12|(63&i)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const s=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let n=0;n<e.length;){const t=s[e.charAt(n++)],i=n<e.length?s[e.charAt(n)]:0;++n;const a=n<e.length?s[e.charAt(n)]:64;++n;const o=n<e.length?s[e.charAt(n)]:64;if(++n,null==t||null==i||null==a||null==o)throw new Es;const l=t<<2|i>>4;if(r.push(l),64!==a){const e=i<<4&240|a>>2;if(r.push(e),64!==o){const e=a<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Es extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _s=function(e){return function(e){const t=ks(e);return Ss.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Ts=function(e){try{return Ss.decodeString(e,!0)}catch(xN){}return null},Is=()=>
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */().__FIREBASE_DEFAULTS__,As=()=>{try{return Is()||(()=>{if("undefined"==typeof process)return;const e=Cs.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(xN){return}const t=e&&Ts(e[1]);return t&&JSON.parse(t)})()}catch(xN){return}},Ds=e=>{var t,s;return null==(s=null==(t=As())?void 0:t.emulatorHosts)?void 0:s[e]},Ps=e=>{const t=Ds(e);if(!t)return;const s=t.lastIndexOf(":");if(s<=0||s+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(s+1),10);return"["===t[0]?[t.substring(1,s-1),r]:[t.substring(0,s),r]},Rs=()=>{var e;return null==(e=As())?void 0:e.config},Ls=e=>{var t;return null==(t=As())?void 0:t[`_${e}`]};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Os{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,s))}}}
/**
     * @license
     * Copyright 2025 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ms(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(xN){return!1}}function Us(e){return p(this,null,function*(){return(yield fetch(e,{credentials:"include"})).ok})}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fs(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s=t||"demo-project",r=e.iat||0,n=e.sub||e.user_id;if(!n)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=d({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}}},e);return[_s(JSON.stringify({alg:"none",type:"JWT"})),_s(JSON.stringify(i)),""].join(".")}const Vs={};let zs=!1;function $s(e,t){if("undefined"==typeof window||"undefined"==typeof document||!Ms(window.location.host)||Vs[e]===t||Vs[e]||zs)return;function s(e){return`__firebase__banner__${e}`}Vs[e]=t;const r="__firebase__banner",n=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(Vs))Vs[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{zs=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function a(){const e=function(e){let t=document.getElementById(e),s=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),s=!0),{created:s,element:t}}(r),t=s("text"),a=document.getElementById(t)||document.createElement("span"),o=s("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=s("preprendIcon"),d=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const s=i();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(d,c),t.append(d,a,l,s),document.body.appendChild(t)}n?(a.innerText="Preview backend disconnected.",d.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(d.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',a.innerText="Preview backend running in this workspace."),a.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Bs(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function qs(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function Hs(){return!function(){var e;const t=null==(e=As())?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(xN){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gs(){try{return"object"==typeof indexedDB}catch(xN){return!1}}function Ws(){return new Promise((e,t)=>{try{let s=!0;const r="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(r);n.onsuccess=()=>{n.result.close(),s||self.indexedDB.deleteDatabase(r),e(!0)},n.onupgradeneeded=()=>{s=!1},n.onerror=()=>{var e;t((null==(e=n.error)?void 0:e.message)||"")}}catch(s){t(s)}})}class Ks extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name="FirebaseError",Object.setPrototypeOf(this,Ks.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qs.prototype.create)}}class Qs{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,n=this.errors[e],i=n?function(e,t){return e.replace(Js,(e,s)=>{const r=t[s];return null!=r?String(r):`<${s}?>`})}(n,s):"Error",a=`${this.serviceName}: ${i} (${r}).`;return new Ks(r,a,s)}}const Js=/\{\$([^}]+)}/g;function Ys(e,t){if(e===t)return!0;const s=Object.keys(e),r=Object.keys(t);for(const n of s){if(!r.includes(n))return!1;const s=e[n],i=t[n];if(Xs(s)&&Xs(i)){if(!Ys(s,i))return!1}else if(s!==i)return!1}for(const n of r)if(!s.includes(n))return!1;return!0}function Xs(e){return null!==e&&"object"==typeof e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zs(e){const t=[];for(const[s,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(s)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(s)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function er(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[s,r]=e.split("=");t[decodeURIComponent(s)]=decodeURIComponent(r)}}),t}function tr(e){const t=e.indexOf("?");if(!t)return"";const s=e.indexOf("#",t);return e.substring(t,s>0?s:void 0)}class sr{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let r;if(void 0===e&&void 0===t&&void 0===s)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const s of t)if(s in e&&"function"==typeof e[s])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:s},void 0===r.next&&(r.next=rr),void 0===r.error&&(r.error=rr),void 0===r.complete&&(r.complete=rr);const n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(xN){}}),this.observers.push(r),n}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(xN){"undefined"!=typeof console&&console.error}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rr(){}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function nr(e,t=1e3,s=2){const r=t*Math.pow(s,e),n=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+n)}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ir(e){return e&&e._delegate?e._delegate:e}class ar{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const or="[DEFAULT]";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lr{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Os;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&e.resolve(s)}catch(xN){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!=(t=null==e?void 0:e.optional)&&t;if(!this.isInitialized(s)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:s})}catch(xN){if(r)return null;throw xN}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e))try{this.getOrInitializeService({instanceIdentifier:or})}catch(xN){}for(const[e,t]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:s});t.resolve(e)}catch(xN){}}}}clearInstance(e=or){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return p(this,null,function*(){const e=Array.from(this.instances.values());yield Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])})}isComponentSet(){return null!=this.component}isInitialized(e=or){return this.instances.has(e)}getOptions(e=or){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[n,i]of this.instancesDeferred.entries())s===this.normalizeInstanceIdentifier(n)&&i.resolve(r);return r}onInit(e,t){var s;const r=this.normalizeInstanceIdentifier(t),n=null!=(s=this.onInitCallbacks.get(r))?s:new Set;n.add(e),this.onInitCallbacks.set(r,n);const i=this.instances.get(r);return i&&e(i,r),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch(xN){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===or?void 0:r),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch(xN){}var r;return s||null}normalizeInstanceIdentifier(e=or){return this.component?this.component.multipleInstances?e:or:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class cr{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new lr(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var dr,ur;(ur=dr||(dr={}))[ur.DEBUG=0]="DEBUG",ur[ur.VERBOSE=1]="VERBOSE",ur[ur.INFO=2]="INFO",ur[ur.WARN=3]="WARN",ur[ur.ERROR=4]="ERROR",ur[ur.SILENT=5]="SILENT";const hr={debug:dr.DEBUG,verbose:dr.VERBOSE,info:dr.INFO,warn:dr.WARN,error:dr.ERROR,silent:dr.SILENT},mr=dr.INFO,pr={[dr.DEBUG]:"log",[dr.VERBOSE]:"log",[dr.INFO]:"info",[dr.WARN]:"warn",[dr.ERROR]:"error"},fr=(e,t,...s)=>{if(!(t<e.logLevel||((new Date).toISOString(),pr[t])))throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class gr{constructor(e){this.name=e,this._logLevel=mr,this._logHandler=fr,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?hr[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dr.DEBUG,...e),this._logHandler(this,dr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dr.VERBOSE,...e),this._logHandler(this,dr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dr.INFO,...e),this._logHandler(this,dr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dr.WARN,...e),this._logHandler(this,dr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dr.ERROR,...e),this._logHandler(this,dr.ERROR,...e)}}let xr,vr;const br=new WeakMap,wr=new WeakMap,yr=new WeakMap,Nr=new WeakMap,jr=new WeakMap;let Cr={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return wr.get(e);if("objectStoreNames"===t)return e.objectStoreNames||yr.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return Er(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function kr(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(vr||(vr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(_r(this),t),Er(br.get(this))}:function(...t){return Er(e.apply(_r(this),t))}:function(t,...s){const r=e.call(_r(this),t,...s);return yr.set(r,t.sort?t.sort():[t]),Er(r)}}function Sr(e){return"function"==typeof e?kr(e):(e instanceof IDBTransaction&&function(e){if(wr.has(e))return;const t=new Promise((t,s)=>{const r=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",i),e.removeEventListener("abort",i)},n=()=>{t(),r()},i=()=>{s(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",n),e.addEventListener("error",i),e.addEventListener("abort",i)});wr.set(e,t)}(e),t=e,(xr||(xr=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Cr):e);var t}function Er(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,s)=>{const r=()=>{e.removeEventListener("success",n),e.removeEventListener("error",i)},n=()=>{t(Er(e.result)),r()},i=()=>{s(e.error),r()};e.addEventListener("success",n),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&br.set(t,e)}).catch(()=>{}),jr.set(t,e),t}(e);if(Nr.has(e))return Nr.get(e);const t=Sr(e);return t!==e&&(Nr.set(e,t),jr.set(t,e)),t}const _r=e=>jr.get(e);function Tr(e,t,{blocked:s,upgrade:r,blocking:n,terminated:i}={}){const a=indexedDB.open(e,t),o=Er(a);return r&&a.addEventListener("upgradeneeded",e=>{r(Er(a.result),e.oldVersion,e.newVersion,Er(a.transaction),e)}),s&&a.addEventListener("blocked",e=>s(e.oldVersion,e.newVersion,e)),o.then(e=>{i&&e.addEventListener("close",()=>i()),n&&e.addEventListener("versionchange",e=>n(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}const Ir=["get","getKey","getAll","getAllKeys","count"],Ar=["put","add","delete","clear"],Dr=new Map;function Pr(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Dr.get(t))return Dr.get(t);const s=t.replace(/FromIndex$/,""),r=t!==s,n=Ar.includes(s);if(!(s in(r?IDBIndex:IDBObjectStore).prototype)||!n&&!Ir.includes(s))return;const i=function(e,...t){return p(this,null,function*(){const i=this.transaction(e,n?"readwrite":"readonly");let a=i.store;return r&&(a=a.index(t.shift())),(yield Promise.all([a[s](...t),n&&i.done]))[0]})};return Dr.set(t,i),i}var Rr;Cr=u(d({},Rr=Cr),{get:(e,t,s)=>Pr(e,t)||Rr.get(e,t,s),has:(e,t)=>!!Pr(e,t)||Rr.has(e,t)});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Lr{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const Or="@firebase/app",Mr="0.14.1",Ur=new gr("@firebase/app"),Fr="@firebase/app-compat",Vr="@firebase/analytics-compat",zr="@firebase/analytics",$r="@firebase/app-check-compat",Br="@firebase/app-check",qr="@firebase/auth",Hr="@firebase/auth-compat",Gr="@firebase/database",Wr="@firebase/data-connect",Kr="@firebase/database-compat",Qr="@firebase/functions",Jr="@firebase/functions-compat",Yr="@firebase/installations",Xr="@firebase/installations-compat",Zr="@firebase/messaging",en="@firebase/messaging-compat",tn="@firebase/performance",sn="@firebase/performance-compat",rn="@firebase/remote-config",nn="@firebase/remote-config-compat",an="@firebase/storage",on="@firebase/storage-compat",ln="@firebase/firestore",cn="@firebase/ai",dn="@firebase/firestore-compat",un="firebase",hn="[DEFAULT]",mn={[Or]:"fire-core",[Fr]:"fire-core-compat",[zr]:"fire-analytics",[Vr]:"fire-analytics-compat",[Br]:"fire-app-check",[$r]:"fire-app-check-compat",[qr]:"fire-auth",[Hr]:"fire-auth-compat",[Gr]:"fire-rtdb",[Wr]:"fire-data-connect",[Kr]:"fire-rtdb-compat",[Qr]:"fire-fn",[Jr]:"fire-fn-compat",[Yr]:"fire-iid",[Xr]:"fire-iid-compat",[Zr]:"fire-fcm",[en]:"fire-fcm-compat",[tn]:"fire-perf",[sn]:"fire-perf-compat",[rn]:"fire-rc",[nn]:"fire-rc-compat",[an]:"fire-gcs",[on]:"fire-gcs-compat",[ln]:"fire-fst",[dn]:"fire-fst-compat",[cn]:"fire-vertex","fire-js":"fire-js",[un]:"fire-js-all"},pn=new Map,fn=new Map,gn=new Map;function xn(e,t){try{e.container.addComponent(t)}catch(xN){Ur.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,xN)}}function vn(e){const t=e.name;if(gn.has(t))return Ur.debug(`There were multiple attempts to register component ${t}.`),!1;gn.set(t,e);for(const s of pn.values())xn(s,e);for(const s of fn.values())xn(s,e);return!0}function bn(e,t){const s=e.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),e.container.getProvider(t)}function wn(e){return null!=e&&void 0!==e.settings}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const yn=new Qs("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Nn{constructor(e,t,s){this._isDeleted=!1,this._options=d({},e),this._config=d({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ar("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yn.create("app-deleted",{appName:this._name})}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const jn="12.1.0";function Cn(e,t={}){let s=e;"object"!=typeof t&&(t={name:t});const r=d({name:hn,automaticDataCollectionEnabled:!0},t),n=r.name;if("string"!=typeof n||!n)throw yn.create("bad-app-name",{appName:String(n)});if(s||(s=Rs()),!s)throw yn.create("no-options");const i=pn.get(n);if(i){if(Ys(s,i.options)&&Ys(r,i.config))return i;throw yn.create("duplicate-app",{appName:n})}const a=new cr(n);for(const l of gn.values())a.addComponent(l);const o=new Nn(s,r,a);return pn.set(n,o),o}function kn(e=hn){const t=pn.get(e);if(!t&&e===hn&&Rs())return Cn();if(!t)throw yn.create("no-app",{appName:e});return t}function Sn(e,t,s){var r;let n=null!=(r=mn[e])?r:e;s&&(n+=`-${s}`);const i=n.match(/\s|\//),a=t.match(/\s|\//);if(i||a){const e=[`Unable to register library "${n}" with version "${t}":`];return i&&e.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Ur.warn(e.join(" "))}vn(new ar(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const En="firebase-heartbeat-store";let _n=null;function Tn(){return _n||(_n=Tr("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(En)}catch(xN){}}}).catch(e=>{throw yn.create("idb-open",{originalErrorMessage:e.message})})),_n}function In(e,t){return p(this,null,function*(){try{const s=(yield Tn()).transaction(En,"readwrite"),r=s.objectStore(En);yield r.put(t,An(e)),yield s.done}catch(xN){if(xN instanceof Ks)Ur.warn(xN.message);else{const t=yn.create("idb-set",{originalErrorMessage:null==xN?void 0:xN.message});Ur.warn(t.message)}}})}function An(e){return`${e.name}!${e.options.appId}`}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Dn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Rn(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}triggerHeartbeat(){return p(this,null,function*(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Pn();if(null==(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,null==(null==(t=this._heartbeatsCache)?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:s}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,s=e[0].date;for(let r=1;r<e.length;r++)e[r].date<s&&(s=e[r].date,t=r);return t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(xN){Ur.warn(xN)}})}getHeartbeatsHeader(){return p(this,null,function*(){var e;try{if(null===this._heartbeatsCache&&(yield this._heartbeatsCachePromise),null==(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Pn(),{heartbeatsToSend:s,unsentEntries:r}=function(e,t=1024){const s=[];let r=e.slice();for(const n of e){const e=s.find(e=>e.agent===n.agent);if(e){if(e.dates.push(n.date),Ln(s)>t){e.dates.pop();break}}else if(s.push({agent:n.agent,dates:[n.date]}),Ln(s)>t){s.pop();break}r=r.slice(1)}return{heartbeatsToSend:s,unsentEntries:r}}(this._heartbeatsCache.heartbeats),n=_s(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(xN){return Ur.warn(xN),""}})}}function Pn(){return(new Date).toISOString().substring(0,10)}class Rn{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return p(this,null,function*(){return!!Gs()&&Ws().then(()=>!0).catch(()=>!1)})}read(){return p(this,null,function*(){if(yield this._canUseIndexedDBPromise){const e=yield function(e){return p(this,null,function*(){try{const t=(yield Tn()).transaction(En),s=yield t.objectStore(En).get(An(e));return yield t.done,s}catch(xN){if(xN instanceof Ks)Ur.warn(xN.message);else{const t=yn.create("idb-get",{originalErrorMessage:null==xN?void 0:xN.message});Ur.warn(t.message)}}})}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}})}overwrite(e){return p(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){const s=yield this.read();return In(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})}add(e){return p(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){const s=yield this.read();return In(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})}}function Ln(e){return _s(JSON.stringify({version:2,heartbeats:e})).length}var On;On="",vn(new ar("platform-logger",e=>new Lr(e),"PRIVATE")),vn(new ar("heartbeat",e=>new Dn(e),"PRIVATE")),Sn(Or,Mr,On),Sn(Or,Mr,"esm2020"),Sn("fire-js","");const Mn="@firebase/installations",Un="0.6.19",Fn=1e4,Vn=`w:${Un}`,zn="FIS_v2",$n=36e5,Bn=new Qs("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function qn(e){return e instanceof Ks&&e.code.includes("request-failed")}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hn({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function Gn(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}function Wn(e,t){return p(this,null,function*(){const s=(yield t.json()).error;return Bn.create("request-failed",{requestName:e,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})})}function Kn({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Qn(e,{refreshToken:t}){const s=Kn(e);return s.append("Authorization",function(e){return`${zn} ${e}`}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)),s}function Jn(e){return p(this,null,function*(){const t=yield e();return t.status>=500&&t.status<600?e():t})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Yn(e){return new Promise(t=>{setTimeout(t,e)})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Xn=/^[cdef][\w-]{21}$/;function Zn(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(s=e,btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_"));var s;return t.substr(0,22)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e);return Xn.test(t)?t:""}catch(xN){return""}}function ei(e){return`${e.appName}!${e.appId}`}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const ti=new Map;function si(e,t){const s=ei(e);ri(s,t),function(e,t){const s=(!ni&&"BroadcastChannel"in self&&(ni=new BroadcastChannel("[Firebase] FID Change"),ni.onmessage=e=>{ri(e.data.key,e.data.fid)}),ni);s&&s.postMessage({key:e,fid:t}),0===ti.size&&ni&&(ni.close(),ni=null)}(s,t)}function ri(e,t){const s=ti.get(e);if(s)for(const r of s)r(t)}let ni=null;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ii="firebase-installations-store";let ai=null;function oi(){return ai||(ai=Tr("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(ii)}})),ai}function li(e,t){return p(this,null,function*(){const s=ei(e),r=(yield oi()).transaction(ii,"readwrite"),n=r.objectStore(ii),i=yield n.get(s);return yield n.put(t,s),yield r.done,i&&i.fid===t.fid||si(e,t.fid),t})}function ci(e){return p(this,null,function*(){const t=ei(e),s=(yield oi()).transaction(ii,"readwrite");yield s.objectStore(ii).delete(t),yield s.done})}function di(e,t){return p(this,null,function*(){const s=ei(e),r=(yield oi()).transaction(ii,"readwrite"),n=r.objectStore(ii),i=yield n.get(s),a=t(i);return void 0===a?yield n.delete(s):yield n.put(a,s),yield r.done,!a||i&&i.fid===a.fid||si(e,a.fid),a})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ui(e){return p(this,null,function*(){let t;const s=yield di(e.appConfig,s=>{const r=function(e){const t=e||{fid:Zn(),registrationStatus:0};return pi(t)}(s),n=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Bn.create("app-offline"))};const s={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return p(this,null,function*(){try{const s=yield function(e,t){return p(this,arguments,function*({appConfig:e,heartbeatServiceProvider:t},{fid:s}){const r=Hn(e),n=Kn(e),i=t.getImmediate({optional:!0});if(i){const e=yield i.getHeartbeatsHeader();e&&n.append("x-firebase-client",e)}const a={fid:s,authVersion:zn,appId:e.appId,sdkVersion:Vn},o={method:"POST",headers:n,body:JSON.stringify(a)},l=yield Jn(()=>fetch(r,o));if(l.ok){const e=yield l.json();return{fid:e.fid||s,registrationStatus:2,refreshToken:e.refreshToken,authToken:Gn(e.authToken)}}throw yield Wn("Create Installation",l)})}(e,t);return li(e.appConfig,s)}catch(xN){throw qn(xN)&&409===xN.customData.serverCode?yield ci(e.appConfig):yield li(e.appConfig,{fid:t.fid,registrationStatus:0}),xN}})}(e,s);return{installationEntry:s,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:hi(e)}:{installationEntry:t}}(e,r);return t=n.registrationPromise,n.installationEntry});return""===s.fid?{installationEntry:yield t}:{installationEntry:s,registrationPromise:t}})}function hi(e){return p(this,null,function*(){let t=yield mi(e.appConfig);for(;1===t.registrationStatus;)yield Yn(100),t=yield mi(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:s}=yield ui(e);return s||t}return t})}function mi(e){return di(e,e=>{if(!e)throw Bn.create("installation-not-found");return pi(e)})}function pi(e){return 1===(t=e).registrationStatus&&t.registrationTime+Fn<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}function fi(e,t){return p(this,arguments,function*({appConfig:e,heartbeatServiceProvider:t},s){const r=function(e,{fid:t}){return`${Hn(e)}/${t}/authTokens:generate`}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,s),n=Qn(e,s),i=t.getImmediate({optional:!0});if(i){const e=yield i.getHeartbeatsHeader();e&&n.append("x-firebase-client",e)}const a={installation:{sdkVersion:Vn,appId:e.appId}},o={method:"POST",headers:n,body:JSON.stringify(a)},l=yield Jn(()=>fetch(r,o));if(l.ok)return Gn(yield l.json());throw yield Wn("Generate Auth Token",l)})}function gi(e,t=!1){return p(this,null,function*(){let s;const r=yield di(e.appConfig,r=>{if(!vi(r))throw Bn.create("not-registered");const n=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+$n}(e)}(n))return r;if(1===n.requestStatus)return s=function(e,t){return p(this,null,function*(){let s=yield xi(e.appConfig);for(;1===s.authToken.requestStatus;)yield Yn(100),s=yield xi(e.appConfig);const r=s.authToken;return 0===r.requestStatus?gi(e,t):r})}(e,t),r;{if(!navigator.onLine)throw Bn.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return u(d({},e),{authToken:t})}(r);return s=function(e,t){return p(this,null,function*(){try{const s=yield fi(e,t),r=u(d({},t),{authToken:s});return yield li(e.appConfig,r),s}catch(xN){if(!qn(xN)||401!==xN.customData.serverCode&&404!==xN.customData.serverCode){const s=u(d({},t),{authToken:{requestStatus:0}});yield li(e.appConfig,s)}else yield ci(e.appConfig);throw xN}})}(e,t),t}});return s?yield s:r.authToken})}function xi(e){return di(e,e=>{if(!vi(e))throw Bn.create("not-registered");const t=e.authToken;return 1===(s=t).requestStatus&&s.requestTime+Fn<Date.now()?u(d({},e),{authToken:{requestStatus:0}}):e;var s;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */})}function vi(e){return void 0!==e&&2===e.registrationStatus}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function bi(e,t=!1){return p(this,null,function*(){const s=e;return yield function(e){return p(this,null,function*(){const{registrationPromise:t}=yield ui(e);t&&(yield t)})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(s),(yield gi(s,t)).token})}function wi(e){return Bn.create("missing-app-config-values",{valueName:e})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const yi="installations",Ni=e=>{const t=bn(e.getProvider("app").getImmediate(),yi).getImmediate();return{getId:()=>function(e){return p(this,null,function*(){const t=e,{installationEntry:s,registrationPromise:r}=yield ui(t);return r?r.catch(console.error):gi(t).catch(console.error),s.fid})}(t),getToken:e=>bi(t,e)}};vn(new ar(yi,e=>{const t=e.getProvider("app").getImmediate(),s=function(e){if(!e||!e.options)throw wi("App Configuration");if(!e.name)throw wi("App Name");const t=["projectId","apiKey","appId"];for(const s of t)if(!e.options[s])throw wi(s);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:s,heartbeatServiceProvider:bn(t,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),vn(new ar("installations-internal",Ni,"PRIVATE")),Sn(Mn,Un),Sn(Mn,Un,"esm2020");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ji="analytics",Ci="https://www.googletagmanager.com/gtag/js",ki=new gr("@firebase/analytics"),Si=new Qs("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ei(e){if(!e.startsWith(Ci)){const t=Si.create("invalid-gtag-resource",{gtagURL:e});return ki.warn(t.message),""}return e}function _i(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function Ti(e,t){const s=function(e,t){let s;return window.trustedTypes&&(s=window.trustedTypes.createPolicy(e,t)),s}("firebase-js-sdk-policy",{createScriptURL:Ei}),r=document.createElement("script"),n=`${Ci}?l=${e}&id=${t}`;r.src=s?null==s?void 0:s.createScriptURL(n):n,r.async=!0,document.head.appendChild(r)}function Ii(e,t,s,r){return function(n,...i){return p(this,null,function*(){try{if("event"===n){const[r,n]=i;yield function(e,t,s,r,n){return p(this,null,function*(){try{let i=[];if(n&&n.send_to){let e=n.send_to;Array.isArray(e)||(e=[e]);const r=yield _i(s);for(const s of e){const e=r.find(e=>e.measurementId===s),n=e&&t[e.appId];if(!n){i=[];break}i.push(n)}}0===i.length&&(i=Object.values(t)),yield Promise.all(i),e("event",r,n||{})}catch(xN){ki.error(xN)}})}(e,t,s,r,n)}else if("config"===n){const[n,a]=i;yield function(e,t,s,r,n,i){return p(this,null,function*(){const a=r[n];try{if(a)yield t[a];else{const e=(yield _i(s)).find(e=>e.measurementId===n);e&&(yield t[e.appId])}}catch(xN){ki.error(xN)}e("config",n,i)})}(e,t,s,r,n,a)}else if("consent"===n){const[t,s]=i;e("consent",t,s)}else if("get"===n){const[t,s,r]=i;e("get",t,s,r)}else if("set"===n){const[t]=i;e("set",t)}else e(n,...i)}catch(xN){ki.error(xN)}})}}const Ai=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Di(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function Pi(e){return p(this,arguments,function*(e,t=Ai,s){const{appId:r,apiKey:n,measurementId:i}=e.options;if(!r)throw Si.create("no-app-id");if(!n){if(i)return{measurementId:i,appId:r};throw Si.create("no-api-key")}const a=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Li;return setTimeout(()=>p(this,null,function*(){o.abort()}),6e4),Ri({appId:r,apiKey:n,measurementId:i},a,o,t)})}function Ri(e,t,s){return p(this,arguments,function*(e,{throttleEndTimeMillis:t,backoffCount:s},r,n=Ai){var i;const{appId:a,measurementId:o}=e;try{yield function(e,t){return new Promise((s,r)=>{const n=Math.max(t-Date.now(),0),i=setTimeout(s,n);e.addEventListener(()=>{clearTimeout(i),r(Si.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(r,t)}catch(xN){if(o)return ki.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==xN?void 0:xN.message}]`),{appId:a,measurementId:o};throw xN}try{const t=yield function(e){return p(this,null,function*(){var t;const{appId:s,apiKey:r}=e,n={method:"GET",headers:Di(r)},i="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",s),a=yield fetch(i,n);if(200!==a.status&&304!==a.status){let e="";try{const s=yield a.json();(null==(t=s.error)?void 0:t.message)&&(e=s.error.message)}catch(o){}throw Si.create("config-fetch-failed",{httpStatus:a.status,responseMessage:e})}return a.json()})}(e);return n.deleteThrottleMetadata(a),t}catch(xN){const l=xN;if(!function(e){if(!(e instanceof Ks&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(l)){if(n.deleteThrottleMetadata(a),o)return ki.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==l?void 0:l.message}]`),{appId:a,measurementId:o};throw xN}const c=503===Number(null==(i=null==l?void 0:l.customData)?void 0:i.httpStatus)?nr(s,n.intervalMillis,30):nr(s,n.intervalMillis),d={throttleEndTimeMillis:Date.now()+c,backoffCount:s+1};return n.setThrottleMetadata(a,d),ki.debug(`Calling attemptFetch again in ${c} millis`),Ri(e,d,r,n)}})}class Li{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}function Oi(e,t,s,r,n,i,a){return p(this,null,function*(){var o;const l=Pi(e);l.then(t=>{s[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&ki.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>ki.error(e)),t.push(l);const c=
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(){return p(this,null,function*(){if(!Gs())return ki.warn(Si.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Ws()}catch(xN){return ki.warn(Si.create("indexeddb-unavailable",{errorInfo:null==xN?void 0:xN.toString()}).message),!1}return!0})}().then(e=>e?r.getId():void 0),[d,u]=yield Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const s of Object.values(t))if(s.src&&s.src.includes(Ci)&&s.src.includes(e))return s;return null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */)(i)||Ti(i,d.measurementId),n("js",new Date);const h=null!=(o=null==a?void 0:a.config)?o:{};return h.origin="firebase",h.update=!0,null!=u&&(h.firebase_id=u),n("config",d.measurementId,h),d.measurementId})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Mi{constructor(e){this.app=e}_delete(){return delete Ui[this.app.options.appId],Promise.resolve()}}let Ui={},Fi=[];const Vi={};let zi,$i,Bi="dataLayer",qi=!1;function Hi(){const e=[];if(qs()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>`(${t+1}) ${e}`).join(" "),s=Si.create("invalid-analytics-context",{errorInfo:t});ki.warn(s.message)}}function Gi(e,t,s){Hi();const r=e.options.appId;if(!r)throw Si.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Si.create("no-api-key");ki.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Ui[r])throw Si.create("already-exists",{id:r});if(!qi){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(Bi);const{wrappedGtag:e,gtagCore:t}=function(e,t,s,r,n){let i=function(...e){window[r].push(arguments)};return window[n]&&"function"==typeof window[n]&&(i=window[n]),window[n]=Ii(i,e,t,s),{gtagCore:i,wrappedGtag:window[n]}}(Ui,Fi,Vi,Bi,"gtag");$i=e,zi=t,qi=!0}return Ui[r]=Oi(e,Fi,Vi,t,zi,Bi,s),new Mi(e)}function Wi(e,t,s,r){e=ir(e),function(e,t,s,r,n){return p(this,null,function*(){if(n&&n.global)e("event",s,r);else{const n=yield t,i=u(d({},r),{send_to:n});e("event",s,i)}})}($i,Ui[e.app.options.appId],t,s,r).catch(e=>ki.error(e))}const Ki="@firebase/analytics",Qi="0.10.18";function Ji(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}vn(new ar(ji,(e,{options:t})=>Gi(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),vn(new ar("analytics-internal",function(e){try{const t=e.getProvider(ji).getImmediate();return{logEvent:(e,s,r)=>Wi(t,e,s,r)}}catch(xN){throw Si.create("interop-component-reg-failed",{reason:xN})}},"PRIVATE")),Sn(Ki,Qi),Sn(Ki,Qi,"esm2020");const Yi=Ji,Xi=new Qs("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Zi=new gr("@firebase/auth");function ea(e,...t){Zi.logLevel<=dr.ERROR&&Zi.error(`Auth (${jn}): ${e}`,...t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ta(e,...t){throw ia(e,...t)}function sa(e,...t){return ia(e,...t)}function ra(e,t,s){const r=u(d({},Yi()),{[t]:s});return new Qs("auth","Firebase",r).create(t,{appName:e.name})}function na(e){return ra(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ia(e,...t){if("string"!=typeof e){const s=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(s,...r)}return Xi.create(e,...t)}function aa(e,t,...s){if(!e)throw ia(t,...s)}function oa(e){const t="INTERNAL ASSERTION FAILED: "+e;throw ea(t),new Error(t)}function la(e,t){e||oa(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ca(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.href)||""}function da(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.protocol)||null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ua(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==da()&&"https:"!==da()&&!qs()&&!("connection"in navigator)||navigator.onLine}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class ha{constructor(e,t){this.shortDelay=e,this.longDelay=t,la(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Bs())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return ua()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ma(e,t){la(e.emulator,"Emulator should always be set here");const{url:s}=e.emulator;return t?`${s}${t.startsWith("/")?t.slice(1):t}`:s}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class pa{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void oa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void oa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void oa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const fa={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ga=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],xa=new ha(3e4,6e4);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function va(e,t){return e.tenantId&&!t.tenantId?u(d({},t),{tenantId:e.tenantId}):t}function ba(e,t,s,r){return p(this,arguments,function*(e,t,s,r,n={}){return wa(e,n,()=>p(this,null,function*(){let n={},i={};r&&("GET"===t?i=r:n={body:JSON.stringify(r)});const a=Zs(d({key:e.config.apiKey},i)).slice(1),o=yield e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=d({method:t,headers:o},n);return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&Ms(e.emulatorConfig.host)&&(l.credentials="include"),pa.fetch()(yield Na(e,e.config.apiHost,s,a),l)}))})}function wa(e,t,s){return p(this,null,function*(){e._canInitEmulator=!1;const r=d(d({},fa),t);try{const t=new Ca(e),n=yield Promise.race([s(),t.promise]);t.clearNetworkTimeout();const i=yield n.json();if("needConfirmation"in i)throw ka(e,"account-exists-with-different-credential",i);if(n.ok&&!("errorMessage"in i))return i;{const t=n.ok?i.errorMessage:i.error.message,[s,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===s)throw ka(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===s)throw ka(e,"email-already-in-use",i);if("USER_DISABLED"===s)throw ka(e,"user-disabled",i);const o=r[s]||s.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw ra(e,o,a);ta(e,o)}}catch(xN){if(xN instanceof Ks)throw xN;ta(e,"network-request-failed",{message:String(xN)})}})}function ya(e,t,s,r){return p(this,arguments,function*(e,t,s,r,n={}){const i=yield ba(e,t,s,r,n);return"mfaPendingCredential"in i&&ta(e,"multi-factor-auth-required",{_serverResponse:i}),i})}function Na(e,t,s,r){return p(this,null,function*(){const n=`${t}${s}?${r}`,i=e,a=i.config.emulator?ma(e.config,n):`${e.config.apiScheme}://${n}`;return ga.includes(s)&&(yield i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())?i._getPersistence()._getFinalTarget(a).toString():a})}function ja(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ca{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(sa(this.auth,"network-request-failed")),xa.get())})}}function ka(e,t,s){const r={appName:e.name};s.email&&(r.email=s.email),s.phoneNumber&&(r.phoneNumber=s.phoneNumber);const n=sa(e,t,r);return n.customData._tokenResponse=s,n}function Sa(e){return void 0!==e&&void 0!==e.enterprise}class Ea{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ja(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}function _a(e,t){return p(this,null,function*(){return ba(e,"POST","/v1/accounts:lookup",t)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ta(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(xN){}}function Ia(e,t=!1){return p(this,null,function*(){const s=ir(e),r=yield s.getIdToken(t),n=Da(r);aa(n&&n.exp&&n.auth_time&&n.iat,s.auth,"internal-error");const i="object"==typeof n.firebase?n.firebase:void 0,a=null==i?void 0:i.sign_in_provider;return{claims:n,token:r,authTime:Ta(Aa(n.auth_time)),issuedAtTime:Ta(Aa(n.iat)),expirationTime:Ta(Aa(n.exp)),signInProvider:a||null,signInSecondFactor:(null==i?void 0:i.sign_in_second_factor)||null}})}function Aa(e){return 1e3*Number(e)}function Da(e){const[t,s,r]=e.split(".");if(void 0===t||void 0===s||void 0===r)return ea("JWT malformed, contained fewer than 3 sections"),null;try{const e=Ts(s);return e?JSON.parse(e):(ea("Failed to decode base64 JWT payload"),null)}catch(xN){return ea("Caught error parsing JWT payload as JSON",null==xN?void 0:xN.toString()),null}}function Pa(e){const t=Da(e);return aa(t,"internal-error"),aa(void 0!==t.exp,"internal-error"),aa(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ra(e,t,s=!1){return p(this,null,function*(){if(s)return t;try{return yield t}catch(xN){throw xN instanceof Ks&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(xN)&&e.auth.currentUser===e&&(yield e.auth.signOut()),xN}})}class La{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!=(t=this.user.stsTokenManager.expirationTime)?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(()=>p(this,null,function*(){yield this.iteration()}),t)}iteration(){return p(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(xN){return void("auth/network-request-failed"===(null==xN?void 0:xN.code)&&this.schedule(!0))}this.schedule()})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Oa{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ta(this.lastLoginAt),this.creationTime=Ta(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ma(e){return p(this,null,function*(){var t;const s=e.auth,r=yield e.getIdToken(),n=yield Ra(e,_a(s,{idToken:r}));aa(null==n?void 0:n.users.length,s,"internal-error");const i=n.users[0];e._notifyReloadListener(i);const a=(null==(t=i.providerUserInfo)?void 0:t.length)?Fa(i.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const d=e.isAnonymous,u=!(e.email&&i.passwordHash||(null==o?void 0:o.length)),h=!!d&&u,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Oa(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,m)})}function Ua(e){return p(this,null,function*(){const t=ir(e);yield Ma(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)})}function Fa(e){return e.map(e=>{var t=e,{providerId:s}=t,r=h(t,["providerId"]);return{providerId:s,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Va{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){aa(e.idToken,"internal-error"),aa(void 0!==e.idToken,"internal-error"),aa(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):Pa(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){aa(0!==e.length,"internal-error");const t=Pa(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return p(this,null,function*(){return t||!this.accessToken||this.isExpired?(aa(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return p(this,null,function*(){const{accessToken:s,refreshToken:r,expiresIn:n}=yield function(e,t){return p(this,null,function*(){const s=yield wa(e,{},()=>p(this,null,function*(){const s=Zs({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:n}=e.config,i=yield Na(e,r,"/v1/token",`key=${n}`),a=yield e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:a,body:s};return e.emulatorConfig&&Ms(e.emulatorConfig.host)&&(o.credentials="include"),pa.fetch()(i,o)}));return{accessToken:s.access_token,expiresIn:s.expires_in,refreshToken:s.refresh_token}})}(e,t);this.updateTokensAndExpiration(s,r,Number(n))})}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*s}static fromJSON(e,t){const{refreshToken:s,accessToken:r,expirationTime:n}=t,i=new Va;return s&&(aa("string"==typeof s,"internal-error",{appName:e}),i.refreshToken=s),r&&(aa("string"==typeof r,"internal-error",{appName:e}),i.accessToken=r),n&&(aa("number"==typeof n,"internal-error",{appName:e}),i.expirationTime=n),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Va,this.toJSON())}_performRefresh(){return oa("not implemented")}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function za(e,t){aa("string"==typeof e||void 0===e,"internal-error",{appName:t})}class $a{constructor(e){var t=e,{uid:s,auth:r,stsTokenManager:n}=t,i=h(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new La(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=s,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Oa(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(e){return p(this,null,function*(){const t=yield Ra(this,this.stsTokenManager.getToken(this.auth,e));return aa(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Ia(this,e)}reload(){return Ua(this)}_assign(e){this!==e&&(aa(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>d({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new $a(u(d({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){aa(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return p(this,null,function*(){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&(yield Ma(this)),yield this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)})}delete(){return p(this,null,function*(){if(wn(this.auth.app))return Promise.reject(na(this.auth));const e=yield this.getIdToken();return yield Ra(this,
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){return p(this,null,function*(){return ba(e,"POST","/v1/accounts:delete",t)})}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return u(d({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>d({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,r,n,i,a,o,l,c;const u=null!=(s=t.displayName)?s:void 0,h=null!=(r=t.email)?r:void 0,m=null!=(n=t.phoneNumber)?n:void 0,p=null!=(i=t.photoURL)?i:void 0,f=null!=(a=t.tenantId)?a:void 0,g=null!=(o=t._redirectEventId)?o:void 0,x=null!=(l=t.createdAt)?l:void 0,v=null!=(c=t.lastLoginAt)?c:void 0,{uid:b,emailVerified:w,isAnonymous:y,providerData:N,stsTokenManager:j}=t;aa(b&&j,e,"internal-error");const C=Va.fromJSON(this.name,j);aa("string"==typeof b,e,"internal-error"),za(u,e.name),za(h,e.name),aa("boolean"==typeof w,e,"internal-error"),aa("boolean"==typeof y,e,"internal-error"),za(m,e.name),za(p,e.name),za(f,e.name),za(g,e.name),za(x,e.name),za(v,e.name);const k=new $a({uid:b,auth:e,email:h,emailVerified:w,displayName:u,isAnonymous:y,photoURL:p,phoneNumber:m,tenantId:f,stsTokenManager:C,createdAt:x,lastLoginAt:v});return N&&Array.isArray(N)&&(k.providerData=N.map(e=>d({},e))),g&&(k._redirectEventId=g),k}static _fromIdTokenResponse(e,t,s=!1){return p(this,null,function*(){const r=new Va;r.updateFromServerResponse(t);const n=new $a({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:s});return yield Ma(n),n})}static _fromGetAccountInfoResponse(e,t,s){return p(this,null,function*(){const r=t.users[0];aa(void 0!==r.localId,"internal-error");const n=void 0!==r.providerUserInfo?Fa(r.providerUserInfo):[],i=!(r.email&&r.passwordHash||(null==n?void 0:n.length)),a=new Va;a.updateFromIdToken(s);const o=new $a({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:i}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:n,metadata:new Oa(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||(null==n?void 0:n.length))};return Object.assign(o,l),o})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ba=new Map;function qa(e){la(e instanceof Function,"Expected a class definition");let t=Ba.get(e);return t?(la(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Ba.set(e,t),t)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ha{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return p(this,null,function*(){return!0})}_set(e,t){return p(this,null,function*(){this.storage[e]=t})}_get(e){return p(this,null,function*(){const t=this.storage[e];return void 0===t?null:t})}_remove(e){return p(this,null,function*(){delete this.storage[e]})}_addListener(e,t){}_removeListener(e,t){}}Ha.type="NONE";const Ga=Ha;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wa(e,t,s){return`firebase:${e}:${t}:${s}`}class Ka{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:r,name:n}=this.auth;this.fullUserKey=Wa(this.userKey,r.apiKey,n),this.fullPersistenceKey=Wa("persistence",r.apiKey,n),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return p(this,null,function*(){const e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=yield _a(this.auth,{idToken:e}).catch(()=>{});return t?$a._fromGetAccountInfoResponse(this.auth,t,e):null}return $a._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return p(this,null,function*(){if(this.persistence===e)return;const t=yield this.getCurrentUser();return yield this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,s="authUser"){return p(this,null,function*(){if(!t.length)return new Ka(qa(Ga),e,s);const r=(yield Promise.all(t.map(e=>p(this,null,function*(){if(yield e._isAvailable())return e})))).filter(e=>e);let n=r[0]||qa(Ga);const i=Wa(s,e.config.apiKey,e.name);let a=null;for(const s of t)try{const t=yield s._get(i);if(t){let r;if("string"==typeof t){const s=yield _a(e,{idToken:t}).catch(()=>{});if(!s)break;r=yield $a._fromGetAccountInfoResponse(e,s,t)}else r=$a._fromJSON(e,t);s!==n&&(a=r),n=s;break}}catch(xN){}const o=r.filter(e=>e._shouldAllowMigration);return n._shouldAllowMigration&&o.length?(n=o[0],a&&(yield n._set(i,a.toJSON())),yield Promise.all(t.map(e=>p(this,null,function*(){if(e!==n)try{yield e._remove(i)}catch(xN){}}))),new Ka(n,e,s)):new Ka(n,e,s)})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qa(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Za(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Ja(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(to(t))return"Blackberry";if(so(t))return"Webos";if(Ya(t))return"Safari";if((t.includes("chrome/")||Xa(t))&&!t.includes("edge/"))return"Chrome";if(eo(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=e.match(t);if(2===(null==s?void 0:s.length))return s[1]}return"Other"}function Ja(e=Bs()){return/firefox\//i.test(e)}function Ya(e=Bs()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Xa(e=Bs()){return/crios\//i.test(e)}function Za(e=Bs()){return/iemobile/i.test(e)}function eo(e=Bs()){return/android/i.test(e)}function to(e=Bs()){return/blackberry/i.test(e)}function so(e=Bs()){return/webos/i.test(e)}function ro(e=Bs()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function no(){return function(){const e=Bs();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function io(e=Bs()){return ro(e)||eo(e)||so(e)||to(e)||/windows phone/i.test(e)||Za(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ao(e,t=[]){let s;switch(e){case"Browser":s=Qa(Bs());break;case"Worker":s=`${Qa(Bs())}-${e}`;break;default:s=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${s}/JsCore/${jn}/${r}`}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class oo{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=t=>new Promise((s,r)=>{try{s(e(t))}catch(xN){r(xN)}});s.onAbort=t,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return p(this,null,function*(){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)yield s(e),s.onAbort&&t.push(s.onAbort)}catch(xN){t.reverse();for(const r of t)try{r()}catch(s){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==xN?void 0:xN.message})}})}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lo{constructor(e){var t,s,r,n;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!=(t=i.minPasswordLength)?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!=(r=null==(s=e.allowedNonAlphanumericCharacters)?void 0:s.join(""))?r:"",this.forceUpgradeOnSignin=null!=(n=e.forceUpgradeOnSignin)&&n,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,r,n,i,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null==(t=o.meetsMinPasswordLength)||t),o.isValid&&(o.isValid=null==(s=o.meetsMaxPasswordLength)||s),o.isValid&&(o.isValid=null==(r=o.containsLowercaseLetter)||r),o.isValid&&(o.isValid=null==(n=o.containsUppercaseLetter)||n),o.isValid&&(o.isValid=null==(i=o.containsNumericCharacter)||i),o.isValid&&(o.isValid=null==(a=o.containsNonAlphanumericCharacter)||a),o}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let s;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,r,n){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=n))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class co{constructor(e,t,s,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ho(this),this.idTokenSubscription=new ho(this),this.beforeStateQueue=new oo(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xi,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=qa(t)),this._initializationPromise=this.queue(()=>p(this,null,function*(){var s,r,n;if(!this._deleted&&(this.persistenceManager=yield Ka.create(this,e),null==(s=this._resolvePersistenceManagerAvailable)||s.call(this),!this._deleted)){if(null==(r=this._popupRedirectResolver)?void 0:r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch(xN){}yield this.initializeCurrentUser(t),this.lastNotifiedUid=(null==(n=this.currentUser)?void 0:n.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return p(this,null,function*(){if(this._deleted)return;const e=yield this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(yield this.currentUser.getIdToken())):void(yield this._updateCurrentUser(e,!0)):void 0})}initializeCurrentUserFromIdToken(e){return p(this,null,function*(){try{const t=yield _a(this,{idToken:e}),s=yield $a._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(s)}catch(t){yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return p(this,null,function*(){var t;if(wn(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const s=yield this.assertedPersistence.getCurrentUser();let r=s,n=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();const s=null==(t=this.redirectUser)?void 0:t._redirectEventId,i=null==r?void 0:r._redirectEventId,a=yield this.tryRedirectSignIn(e);s&&s!==i||!(null==a?void 0:a.user)||(r=a.user,n=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(n)try{yield this.beforeStateQueue.runMiddleware(r)}catch(xN){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(xN))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return aa(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return p(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(xN){yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return p(this,null,function*(){try{yield Ma(e)}catch(xN){if("auth/network-request-failed"!==(null==xN?void 0:xN.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}_delete(){return p(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return p(this,null,function*(){if(wn(this.app))return Promise.reject(na(this));const t=e?ir(e):null;return t&&aa(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return p(this,null,function*(){if(!this._deleted)return e&&aa(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>p(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return p(this,null,function*(){return wn(this.app)?Promise.reject(na(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return wn(this.app)?Promise.reject(na(this)):this.queue(()=>p(this,null,function*(){yield this.assertedPersistence.setPersistence(qa(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return p(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return p(this,null,function*(){const e=yield function(e){return p(this,arguments,function*(e,t={}){return ba(e,"GET","/v2/passwordPolicy",va(e,t))})}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this),t=new lo(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qs("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}revokeAccessToken(e){return p(this,null,function*(){if(this.currentUser){const t=yield this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};null!=this.tenantId&&(s.tenantId=this.tenantId),yield function(e,t){return p(this,null,function*(){return ba(e,"POST","/v2/accounts:revokeToken",va(e,t))})}(this,s)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null==(e=this._currentUser)?void 0:e.toJSON()}}_setRedirectUser(e,t){return p(this,null,function*(){const s=yield this.getOrInitRedirectPersistenceManager(t);return null===e?s.removeCurrentUser():s.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return p(this,null,function*(){if(!this.redirectPersistenceManager){const t=e&&qa(e)||this._popupRedirectResolver;aa(t,this,"argument-error"),this.redirectPersistenceManager=yield Ka.create(this,[qa(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return p(this,null,function*(){var t,s;return this._isInitialized&&(yield this.queue(()=>p(this,null,function*(){}))),(null==(t=this._currentUser)?void 0:t._redirectEventId)===e?this._currentUser:(null==(s=this.redirectUser)?void 0:s._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return p(this,null,function*(){if(e===this.currentUser)return this.queue(()=>p(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=null!=(t=null==(e=this.currentUser)?void 0:e.uid)?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,r){if(this._deleted)return()=>{};const n="function"==typeof t?t:t.next.bind(t);let i=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(aa(a,this,"internal-error"),a.then(()=>{i||n(this.currentUser)}),"function"==typeof t){const n=e.addObserver(t,s,r);return()=>{i=!0,n()}}{const s=e.addObserver(t);return()=>{i=!0,s()}}}directlySetCurrentUser(e){return p(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return aa(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ao(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return p(this,null,function*(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=yield null==(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))?void 0:e.getHeartbeatsHeader();s&&(t["X-Firebase-Client"]=s);const r=yield this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t})}_getAppCheckToken(){return p(this,null,function*(){var e;if(wn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=yield null==(e=this.appCheckServiceProvider.getImmediate({optional:!0}))?void 0:e.getToken();return(null==t?void 0:t.error)&&function(e,...t){Zi.logLevel<=dr.WARN&&Zi.warn(`Auth (${jn}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token})}}function uo(e){return ir(e)}class ho{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const s=new sr(e,t);return s.subscribe.bind(s)}(e=>this.observer=e)}get next(){return aa(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let mo={loadJS(){return p(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function po(e){return mo.loadJS(e)}class fo{constructor(){this.enterprise=new go}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class go{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const xo="NO_RECAPTCHA";class vo{constructor(e){this.type="recaptcha-enterprise",this.auth=uo(e)}verify(e="verify",t=!1){return p(this,null,function*(){function s(e){return p(this,null,function*(){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((t,s)=>p(this,null,function*(){(function(e,t){return p(this,null,function*(){return ba(e,"GET","/v2/recaptchaConfig",va(e,t))})})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const s=new Ea(r);return null==e.tenantId?e._agentRecaptchaConfig=s:e._tenantRecaptchaConfigs[e.tenantId]=s,t(s.siteKey)}s(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{s(e)})}))})}function r(t,s,r){const n=window.grecaptcha;Sa(n)?n.enterprise.ready(()=>{n.enterprise.execute(t,{action:e}).then(e=>{s(e)}).catch(()=>{s(xo)})}):r(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?(new fo).execute("siteKey",{action:"verify"}):new Promise((e,n)=>{s(this.auth).then(s=>{if(!t&&Sa(window.grecaptcha))r(s,e,n);else{if("undefined"==typeof window)return void n(new Error("RecaptchaVerifier is only supported in browser"));let t=mo.recaptchaEnterpriseScript;0!==t.length&&(t+=s),po(t).then(()=>{r(s,e,n)}).catch(e=>{n(e)})}}).catch(e=>{n(e)})})})}}function bo(e,t,s,r=!1,n=!1){return p(this,null,function*(){const i=new vo(e);let a;if(n)a=xo;else try{a=yield i.verify(s)}catch(l){a=yield i.verify(s,!0)}const o=d({},t);if("mfaSmsEnrollment"===s||"mfaSmsSignIn"===s){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function wo(e,t,s,r,n){return p(this,null,function*(){var n;if(null==(n=e._getRecaptchaConfig())?void 0:n.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const n=yield bo(e,t,s,"getOobCode"===s);return r(e,n)}return r(e,t).catch(n=>p(this,null,function*(){if("auth/missing-recaptcha-token"===n.code){const n=yield bo(e,t,s,"getOobCode"===s);return r(e,n)}return Promise.reject(n)}))})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function yo(e,t){const s=bn(e,"auth");if(s.isInitialized()){const e=s.getImmediate();if(Ys(s.getOptions(),null!=t?t:{}))return e;ta(e,"already-initialized")}return s.initialize({options:t})}function No(e,t,s){const r=uo(e);aa(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const n=!!(null==s?void 0:s.disableWarnings),i=jo(t),{host:a,port:o}=function(e){const t=jo(e),s=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!s)return{host:"",port:null};const r=s[2].split("@").pop()||"",n=/^(\[[^\]]+\])(:|$)/.exec(r);if(n){const e=n[1];return{host:e,port:Co(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Co(t)}}}(t),l=null===o?"":`:${o}`,c={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:n})});if(!r._canInitEmulator)return aa(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void aa(Ys(c,r.config.emulator)&&Ys(d,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Ms(a)?(Us(`${i}//${a}${l}`),$s("Auth",!0)):function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&console.info,"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */()}function jo(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Co(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class ko{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oa("not implemented")}_getIdTokenResponse(e){return oa("not implemented")}_linkToIdToken(e,t){return oa("not implemented")}_getReauthenticationResolver(e){return oa("not implemented")}}function So(e,t){return p(this,null,function*(){return ba(e,"POST","/v1/accounts:signUp",t)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Eo(e,t){return p(this,null,function*(){return ya(e,"POST","/v1/accounts:signInWithPassword",va(e,t))})}function _o(e,t){return p(this,null,function*(){return function(e,t){return p(this,null,function*(){return ba(e,"POST","/v1/accounts:sendOobCode",va(e,t))})}(e,t)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class To extends ko{constructor(e,t,s,r=null){super("password",s),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new To(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new To(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return p(this,null,function*(){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wo(e,t,"signInWithPassword",Eo);case"emailLink":return function(e,t){return p(this,null,function*(){return ya(e,"POST","/v1/accounts:signInWithEmailLink",va(e,t))})}(e,{email:this._email,oobCode:this._password});default:ta(e,"internal-error")}})}_linkToIdToken(e,t){return p(this,null,function*(){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wo(e,s,"signUpPassword",So);case"emailLink":return function(e,t){return p(this,null,function*(){return ya(e,"POST","/v1/accounts:signInWithEmailLink",va(e,t))})}(e,{idToken:t,email:this._email,oobCode:this._password});default:ta(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Io(e,t){return p(this,null,function*(){return ya(e,"POST","/v1/accounts:signInWithIdp",va(e,t))})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ao extends ko{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ao(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ta("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:s,signInMethod:r}=t,n=h(t,["providerId","signInMethod"]);if(!s||!r)return null;const i=new Ao(s,r);return i.idToken=n.idToken||void 0,i.accessToken=n.accessToken||void 0,i.secret=n.secret,i.nonce=n.nonce,i.pendingToken=n.pendingToken||null,i}_getIdTokenResponse(e){return Io(e,this.buildRequest())}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Io(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Io(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Zs(t)}return e}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Do{constructor(e){var t,s,r,n,i,a;const o=er(tr(e)),l=null!=(t=o.apiKey)?t:null,c=null!=(s=o.oobCode)?s:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!=(r=o.mode)?r:null);aa(l&&c&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=c,this.continueUrl=null!=(n=o.continueUrl)?n:null,this.languageCode=null!=(i=o.lang)?i:null,this.tenantId=null!=(a=o.tenantId)?a:null}static parseLink(e){const t=function(e){const t=er(tr(e)).link,s=t?er(tr(t)).deep_link_id:null,r=er(tr(e)).deep_link_id;return(r?er(tr(r)).link:null)||r||s||t||e}(e);try{return new Do(t)}catch(xN){return null}}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Po{constructor(){this.providerId=Po.PROVIDER_ID}static credential(e,t){return To._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Do.parseLink(t);return aa(s,"argument-error"),To._fromEmailAndCode(e,s.code,s.tenantId)}}Po.PROVIDER_ID="password",Po.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Po.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ro{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Lo extends Ro{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Oo extends Lo{constructor(){super("facebook.com")}static credential(e){return Ao._fromParams({providerId:Oo.PROVIDER_ID,signInMethod:Oo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oo.credentialFromTaggedObject(e)}static credentialFromError(e){return Oo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Oo.credential(e.oauthAccessToken)}catch(xN){return null}}}Oo.FACEBOOK_SIGN_IN_METHOD="facebook.com",Oo.PROVIDER_ID="facebook.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Mo extends Lo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ao._fromParams({providerId:Mo.PROVIDER_ID,signInMethod:Mo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Mo.credentialFromTaggedObject(e)}static credentialFromError(e){return Mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Mo.credential(t,s)}catch(xN){return null}}}Mo.GOOGLE_SIGN_IN_METHOD="google.com",Mo.PROVIDER_ID="google.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Uo extends Lo{constructor(){super("github.com")}static credential(e){return Ao._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch(xN){return null}}}Uo.GITHUB_SIGN_IN_METHOD="github.com",Uo.PROVIDER_ID="github.com";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Fo extends Lo{constructor(){super("twitter.com")}static credential(e,t){return Ao._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Fo.credential(t,s)}catch(xN){return null}}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Vo(e,t){return p(this,null,function*(){return ya(e,"POST","/v1/accounts:signUp",va(e,t))})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Fo.TWITTER_SIGN_IN_METHOD="twitter.com",Fo.PROVIDER_ID="twitter.com";class zo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,s,r=!1){return p(this,null,function*(){const n=yield $a._fromIdTokenResponse(e,s,r),i=$o(s);return new zo({user:n,providerId:i,_tokenResponse:s,operationType:t})})}static _forOperation(e,t,s){return p(this,null,function*(){yield e._updateTokensIfNecessary(s,!0);const r=$o(s);return new zo({user:e,providerId:r,_tokenResponse:s,operationType:t})})}}function $o(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Bo extends Ks{constructor(e,t,s,r){var n;super(t.code,t.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,Bo.prototype),this.customData={appName:e.name,tenantId:null!=(n=e.tenantId)?n:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,r){return new Bo(e,t,s,r)}}function qo(e,t,s,r){return("reauthenticate"===t?s._getReauthenticationResolver(e):s._getIdTokenResponse(e)).catch(s=>{if("auth/multi-factor-auth-required"===s.code)throw Bo._fromErrorAndOperation(e,s,t,r);throw s})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ho(e,t,s=!1){return p(this,null,function*(){if(wn(e.app))return Promise.reject(na(e));const r="signIn",n=yield qo(e,r,t),i=yield zo._fromIdTokenResponse(e,r,n);return s||(yield e._updateCurrentUser(i.user)),i})}function Go(e,t){return p(this,null,function*(){return Ho(uo(e),t)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Wo(e){return p(this,null,function*(){const t=uo(e);t._getPasswordPolicyInternal()&&(yield t._updatePasswordPolicy())})}function Ko(e,t,s){return p(this,null,function*(){if(wn(e.app))return Promise.reject(na(e));const r=uo(e),n=wo(r,{returnSecureToken:!0,email:t,password:s,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Vo),i=yield n.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Wo(e),t}),a=yield zo._fromIdTokenResponse(r,"signIn",i);return yield r._updateCurrentUser(a.user),a})}function Qo(e,t,s){return wn(e.app)?Promise.reject(na(e)):Go(ir(e),Po.credential(t,s)).catch(t=>p(this,null,function*(){throw"auth/password-does-not-meet-requirements"===t.code&&Wo(e),t}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Jo(e,t){return p(this,arguments,function*(e,{displayName:t,photoURL:s}){if(void 0===t&&void 0===s)return;const r=ir(e),n={idToken:yield r.getIdToken(),displayName:t,photoUrl:s,returnSecureToken:!0},i=yield Ra(r,function(e,t){return p(this,null,function*(){return ba(e,"POST","/v1/accounts:update",t)})}(r.auth,n));r.displayName=i.displayName||null,r.photoURL=i.photoUrl||null;const a=r.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),yield r._updateTokensIfNecessary(i)})}function Yo(e,t,s,r){return ir(e).onIdTokenChanged(t,s,r)}function Xo(e,t,s){return ir(e).beforeAuthStateChanged(t,s)}function Zo(e){return p(this,null,function*(){return ir(e).delete()})}const el="__sak";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class tl{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(el,"1"),this.storage.removeItem(el),Promise.resolve(!0)):Promise.resolve(!1)}catch(xN){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class sl extends tl{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=io(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),r=this.localCache[t];s!==r&&e(t,r,s)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,s)=>{this.notifyListeners(e,s)});const s=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(s);(t||this.localCache[s]!==e)&&this.notifyListeners(s,e)},n=this.storage.getItem(s);no()&&n!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,t){return p(this,null,function*(){yield m(sl.prototype,this,"_set").call(this,e,t),this.localCache[e]=JSON.stringify(t)})}_get(e){return p(this,null,function*(){const t=yield m(sl.prototype,this,"_get").call(this,e);return this.localCache[e]=JSON.stringify(t),t})}_remove(e){return p(this,null,function*(){yield m(sl.prototype,this,"_remove").call(this,e),delete this.localCache[e]})}}sl.type="LOCAL";const rl=sl;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class nl extends tl{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}nl.type="SESSION";const il=nl;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class al{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const s=new al(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}handleEvent(e){return p(this,null,function*(){const t=e,{eventId:s,eventType:r,data:n}=t.data,i=this.handlersMap[r];if(!(null==i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(i).map(e=>p(this,null,function*(){return e(t.origin,n)})),o=yield function(e){return Promise.all(e.map(e=>p(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}(a);t.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:o})})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function ol(e="",t=10){let s="";for(let r=0;r<t;r++)s+=Math.floor(10*Math.random());return e+s}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */al.receivers=[];class ll{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,s=50){return p(this,null,function*(){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let n,i;return new Promise((a,o)=>{const l=ol("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},s);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),n=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(n),a(t.data.response);break;default:clearTimeout(c),clearTimeout(n),o(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cl(){return window}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function dl(){return void 0!==cl().WorkerGlobalScope&&"function"==typeof cl().importScripts}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ul="firebaseLocalStorageDb",hl="firebaseLocalStorage",ml="fbase_key";class pl{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function fl(e,t){return e.transaction([hl],t?"readwrite":"readonly").objectStore(hl)}function gl(){const e=indexedDB.open(ul,1);return new Promise((t,s)=>{e.addEventListener("error",()=>{s(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(hl,{keyPath:ml})}catch(xN){s(xN)}}),e.addEventListener("success",()=>p(this,null,function*(){const s=e.result;s.objectStoreNames.contains(hl)?t(s):(s.close(),yield function(){const e=indexedDB.deleteDatabase(ul);return new pl(e).toPromise()}(),t(yield gl()))}))})}function xl(e,t,s){return p(this,null,function*(){const r=fl(e,!0).put({[ml]:t,value:s});return new pl(r).toPromise()})}function vl(e,t){const s=fl(e,!0).delete(t);return new pl(s).toPromise()}class bl{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return p(this,null,function*(){return this.db||(this.db=yield gl()),this.db})}_withRetries(e){return p(this,null,function*(){let t=0;for(;;)try{const t=yield this._openDb();return yield e(t)}catch(xN){if(t++>3)throw xN;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return p(this,null,function*(){return dl()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return p(this,null,function*(){this.receiver=al._getInstance(dl()?self:null),this.receiver._subscribe("keyChanged",(e,t)=>p(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(t.key)}})),this.receiver._subscribe("ping",(e,t)=>p(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return p(this,null,function*(){var e,t;if(this.activeServiceWorker=yield function(){return p(this,null,function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(xN){return null}})}(),!this.activeServiceWorker)return;this.sender=new ll(this.activeServiceWorker);const s=yield this.sender._send("ping",{},800);s&&(null==(e=s[0])?void 0:e.fulfilled)&&(null==(t=s[0])?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(e){return p(this,null,function*(){var t;if(this.sender&&this.activeServiceWorker&&((null==(t=null==navigator?void 0:navigator.serviceWorker)?void 0:t.controller)||null)===this.activeServiceWorker)try{yield this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(xN){}})}_isAvailable(){return p(this,null,function*(){try{if(!indexedDB)return!1;const e=yield gl();return yield xl(e,el,"1"),yield vl(e,el),!0}catch(xN){}return!1})}_withPendingWrite(e){return p(this,null,function*(){this.pendingWrites++;try{yield e()}finally{this.pendingWrites--}})}_set(e,t){return p(this,null,function*(){return this._withPendingWrite(()=>p(this,null,function*(){return yield this._withRetries(s=>xl(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)}))})}_get(e){return p(this,null,function*(){const t=yield this._withRetries(t=>function(e,t){return p(this,null,function*(){const s=fl(e,!1).get(t),r=yield new pl(s).toPromise();return void 0===r?null:r.value})}(t,e));return this.localCache[e]=t,t})}_remove(e){return p(this,null,function*(){return this._withPendingWrite(()=>p(this,null,function*(){return yield this._withRetries(t=>vl(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)}))})}_poll(){return p(this,null,function*(){const e=yield this._withRetries(e=>{const t=fl(e,!1).getAll();return new pl(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],s=new Set;if(0!==e.length)for(const{fbase_key:r,value:n}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(n)&&(this.notifyListeners(r,n),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),t.push(r));return t})}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>p(this,null,function*(){return this._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}bl.type="LOCAL";const wl=bl;
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function yl(e,t){return t?qa(t):(aa(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */new ha(3e4,6e4);class Nl extends ko{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Io(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Io(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Io(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function jl(e){return Ho(e.auth,new Nl(e),e.bypassAuthState)}function Cl(e){const{auth:t,user:s}=e;return aa(s,t,"internal-error"),
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t,s=!1){return p(this,null,function*(){const{auth:r}=e;if(wn(r.app))return Promise.reject(na(r));const n="reauthenticate";try{const i=yield Ra(e,qo(r,n,t,e),s);aa(i.idToken,r,"internal-error");const a=Da(i.idToken);aa(a,r,"internal-error");const{sub:o}=a;return aa(e.uid===o,r,"user-mismatch"),zo._forOperation(e,n,i)}catch(xN){throw"auth/user-not-found"===(null==xN?void 0:xN.code)&&ta(r,"user-mismatch"),xN}})}(s,new Nl(e),e.bypassAuthState)}function kl(e){return p(this,null,function*(){const{auth:t,user:s}=e;return aa(s,t,"internal-error"),function(e,t,s=!1){return p(this,null,function*(){const r=yield Ra(e,t._linkToIdToken(e.auth,yield e.getIdToken()),s);return zo._forOperation(e,"link",r)})}(s,new Nl(e),e.bypassAuthState)})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Sl{constructor(e,t,s,r,n=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=n,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>p(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(xN){this.reject(xN)}}))}onAuthEvent(e){return p(this,null,function*(){const{urlResponse:t,sessionId:s,postBody:r,tenantId:n,error:i,type:a}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:s,tenantId:n||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(o))}catch(xN){this.reject(xN)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jl;case"linkViaPopup":case"linkViaRedirect":return kl;case"reauthViaPopup":case"reauthViaRedirect":return Cl;default:ta(this.auth,"internal-error")}}resolve(e){la(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){la(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const El=new ha(2e3,1e4);function _l(e,t,s){return p(this,null,function*(){if(wn(e.app))return Promise.reject(sa(e,"operation-not-supported-in-this-environment"));const r=uo(e);!function(e,t,s){if(!(t instanceof s))throw s.name!==t.constructor.name&&ta(e,"argument-error"),ra(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(e,t,Ro);const n=yl(r,s);return new Tl(r,"signInViaPopup",t,n).executeNotNull()})}class Tl extends Sl{constructor(e,t,s,r,n){super(e,t,r,n),this.provider=s,this.authWindow=null,this.pollId=null,Tl.currentPopupAction&&Tl.currentPopupAction.cancel(),Tl.currentPopupAction=this}executeNotNull(){return p(this,null,function*(){const e=yield this.execute();return aa(e,this.auth,"internal-error"),e})}onExecution(){return p(this,null,function*(){la(1===this.filter.length,"Popup operations only handle one event");const e=ol();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(sa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var e;return(null==(e=this.authWindow)?void 0:e.associatedEvent)||null}cancel(){this.reject(sa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;(null==(s=null==(t=this.authWindow)?void 0:t.window)?void 0:s.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(sa(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,El.get())};e()}}Tl.currentPopupAction=null;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Il="pendingRedirect",Al=new Map;class Dl extends Sl{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}execute(){return p(this,null,function*(){let e=Al.get(this.auth._key());if(!e){try{const t=(yield function(e,t){return p(this,null,function*(){const s=function(e){return Wa(Il,e.config.apiKey,e.name)}(t),r=function(e){return qa(e._redirectPersistence)}(e);if(!(yield r._isAvailable()))return!1;const n="true"===(yield r._get(s));return yield r._remove(s),n})}(this.resolver,this.auth))?yield m(Dl.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(t)}catch(xN){e=()=>Promise.reject(xN)}Al.set(this.auth._key(),e)}return this.bypassAuthState||Al.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return p(this,null,function*(){if("signInViaRedirect"===e.type)return m(Dl.prototype,this,"onAuthEvent").call(this,e);if("unknown"!==e.type){if(e.eventId){const t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,m(Dl.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}}else this.resolve(null)})}onExecution(){return p(this,null,function*(){})}cleanUp(){}}function Pl(e,t){Al.set(e._key(),t)}function Rl(e,t,s=!1){return p(this,null,function*(){if(wn(e.app))return Promise.reject(na(e));const r=uo(e),n=yl(r,t),i=new Dl(r,n,s),a=yield i.execute();return a&&!s&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,t)),a})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ll{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ml(e);default:return!1}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!Ml(e)){const r=(null==(s=e.error.code)?void 0:s.split("auth/")[1])||"internal-error";t.onError(sa(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ol(e))}saveEventToCache(e){this.cachedEventUids.add(Ol(e)),this.lastProcessedEventTime=Date.now()}}function Ol(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Ml({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Ul=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Fl=/^https?/;function Vl(e){return p(this,null,function*(){if(e.config.emulator)return;const{authorizedDomains:t}=yield function(e){return p(this,arguments,function*(e,t={}){return ba(e,"GET","/v1/projects",t)})}(e);for(const e of t)try{if(zl(e))return}catch(xN){}ta(e,"unauthorized-domain")})}function zl(e){const t=ca(),{protocol:s,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const n=new URL(e);return""===n.hostname&&""===r?"chrome-extension:"===s&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===s&&n.hostname===r}if(!Fl.test(s))return!1;if(Ul.test(e))return r===e;const n=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+n+"|"+n+")$","i").test(r)}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const $l=new ha(3e4,6e4);function Bl(){const e=cl().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let s=0;s<e.CP.length;s++)e.CP[s]=null}function ql(e){return new Promise((t,s)=>{var r,n,i;function a(){Bl(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Bl(),s(sa(e,"network-request-failed"))},timeout:$l.get()})}if(null==(n=null==(r=cl().gapi)?void 0:r.iframes)?void 0:n.Iframe)t(gapi.iframes.getContext());else{if(!(null==(i=cl().gapi)?void 0:i.load)){const t=`__iframefcb${Math.floor(1e6*Math.random())}`;return cl()[t]=()=>{gapi.load?a():s(sa(e,"network-request-failed"))},po(`${mo.gapiScript}?onload=${t}`).catch(e=>s(e))}a()}}).catch(e=>{throw Hl=null,e})}let Hl=null;
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Gl=new ha(5e3,15e3),Wl={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Kl=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ql(e){const t=e.config;aa(t.authDomain,e,"auth-domain-config-required");const s=t.emulator?ma(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:jn},n=Kl.get(e.config.apiHost);n&&(r.eid=n);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),`${s}?${Zs(r).slice(1)}`}function Jl(e){return p(this,null,function*(){const t=yield function(e){return Hl=Hl||ql(e),Hl}(e),s=cl().gapi;return aa(s,e,"internal-error"),t.open({where:document.body,url:Ql(e),messageHandlersFilter:s.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Wl,dontclear:!0},t=>new Promise((s,r)=>p(this,null,function*(){yield t.restyle({setHideOnLeave:!1});const n=sa(e,"network-request-failed"),i=cl().setTimeout(()=>{r(n)},Gl.get());function a(){cl().clearTimeout(i),s(t)}t.ping(a).then(a,()=>{r(n)})})))})}
/**
     * @license
     * Copyright 2020 Google LLC.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Yl={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Xl{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(xN){}}}function Zl(e,t,s,r=500,n=600){const i=Math.max((window.screen.availHeight-n)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=u(d({},Yl),{width:r.toString(),height:n.toString(),top:i,left:a}),c=Bs().toLowerCase();s&&(o=Xa(c)?"_blank":s),Ja(c)&&(t=t||"http://localhost",l.scrollbars="yes");const h=Object.entries(l).reduce((e,[t,s])=>`${e}${t}=${s},`,"");if(function(e=Bs()){var t;return ro(e)&&!!(null==(t=window.navigator)?void 0:t.standalone)}(c)&&"_self"!==o)return function(e,t){const s=document.createElement("a");s.href=e,s.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),s.dispatchEvent(r)}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t||"",o),new Xl(null);const m=window.open(t||"",o,h);aa(m,e,"popup-blocked");try{m.focus()}catch(xN){}return new Xl(m)}const ec="__/auth/handler",tc="emulator/auth/handler",sc=encodeURIComponent("fac");function rc(e,t,s,r,n,i){return p(this,null,function*(){aa(e.config.authDomain,e,"auth-domain-config-required"),aa(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:s,redirectUrl:r,v:jn,eventId:n};if(t instanceof Ro){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))i[e]=t}if(t instanceof Lo){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(i.scopes=e.join(","))}e.tenantId&&(i.tid=e.tenantId);const a=i;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const o=yield e._getAppCheckToken(),l=o?`#${sc}=${encodeURIComponent(o)}`:"";return`${function({config:e}){return e.emulator?ma(e,tc):`https://${e.authDomain}/${ec}`}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)}?${Zs(a).slice(1)}${l}`})}const nc="webStorageSupport",ic=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=il,this._completeRedirectFn=Rl,this._overrideRedirectResult=Pl}_openPopup(e,t,s,r){return p(this,null,function*(){var n;la(null==(n=this.eventManagers[e._key()])?void 0:n.manager,"_initialize() not called before _openPopup()");const i=yield rc(e,t,s,ca(),r);return Zl(e,i,ol())})}_openRedirect(e,t,s,r){return p(this,null,function*(){return yield this._originValidation(e),function(e){cl().location.href=e}(yield rc(e,t,s,ca(),r)),new Promise(()=>{})})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:s}=this.eventManagers[t];return e?Promise.resolve(e):(la(s,"If manager is not set, promise should be"),s)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}initAndGetManager(e){return p(this,null,function*(){const t=yield Jl(e),s=new Ll(e);return t.register("authEvent",t=>(aa(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:s.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(nc,{type:nc},s=>{var r;const n=null==(r=null==s?void 0:s[0])?void 0:r[nc];void 0!==n&&t(!!n),ta(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Vl(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return io()||Ya()||ro()}};var ac="@firebase/auth",oc="1.11.0";
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class lc{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null==(e=this.auth.currentUser)?void 0:e.uid)||null}getToken(e){return p(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){aa(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const cc=Ls("authIdTokenMaxAge")||300;let dc=null;function uc(t=kn()){const s=bn(t,"auth");if(s.isInitialized())return s.getImmediate();const r=yo(t,{popupRedirectResolver:ic,persistence:[wl,rl,il]}),n=Ls("authTokenSyncURL");if(n&&"boolean"==typeof isSecureContext&&isSecureContext){const t=new URL(n,location.origin);if(location.origin===t.origin){const s=(i=t.toString(),t=>p(e,null,function*(){const e=t&&(yield t.getIdTokenResult()),s=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(s&&s>cc)return;const r=null==e?void 0:e.token;dc!==r&&(dc=r,yield fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))}));Xo(r,s,()=>s(r.currentUser)),Yo(r,e=>s(e))}}var i;const a=Ds("auth");return a&&No(r,`http://${a}`),r}var hc;mo={loadJS:e=>new Promise((t,s)=>{const r=document.createElement("script");var n,i;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=sa("internal-error");t.customData=e,s(t)},r.type="text/javascript",r.charset="UTF-8",(null!=(i=null==(n=document.getElementsByTagName("head"))?void 0:n[0])?i:document).appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},hc="Browser",vn(new ar("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),n=e.getProvider("app-check-internal"),{apiKey:i,authDomain:a}=s.options;aa(i&&!i.includes(":"),"invalid-api-key",{appName:s.name});const o={apiKey:i,authDomain:a,clientPlatform:hc,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ao(hc)},l=new co(s,r,n,o);return function(e,t){const s=(null==t?void 0:t.persistence)||[],r=(Array.isArray(s)?s:[s]).map(qa);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),vn(new ar("auth-internal",e=>{const t=uo(e.getProvider("auth").getImmediate());return new lc(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Sn(ac,oc,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(hc)),Sn(ac,oc,"esm2020");const mc=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Do,AuthCredential:ko,EmailAuthCredential:To,EmailAuthProvider:Po,FacebookAuthProvider:Oo,GithubAuthProvider:Uo,GoogleAuthProvider:Mo,OAuthCredential:Ao,TwitterAuthProvider:Fo,beforeAuthStateChanged:Xo,browserLocalPersistence:rl,browserPopupRedirectResolver:ic,browserSessionPersistence:il,connectAuthEmulator:No,createUserWithEmailAndPassword:Ko,deleteUser:Zo,getAuth:uc,getIdTokenResult:Ia,inMemoryPersistence:Ga,indexedDBLocalPersistence:wl,initializeAuth:yo,onIdTokenChanged:Yo,prodErrorMap:Yi,reload:Ua,sendPasswordResetEmail:function(e,t,s){return p(this,null,function*(){const r=uo(e),n={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};s&&function(e,t,s){var r;aa((null==(r=s.url)?void 0:r.length)>0,e,"invalid-continue-uri"),aa(void 0===s.dynamicLinkDomain||s.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),aa(void 0===s.linkDomain||s.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=s.url,t.dynamicLinkDomain=s.dynamicLinkDomain,t.linkDomain=s.linkDomain,t.canHandleCodeInApp=s.handleCodeInApp,s.iOS&&(aa(s.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=s.iOS.bundleId),s.android&&(aa(s.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=s.android.installApp,t.androidMinimumVersionCode=s.android.minimumVersion,t.androidPackageName=s.android.packageName)}(r,n,s),yield wo(r,n,"getOobCode",_o)})},signInWithCredential:Go,signInWithEmailAndPassword:Qo,signInWithPopup:_l,updateProfile:Jo},Symbol.toStringTag,{value:"Module"}));var pc,fc,gc="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
    Copyright The Closure Library Authors.
    SPDX-License-Identifier: Apache-2.0
    */(function(){var e;
/** @license
      
       Copyright The Closure Library Authors.
       SPDX-License-Identifier: Apache-2.0
      */function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function s(e,t,s){s||(s=0);var r=Array(16);if("string"==typeof t)for(var n=0;16>n;++n)r[n]=t.charCodeAt(s++)|t.charCodeAt(s++)<<8|t.charCodeAt(s++)<<16|t.charCodeAt(s++)<<24;else for(n=0;16>n;++n)r[n]=t[s++]|t[s++]<<8|t[s++]<<16|t[s++]<<24;t=e.g[0],s=e.g[1],n=e.g[2];var i=e.g[3],a=t+(i^s&(n^i))+r[0]+3614090360&4294967295;a=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=(s=(n=(i=(t=s+(a<<7&4294967295|a>>>25))+((a=i+(n^t&(s^n))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=n+(s^i&(t^s))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=s+(t^n&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(n^i))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=i+(n^t&(s^n))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=n+(s^i&(t^s))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=s+(t^n&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(n^i))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=i+(n^t&(s^n))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=n+(s^i&(t^s))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=s+(t^n&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(n^i))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=i+(n^t&(s^n))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=n+(s^i&(t^s))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=s+(t^n&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(n^i&(s^n))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=i+(s^n&(t^s))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=n+(t^s&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=s+(i^t&(n^i))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^i&(s^n))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=i+(s^n&(t^s))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=n+(t^s&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=s+(i^t&(n^i))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^i&(s^n))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=i+(s^n&(t^s))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=n+(t^s&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=s+(i^t&(n^i))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^i&(s^n))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=i+(s^n&(t^s))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=n+(t^s&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=s+(i^t&(n^i))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^n^i)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^s^n)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=n+(i^t^s)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=s+(n^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(s^n^i)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^s^n)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=n+(i^t^s)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=s+(n^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(s^n^i)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^s^n)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=n+(i^t^s)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=s+(n^i^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(s^n^i)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^s^n)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=n+(i^t^s)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=s+(n^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^(s|~i))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=i+(s^(t|~n))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=n+(t^(i|~s))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=s+(i^(n|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(n^(s|~i))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=i+(s^(t|~n))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=n+(t^(i|~s))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=s+(i^(n|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(n^(s|~i))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=i+(s^(t|~n))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=n+(t^(i|~s))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=s+(i^(n|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((i=(t=s+((a=t+(n^(s|~i))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=i+(s^(t|~n))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((n=i+((a=n+(t^(i|~s))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(n+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+n&4294967295,e.g[3]=e.g[3]+i&4294967295}function r(e,t){this.h=t;for(var s=[],r=!0,n=e.length-1;0<=n;n--){var i=0|e[n];r&&i==t||(s[n]=i,r=!1)}this.g=s}!function(e,t){function s(){}s.prototype=t.prototype,e.D=t.prototype,e.prototype=new s,e.prototype.constructor=e,e.C=function(e,s,r){for(var n=Array(arguments.length-2),i=2;i<arguments.length;i++)n[i-2]=arguments[i];return t.prototype[s].apply(e,n)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,n=this.B,i=this.h,a=0;a<t;){if(0==i)for(;a<=r;)s(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(n[i++]=e.charCodeAt(a++),i==this.blockSize){s(this,n),i=0;break}}else for(;a<t;)if(n[i++]=e[a++],i==this.blockSize){s(this,n),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var s=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&s,s/=256;for(this.u(e),e=Array(16),t=s=0;4>t;++t)for(var r=0;32>r;r+=8)e[s++]=this.g[t]>>>r&255;return e};var n={};function i(e){return-128<=e&&128>e?function(e,t){var s=n;return Object.prototype.hasOwnProperty.call(s,e)?s[e]:s[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(a(-e));for(var t=[],s=1,n=0;e>=s;n++)t[n]=e/s|0,s*=4294967296;return new r(t,0)}var o=i(0),l=i(1),c=i(16777216);function d(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function u(e){return-1==e.h}function h(e){for(var t=e.g.length,s=[],n=0;n<t;n++)s[n]=~e.g[n];return new r(s,~e.h).add(l)}function m(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function f(e,t){this.g=e,this.h=t}function g(e,t){if(d(t))throw Error("division by zero");if(d(e))return new f(o,o);if(u(e))return t=g(h(e),t),new f(h(t.g),h(t.h));if(u(t))return t=g(e,h(t)),new f(h(t.g),t.h);if(30<e.g.length){if(u(e)||u(t))throw Error("slowDivide_ only works with positive integers.");for(var s=l,r=t;0>=r.l(e);)s=x(s),r=x(r);var n=v(s,1),i=v(r,1);for(r=v(r,2),s=v(s,2);!d(r);){var c=i.add(r);0>=c.l(e)&&(n=n.add(s),i=c),r=v(r,1),s=v(s,1)}return t=m(e,n.j(t)),new f(n,t)}for(n=o;0<=e.l(t);){for(s=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(s)/Math.LN2))?1:Math.pow(2,r-48),c=(i=a(s)).j(t);u(c)||0<c.l(e);)c=(i=a(s-=r)).j(t);d(i)&&(i=l),n=n.add(i),e=m(e,c)}return new f(n,e)}function x(e){for(var t=e.g.length+1,s=[],n=0;n<t;n++)s[n]=e.i(n)<<1|e.i(n-1)>>>31;return new r(s,e.h)}function v(e,t){var s=t>>5;t%=32;for(var n=e.g.length-s,i=[],a=0;a<n;a++)i[a]=0<t?e.i(a+s)>>>t|e.i(a+s+1)<<32-t:e.i(a+s);return new r(i,e.h)}(e=r.prototype).m=function(){if(u(this))return-h(this).m();for(var e=0,t=1,s=0;s<this.g.length;s++){var r=this.i(s);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(d(this))return"0";if(u(this))return"-"+h(this).toString(e);for(var t=a(Math.pow(e,6)),s=this,r="";;){var n=g(s,t).g,i=((0<(s=m(s,n.j(t))).g.length?s.g[0]:s.h)>>>0).toString(e);if(d(s=n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return u(e=m(this,e))?-1:d(e)?0:1},e.abs=function(){return u(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),s=[],n=0,i=0;i<=t;i++){var a=n+(65535&this.i(i))+(65535&e.i(i)),o=(a>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);n=o>>>16,a&=65535,o&=65535,s[i]=o<<16|a}return new r(s,-2147483648&s[s.length-1]?-1:0)},e.j=function(e){if(d(this)||d(e))return o;if(u(this))return u(e)?h(this).j(h(e)):h(h(this).j(e));if(u(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return a(this.m()*e.m());for(var t=this.g.length+e.g.length,s=[],n=0;n<2*t;n++)s[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<e.g.length;i++){var l=this.i(n)>>>16,m=65535&this.i(n),f=e.i(i)>>>16,g=65535&e.i(i);s[2*n+2*i]+=m*g,p(s,2*n+2*i),s[2*n+2*i+1]+=l*g,p(s,2*n+2*i+1),s[2*n+2*i+1]+=m*f,p(s,2*n+2*i+1),s[2*n+2*i+2]+=l*f,p(s,2*n+2*i+2)}for(n=0;n<t;n++)s[n]=s[2*n+1]<<16|s[2*n];for(n=t;n<2*t;n++)s[n]=0;return new r(s,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),s=[],n=0;n<t;n++)s[n]=this.i(n)&e.i(n);return new r(s,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),s=[],n=0;n<t;n++)s[n]=this.i(n)|e.i(n);return new r(s,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),s=[],n=0;n<t;n++)s[n]=this.i(n)^e.i(n);return new r(s,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,fc=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=a,r.fromString=function e(t,s){if(0==t.length)throw Error("number format error: empty string");if(2>(s=s||10)||36<s)throw Error("radix out of range: "+s);if("-"==t.charAt(0))return h(e(t.substring(1),s));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=a(Math.pow(s,8)),n=o,i=0;i<t.length;i+=8){var l=Math.min(8,t.length-i),c=parseInt(t.substring(i,i+l),s);8>l?(l=a(Math.pow(s,l)),n=n.j(l).add(a(c))):n=(n=n.j(r)).add(a(c))}return n},pc=r}).apply(void 0!==gc?gc:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var xc,vc,bc,wc,yc,Nc,jc,Cc,kc="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
    Copyright The Closure Library Authors.
    SPDX-License-Identifier: Apache-2.0
    */(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,s){return e==Array.prototype||e==Object.prototype||(e[t]=s.value),e},s=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof kc&&kc];for(var t=0;t<e.length;++t){var s=e[t];if(s&&s.Math==Math)return s}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var n=s;e=e.split(".");for(var i=0;i<e.length-1;i++){var a=e[i];if(!(a in n))break e;n=n[a]}(r=r(i=n[e=e[e.length-1]]))!=i&&null!=r&&t(n,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var s=0,r=!1,n={next:function(){if(!r&&s<e.length){var n=s++;return{value:t(n,e[n]),done:!1}}return r=!0,{done:!0,value:void 0}}};return n[Symbol.iterator]=function(){return n},n}(this,function(e,t){return t})}});
/** @license
      
       Copyright The Closure Library Authors.
       SPDX-License-Identifier: Apache-2.0
      */
var r=r||{},n=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,s){return e.call.apply(e.bind,arguments)}function l(e,t,s){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),e.apply(t,s)}}return function(){return e.apply(t,arguments)}}function c(e,t,s){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function d(e,t){var s=Array.prototype.slice.call(arguments,1);return function(){var t=s.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function s(){}s.prototype=t.prototype,e.aa=t.prototype,e.prototype=new s,e.prototype.constructor=e,e.Qb=function(e,s,r){for(var n=Array(arguments.length-2),i=2;i<arguments.length;i++)n[i-2]=arguments[i];return t.prototype[s].apply(e,n)}}function h(e){const t=e.length;if(0<t){const s=Array(t);for(let r=0;r<t;r++)s[r]=e[r];return s}return[]}function m(e,t){for(let s=1;s<arguments.length;s++){const t=arguments[s];if(i(t)){const s=e.length||0,r=t.length||0;e.length=s+r;for(let n=0;n<r;n++)e[s+n]=t[n]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function f(){var e=n.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var x=!(-1==f().indexOf("Gecko")||-1!=f().toLowerCase().indexOf("webkit")&&-1==f().indexOf("Edge")||-1!=f().indexOf("Trident")||-1!=f().indexOf("MSIE")||-1!=f().indexOf("Edge"));function v(e,t,s){for(const r in e)t.call(s,e[r],r,e)}function b(e){const t={};for(const s in e)t[s]=e[s];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function y(e,t){let s,r;for(let n=1;n<arguments.length;n++){for(s in r=arguments[n],r)e[s]=r[s];for(let t=0;t<w.length;t++)s=w[t],Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}}function N(e){var t=1;e=e.split(":");const s=[];for(;0<t&&e.length;)s.push(e.shift()),t--;return e.length&&s.push(e.join(":")),s}function j(e){n.setTimeout(()=>{throw e},0)}function C(){var e=T;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var k=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new S,e=>e.reset());class S{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let E,_=!1,T=new class{constructor(){this.h=this.g=null}add(e,t){const s=k.get();s.set(e,t),this.h?this.h.next=s:this.g=s,this.h=s}},I=()=>{const e=n.Promise.resolve(void 0);E=()=>{e.then(A)}};var A=()=>{for(var e;e=C();){try{e.h.call(e.g)}catch(s){j(s)}var t=k;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}_=!1};function D(){this.s=this.s,this.C=this.C}function P(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}D.prototype.s=!1,D.prototype.ma=function(){this.s||(this.s=!0,this.N())},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},P.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!n.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};n.addEventListener("test",e,t),n.removeEventListener("test",e,t)}catch(s){}return e}();function L(e,t){if(P.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var s=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(x){e:{try{g(t.nodeName);var n=!0;break e}catch(i){}n=!1}n||(t=null)}}else"mouseover"==s?t=e.fromElement:"mouseout"==s&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:O[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}u(L,P);var O={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),U=0;function F(e,t,s,r,n){this.listener=e,this.proxy=null,this.src=t,this.type=s,this.capture=!!r,this.ha=n,this.key=++U,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function $(e,t){var s=t.type;if(s in e.g){var r,n=e.g[s],i=Array.prototype.indexOf.call(n,t,void 0);(r=0<=i)&&Array.prototype.splice.call(n,i,1),r&&(V(t),0==e.g[s].length&&(delete e.g[s],e.h--))}}function B(e,t,s,r){for(var n=0;n<e.length;++n){var i=e[n];if(!i.da&&i.listener==t&&i.capture==!!s&&i.ha==r)return n}return-1}z.prototype.add=function(e,t,s,r,n){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var a=B(e,t,r,n);return-1<a?(t=e[a],s||(t.fa=!1)):((t=new F(t,this.src,i,!!r,n)).fa=s,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),H={};function G(e,t,s,r,n){if(Array.isArray(t)){for(var i=0;i<t.length;i++)G(e,t[i],s,r,n);return null}return s=Z(s),e&&e[M]?e.K(t,s,a(r)?!!r.capture:!!r,n):function(e,t,s,r,n,i){if(!t)throw Error("Invalid event type");var o=a(n)?!!n.capture:!!n,l=Y(e);if(l||(e[q]=l=new z(e)),(s=l.add(t,s,r,o,i)).proxy)return s;if(r=function(){function e(s){return t.call(e.src,e.listener,s)}const t=J;return e}(),s.proxy=r,r.src=e,r.listener=s,e.addEventListener)R||(n=o),void 0===n&&(n=!1),e.addEventListener(t.toString(),r,n);else if(e.attachEvent)e.attachEvent(Q(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return s}(e,t,s,!1,r,n)}function W(e,t,s,r,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)W(e,t[i],s,r,n);else r=a(r)?!!r.capture:!!r,s=Z(s),e&&e[M]?(e=e.i,(t=String(t).toString())in e.g&&-1<(s=B(i=e.g[t],s,r,n))&&(V(i[s]),Array.prototype.splice.call(i,s,1),0==i.length&&(delete e.g[t],e.h--))):e&&(e=Y(e))&&(t=e.g[t.toString()],e=-1,t&&(e=B(t,s,r,n)),(s=-1<e?t[e]:null)&&K(s))}function K(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])$(t.i,e);else{var s=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(s,r,e.capture):t.detachEvent?t.detachEvent(Q(s),r):t.addListener&&t.removeListener&&t.removeListener(r),(s=Y(t))?($(s,e),0==s.h&&(s.src=null,t[q]=null)):V(e)}}}function Q(e){return e in H?H[e]:H[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new L(t,this);var s=e.listener,r=e.ha||e.src;e.fa&&K(e),e=s.call(r,t)}return e}function Y(e){return(e=e[q])instanceof z?e:null}var X="__closure_events_fn_"+(1e9*Math.random()>>>0);function Z(e){return"function"==typeof e?e:(e[X]||(e[X]=function(t){return e.handleEvent(t)}),e[X])}function ee(){D.call(this),this.i=new z(this),this.M=this,this.F=null}function te(e,t){var s,r=e.F;if(r)for(s=[];r;r=r.F)s.push(r);if(e=e.M,r=t.type||t,"string"==typeof t)t=new P(t,e);else if(t instanceof P)t.target=t.target||e;else{var n=t;y(t=new P(r,e),n)}if(n=!0,s)for(var i=s.length-1;0<=i;i--){var a=t.g=s[i];n=se(a,r,!0,t)&&n}if(n=se(a=t.g=e,r,!0,t)&&n,n=se(a,r,!1,t)&&n,s)for(i=0;i<s.length;i++)n=se(a=t.g=s[i],r,!1,t)&&n}function se(e,t,s,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var n=!0,i=0;i<t.length;++i){var a=t[i];if(a&&!a.da&&a.capture==s){var o=a.listener,l=a.ha||a.src;a.fa&&$(e.i,a),n=!1!==o.call(l,r)&&n}}return n&&!r.defaultPrevented}function re(e,t,s){if("function"==typeof e)s&&(e=c(e,s));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:n.setTimeout(e,t||0)}function ne(e){e.g=re(()=>{e.g=null,e.i&&(e.i=!1,ne(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(ee,D),ee.prototype[M]=!0,ee.prototype.removeEventListener=function(e,t,s,r){W(this,e,t,s,r)},ee.prototype.N=function(){if(ee.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var s=t.g[e],r=0;r<s.length;r++)V(s[r]);delete t.g[e],t.h--}}this.F=null},ee.prototype.K=function(e,t,s,r){return this.i.add(String(e),t,!1,s,r)},ee.prototype.L=function(e,t,s,r){return this.i.add(String(e),t,!0,s,r)};class ie extends D{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ne(this)}N(){super.N(),this.g&&(n.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ae(e){D.call(this),this.h=e,this.g={}}u(ae,D);var oe=[];function le(e){v(e.g,function(e,t){this.g.hasOwnProperty(t)&&K(e)},e),e.g={}}ae.prototype.N=function(){ae.aa.N.call(this),le(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=n.JSON.stringify,de=n.JSON.parse,ue=class{stringify(e){return n.JSON.stringify(e,void 0)}parse(e){return n.JSON.parse(e,void 0)}};function he(){}function me(e){return e.h||(e.h=e.i())}function pe(){}he.prototype.h=null;var fe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ge(){P.call(this,"d")}function xe(){P.call(this,"c")}u(ge,P),u(xe,P);var ve={},be=null;function we(){return be=be||new ee}function ye(e){P.call(this,ve.La,e)}function Ne(e){const t=we();te(t,new ye(t))}function je(e,t){P.call(this,ve.STAT_EVENT,e),this.stat=t}function Ce(e){const t=we();te(t,new je(t,e))}function ke(e,t){P.call(this,ve.Ma,e),this.size=t}function Se(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return n.setTimeout(function(){e()},t)}function Ee(){this.g=!0}function _e(e,t,s,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var s=JSON.parse(t);if(s)for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var r=s[e];if(!(2>r.length)){var n=r[1];if(Array.isArray(n)&&!(1>n.length)){var i=n[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var a=1;a<n.length;a++)n[a]=""}}}return ce(s)}catch(o){return t}}(e,s)+(r?" "+r:"")})}ve.La="serverreachability",u(ye,P),ve.STAT_EVENT="statevent",u(je,P),ve.Ma="timingevent",u(ke,P),Ee.prototype.xa=function(){this.g=!1},Ee.prototype.info=function(){};var Te,Ie={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ae={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function De(){}function Pe(e,t,s,r){this.j=e,this.i=t,this.l=s,this.R=r||1,this.U=new ae(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}u(De,he),De.prototype.g=function(){return new XMLHttpRequest},De.prototype.i=function(){return{}},Te=new De;var Le={},Oe={};function Me(e,t,s){e.L=1,e.v=ct(nt(t)),e.m=s,e.P=!0,Ue(e,null)}function Ue(e,t){e.F=Date.now(),ze(e),e.A=nt(e.v);var s=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Nt(s.i,"t",r),e.C=0,s=e.j.J,e.h=new Re,e.g=cs(e.j,s?t:null,!e.m),0<e.O&&(e.M=new ie(c(e.Y,e,e.g),e.O)),t=e.U,s=e.g,r=e.ca;var n="readystatechange";Array.isArray(n)||(n&&(oe[0]=n.toString()),n=oe);for(var i=0;i<n.length;i++){var a=G(s,n[i],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ne(),function(e,t,s,r,n,i){e.info(function(){if(e.g)if(i)for(var a="",o=i.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");a=2<=u.length&&"type"==u[1]?a+(d+"=")+c+"&":a+(d+"=redacted&")}}else a=null;else a=i;return"XMLHTTP REQ ("+r+") [attempt "+n+"]: "+t+"\n"+s+"\n"+a})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Fe(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.j.Ca}function Ve(e,t){var s=e.C,r=t.indexOf("\n",s);return-1==r?Oe:(s=Number(t.substring(s,r)),isNaN(s)?Le:(r+=1)+s>t.length?Oe:(t=t.slice(r,r+s),e.C=r+s,t))}function ze(e){e.S=Date.now()+e.I,$e(e,e.I)}function $e(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Se(c(e.ba,e),t)}function Be(e){e.B&&(n.clearTimeout(e.B),e.B=null)}function qe(e){0==e.j.G||e.J||ns(e.j,e)}function He(e){Be(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,le(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ge(e,t){try{var s=e.j;if(0!=s.G&&(s.g==e||Ye(s.h,e)))if(!e.K&&Ye(s.h,e)&&3==s.G){try{var r=s.Da.g.parse(t)}catch(d){r=null}if(Array.isArray(r)&&3==r.length){var n=r;if(0==n[0]){e:if(!s.u){if(s.g){if(!(s.g.F+3e3<e.F))break e;rs(s),Wt(s)}es(s),Ce(18)}}else s.za=n[1],0<s.za-s.T&&37500>n[2]&&s.F&&0==s.v&&!s.C&&(s.C=Se(c(s.Za,s),6e3));if(1>=Je(s.h)&&s.ca){try{s.ca()}catch(d){}s.ca=void 0}}else as(s,11)}else if((e.K||s.g==e)&&rs(s),!p(t))for(n=s.Da.g.parse(t),t=0;t<n.length;t++){let c=n[t];if(s.T=c[0],c=c[1],2==s.G)if("c"==c[0]){s.K=c[1],s.ia=c[2];const t=c[3];null!=t&&(s.la=t,s.j.info("VER="+s.la));const n=c[4];null!=n&&(s.Aa=n,s.j.info("SVER="+s.Aa));const d=c[5];null!=d&&"number"==typeof d&&0<d&&(r=1.5*d,s.L=r,s.j.info("backChannelRequestTimeoutMs_="+r)),r=s;const u=e.g;if(u){const e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(Xe(i,i.h),i.h=null))}if(r.D){const e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,lt(r.I,r.D,e))}}s.G=3,s.l&&s.l.ua(),s.ba&&(s.R=Date.now()-e.F,s.j.info("Handshake RTT: "+s.R+"ms"));var a=e;if((r=s).qa=ls(r,r.J?r.ia:null,r.W),a.K){Ze(r.h,a);var o=a,l=r.L;l&&(o.I=l),o.B&&(Be(o),ze(o)),r.g=a}else Zt(r);0<s.i.length&&Qt(s)}else"stop"!=c[0]&&"close"!=c[0]||as(s,7);else 3==s.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?as(s,7):Gt(s):"noop"!=c[0]&&s.l&&s.l.ta(c),s.v=0)}Ne()}catch(d){}}Pe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==$t(e)?t.j():this.Y(e)},Pe.prototype.Y=function(e){try{if(e==this.g)e:{const h=$t(this.g);var t=this.g.Ba();if(this.g.Z(),!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Bt(this.g)))){this.J||4!=h||7==t||Ne(),Be(this);var s=this.g.Z();this.X=s;t:if(Fe(this)){var r=Bt(this.g);e="";var i=r.length,a=4==$t(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){He(this),qe(this);var o="";break t}this.h.i=new n.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==s,function(e,t,s,r,n,i,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+n+"]: "+t+"\n"+s+"\n"+i+" "+a})}(this.i,this.u,this.A,this.l,this.R,h,s),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var d=l;break t}}d=null}if(!(s=d)){this.o=!1,this.s=3,Ce(12),He(this),qe(this);break e}_e(this.i,this.l,s,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ge(this,s)}if(this.P){let e;for(s=!0;!this.J&&this.C<o.length;){if(e=Ve(this,o),e==Oe){4==h&&(this.s=4,Ce(14),s=!1),_e(this.i,this.l,null,"[Incomplete Response]");break}if(e==Le){this.s=4,Ce(15),_e(this.i,this.l,o,"[Invalid Chunk]"),s=!1;break}_e(this.i,this.l,e,null),Ge(this,e)}if(Fe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Ce(16),s=!1),this.o=this.o&&s,s){if(0<o.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),ts(u),u.M=!0,Ce(11))}}else _e(this.i,this.l,o,"[Invalid Chunked Response]"),He(this),qe(this)}else _e(this.i,this.l,o,null),Ge(this,o);4==h&&He(this),this.o&&!this.J&&(4==h?ns(this.j,this):(this.o=!1,ze(this)))}else(function(e){const t={};e=(e.g&&2<=$t(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var s=N(e[r]);const n=s[0];if("string"!=typeof(s=s[1]))continue;s=s.trim();const i=t[n]||[];t[n]=i,i.push(s)}!function(e,t){for(const s in e)t.call(void 0,e[s],s,e)}(t,function(e){return e.join(", ")})})(this.g),400==s&&0<o.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),He(this),qe(this)}}}catch(h){}},Pe.prototype.cancel=function(){this.J=!0,He(this)},Pe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Ne(),Ce(17)),He(this),this.s=2,qe(this)):$e(this,this.S-e)};var We=class{constructor(e,t){this.g=e,this.map=t}};function Ke(e){this.l=e||10,e=n.PerformanceNavigationTiming?0<(e=n.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(n.chrome&&n.chrome.loadTimes&&n.chrome.loadTimes()&&n.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Ye(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Xe(e,t){e.g?e.g.add(t):e.h=t}function Ze(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function et(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const s of e.g.values())t=t.concat(s.D);return t}return h(e.i)}function tt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var s=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(i(e)||"string"==typeof e){var t=[];e=e.length;for(var s=0;s<e;s++)t.push(s);return t}t=[],s=0;for(const r in e)t[s++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(i(e)){for(var t=[],s=e.length,r=0;r<s;r++)t.push(e[r]);return t}for(r in t=[],s=0,e)t[s++]=e[r];return t}(e),n=r.length,a=0;a<n;a++)t.call(void 0,r[a],s&&s[a],e)}Ke.prototype.cancel=function(){if(this.i=et(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var st=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof rt){this.h=e.h,it(this,e.j),this.o=e.o,this.g=e.g,at(this,e.s),this.l=e.l;var t=e.i,s=new vt;s.i=t.i,t.g&&(s.g=new Map(t.g),s.h=t.h),ot(this,s),this.m=e.m}else e&&(t=String(e).match(st))?(this.h=!1,it(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),at(this,t[4]),this.l=dt(t[5]||"",!0),ot(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new vt(null,this.h))}function nt(e){return new rt(e)}function it(e,t,s){e.j=s?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function at(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ot(e,t,s){t instanceof vt?(e.i=t,function(e,t){t&&!e.j&&(bt(e),e.i=null,e.g.forEach(function(e,t){var s=t.toLowerCase();t!=s&&(wt(this,t),Nt(this,s,e))},e)),e.j=t}(e.i,e.h)):(s||(t=ut(t,gt)),e.i=new vt(t,e.h))}function lt(e,t,s){e.i.set(t,s)}function ct(e){return lt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ut(e,t,s){return"string"==typeof e?(e=encodeURI(e).replace(t,ht),s&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ht(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}rt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ut(t,mt,!0),":");var s=this.g;return(s||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ut(t,mt,!0),"@"),e.push(encodeURIComponent(String(s)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(s=this.s)&&e.push(":",String(s))),(s=this.l)&&(this.g&&"/"!=s.charAt(0)&&e.push("/"),e.push(ut(s,"/"==s.charAt(0)?ft:pt,!0))),(s=this.i.toString())&&e.push("?",s),(s=this.m)&&e.push("#",ut(s,xt)),e.join("")};var mt=/[#\/\?@]/g,pt=/[#\?:]/g,ft=/[#\?]/g,gt=/[#\?@]/g,xt=/#/g;function vt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function bt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var s=0;s<e.length;s++){var r=e[s].indexOf("="),n=null;if(0<=r){var i=e[s].substring(0,r);n=e[s].substring(r+1)}else i=e[s];t(i,n?decodeURIComponent(n.replace(/\+/g," ")):"")}}}(e.i,function(t,s){e.add(decodeURIComponent(t.replace(/\+/g," ")),s)}))}function wt(e,t){bt(e),t=jt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function yt(e,t){return bt(e),t=jt(e,t),e.g.has(t)}function Nt(e,t,s){wt(e,t),0<s.length&&(e.i=null,e.g.set(jt(e,t),h(s)),e.h+=s.length)}function jt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ct(e,t,s,r,n){try{n&&(n.onload=null,n.onerror=null,n.onabort=null,n.ontimeout=null),r(s)}catch(i){}}function kt(){this.g=new ue}function St(e,t,s){const r=s||"";try{tt(e,function(e,s){let n=e;a(e)&&(n=ce(e)),t.push(r+s+"="+encodeURIComponent(n))})}catch(xN){throw t.push(r+"type="+encodeURIComponent("_badmap")),xN}}function Et(e){this.l=e.Ub||null,this.j=e.eb||!1}function _t(e,t){ee.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Tt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function It(e){e.readyState=4,e.l=null,e.j=null,e.v=null,At(e)}function At(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Dt(e){let t="";return v(e,function(e,s){t+=s,t+=":",t+=e,t+="\r\n"}),t}function Pt(e,t,s){e:{for(r in s){var r=!1;break e}r=!0}r||(s=Dt(s),"string"==typeof e?null!=s&&encodeURIComponent(String(s)):lt(e,t,s))}function Rt(e){ee.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=vt.prototype).add=function(e,t){bt(this),this.i=null,e=jt(this,e);var s=this.g.get(e);return s||this.g.set(e,s=[]),s.push(t),this.h+=1,this},e.forEach=function(e,t){bt(this),this.g.forEach(function(s,r){s.forEach(function(s){e.call(t,s,r,this)},this)},this)},e.na=function(){bt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),s=[];for(let r=0;r<t.length;r++){const n=e[r];for(let e=0;e<n.length;e++)s.push(t[r])}return s},e.V=function(e){bt(this);let t=[];if("string"==typeof e)yt(this,e)&&(t=t.concat(this.g.get(jt(this,e))));else{e=Array.from(this.g.values());for(let s=0;s<e.length;s++)t=t.concat(e[s])}return t},e.set=function(e,t){return bt(this),this.i=null,yt(this,e=jt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var s=0;s<t.length;s++){var r=t[s];const i=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var n=i;""!==a[r]&&(n+="="+encodeURIComponent(String(a[r]))),e.push(n)}}return this.i=e.join("&")},u(Et,he),Et.prototype.g=function(){return new _t(this.l,this.j)},Et.prototype.i=function(e){return function(){return e}}({}),u(_t,ee),(e=_t.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,At(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||n).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,It(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,At(this)),this.g&&(this.readyState=3,At(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==n.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Tt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?It(this):At(this),3==this.readyState&&Tt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,It(this))},e.Qa=function(e){this.g&&(this.response=e,It(this))},e.ga=function(){this.g&&It(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var s=t.next();!s.done;)s=s.value,e.push(s[0]+": "+s[1]),s=t.next();return e.join("\r\n")},Object.defineProperty(_t.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Rt,ee);var Lt=/^https?$/i,Ot=["POST","PUT"];function Mt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Ut(e),Vt(e)}function Ut(e){e.A||(e.A=!0,te(e,"complete"),te(e,"error"))}function Ft(e){if(e.h&&void 0!==r&&(!e.v[1]||4!=$t(e)||2!=e.Z()))if(e.u&&4==$t(e))re(e.Ea,0,e);else if(te(e,"readystatechange"),4==$t(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var s;if(!(s=t)){var i;if(i=0===r){var a=String(e.D).match(st)[1]||null;!a&&n.self&&n.self.location&&(a=n.self.location.protocol.slice(0,-1)),i=!Lt.test(a?a.toLowerCase():"")}s=i}if(s)te(e,"complete"),te(e,"success");else{e.m=6;try{var o=2<$t(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Ut(e)}}finally{Vt(e)}}}function Vt(e,t){if(e.g){zt(e);const s=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||te(e,"ready");try{s.onreadystatechange=r}catch(xN){}}}function zt(e){e.I&&(n.clearTimeout(e.I),e.I=null)}function $t(e){return e.g?e.g.readyState:0}function Bt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function qt(e,t,s){return s&&s.internalChannelParams&&s.internalChannelParams[e]||t}function Ht(e){this.Aa=0,this.i=[],this.j=new Ee,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=qt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=qt("baseRetryDelayMs",5e3,e),this.cb=qt("retryDelaySeedMs",1e4,e),this.Wa=qt("forwardChannelMaxRetries",2,e),this.wa=qt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ke(e&&e.concurrentRequestLimit),this.Da=new kt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Gt(e){if(Kt(e),3==e.G){var t=e.U++,s=nt(e.I);if(lt(s,"SID",e.K),lt(s,"RID",t),lt(s,"TYPE","terminate"),Yt(e,s),(t=new Pe(e,e.j,t)).L=2,t.v=ct(nt(s)),s=!1,n.navigator&&n.navigator.sendBeacon)try{s=n.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!s&&n.Image&&((new Image).src=t.v,s=!0),s||(t.g=cs(t.j,null),t.g.ea(t.v)),t.F=Date.now(),ze(t)}os(e)}function Wt(e){e.g&&(ts(e),e.g.cancel(),e.g=null)}function Kt(e){Wt(e),e.u&&(n.clearTimeout(e.u),e.u=null),rs(e),e.h.cancel(),e.s&&("number"==typeof e.s&&n.clearTimeout(e.s),e.s=null)}function Qt(e){if(!Qe(e.h)&&!e.s){e.s=!0;var t=e.Ga;E||I(),_||(E(),_=!0),T.add(t,e),e.B=0}}function Jt(e,t){var s;s=t?t.l:e.U++;const r=nt(e.I);lt(r,"SID",e.K),lt(r,"RID",s),lt(r,"AID",e.T),Yt(e,r),e.m&&e.o&&Pt(r,e.m,e.o),s=new Pe(e,e.j,s,e.B+1),null===e.m&&(s.H=e.o),t&&(e.i=t.D.concat(e.i)),t=Xt(e,s,1e3),s.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),Xe(e.h,s),Me(s,r,t)}function Yt(e,t){e.H&&v(e.H,function(e,s){lt(t,s,e)}),e.l&&tt({},function(e,s){lt(t,s,e)})}function Xt(e,t,s){s=Math.min(e.i.length,s);var r=e.l?c(e.l.Na,e.l,e):null;e:{var n=e.i;let t=-1;for(;;){const e=["count="+s];-1==t?0<s?(t=n[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let o=0;o<s;o++){let s=n[o].g;const l=n[o].map;if(s-=t,0>s)t=Math.max(0,n[o].g-100),a=!1;else try{St(l,e,"req"+s+"_")}catch(i){r&&r(l)}}if(a){r=e.join("&");break e}}}return e=e.i.splice(0,s),t.D=e,r}function Zt(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;E||I(),_||(E(),_=!0),T.add(t,e),e.v=0}}function es(e){return!(e.g||e.u||3<=e.v||(e.Y++,e.u=Se(c(e.Fa,e),is(e,e.v)),e.v++,0))}function ts(e){null!=e.A&&(n.clearTimeout(e.A),e.A=null)}function ss(e){e.g=new Pe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=nt(e.qa);lt(t,"RID","rpc"),lt(t,"SID",e.K),lt(t,"AID",e.T),lt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&lt(t,"TO",e.ja),lt(t,"TYPE","xmlhttp"),Yt(e,t),e.m&&e.o&&Pt(t,e.m,e.o),e.L&&(e.g.I=e.L);var s=e.g;e=e.ia,s.L=1,s.v=ct(nt(t)),s.m=null,s.P=!0,Ue(s,e)}function rs(e){null!=e.C&&(n.clearTimeout(e.C),e.C=null)}function ns(e,t){var s=null;if(e.g==t){rs(e),ts(e),e.g=null;var r=2}else{if(!Ye(e.h,t))return;s=t.D,Ze(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){s=t.m?t.m.length:0,t=Date.now()-t.F;var n=e.B;te(r=we(),new ke(r,s)),Qt(e)}else Zt(e);else if(3==(n=t.s)||0==n&&0<t.X||!(1==r&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0)||(e.s?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa)||(e.s=Se(c(e.Ga,e,t),is(e,e.B)),e.B++,0)))}(e,t)||2==r&&es(e)))switch(s&&0<s.length&&(t=e.h,t.i=t.i.concat(s)),n){case 1:as(e,5);break;case 4:as(e,10);break;case 3:as(e,6);break;default:as(e,2)}}function is(e,t){let s=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(s*=2),s*t}function as(e,t){if(e.j.info("Error code "+t),2==t){var s=c(e.fb,e),r=e.Xa;const t=!r;r=new rt(r||"//www.google.com/images/cleardot.gif"),n.location&&"http"==n.location.protocol||it(r,"https"),ct(r),t?function(e,t){const s=new Ee;if(n.Image){const r=new Image;r.onload=d(Ct,s,"TestLoadImage: loaded",!0,t,r),r.onerror=d(Ct,s,"TestLoadImage: error",!1,t,r),r.onabort=d(Ct,s,"TestLoadImage: abort",!1,t,r),r.ontimeout=d(Ct,s,"TestLoadImage: timeout",!1,t,r),n.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),s):function(e,t){new Ee;const s=new AbortController,r=setTimeout(()=>{s.abort(),Ct(0,0,!1,t)},1e4);fetch(e,{signal:s.signal}).then(e=>{clearTimeout(r),e.ok?Ct(0,0,!0,t):Ct(0,0,!1,t)}).catch(()=>{clearTimeout(r),Ct(0,0,!1,t)})}(r.toString(),s)}else Ce(2);e.G=0,e.l&&e.l.sa(t),os(e),Kt(e)}function os(e){if(e.G=0,e.ka=[],e.l){const t=et(e.h);0==t.length&&0==e.i.length||(m(e.ka,t),m(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function ls(e,t,s){var r=s instanceof rt?nt(s):new rt(s);if(""!=r.g)t&&(r.g=t+"."+r.g),at(r,r.s);else{var i=n.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new rt(null);r&&it(a,r),t&&(a.g=t),i&&at(a,i),s&&(a.l=s),r=a}return s=e.D,t=e.ya,s&&t&&lt(r,s,t),lt(r,"VER",e.la),Yt(e,r),r}function cs(e,t,s){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Rt(new Et({eb:s})):new Rt(e.pa)).Ha(e.J),t}function ds(){}function us(){}function hs(e,t){ee.call(this),this.g=new Ht(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new fs(this)}function ms(e){ge.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const s in t){e=s;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ps(){xe.call(this),this.status=1}function fs(e){this.g=e}(e=Rt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,s,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Te.g(),this.v=this.o?me(this.o):me(Te),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Mt(this,a)}if(e=s||"",s=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)s.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())s.set(e,r.get(e))}r=Array.from(s.keys()).find(e=>"content-type"==e.toLowerCase()),i=n.FormData&&e instanceof n.FormData,!(0<=Array.prototype.indexOf.call(Ot,t,void 0))||r||i||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[n,o]of s)this.g.setRequestHeader(n,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zt(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){Mt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,te(this,"complete"),te(this,"abort"),Vt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vt(this,!0)),Rt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Ft(this):this.bb())},e.bb=function(){Ft(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<$t(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Ht.prototype).la=8,e.G=1,e.connect=function(e,t,s,r){Ce(0),this.W=e,this.H=t||{},s&&void 0!==r&&(this.H.OSID=s,this.H.OAID=r),this.F=this.X,this.I=ls(this,null,this.W),Qt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const n=new Pe(this,this.j,e);let i=this.o;if(this.S&&(i?(i=b(i),y(i,this.S)):i=this.S),null!==this.m||this.O||(n.H=i,i=null),this.P)e:{for(var t=0,s=0;s<this.i.length;s++){var r=this.i[s];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=s;break e}if(4096===t||s===this.i.length-1){t=s+1;break e}}t=1e3}else t=1e3;t=Xt(this,n,t),lt(s=nt(this.I),"RID",e),lt(s,"CVER",22),this.D&&lt(s,"X-HTTP-Session-Id",this.D),Yt(this,s),i&&(this.O?t="headers="+encodeURIComponent(String(Dt(i)))+"&"+t:this.m&&Pt(s,this.m,i)),Xe(this.h,n),this.Ua&&lt(s,"TYPE","init"),this.P?(lt(s,"$req",t),lt(s,"SID","null"),n.T=!0,Me(n,s,null)):Me(n,s,t),this.G=2}}else 3==this.G&&(e?Jt(this,e):0==this.i.length||Qe(this.h)||Jt(this))},e.Fa=function(){if(this.u=null,ss(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Se(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),Wt(this),ss(this))},e.Za=function(){null!=this.C&&(this.C=null,Wt(this),es(this),Ce(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=ds.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},us.prototype.g=function(e,t){return new hs(e,t)},u(hs,ee),hs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},hs.prototype.close=function(){Gt(this.g)},hs.prototype.o=function(e){var t=this.g;if("string"==typeof e){var s={};s.__data__=e,e=s}else this.u&&((s={}).__data__=ce(e),e=s);t.i.push(new We(t.Ya++,e)),3==t.G&&Qt(t)},hs.prototype.N=function(){this.g.l=null,delete this.j,Gt(this.g),delete this.g,hs.aa.N.call(this)},u(ms,ge),u(ps,xe),u(fs,ds),fs.prototype.ua=function(){te(this.g,"a")},fs.prototype.ta=function(e){te(this.g,new ms(e))},fs.prototype.sa=function(e){te(this.g,new ps)},fs.prototype.ra=function(){te(this.g,"b")},us.prototype.createWebChannel=us.prototype.g,hs.prototype.send=hs.prototype.o,hs.prototype.open=hs.prototype.m,hs.prototype.close=hs.prototype.close,Cc=function(){return new us},jc=function(){return we()},Nc=ve,yc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,wc=Ie,Ae.COMPLETE="complete",bc=Ae,pe.EventType=fe,fe.OPEN="a",fe.CLOSE="b",fe.ERROR="c",fe.MESSAGE="d",ee.prototype.listen=ee.prototype.K,vc=pe,Rt.prototype.listenOnce=Rt.prototype.L,Rt.prototype.getLastError=Rt.prototype.Ka,Rt.prototype.getLastErrorCode=Rt.prototype.Ba,Rt.prototype.getStatus=Rt.prototype.Z,Rt.prototype.getResponseJson=Rt.prototype.Oa,Rt.prototype.getResponseText=Rt.prototype.oa,Rt.prototype.send=Rt.prototype.ea,Rt.prototype.setWithCredentials=Rt.prototype.Ha,xc=Rt}).apply(void 0!==kc?kc:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const Sc="@firebase/firestore",Ec="4.9.0";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _c{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_c.UNAUTHENTICATED=new _c(null),_c.GOOGLE_CREDENTIALS=new _c("google-credentials-uid"),_c.FIRST_PARTY=new _c("first-party-uid"),_c.MOCK_USER=new _c("mock-user");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
let Tc="12.0.0";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ic=new gr("@firebase/firestore");function Ac(){return Ic.logLevel}function Dc(e,...t){if(Ic.logLevel<=dr.DEBUG){const s=t.map(Lc);Ic.debug(`Firestore (${Tc}): ${e}`,...s)}}function Pc(e,...t){if(Ic.logLevel<=dr.ERROR){const s=t.map(Lc);Ic.error(`Firestore (${Tc}): ${e}`,...s)}}function Rc(e,...t){if(Ic.logLevel<=dr.WARN){const s=t.map(Lc);Ic.warn(`Firestore (${Tc}): ${e}`,...s)}}function Lc(e){if("string"==typeof e)return e;try{
/**
        * @license
        * Copyright 2020 Google LLC
        *
        * Licensed under the Apache License, Version 2.0 (the "License");
        * you may not use this file except in compliance with the License.
        * You may obtain a copy of the License at
        *
        *   http://www.apache.org/licenses/LICENSE-2.0
        *
        * Unless required by applicable law or agreed to in writing, software
        * distributed under the License is distributed on an "AS IS" BASIS,
        * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
        * See the License for the specific language governing permissions and
        * limitations under the License.
        */
return t=e,JSON.stringify(t)}catch(s){return e}var t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Oc(e,t,s){let r="Unexpected state";"string"==typeof t?r=t:s=t,Mc(e,r,s)}function Mc(e,t,s){let r=`FIRESTORE (${Tc}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==s)try{r+=" CONTEXT: "+JSON.stringify(s)}catch(n){r+=" CONTEXT: "+s}throw Pc(r),new Error(r)}function Uc(e,t,s,r){let n="Unexpected state";"string"==typeof s?n=s:r=s,e||Mc(t,n,r)}function Fc(e,t){return e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Vc={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class zc extends Ks{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class $c{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Bc{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class qc{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(_c.UNAUTHENTICATED))}shutdown(){}}class Hc{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Gc{constructor(e){this.t=e,this.currentUser=_c.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Uc(void 0===this.o,42304);let s=this.i;const r=e=>this.i!==s?(s=this.i,t(e)):Promise.resolve();let n=new $c;this.o=()=>{this.i++,this.currentUser=this.u(),n.resolve(),n=new $c,e.enqueueRetryable(()=>r(this.currentUser))};const i=()=>{const t=n;e.enqueueRetryable(()=>p(this,null,function*(){yield t.promise,yield r(this.currentUser)}))},a=e=>{Dc("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(Dc("FirebaseAuthCredentialsProvider","Auth not yet detected"),n.resolve(),n=new $c)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Dc("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Uc("string"==typeof t.accessToken,31837,{l:t}),new Bc(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Uc(null===e||"string"==typeof e,2055,{h:e}),new _c(e)}}class Wc{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=_c.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Kc{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new Wc(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(_c.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Jc{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Uc(void 0===this.o,3512);const s=e=>{null!=e.error&&Dc("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const s=e.token!==this.m;return this.m=e.token,Dc("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>s(t))};const r=e=>{Dc("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):Dc("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Qc(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Uc("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new Qc(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Yc(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),s=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(s);else for(let r=0;r<e;r++)s[r]=Math.floor(256*Math.random());return s}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Xc{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const s=Yc(40);for(let r=0;r<s.length;++r)t.length<20&&s[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(s[r]%62))}return t}}function Zc(e,t){return e<t?-1:e>t?1:0}function ed(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const s=e.charAt(r),n=t.charAt(r);if(s!==n)return td(s)===td(n)?Zc(s,n):td(s)?1:-1}return Zc(e.length,t.length)}function td(e){const t=e.charCodeAt(0);return t>=55296&&t<=57343}function sd(e,t,s){return e.length===t.length&&e.every((e,r)=>s(e,t[r]))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const rd="__name__";class nd{constructor(e,t,s){void 0===t?t=0:t>e.length&&Oc(637,{offset:t,range:e.length}),void 0===s?s=e.length-t:s>e.length-t&&Oc(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return 0===nd.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof nd?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const s=nd.compareSegments(e.get(r),t.get(r));if(0!==s)return s}return Zc(e.length,t.length)}static compareSegments(e,t){const s=nd.isNumericId(e),r=nd.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?nd.extractNumericId(e).compare(nd.extractNumericId(t)):ed(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return pc.fromString(e.substring(4,e.length-2))}}class id extends nd{construct(e,t,s){return new id(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new zc(Vc.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(e=>e.length>0))}return new id(t)}static emptyPath(){return new id([])}}const ad=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class od extends nd{construct(e,t,s){return new od(e,t,s)}static isValidIdentifier(e){return ad.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),od.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===rd}static keyField(){return new od([rd])}static fromServerFormat(e){const t=[];let s="",r=0;const n=()=>{if(0===s.length)throw new zc(Vc.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new zc(Vc.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new zc(Vc.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(s+=t,r++):(n(),r++)}if(n(),i)throw new zc(Vc.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new od(t)}static emptyPath(){return new od([])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ld{constructor(e){this.path=e}static fromPath(e){return new ld(id.fromString(e))}static fromName(e){return new ld(id.fromString(e).popFirst(5))}static empty(){return new ld(id.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===id.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return id.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ld(new id(e.slice()))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cd(e,t,s){if(!s)throw new zc(Vc.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function dd(e){if(!ld.isDocumentKey(e))throw new zc(Vc.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function ud(e){if(ld.isDocumentKey(e))throw new zc(Vc.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function hd(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function md(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const s=(t=e).constructor?t.constructor.name:null;return s?`a custom ${s} object`:"an object"}}var t;return"function"==typeof e?"a function":Oc(12329,{type:typeof e})}function pd(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new zc(Vc.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=md(e);throw new zc(Vc.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${s}`)}}return e}
/**
     * @license
     * Copyright 2025 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function fd(e,t){const s={typeString:e};return t&&(s.value=t),s}function gd(e,t){if(!hd(e))throw new zc(Vc.INVALID_ARGUMENT,"JSON must be an object");let s;for(const r in t)if(t[r]){const n=t[r].typeString,i="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){s=`JSON missing required field: '${r}'`;break}const a=e[r];if(n&&typeof a!==n){s=`JSON field '${r}' must be a ${n}.`;break}if(void 0!==i&&a!==i.value){s=`Expected '${r}' field to equal '${i.value}'`;break}}if(s)throw new zc(Vc.INVALID_ARGUMENT,s);return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const xd=-62135596800,vd=1e6;class bd{static now(){return bd.fromMillis(Date.now())}static fromDate(e){return bd.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*vd);return new bd(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new zc(Vc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new zc(Vc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<xd)throw new zc(Vc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new zc(Vc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vd}_compareTo(e){return this.seconds===e.seconds?Zc(this.nanoseconds,e.nanoseconds):Zc(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:bd._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gd(e,bd._jsonSchema))return new bd(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xd;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}bd._jsonSchemaVersion="firestore/timestamp/1.0",bd._jsonSchema={type:fd("string",bd._jsonSchemaVersion),seconds:fd("number"),nanoseconds:fd("number")};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class wd{static fromTimestamp(e){return new wd(e)}static min(){return new wd(new bd(0,0))}static max(){return new wd(new bd(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function yd(e){return new Nd(e.readTime,e.key,-1)}class Nd{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Nd(wd.min(),ld.empty(),-1)}static max(){return new Nd(wd.max(),ld.empty(),-1)}}function jd(e,t){let s=e.readTime.compareTo(t.readTime);return 0!==s?s:(s=ld.comparator(e.documentKey,t.documentKey),0!==s?s:Zc(e.largestBatchId,t.largestBatchId)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */)}class Cd{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kd(e){return p(this,null,function*(){if(e.code!==Vc.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;Dc("LocalStore","Unexpectedly lost primary lease")})}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Sd{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Oc(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Sd((s,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(s,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(s,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Sd?t:Sd.resolve(t)}catch(t){return Sd.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Sd.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Sd.reject(t)}static resolve(e){return new Sd((t,s)=>{t(e)})}static reject(e){return new Sd((t,s)=>{s(e)})}static waitFor(e){return new Sd((t,s)=>{let r=0,n=0,i=!1;e.forEach(e=>{++r,e.next(()=>{++n,i&&n===r&&t()},e=>s(e))}),i=!0,n===r&&t()})}static or(e){let t=Sd.resolve(!1);for(const s of e)t=t.next(e=>e?Sd.resolve(e):s());return t}static forEach(e,t){const s=[];return e.forEach((e,r)=>{s.push(t.call(this,e,r))}),this.waitFor(s)}static mapArray(e,t){return new Sd((s,r)=>{const n=e.length,i=new Array(n);let a=0;for(let o=0;o<n;o++){const l=o;t(e[l]).next(e=>{i[l]=e,++a,a===n&&s(i)},e=>r(e))}})}static doWhile(e,t){return new Sd((s,r)=>{const n=()=>{!0===e()?t().next(()=>{n()},r):s()};n()})}}function Ed(e){return"IndexedDbTransactionError"===e.name}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _d{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}function Td(e){return null==e}function Id(e){return 0===e&&1/e==-1/0}function Ad(e,t){let s=t;const r=e.length;for(let n=0;n<r;n++){const t=e.charAt(n);switch(t){case"\0":s+="";break;case"":s+="";break;default:s+=t}}return s}function Dd(e){return e+""}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pd(e){let t=0;for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&t++;return t}function Rd(e,t){for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&t(s,e[s])}function Ld(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */_d.ce=-1;class Od{constructor(e,t){this.comparator=e,this.root=t||Ud.EMPTY}insert(e,t){return new Od(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ud.BLACK,null,null))}remove(e){return new Od(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ud.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(0===s)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(0===r)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Md(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Md(this.root,e,this.comparator,!1)}getReverseIterator(){return new Md(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Md(this.root,e,this.comparator,!0)}}class Md{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let n=1;for(;!e.isEmpty();)if(n=t?s(e.key,t):1,t&&r&&(n*=-1),n<0)e=this.isReverse?e.left:e.right;else{if(0===n){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ud{constructor(e,t,s,r,n){this.key=e,this.value=t,this.color=null!=s?s:Ud.RED,this.left=null!=r?r:Ud.EMPTY,this.right=null!=n?n:Ud.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,n){return new Ud(null!=e?e:this.key,null!=t?t:this.value,null!=s?s:this.color,null!=r?r:this.left,null!=n?n:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const n=s(e,r.key);return r=n<0?r.copy(null,null,null,r.left.insert(e,t,s),null):0===n?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ud.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ud.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ud.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ud.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Oc(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Oc(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Oc(27949);return e+(this.isRed()?0:1)}}Ud.EMPTY=null,Ud.RED=!0,Ud.BLACK=!1,Ud.EMPTY=new class{constructor(){this.size=0}get key(){throw Oc(57766)}get value(){throw Oc(16141)}get color(){throw Oc(16727)}get left(){throw Oc(29726)}get right(){throw Oc(36894)}copy(e,t,s,r,n){return this}insert(e,t,s){return new Ud(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Fd{constructor(e){this.comparator=e,this.data=new Od(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Vd(this.data.getIterator())}getIteratorFrom(e){return new Vd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Fd))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=s.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Fd(this.comparator);return t.data=e,t}}class Vd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zd{constructor(e){this.fields=e,e.sort(od.comparator)}static empty(){return new zd([])}unionWith(e){let t=new Fd(od.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new zd(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sd(this.fields,e.fields,(e,t)=>e.isEqual(t))}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class $d extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Bd{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new $d("Invalid base64 string: "+t):t}}(e);return new Bd(t)}static fromUint8Array(e){const t=function(e){let t="";for(let s=0;s<e.length;++s)t+=String.fromCharCode(e[s]);return t}(e);return new Bd(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Zc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bd.EMPTY_BYTE_STRING=new Bd("");const qd=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hd(e){if(Uc(!!e,39018),"string"==typeof e){let t=0;const s=qd.exec(e);if(Uc(!!s,46558,{timestamp:e}),s[1]){let e=s[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Gd(e.seconds),nanos:Gd(e.nanos)}}function Gd(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Wd(e){return"string"==typeof e?Bd.fromBase64String(e):Bd.fromUint8Array(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Kd="server_timestamp",Qd="__type__",Jd="__previous_value__",Yd="__local_write_time__";function Xd(e){var t,s;return(null==(s=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[Qd])?void 0:s.stringValue)===Kd}function Zd(e){const t=e.mapValue.fields[Jd];return Xd(t)?Zd(t):t}function eu(e){const t=Hd(e.mapValue.fields[Yd].timestampValue);return new bd(t.seconds,t.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class tu{constructor(e,t,s,r,n,i,a,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=n,this.forceLongPolling=i,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const su="(default)";class ru{constructor(e,t){this.projectId=e,this.database=t||su}static empty(){return new ru("","")}get isDefaultDatabase(){return this.database===su}isEqual(e){return e instanceof ru&&e.projectId===this.projectId&&e.database===this.database}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const nu="__type__",iu="__max__",au={fields:{__type__:{stringValue:iu}}},ou="__vector__",lu="value";function cu(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Xd(e)?4:function(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===iu}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e)?9007199254740991:function(e){var t,s;const r=null==(s=((null==(t=null==e?void 0:e.mapValue)?void 0:t.fields)||{})[nu])?void 0:s.stringValue;return r===ou}(e)?10:11:Oc(28295,{value:e})}function du(e,t){if(e===t)return!0;const s=cu(e);if(s!==cu(t))return!1;switch(s){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return eu(e).isEqual(eu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const s=Hd(e.timestampValue),r=Hd(t.timestampValue);return s.seconds===r.seconds&&s.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return r=t,Wd(e.bytesValue).isEqual(Wd(r.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Gd(e.geoPointValue.latitude)===Gd(t.geoPointValue.latitude)&&Gd(e.geoPointValue.longitude)===Gd(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Gd(e.integerValue)===Gd(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const s=Gd(e.doubleValue),r=Gd(t.doubleValue);return s===r?Id(s)===Id(r):isNaN(s)&&isNaN(r)}return!1}(e,t);case 9:return sd(e.arrayValue.values||[],t.arrayValue.values||[],du);case 10:case 11:return function(e,t){const s=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Pd(s)!==Pd(r))return!1;for(const n in s)if(s.hasOwnProperty(n)&&(void 0===r[n]||!du(s[n],r[n])))return!1;return!0}(e,t);default:return Oc(52216,{left:e})}var r}function uu(e,t){return void 0!==(e.values||[]).find(e=>du(e,t))}function hu(e,t){if(e===t)return 0;const s=cu(e),r=cu(t);if(s!==r)return Zc(s,r);switch(s){case 0:case 9007199254740991:return 0;case 1:return Zc(e.booleanValue,t.booleanValue);case 2:return function(e,t){const s=Gd(e.integerValue||e.doubleValue),r=Gd(t.integerValue||t.doubleValue);return s<r?-1:s>r?1:s===r?0:isNaN(s)?isNaN(r)?0:-1:1}(e,t);case 3:return mu(e.timestampValue,t.timestampValue);case 4:return mu(eu(e),eu(t));case 5:return ed(e.stringValue,t.stringValue);case 6:return function(e,t){const s=Wd(e),r=Wd(t);return s.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const s=e.split("/"),r=t.split("/");for(let n=0;n<s.length&&n<r.length;n++){const e=Zc(s[n],r[n]);if(0!==e)return e}return Zc(s.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const s=Zc(Gd(e.latitude),Gd(t.latitude));return 0!==s?s:Zc(Gd(e.longitude),Gd(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return pu(e.arrayValue,t.arrayValue);case 10:return function(e,t){var s,r,n,i;const a=e.fields||{},o=t.fields||{},l=null==(s=a[lu])?void 0:s.arrayValue,c=null==(r=o[lu])?void 0:r.arrayValue,d=Zc((null==(n=null==l?void 0:l.values)?void 0:n.length)||0,(null==(i=null==c?void 0:c.values)?void 0:i.length)||0);return 0!==d?d:pu(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===au&&t===au)return 0;if(e===au)return 1;if(t===au)return-1;const s=e.fields||{},r=Object.keys(s),n=t.fields||{},i=Object.keys(n);r.sort(),i.sort();for(let a=0;a<r.length&&a<i.length;++a){const e=ed(r[a],i[a]);if(0!==e)return e;const t=hu(s[r[a]],n[i[a]]);if(0!==t)return t}return Zc(r.length,i.length)}(e.mapValue,t.mapValue);default:throw Oc(23264,{he:s})}}function mu(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Zc(e,t);const s=Hd(e),r=Hd(t),n=Zc(s.seconds,r.seconds);return 0!==n?n:Zc(s.nanos,r.nanos)}function pu(e,t){const s=e.values||[],r=t.values||[];for(let n=0;n<s.length&&n<r.length;++n){const e=hu(s[n],r[n]);if(e)return e}return Zc(s.length,r.length)}function fu(e){return gu(e)}function gu(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Hd(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Wd(e.bytesValue).toBase64():"referenceValue"in e?function(e){return ld.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",s=!0;for(const r of e.values||[])s?s=!1:t+=",",t+=gu(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let s="{",r=!0;for(const n of t)r?r=!1:s+=",",s+=`${n}:${gu(e.fields[n])}`;return s+"}"}(e.mapValue):Oc(61005,{value:e})}function xu(e){switch(cu(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Zd(e);return t?16+xu(t):16;case 5:return 2*e.stringValue.length;case 6:return Wd(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(e.arrayValue.values||[]).reduce((e,t)=>e+xu(t),0);case 10:case 11:return function(e){let t=0;return Rd(e.fields,(e,s)=>{t+=e.length+xu(s)}),t}(e.mapValue);default:throw Oc(13486,{value:e})}}function vu(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function bu(e){return!!e&&"integerValue"in e}function wu(e){return!!e&&"arrayValue"in e}function yu(e){return!!e&&"nullValue"in e}function Nu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ju(e){return!!e&&"mapValue"in e}function Cu(e){if(e.geoPointValue)return{geoPointValue:d({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:d({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Rd(e.mapValue.fields,(e,s)=>t.mapValue.fields[e]=Cu(s)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let s=0;s<(e.arrayValue.values||[]).length;++s)t.arrayValue.values[s]=Cu(e.arrayValue.values[s]);return t}return d({},e)}class ku{constructor(e){this.value=e}static empty(){return new ku({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!ju(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cu(t)}setAll(e){let t=od.emptyPath(),s={},r=[];e.forEach((e,n)=>{if(!t.isImmediateParentOf(n)){const e=this.getFieldsMap(t);this.applyChanges(e,s,r),s={},r=[],t=n.popLast()}e?s[n.lastSegment()]=Cu(e):r.push(n.lastSegment())});const n=this.getFieldsMap(t);this.applyChanges(n,s,r)}delete(e){const t=this.field(e.popLast());ju(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return du(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];ju(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){Rd(t,(t,s)=>e[t]=s);for(const r of s)delete e[r]}clone(){return new ku(Cu(this.value))}}function Su(e){const t=[];return Rd(e.fields,(e,s)=>{const r=new od([e]);if(ju(s)){const e=Su(s.mapValue).fields;if(0===e.length)t.push(r);else for(const s of e)t.push(r.child(s))}else t.push(r)}),new zd(t)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class Eu{constructor(e,t,s,r,n,i,a){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=n,this.data=i,this.documentState=a}static newInvalidDocument(e){return new Eu(e,0,wd.min(),wd.min(),wd.min(),ku.empty(),0)}static newFoundDocument(e,t,s,r){return new Eu(e,1,t,wd.min(),s,r,0)}static newNoDocument(e,t){return new Eu(e,2,t,wd.min(),wd.min(),ku.empty(),0)}static newUnknownDocument(e,t){return new Eu(e,3,t,wd.min(),wd.min(),ku.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(wd.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ku.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ku.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=wd.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Eu&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Eu(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _u{constructor(e,t){this.position=e,this.inclusive=t}}function Tu(e,t,s){let r=0;for(let n=0;n<e.position.length;n++){const i=t[n],a=e.position[n];if(r=i.field.isKeyField()?ld.comparator(ld.fromName(a.referenceValue),s.key):hu(a,s.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Iu(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let s=0;s<e.position.length;s++)if(!du(e.position[s],t.position[s]))return!1;return!0}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Au{constructor(e,t="asc"){this.field=e,this.dir=t}}function Du(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Pu{}class Ru extends Pu{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,s):new zu(e,t,s):"array-contains"===t?new Hu(e,s):"in"===t?new Gu(e,s):"not-in"===t?new Wu(e,s):"array-contains-any"===t?new Ku(e,s):new Ru(e,t,s)}static createKeyFieldInFilter(e,t,s){return"in"===t?new $u(e,s):new Bu(e,s)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(hu(t,this.value)):null!==t&&cu(this.value)===cu(t)&&this.matchesComparison(hu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Oc(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lu extends Pu{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Lu(e,t)}matches(e){return Ou(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ou(e){return"and"===e.op}function Mu(e){return function(e){for(const t of e.filters)if(t instanceof Lu)return!1;return!0}(e)&&Ou(e)}function Uu(e){if(e instanceof Ru)return e.field.canonicalString()+e.op.toString()+fu(e.value);if(Mu(e))return e.filters.map(e=>Uu(e)).join(",");{const t=e.filters.map(e=>Uu(e)).join(",");return`${e.op}(${t})`}}function Fu(e,t){return e instanceof Ru?(s=e,(r=t)instanceof Ru&&s.op===r.op&&s.field.isEqual(r.field)&&du(s.value,r.value)):e instanceof Lu?function(e,t){return t instanceof Lu&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,s,r)=>e&&Fu(s,t.filters[r]),!0)}(e,t):void Oc(19439);var s,r}function Vu(e){return e instanceof Ru?`${(t=e).field.canonicalString()} ${t.op} ${fu(t.value)}`:e instanceof Lu?function(e){return e.op.toString()+" {"+e.getFilters().map(Vu).join(" ,")+"}"}(e):"Filter";var t}class zu extends Ru{constructor(e,t,s){super(e,t,s),this.key=ld.fromName(s.referenceValue)}matches(e){const t=ld.comparator(e.key,this.key);return this.matchesComparison(t)}}class $u extends Ru{constructor(e,t){super(e,"in",t),this.keys=qu(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Bu extends Ru{constructor(e,t){super(e,"not-in",t),this.keys=qu(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function qu(e,t){var s;return((null==(s=t.arrayValue)?void 0:s.values)||[]).map(e=>ld.fromName(e.referenceValue))}class Hu extends Ru{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return wu(t)&&uu(t.arrayValue,this.value)}}class Gu extends Ru{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&uu(this.value.arrayValue,t)}}class Wu extends Ru{constructor(e,t){super(e,"not-in",t)}matches(e){if(uu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!uu(this.value.arrayValue,t)}}class Ku extends Ru{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!wu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>uu(this.value.arrayValue,e))}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Qu{constructor(e,t=null,s=[],r=[],n=null,i=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=n,this.startAt=i,this.endAt=a,this.Te=null}}function Ju(e,t=null,s=[],r=[],n=null,i=null,a=null){return new Qu(e,t,s,r,n,i,a)}function Yu(e){const t=Fc(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Uu(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),Td(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>fu(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>fu(e)).join(",")),t.Te=e}return t.Te}function Xu(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<e.orderBy.length;s++)if(!Du(e.orderBy[s],t.orderBy[s]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let s=0;s<e.filters.length;s++)if(!Fu(e.filters[s],t.filters[s]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Iu(e.startAt,t.startAt)&&Iu(e.endAt,t.endAt)}function Zu(e){return ld.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class eh{constructor(e,t=null,s=[],r=[],n=null,i="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=n,this.limitType=i,this.startAt=a,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function th(e){return new eh(e)}function sh(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function rh(e){return null!==e.collectionGroup}function nh(e){const t=Fc(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const r of t.explicitOrderBy)t.Ie.push(r),e.add(r.field.canonicalString());const s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(e){let t=new Fd(od.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t})(t).forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Au(r,s))}),e.has(od.keyField().canonicalString())||t.Ie.push(new Au(od.keyField(),s))}return t.Ie}function ih(e){const t=Fc(e);return t.Ee||(t.Ee=function(e,t){if("F"===e.limitType)return Ju(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Au(e.field,t)});const s=e.endAt?new _u(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new _u(e.startAt.position,e.startAt.inclusive):null;return Ju(e.path,e.collectionGroup,t,e.filters,e.limit,s,r)}}(t,nh(e))),t.Ee}function ah(e,t){const s=e.filters.concat([t]);return new eh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),s,e.limit,e.limitType,e.startAt,e.endAt)}function oh(e,t,s){return new eh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,s,e.startAt,e.endAt)}function lh(e,t){return Xu(ih(e),ih(t))&&e.limitType===t.limitType}function ch(e){return`${Yu(ih(e))}|lt:${e.limitType}`}function dh(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>Vu(e)).join(", ")}]`),Td(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>fu(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>fu(e)).join(",")),`Target(${t})`}(ih(e))}; limitType=${e.limitType})`}function uh(e,t){return t.isFoundDocument()&&function(e,t){const s=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(s):ld.isDocumentKey(e.path)?e.path.isEqual(s):e.path.isImmediateParentOf(s)}(e,t)&&function(e,t){for(const s of nh(e))if(!s.field.isKeyField()&&null===t.data.field(s.field))return!1;return!0}(e,t)&&function(e,t){for(const s of e.filters)if(!s.matches(t))return!1;return!0}(e,t)&&(r=t,!((s=e).startAt&&!function(e,t,s){const r=Tu(e,t,s);return e.inclusive?r<=0:r<0}(s.startAt,nh(s),r)||s.endAt&&!function(e,t,s){const r=Tu(e,t,s);return e.inclusive?r>=0:r>0}(s.endAt,nh(s),r)));var s,r}function hh(e){return(t,s)=>{let r=!1;for(const n of nh(e)){const e=mh(n,t,s);if(0!==e)return e;r=r||n.field.isKeyField()}return 0}}function mh(e,t,s){const r=e.field.isKeyField()?ld.comparator(t.key,s.key):function(e,t,s){const r=t.data.field(e),n=s.data.field(e);return null!==r&&null!==n?hu(r,n):Oc(42886)}(e.field,t,s);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Oc(19790,{direction:e.dir})}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ph{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(void 0!==s)for(const[r,n]of s)if(this.equalsFn(r,e))return n}has(e){return void 0!==this.get(e)}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(void 0===r)return this.inner[s]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(void 0===s)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return 1===s.length?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Rd(this.inner,(t,s)=>{for(const[r,n]of s)e(r,n)})}isEmpty(){return Ld(this.inner)}size(){return this.innerSize}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const fh=new Od(ld.comparator);function gh(){return fh}const xh=new Od(ld.comparator);function vh(...e){let t=xh;for(const s of e)t=t.insert(s.key,s);return t}function bh(e){let t=xh;return e.forEach((e,s)=>t=t.insert(e,s.overlayedDocument)),t}function wh(){return Nh()}function yh(){return Nh()}function Nh(){return new ph(e=>e.toString(),(e,t)=>e.isEqual(t))}const jh=new Od(ld.comparator),Ch=new Fd(ld.comparator);function kh(...e){let t=Ch;for(const s of e)t=t.add(s);return t}const Sh=new Fd(Zc);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Eh(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Id(t)?"-0":t}}function _h(e){return{integerValue:""+e}}function Th(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!Id(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)?_h(t):Eh(e,t)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ih{constructor(){this._=void 0}}function Ah(e,t,s){return e instanceof Rh?function(e,t){const s={fields:{[Qd]:{stringValue:Kd},[Yd]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Xd(t)&&(t=Zd(t)),t&&(s.fields[Jd]=t),{mapValue:s}}(s,t):e instanceof Lh?Oh(e,t):e instanceof Mh?Uh(e,t):function(e,t){const s=Ph(e,t),r=Vh(s)+Vh(e.Ae);return bu(s)&&bu(e.Ae)?_h(r):Eh(e.serializer,r)}(e,t)}function Dh(e,t,s){return e instanceof Lh?Oh(e,t):e instanceof Mh?Uh(e,t):s}function Ph(e,t){return e instanceof Fh?bu(s=t)||(r=s)&&"doubleValue"in r?t:{integerValue:0}:null;var s,r}class Rh extends Ih{}class Lh extends Ih{constructor(e){super(),this.elements=e}}function Oh(e,t){const s=zh(t);for(const r of e.elements)s.some(e=>du(e,r))||s.push(r);return{arrayValue:{values:s}}}class Mh extends Ih{constructor(e){super(),this.elements=e}}function Uh(e,t){let s=zh(t);for(const r of e.elements)s=s.filter(e=>!du(e,r));return{arrayValue:{values:s}}}class Fh extends Ih{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Vh(e){return Gd(e.integerValue||e.doubleValue)}function zh(e){return wu(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class $h{constructor(e,t){this.field=e,this.transform=t}}class Bh{constructor(e,t){this.version=e,this.transformResults=t}}class qh{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new qh}static exists(e){return new qh(void 0,e)}static updateTime(e){return new qh(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hh(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Gh{}function Wh(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new rm(e.key,qh.none()):new Xh(e.key,e.data,qh.none());{const s=e.data,r=ku.empty();let n=new Fd(od.comparator);for(let e of t.fields)if(!n.has(e)){let t=s.field(e);null===t&&e.length>1&&(e=e.popLast(),t=s.field(e)),null===t?r.delete(e):r.set(e,t),n=n.add(e)}return new Zh(e.key,r,new zd(n.toArray()),qh.none())}}function Kh(e,t,s){var r;e instanceof Xh?function(e,t,s){const r=e.value.clone(),n=tm(e.fieldTransforms,t,s.transformResults);r.setAll(n),t.convertToFoundDocument(s.version,r).setHasCommittedMutations()}(e,t,s):e instanceof Zh?function(e,t,s){if(!Hh(e.precondition,t))return void t.convertToUnknownDocument(s.version);const r=tm(e.fieldTransforms,t,s.transformResults),n=t.data;n.setAll(em(e)),n.setAll(r),t.convertToFoundDocument(s.version,n).setHasCommittedMutations()}(e,t,s):(r=s,t.convertToNoDocument(r.version).setHasCommittedMutations())}function Qh(e,t,s,r){return e instanceof Xh?function(e,t,s,r){if(!Hh(e.precondition,t))return s;const n=e.value.clone(),i=sm(e.fieldTransforms,r,t);return n.setAll(i),t.convertToFoundDocument(t.version,n).setHasLocalMutations(),null}(e,t,s,r):e instanceof Zh?function(e,t,s,r){if(!Hh(e.precondition,t))return s;const n=sm(e.fieldTransforms,r,t),i=t.data;return i.setAll(em(e)),i.setAll(n),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===s?null:s.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,s,r):(n=t,i=s,Hh(e.precondition,n)?(n.convertToNoDocument(n.version).setHasLocalMutations(),null):i);var n,i}function Jh(e,t){let s=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),n=Ph(r.transform,e||null);null!=n&&(null===s&&(s=ku.empty()),s.set(r.field,n))}return s||null}function Yh(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(s=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===s&&void 0===r||s&&r&&sd(s,r,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(s=e.transform,r=t.transform,s instanceof Lh&&r instanceof Lh||s instanceof Mh&&r instanceof Mh?sd(s.elements,r.elements,du):s instanceof Fh&&r instanceof Fh?du(s.Ae,r.Ae):s instanceof Rh&&r instanceof Rh);var s,r}(e,t)))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var s,r}class Xh extends Gh{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Zh extends Gh{constructor(e,t,s,r,n=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=n,this.type=1}getFieldMask(){return this.fieldMask}}function em(e){const t=new Map;return e.fieldMask.fields.forEach(s=>{if(!s.isEmpty()){const r=e.data.field(s);t.set(s,r)}}),t}function tm(e,t,s){const r=new Map;Uc(e.length===s.length,32656,{Re:s.length,Ve:e.length});for(let n=0;n<s.length;n++){const i=e[n],a=i.transform,o=t.data.field(i.field);r.set(i.field,Dh(a,o,s[n]))}return r}function sm(e,t,s){const r=new Map;for(const n of e){const e=n.transform,i=s.data.field(n.field);r.set(n.field,Ah(e,i,t))}return r}class rm extends Gh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nm extends Gh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class im{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Kh(t,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Qh(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Qh(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=yh();return this.mutations.forEach(r=>{const n=e.get(r.key),i=n.overlayedDocument;let a=this.applyToLocalView(i,n.mutatedFields);a=t.has(r.key)?null:a;const o=Wh(i,a);null!==o&&s.set(r.key,o),i.isValidDocument()||i.convertToNoDocument(wd.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),kh())}isEqual(e){return this.batchId===e.batchId&&sd(this.mutations,e.mutations,(e,t)=>Yh(e,t))&&sd(this.baseMutations,e.baseMutations,(e,t)=>Yh(e,t))}}class am{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){Uc(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return jh}();const n=e.mutations;for(let i=0;i<n.length;i++)r=r.insert(n[i].key,s[i].version);return new am(e,t,s,r)}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class om{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lm{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var cm,dm;function um(e){if(void 0===e)return Pc("GRPC error has no .code"),Vc.UNKNOWN;switch(e){case cm.OK:return Vc.OK;case cm.CANCELLED:return Vc.CANCELLED;case cm.UNKNOWN:return Vc.UNKNOWN;case cm.DEADLINE_EXCEEDED:return Vc.DEADLINE_EXCEEDED;case cm.RESOURCE_EXHAUSTED:return Vc.RESOURCE_EXHAUSTED;case cm.INTERNAL:return Vc.INTERNAL;case cm.UNAVAILABLE:return Vc.UNAVAILABLE;case cm.UNAUTHENTICATED:return Vc.UNAUTHENTICATED;case cm.INVALID_ARGUMENT:return Vc.INVALID_ARGUMENT;case cm.NOT_FOUND:return Vc.NOT_FOUND;case cm.ALREADY_EXISTS:return Vc.ALREADY_EXISTS;case cm.PERMISSION_DENIED:return Vc.PERMISSION_DENIED;case cm.FAILED_PRECONDITION:return Vc.FAILED_PRECONDITION;case cm.ABORTED:return Vc.ABORTED;case cm.OUT_OF_RANGE:return Vc.OUT_OF_RANGE;case cm.UNIMPLEMENTED:return Vc.UNIMPLEMENTED;case cm.DATA_LOSS:return Vc.DATA_LOSS;default:return Oc(39323,{code:e})}}(dm=cm||(cm={}))[dm.OK=0]="OK",dm[dm.CANCELLED=1]="CANCELLED",dm[dm.UNKNOWN=2]="UNKNOWN",dm[dm.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",dm[dm.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",dm[dm.NOT_FOUND=5]="NOT_FOUND",dm[dm.ALREADY_EXISTS=6]="ALREADY_EXISTS",dm[dm.PERMISSION_DENIED=7]="PERMISSION_DENIED",dm[dm.UNAUTHENTICATED=16]="UNAUTHENTICATED",dm[dm.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",dm[dm.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",dm[dm.ABORTED=10]="ABORTED",dm[dm.OUT_OF_RANGE=11]="OUT_OF_RANGE",dm[dm.UNIMPLEMENTED=12]="UNIMPLEMENTED",dm[dm.INTERNAL=13]="INTERNAL",dm[dm.UNAVAILABLE=14]="UNAVAILABLE",dm[dm.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const hm=new pc([4294967295,4294967295],0);function mm(e){const t=(new TextEncoder).encode(e),s=new fc;return s.update(t),new Uint8Array(s.digest())}function pm(e){const t=new DataView(e.buffer),s=t.getUint32(0,!0),r=t.getUint32(4,!0),n=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new pc([s,r],0),new pc([n,i],0)]}class fm{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new gm(`Invalid padding: ${t}`);if(s<0)throw new gm(`Invalid hash count: ${s}`);if(e.length>0&&0===this.hashCount)throw new gm(`Invalid hash count: ${s}`);if(0===e.length&&0!==t)throw new gm(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=pc.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply(pc.fromNumber(s)));return 1===r.compare(hm)&&(r=new pc([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=mm(e),[s,r]=pm(t);for(let n=0;n<this.hashCount;n++){const e=this.ye(s,r,n);if(!this.we(e))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,n=new Uint8Array(Math.ceil(e/8)),i=new fm(n,r,t);return s.forEach(e=>i.insert(e)),i}insert(e){if(0===this.ge)return;const t=mm(e),[s,r]=pm(t);for(let n=0;n<this.hashCount;n++){const e=this.ye(s,r,n);this.Se(e)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class gm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xm{constructor(e,t,s,r,n){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=n}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,vm.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new xm(wd.min(),r,new Od(Zc),gh(),kh())}}class vm{constructor(e,t,s,r,n){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=n}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new vm(s,t,kh(),kh(),kh())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class bm{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class wm{constructor(e,t){this.targetId=e,this.Ce=t}}class ym{constructor(e,t,s=Bd.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class Nm{constructor(){this.ve=0,this.Fe=km(),this.Me=Bd.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=kh(),t=kh(),s=kh();return this.Fe.forEach((r,n)=>{switch(n){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:Oc(38017,{changeType:n})}}),new vm(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=km()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Uc(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class jm{constructor(e){this.Ge=e,this.ze=new Map,this.je=gh(),this.Je=Cm(),this.He=Cm(),this.Ye=new Od(Zc)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Oc(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,s)=>{this.rt(s)&&t(s)})}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const n=r.target;if(Zu(n))if(0===s){const e=new ld(n.path);this.et(t,e,Eu.newNoDocument(e,wd.min()))}else Uc(1===s,20013,{expectedCount:s});else{const r=this._t(t);if(r!==s){const s=this.ut(e),n=s?this.ct(s,e,r):1;if(0!==n){this.it(t);const e=2===n?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:n=0}=t;let i,a;try{i=Wd(s).toUint8Array()}catch(o){if(o instanceof $d)return Rc("Decoding the base64 bloom filter in existence filter failed ("+o.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw o}try{a=new fm(i,r,n)}catch(o){return Rc(o instanceof gm?"BloomFilter error: ":"Applying bloom filter failed: ",o),null}return 0===a.ge?null:a}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach(s=>{const n=this.Ge.ht(),i=`projects/${n.projectId}/databases/${n.database}/documents/${s.path.canonicalString()}`;e.mightContain(i)||(this.et(t,s,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((s,r)=>{const n=this.ot(r);if(n){if(s.current&&Zu(n.target)){const t=new ld(n.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Eu.newNoDocument(t,e))}s.Be&&(t.set(r,s.ke()),s.qe())}});let s=kh();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(s=s.add(e))}),this.je.forEach((t,s)=>s.setReadTime(e));const r=new xm(e,t,this.Ye,this.je,s);return this.je=gh(),this.Je=Cm(),this.He=Cm(),this.Ye=new Od(Zc),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Nm,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Fd(Zc),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Fd(Zc),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||Dc("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Nm),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Cm(){return new Od(ld.comparator)}function km(){return new Od(ld.comparator)}const Sm=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Em=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),_m=(()=>({and:"AND",or:"OR"}))();class Tm{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Im(e,t){return e.useProto3Json||Td(t)?t:{value:t}}function Am(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Dm(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Pm(e,t){return Am(e,t.toTimestamp())}function Rm(e){return Uc(!!e,49232),wd.fromTimestamp(function(e){const t=Hd(e);return new bd(t.seconds,t.nanos)}(e))}function Lm(e,t){return Om(e,t).canonicalString()}function Om(e,t){const s=(r=e,new id(["projects",r.projectId,"databases",r.database])).child("documents");var r;return void 0===t?s:s.child(t)}function Mm(e){const t=id.fromString(e);return Uc(tp(t),10190,{key:t.toString()}),t}function Um(e,t){return Lm(e.databaseId,t.path)}function Fm(e,t){const s=Mm(t);if(s.get(1)!==e.databaseId.projectId)throw new zc(Vc.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+s.get(1)+" vs "+e.databaseId.projectId);if(s.get(3)!==e.databaseId.database)throw new zc(Vc.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+s.get(3)+" vs "+e.databaseId.database);return new ld($m(s))}function Vm(e,t){return Lm(e.databaseId,t)}function zm(e){return new id(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function $m(e){return Uc(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Bm(e,t,s){return{name:Um(e,t),fields:s.value.mapValue.fields}}function qm(e,t){return{documents:[Vm(e,t.path)]}}function Hm(e,t){const s={structuredQuery:{}},r=t.path;let n;null!==t.collectionGroup?(n=r,s.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n=r.popLast(),s.structuredQuery.from=[{collectionId:r.lastSegment()}]),s.parent=Vm(e,n);const i=function(e){if(0!==e.length)return Zm(Lu.create(e,"and"))}(t.filters);i&&(s.structuredQuery.where=i);const a=function(e){if(0!==e.length)return e.map(e=>{return{field:Ym((t=e).field),direction:Km(t.dir)};var t})}(t.orderBy);a&&(s.structuredQuery.orderBy=a);const o=Im(e,t.limit);return null!==o&&(s.structuredQuery.limit=o),t.startAt&&(s.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(s.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:s,parent:n};var l}function Gm(e){let t=function(e){const t=Mm(e);return 4===t.length?id.emptyPath():$m(t)}(e.parent);const s=e.structuredQuery,r=s.from?s.from.length:0;let n=null;if(r>0){Uc(1===r,65062);const e=s.from[0];e.allDescendants?n=e.collectionId:t=t.child(e.collectionId)}let i=[];s.where&&(i=function(e){const t=Wm(e);return t instanceof Lu&&Mu(t)?t.getFilters():[t]}(s.where));let a=[];s.orderBy&&(a=s.orderBy.map(e=>{return new Au(Xm((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let o=null;s.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Td(t)?null:t}(s.limit));let l=null;s.startAt&&(l=function(e){const t=!!e.before,s=e.values||[];return new _u(s,t)}(s.startAt));let c=null;return s.endAt&&(c=function(e){const t=!e.before,s=e.values||[];return new _u(s,t)}(s.endAt)),function(e,t,s,r,n,i,a,o){return new eh(e,t,s,r,n,i,a,o)}(t,n,a,i,o,"F",l,c)}function Wm(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Xm(e.unaryFilter.field);return Ru.create(t,"==",{doubleValue:NaN});case"IS_NULL":const s=Xm(e.unaryFilter.field);return Ru.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Xm(e.unaryFilter.field);return Ru.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const n=Xm(e.unaryFilter.field);return Ru.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Oc(61313);default:return Oc(60726)}}(e):void 0!==e.fieldFilter?(t=e,Ru.create(Xm(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Oc(58110);default:return Oc(50506)}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return Lu.create(e.compositeFilter.filters.map(e=>Wm(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Oc(1026)}}(e.compositeFilter.op))}(e):Oc(30097,{filter:e});var t}function Km(e){return Sm[e]}function Qm(e){return Em[e]}function Jm(e){return _m[e]}function Ym(e){return{fieldPath:e.canonicalString()}}function Xm(e){return od.fromServerFormat(e.fieldPath)}function Zm(e){return e instanceof Ru?function(e){if("=="===e.op){if(Nu(e.value))return{unaryFilter:{field:Ym(e.field),op:"IS_NAN"}};if(yu(e.value))return{unaryFilter:{field:Ym(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Nu(e.value))return{unaryFilter:{field:Ym(e.field),op:"IS_NOT_NAN"}};if(yu(e.value))return{unaryFilter:{field:Ym(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ym(e.field),op:Qm(e.op),value:e.value}}}(e):e instanceof Lu?function(e){const t=e.getFilters().map(e=>Zm(e));return 1===t.length?t[0]:{compositeFilter:{op:Jm(e.op),filters:t}}}(e):Oc(54877,{filter:e})}function ep(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function tp(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class sp{constructor(e,t,s,r,n=wd.min(),i=wd.min(),a=Bd.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=n,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new sp(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new sp(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new sp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new sp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class rp{constructor(e){this.yt=e}}function np(e){const t=Gm({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?oh(t,t.limit,"L"):t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ip{constructor(){this.Cn=new ap}addToCollectionParentIndex(e,t){return this.Cn.add(t),Sd.resolve()}getCollectionParents(e,t){return Sd.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Sd.resolve()}deleteFieldIndex(e,t){return Sd.resolve()}deleteAllFieldIndexes(e){return Sd.resolve()}createTargetIndexes(e,t){return Sd.resolve()}getDocumentsMatchingTarget(e,t){return Sd.resolve(null)}getIndexType(e,t){return Sd.resolve(0)}getFieldIndexes(e,t){return Sd.resolve([])}getNextCollectionGroupToUpdate(e){return Sd.resolve(null)}getMinOffset(e,t){return Sd.resolve(Nd.min())}getMinOffsetFromCollectionGroup(e,t){return Sd.resolve(Nd.min())}updateCollectionGroup(e,t,s){return Sd.resolve()}updateIndexEntries(e,t){return Sd.resolve()}}class ap{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Fd(id.comparator),n=!r.has(s);return this.index[t]=r.add(s),n}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Fd(id.comparator)).toArray()}}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const op={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lp=41943040;class cp{static withCacheSize(e){return new cp(e,cp.DEFAULT_COLLECTION_PERCENTILE,cp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */cp.DEFAULT_COLLECTION_PERCENTILE=10,cp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cp.DEFAULT=new cp(lp,cp.DEFAULT_COLLECTION_PERCENTILE,cp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cp.DISABLED=new cp(-1,0,0);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class dp{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new dp(0)}static cr(){return new dp(-1)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const up="LruGarbageCollector";function hp([e,t],[s,r]){const n=Zc(e,s);return 0===n?Zc(t,r):n}class mp{constructor(e){this.Ir=e,this.buffer=new Fd(hp),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();hp(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class pp{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){Dc(up,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>p(this,null,function*(){this.Rr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ed(e)?Dc(up,"Ignoring IndexedDB error during garbage collection: ",e):yield kd(e)}yield this.Vr(3e5)}))}}class fp{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Sd.resolve(_d.ce);const s=new mp(t);return this.mr.forEachTarget(e,e=>s.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>s.Ar(e))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Dc("LruGarbageCollector","Garbage collection skipped; disabled"),Sd.resolve(op)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(Dc("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),op):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,n,i,a,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(Dc("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(s=r,a=Date.now(),this.removeTargets(e,s,t))).next(t=>(n=t,o=Date.now(),this.removeOrphanedDocuments(e,s))).next(e=>(l=Date.now(),Ac()<=dr.DEBUG&&Dc("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-c}ms\n\tDetermined least recently used ${r} in `+(a-i)+`ms\n\tRemoved ${n} targets in `+(o-a)+`ms\n\tRemoved ${e} documents in `+(l-o)+`ms\nTotal Duration: ${l-c}ms`),Sd.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:n,documentsRemoved:e})))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class gp{constructor(){this.changes=new ph(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Eu.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return void 0!==s?Sd.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xp{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class vp{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==s&&Qh(s.mutation,e,zd.empty(),bd.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,kh()).next(()=>t))}getLocalViewOfDocuments(e,t,s=kh()){const r=wh();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,s).next(e=>{let t=vh();return e.forEach((e,s)=>{t=t.insert(e,s.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const s=wh();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,kh()))}populateOverlays(e,t,s){const r=[];return s.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,s)=>{t.set(e,s)})})}computeViews(e,t,s,r){let n=gh();const i=Nh(),a=Nh();return t.forEach((e,t)=>{const a=s.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof Zh)?n=n.insert(t.key,t):void 0!==a?(i.set(t.key,a.mutation.getFieldMask()),Qh(a.mutation,t,a.mutation.getFieldMask(),bd.now())):i.set(t.key,zd.empty())}),this.recalculateAndSaveOverlays(e,n).next(e=>(e.forEach((e,t)=>i.set(e,t)),t.forEach((e,t)=>{var s;return a.set(e,new xp(t,null!=(s=i.get(e))?s:null))}),a))}recalculateAndSaveOverlays(e,t){const s=Nh();let r=new Od((e,t)=>e-t),n=kh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const n of e)n.keys().forEach(e=>{const i=t.get(e);if(null===i)return;let a=s.get(e)||zd.empty();a=n.applyToLocalView(i,a),s.set(e,a);const o=(r.get(n.batchId)||kh()).add(e);r=r.insert(n.batchId,o)})}).next(()=>{const i=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=yh();l.forEach(e=>{if(!n.has(e)){const r=Wh(t.get(e),s.get(e));null!==r&&c.set(e,r),n=n.add(e)}}),i.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Sd.waitFor(i)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,s,r){return n=t,ld.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):rh(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r);var n}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next(n=>{const i=r-n.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-n.size):Sd.resolve(wh());let a=-1,o=n;return i.next(t=>Sd.forEach(t,(t,s)=>(a<s.largestBatchId&&(a=s.largestBatchId),n.get(t)?Sd.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,n)).next(()=>this.computeViews(e,o,t,kh())).next(e=>({batchId:a,changes:bh(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ld(t)).next(e=>{let t=vh();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const n=t.collectionGroup;let i=vh();return this.indexManager.getCollectionParents(e,n).next(a=>Sd.forEach(a,a=>{const o=(l=t,c=a.child(n),new eh(c,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,c;return this.getDocumentsMatchingCollectionQuery(e,o,s,r).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,s,r){let n;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(i=>(n=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,n,r))).next(e=>{n.forEach((t,s)=>{const r=s.getKey();null===e.get(r)&&(e=e.insert(r,Eu.newInvalidDocument(r)))});let s=vh();return e.forEach((e,r)=>{const i=n.get(e);void 0!==i&&Qh(i.mutation,r,zd.empty(),bd.now()),uh(t,r)&&(s=s.insert(e,r))}),s})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class bp{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Sd.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,{id:(s=t).id,version:s.version,createTime:Rm(s.createTime)}),Sd.resolve();var s}getNamedQuery(e,t){return Sd.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,{name:(s=t).name,query:np(s.bundledQuery),readTime:Rm(s.readTime)}),Sd.resolve();var s}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class wp{constructor(){this.overlays=new Od(ld.comparator),this.qr=new Map}getOverlay(e,t){return Sd.resolve(this.overlays.get(t))}getOverlays(e,t){const s=wh();return Sd.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&s.set(t,e)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((s,r)=>{this.St(e,t,r)}),Sd.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(s)),Sd.resolve()}getOverlaysForCollection(e,t,s){const r=wh(),n=t.length+1,i=new ld(t.child("")),a=this.overlays.getIteratorFrom(i);for(;a.hasNext();){const e=a.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===n&&e.largestBatchId>s&&r.set(e.getKey(),e)}return Sd.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let n=new Od((e,t)=>e-t);const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>s){let t=n.get(e.largestBatchId);null===t&&(t=wh(),n=n.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=wh(),o=n.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return Sd.resolve(a)}St(e,t,s){const r=this.overlays.get(s.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(s.key,new om(t,s));let n=this.qr.get(t);void 0===n&&(n=kh(),this.qr.set(t,n)),this.qr.set(t,n.add(s.key))}}
/**
     * @license
     * Copyright 2024 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class yp{constructor(){this.sessionToken=Bd.EMPTY_BYTE_STRING}getSessionToken(e){return Sd.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Sd.resolve()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Np{constructor(){this.Qr=new Fd(jp.$r),this.Ur=new Fd(jp.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new jp(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new jp(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new ld(new id([])),s=new jp(t,e),r=new jp(t,e+1),n=[];return this.Ur.forEachInRange([s,r],e=>{this.Gr(e),n.push(e.key)}),n}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ld(new id([])),s=new jp(t,e),r=new jp(t,e+1);let n=kh();return this.Ur.forEachInRange([s,r],e=>{n=n.add(e.key)}),n}containsKey(e){const t=new jp(e,0),s=this.Qr.firstAfterOrEqual(t);return null!==s&&e.isEqual(s.key)}}class jp{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ld.comparator(e.key,t.key)||Zc(e.Yr,t.Yr)}static Kr(e,t){return Zc(e.Yr,t.Yr)||ld.comparator(e.key,t.key)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Cp{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Fd(jp.$r)}checkEmpty(e){return Sd.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,s,r){const n=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new im(n,t,s,r);this.mutationQueue.push(i);for(const a of r)this.Zr=this.Zr.add(new jp(a.key,n)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Sd.resolve(i)}lookupMutationBatch(e,t){return Sd.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),n=r<0?0:r;return Sd.resolve(this.mutationQueue.length>n?this.mutationQueue[n]:null)}getHighestUnacknowledgedBatchId(){return Sd.resolve(0===this.mutationQueue.length?-1:this.tr-1)}getAllMutationBatches(e){return Sd.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new jp(t,0),r=new jp(t,Number.POSITIVE_INFINITY),n=[];return this.Zr.forEachInRange([s,r],e=>{const t=this.Xr(e.Yr);n.push(t)}),Sd.resolve(n)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Fd(Zc);return t.forEach(e=>{const t=new jp(e,0),r=new jp(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{s=s.add(e.Yr)})}),Sd.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let n=s;ld.isDocumentKey(n)||(n=n.child(""));const i=new jp(new ld(n),0);let a=new Fd(Zc);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!s.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.Yr)),!0)},i),Sd.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(e=>{const s=this.Xr(e);null!==s&&t.push(s)}),t}removeMutationBatch(e,t){Uc(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let s=this.Zr;return Sd.forEach(t.mutations,r=>{const n=new jp(r.key,t.batchId);return s=s.delete(n),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,t){const s=new jp(t,0),r=this.Zr.firstAfterOrEqual(s);return Sd.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Sd.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class kp{constructor(e){this.ri=e,this.docs=new Od(ld.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),n=r?r.size:0,i=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:i}),this.size+=i-n,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return Sd.resolve(s?s.document.mutableCopy():Eu.newInvalidDocument(t))}getEntries(e,t){let s=gh();return t.forEach(e=>{const t=this.docs.get(e);s=s.insert(e,t?t.document.mutableCopy():Eu.newInvalidDocument(e))}),Sd.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let n=gh();const i=t.path,a=new ld(i.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||jd(yd(a),s)<=0||(r.has(a.key)||uh(t,a))&&(n=n.insert(a.key,a.mutableCopy()))}return Sd.resolve(n)}getAllFromCollectionGroup(e,t,s,r){Oc(9500)}ii(e,t){return Sd.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Sp(this)}getSize(e){return Sd.resolve(this.size)}}class Sp extends gp{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),Sd.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ep{constructor(e){this.persistence=e,this.si=new ph(e=>Yu(e),Xu),this.lastRemoteSnapshotVersion=wd.min(),this.highestTargetId=0,this.oi=0,this._i=new Np,this.targetCount=0,this.ai=dp.ur()}forEachTarget(e,t){return this.si.forEach((e,s)=>t(s)),Sd.resolve()}getLastRemoteSnapshotVersion(e){return Sd.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Sd.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Sd.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),Sd.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new dp(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Sd.resolve()}updateTargetData(e,t){return this.Pr(t),Sd.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Sd.resolve()}removeTargets(e,t,s){let r=0;const n=[];return this.si.forEach((i,a)=>{a.sequenceNumber<=t&&null===s.get(a.targetId)&&(this.si.delete(i),n.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),Sd.waitFor(n).next(()=>r)}getTargetCount(e){return Sd.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return Sd.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),Sd.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,n=[];return r&&t.forEach(t=>{n.push(r.markPotentiallyOrphaned(e,t))}),Sd.waitFor(n)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Sd.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return Sd.resolve(s)}containsKey(e,t){return Sd.resolve(this._i.containsKey(t))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _p{constructor(e,t){this.ui={},this.overlays={},this.ci=new _d(0),this.li=!1,this.li=!0,this.hi=new yp,this.referenceDelegate=e(this),this.Pi=new Ep(this),this.indexManager=new ip,this.remoteDocumentCache=new kp(e=>this.referenceDelegate.Ti(e)),this.serializer=new rp(t),this.Ii=new bp(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new Cp(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){Dc("MemoryPersistence","Starting transaction:",e);const r=new Tp(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return Sd.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,t)))}}class Tp extends Cd{constructor(e){super(),this.currentSequenceNumber=e}}class Ip{constructor(e){this.persistence=e,this.Ri=new Np,this.Vi=null}static mi(e){return new Ip(e)}get fi(){if(this.Vi)return this.Vi;throw Oc(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),Sd.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),Sd.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Sd.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>s.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Sd.forEach(this.fi,s=>{const r=ld.fromPath(s);return this.gi(e,r).next(e=>{e||t.removeEntry(r,wd.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Sd.or([()=>Sd.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ap{constructor(e,t){this.persistence=e,this.pi=new ph(e=>function(e){let t="";for(let s=0;s<e.length;s++)t.length>0&&(t=Dd(t)),t=Ad(e.get(s),t);return Dd(t)}(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=function(e,t){return new fp(e,t)}(this,t)}static mi(e,t){return new Ap(e,t)}Ei(){}di(e){return Sd.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Sd.forEach(this.pi,(s,r)=>this.br(e,s,r).next(e=>e?Sd.resolve():t(r)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),n=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(s++,n.removeEntry(r,wd.min()))})).next(()=>n.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Sd.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),Sd.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),Sd.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Sd.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=xu(e.data.value)),t}br(e,t,s){return Sd.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Sd.resolve(void 0!==e&&e>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Dp{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=kh(),r=kh();for(const n of t.docChanges)switch(n.type){case 0:s=s.add(n.doc.key);break;case 1:r=r.add(n.doc.key)}return new Dp(e,t.fromCache,s,r)}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Pp{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Rp{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=Hs()?8:function(e){const t=e.match(/Android ([\d.]+)/i),s=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(s)}(Bs())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const n={result:null};return this.ys(e,t).next(e=>{n.result=e}).next(()=>{if(!n.result)return this.ws(e,t,r,s).next(e=>{n.result=e})}).next(()=>{if(n.result)return;const s=new Pp;return this.Ss(e,t,s).next(r=>{if(n.result=r,this.Vs)return this.bs(e,t,s,r.size)})}).next(()=>n.result)}bs(e,t,s,r){return s.documentReadCount<this.fs?(Ac()<=dr.DEBUG&&Dc("QueryEngine","SDK will not create cache indexes for query:",dh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Sd.resolve()):(Ac()<=dr.DEBUG&&Dc("QueryEngine","Query:",dh(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Ac()<=dr.DEBUG&&Dc("QueryEngine","The SDK decides to create cache indexes for query:",dh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ih(t))):Sd.resolve())}ys(e,t){if(sh(t))return Sd.resolve(null);let s=ih(t);return this.indexManager.getIndexType(e,s).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=oh(t,null,"F"),s=ih(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(r=>{const n=kh(...r);return this.ps.getDocuments(e,n).next(r=>this.indexManager.getMinOffset(e,s).next(s=>{const i=this.Ds(t,r);return this.Cs(t,i,n,s.readTime)?this.ys(e,oh(t,null,"F")):this.vs(e,i,t,s)}))})))}ws(e,t,s,r){return sh(t)||r.isEqual(wd.min())?Sd.resolve(null):this.ps.getDocuments(e,s).next(n=>{const i=this.Ds(t,n);return this.Cs(t,i,s,r)?Sd.resolve(null):(Ac()<=dr.DEBUG&&Dc("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),dh(t)),this.vs(e,i,t,function(e,t){const s=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,n=wd.fromTimestamp(1e9===r?new bd(s+1,0):new bd(s,r));return new Nd(n,ld.empty(),t)}(r,-1)).next(e=>e))})}Ds(e,t){let s=new Fd(hh(e));return t.forEach((t,r)=>{uh(e,r)&&(s=s.add(r))}),s}Cs(e,t,s,r){if(null===e.limit)return!1;if(s.size!==t.size)return!0;const n="F"===e.limitType?t.last():t.first();return!!n&&(n.hasPendingWrites||n.version.compareTo(r)>0)}Ss(e,t,s){return Ac()<=dr.DEBUG&&Dc("QueryEngine","Using full collection scan to execute query:",dh(t)),this.ps.getDocumentsMatchingQuery(e,t,Nd.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Lp="LocalStore";class Op{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Od(Zc),this.xs=new ph(e=>Yu(e),Xu),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vp(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Mp(e,t){return p(this,null,function*(){const s=Fc(e);return yield s.persistence.runTransaction("Handle user change","readonly",e=>{let r;return s.mutationQueue.getAllMutationBatches(e).next(n=>(r=n,s.Bs(t),s.mutationQueue.getAllMutationBatches(e))).next(t=>{const n=[],i=[];let a=kh();for(const e of r){n.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return s.localDocuments.getDocuments(e,a).next(e=>({Ls:e,removedBatchIds:n,addedBatchIds:i}))})})})}function Up(e){const t=Fc(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Fp(e,t){const s=Fc(e),r=t.snapshotVersion;let n=s.Ms;return s.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const i=s.Ns.newChangeBuffer({trackRemovals:!0});n=s.Ms;const a=[];t.targetChanges.forEach((i,o)=>{const l=n.get(o);if(!l)return;a.push(s.Pi.removeMatchingKeys(e,i.removedDocuments,o).next(()=>s.Pi.addMatchingKeys(e,i.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);var d,u,h;null!==t.targetMismatches.get(o)?c=c.withResumeToken(Bd.EMPTY_BYTE_STRING,wd.min()).withLastLimboFreeSnapshotVersion(wd.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),n=n.insert(o,c),u=c,h=i,(0===(d=l).resumeToken.approximateByteSize()||u.snapshotVersion.toMicroseconds()-d.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&a.push(s.Pi.updateTargetData(e,c))});let o=gh(),l=kh();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(s.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(function(e,t,s){let r=kh(),n=kh();return s.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=gh();return s.forEach((s,i)=>{const a=e.get(s);i.isFoundDocument()!==a.isFoundDocument()&&(n=n.add(s)),i.isNoDocument()&&i.version.isEqual(wd.min())?(t.removeEntry(s,i.readTime),r=r.insert(s,i)):!a.isValidDocument()||i.version.compareTo(a.version)>0||0===i.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(i),r=r.insert(s,i)):Dc(Lp,"Ignoring outdated watch update for ",s,". Current version:",a.version," Watch version:",i.version)}),{ks:r,qs:n}})}(e,i,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!r.isEqual(wd.min())){const t=s.Pi.getLastRemoteSnapshotVersion(e).next(t=>s.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return Sd.waitFor(a).next(()=>i.apply(e)).next(()=>s.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(s.Ms=n,e))}function Vp(e,t){const s=Fc(e);return s.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),s.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function zp(e,t,s){return p(this,null,function*(){const r=Fc(e),n=r.Ms.get(t),i=s?"readwrite":"readwrite-primary";try{s||(yield r.persistence.runTransaction("Release target",i,e=>r.persistence.referenceDelegate.removeTarget(e,n)))}catch(a){if(!Ed(a))throw a;Dc(Lp,`Failed to update sequence numbers for target ${t}: ${a}`)}r.Ms=r.Ms.remove(t),r.xs.delete(n.target)})}function $p(e,t,s){const r=Fc(e);let n=wd.min(),i=kh();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,s){const r=Fc(e),n=r.xs.get(s);return void 0!==n?Sd.resolve(r.Ms.get(n)):r.Pi.getTargetData(t,s)}(r,e,ih(t)).next(t=>{if(t)return n=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{i=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,s?n:wd.min(),s?i:kh())).next(e=>(function(e,t,s){let r=e.Os.get(t)||wd.min();s.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Qs:i})))}class Bp{constructor(){this.activeTargetIds=Sh}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qp{constructor(){this.Mo=new Bp,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Bp,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Hp{Oo(e){}shutdown(){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Gp="ConnectivityMonitor";class Wp{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Dc(Gp,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Dc(Gp,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let Kp=null;function Qp(){return null===Kp?Kp=268435456+Math.round(2147483648*Math.random()):Kp++,"0x"+Kp.toString(16)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const Jp="RestConnection",Yp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Xp{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===su?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,n){const i=Qp(),a=this.zo(e,t.toUriEncodedString());Dc(Jp,`Sending RPC '${e}' ${i}:`,a,s);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,r,n);const{host:l}=new URL(a),c=Ms(l);return this.Jo(e,a,o,s,c).then(t=>(Dc(Jp,`Received RPC '${e}' ${i}: `,t),t),t=>{throw Rc(Jp,`RPC '${e}' ${i} failed with error: `,t,"url: ",a,"request:",s),t})}Ho(e,t,s,r,n,i){return this.Go(e,t,s,r,n)}jo(e,t,s){e["X-Goog-Api-Client"]="gl-js/ fire/"+Tc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,s)=>e[s]=t),s&&s.headers.forEach((t,s)=>e[s]=t)}zo(e,t){const s=Yp[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Zp{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const ef="WebChannelConnection";class tf extends Xp{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,n){const i=Qp();return new Promise((n,a)=>{const o=new xc;o.setWithCredentials(!0),o.listenOnce(bc.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case wc.NO_ERROR:const t=o.getResponseJson();Dc(ef,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),n(t);break;case wc.TIMEOUT:Dc(ef,`RPC '${e}' ${i} timed out`),a(new zc(Vc.DEADLINE_EXCEEDED,"Request time out"));break;case wc.HTTP_ERROR:const s=o.getStatus();if(Dc(ef,`RPC '${e}' ${i} failed with status:`,s,"response text:",o.getResponseText()),s>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Vc).indexOf(t)>=0?t:Vc.UNKNOWN}(t.status);a(new zc(e,t.message))}else a(new zc(Vc.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new zc(Vc.UNAVAILABLE,"Connection failed."));break;default:Oc(9055,{l_:e,streamId:i,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{Dc(ef,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(r);Dc(ef,`RPC '${e}' ${i} sending request:`,r),o.send(t,"POST",l,s,15)})}T_(e,t,s){const r=Qp(),n=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Cc(),a=jc(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,s),o.encodeInitMessageHeaders=!0;const c=n.join("");Dc(ef,`Creating RPC '${e}' stream ${r}: ${c}`,o);const d=i.createWebChannel(c,o);this.I_(d);let u=!1,h=!1;const m=new Zp({Yo:t=>{h?Dc(ef,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(u||(Dc(ef,`Opening RPC '${e}' stream ${r} transport.`),d.open(),u=!0),Dc(ef,`RPC '${e}' stream ${r} sending:`,t),d.send(t))},Zo:()=>d.close()}),p=(e,t,s)=>{e.listen(t,e=>{try{s(e)}catch(t){setTimeout(()=>{throw t},0)}})};return p(d,vc.EventType.OPEN,()=>{h||(Dc(ef,`RPC '${e}' stream ${r} transport opened.`),m.o_())}),p(d,vc.EventType.CLOSE,()=>{h||(h=!0,Dc(ef,`RPC '${e}' stream ${r} transport closed`),m.a_(),this.E_(d))}),p(d,vc.EventType.ERROR,t=>{h||(h=!0,Rc(ef,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),m.a_(new zc(Vc.UNAVAILABLE,"The operation could not be completed")))}),p(d,vc.EventType.MESSAGE,t=>{var s;if(!h){const n=t.data[0];Uc(!!n,16349);const i=n,a=(null==i?void 0:i.error)||(null==(s=i[0])?void 0:s.error);if(a){Dc(ef,`RPC '${e}' stream ${r} received error:`,a);const t=a.status;let s=function(e){const t=cm[e];if(void 0!==t)return um(t)}(t),n=a.message;void 0===s&&(s=Vc.INTERNAL,n="Unknown error status: "+t+" with message "+a.message),h=!0,m.a_(new zc(s,n)),d.close()}else Dc(ef,`RPC '${e}' stream ${r} received:`,n),m.u_(n)}}),p(a,Nc.STAT_EVENT,t=>{t.stat===yc.PROXY?Dc(ef,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===yc.NOPROXY&&Dc(ef,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{m.__()},0),m}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function sf(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function rf(e){return new Tm(e,!0)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class nf{constructor(e,t,s=1e3,r=1.5,n=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=n,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&Dc("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const af="PersistentStream";class of{constructor(e,t,s,r,n,i,a,o){this.Mi=e,this.S_=s,this.b_=r,this.connection=n,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new nf(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}stop(){return p(this,null,function*(){this.x_()&&(yield this.close(0))})}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}k_(){return p(this,null,function*(){if(this.O_())return this.close(0)})}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return p(this,null,function*(){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===Vc.RESOURCE_EXHAUSTED?(Pc(t.toString()),Pc("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Vc.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.r_(t)})}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,s])=>{this.D_===t&&this.G_(e,s)},t=>{e(()=>{const e=new zc(Vc.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{s(()=>this.z_(e))}),this.stream.onMessage(e=>{s(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(()=>p(this,null,function*(){this.state=0,this.start()}))}z_(e){return Dc(af,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(Dc(af,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lf extends of{constructor(e,t,s,r,n,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,i),this.serializer=n}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let s;if("targetChange"in t){t.targetChange;const n="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:Oc(39313,{state:r}),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(Uc(void 0===t||"string"==typeof t,58123),Bd.fromBase64String(t||"")):(Uc(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Bd.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&function(e){const t=void 0===e.code?Vc.UNKNOWN:um(e.code);return new zc(t,e.message||"")}(o);s=new ym(n,i,a,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const n=Fm(e,r.document.name),i=Rm(r.document.updateTime),a=r.document.createTime?Rm(r.document.createTime):wd.min(),o=new ku({mapValue:{fields:r.document.fields}}),l=Eu.newFoundDocument(n,i,a,o),c=r.targetIds||[],d=r.removedTargetIds||[];s=new bm(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const n=Fm(e,r.document),i=r.readTime?Rm(r.readTime):wd.min(),a=Eu.newNoDocument(n,i),o=r.removedTargetIds||[];s=new bm([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const n=Fm(e,r.document),i=r.removedTargetIds||[];s=new bm([],i,n,null)}else{if(!("filter"in t))return Oc(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:n}=e,i=new lm(r,n),a=e.targetId;s=new wm(a,i)}}var r;return s}(this.serializer,e),s=function(e){if(!("targetChange"in e))return wd.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?wd.min():t.readTime?Rm(t.readTime):wd.min()}(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=zm(this.serializer),t.addTarget=function(e,t){let s;const r=t.target;if(s=Zu(r)?{documents:qm(e,r)}:{query:Hm(e,r).ft},s.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){s.resumeToken=Dm(e,t.resumeToken);const r=Im(e,t.expectedCount);null!==r&&(s.expectedCount=r)}else if(t.snapshotVersion.compareTo(wd.min())>0){s.readTime=Am(e,t.snapshotVersion.toTimestamp());const r=Im(e,t.expectedCount);null!==r&&(s.expectedCount=r)}return s}(this.serializer,e);const s=function(e,t){const s=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Oc(28987,{purpose:e})}}(t.purpose);return null==s?null:{"goog-listen-tags":s}}(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=zm(this.serializer),t.removeTarget=e,this.q_(t)}}class cf extends of{constructor(e,t,s,r,n,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,i),this.serializer=n}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Uc(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Uc(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){Uc(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(Uc(void 0!==t,14353),e.map(e=>function(e,t){let s=e.updateTime?Rm(e.updateTime):Rm(t);return s.isEqual(wd.min())&&(s=Rm(t)),new Bh(s,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),s=Rm(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=zm(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let s;if(t instanceof Xh)s={update:Bm(e,t.key,t.value)};else if(t instanceof rm)s={delete:Um(e,t.key)};else if(t instanceof Zh)s={update:Bm(e,t.key,t.data),updateMask:ep(t.fieldMask)};else{if(!(t instanceof nm))return Oc(16599,{Vt:t.type});s={verify:Um(e,t.key)}}return t.fieldTransforms.length>0&&(s.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const s=t.transform;if(s instanceof Rh)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(s instanceof Lh)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:s.elements}};if(s instanceof Mh)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:s.elements}};if(s instanceof Fh)return{fieldPath:t.field.canonicalString(),increment:s.Ae};throw Oc(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(s.currentDocument=(r=e,void 0!==(n=t.precondition).updateTime?{updateTime:Pm(r,n.updateTime)}:void 0!==n.exists?{exists:n.exists}:Oc(27497))),s;var r,n}(this.serializer,e))};this.q_(t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class df{}class uf extends df{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new zc(Vc.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([n,i])=>this.connection.Go(e,Om(t,s),r,n,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Vc.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new zc(Vc.UNKNOWN,e.toString())})}Ho(e,t,s,r,n){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Ho(e,Om(t,s),r,i,a,n)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Vc.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new zc(Vc.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class hf{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Pc(t),this.aa=!1):Dc("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const mf="RemoteStore";class pf{constructor(e,t,s,r,n){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=n,this.Aa.Oo(e=>{s.enqueueAndForget(()=>p(this,null,function*(){jf(this)&&(Dc(mf,"Restarting streams for network reachability change."),yield function(e){return p(this,null,function*(){const t=Fc(e);t.Ea.add(4),yield gf(t),t.Ra.set("Unknown"),t.Ea.delete(4),yield ff(t)})}(this))}))}),this.Ra=new hf(s,r)}}function ff(e){return p(this,null,function*(){if(jf(e))for(const t of e.da)yield t(!0)})}function gf(e){return p(this,null,function*(){for(const t of e.da)yield t(!1)})}function xf(e,t){const s=Fc(e);s.Ia.has(t.targetId)||(s.Ia.set(t.targetId,t),Nf(s)?yf(s):zf(s).O_()&&bf(s,t))}function vf(e,t){const s=Fc(e),r=zf(s);s.Ia.delete(t),r.O_()&&wf(s,t),0===s.Ia.size&&(r.O_()?r.L_():jf(s)&&s.Ra.set("Unknown"))}function bf(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(wd.min())>0){const s=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(s)}zf(e).Y_(t)}function wf(e,t){e.Va.Ue(t),zf(e).Z_(t)}function yf(e){e.Va=new jm({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),zf(e).start(),e.Ra.ua()}function Nf(e){return jf(e)&&!zf(e).x_()&&e.Ia.size>0}function jf(e){return 0===Fc(e).Ea.size}function Cf(e){e.Va=void 0}function kf(e){return p(this,null,function*(){e.Ra.set("Online")})}function Sf(e){return p(this,null,function*(){e.Ia.forEach((t,s)=>{bf(e,t)})})}function Ef(e,t){return p(this,null,function*(){Cf(e),Nf(e)?(e.Ra.ha(t),yf(e)):e.Ra.set("Unknown")})}function _f(e,t,s){return p(this,null,function*(){if(e.Ra.set("Online"),t instanceof ym&&2===t.state&&t.cause)try{yield function(e,t){return p(this,null,function*(){const s=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(yield e.remoteSyncer.rejectListen(r,s),e.Ia.delete(r),e.Va.removeTarget(r))})}(e,t)}catch(r){Dc(mf,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield Tf(e,r)}else if(t instanceof bm?e.Va.Ze(t):t instanceof wm?e.Va.st(t):e.Va.tt(t),!s.isEqual(wd.min()))try{const t=yield Up(e.localStore);s.compareTo(t)>=0&&(yield function(e,t){const s=e.Va.Tt(t);return s.targetChanges.forEach((s,r)=>{if(s.resumeToken.approximateByteSize()>0){const n=e.Ia.get(r);n&&e.Ia.set(r,n.withResumeToken(s.resumeToken,t))}}),s.targetMismatches.forEach((t,s)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(Bd.EMPTY_BYTE_STRING,r.snapshotVersion)),wf(e,t);const n=new sp(r.target,t,s,r.sequenceNumber);bf(e,n)}),e.remoteSyncer.applyRemoteEvent(s)}(e,s))}catch(n){Dc(mf,"Failed to raise snapshot:",n),yield Tf(e,n)}})}function Tf(e,t,s){return p(this,null,function*(){if(!Ed(t))throw t;e.Ea.add(1),yield gf(e),e.Ra.set("Offline"),s||(s=()=>Up(e.localStore)),e.asyncQueue.enqueueRetryable(()=>p(this,null,function*(){Dc(mf,"Retrying IndexedDB access"),yield s(),e.Ea.delete(1),yield ff(e)}))})}function If(e,t){return t().catch(s=>Tf(e,s,t))}function Af(e){return p(this,null,function*(){const t=Fc(e),s=$f(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:-1;for(;Df(t);)try{const e=yield Vp(t.localStore,r);if(null===e){0===t.Ta.length&&s.L_();break}r=e.batchId,Pf(t,e)}catch(n){yield Tf(t,n)}Rf(t)&&Lf(t)})}function Df(e){return jf(e)&&e.Ta.length<10}function Pf(e,t){e.Ta.push(t);const s=$f(e);s.O_()&&s.X_&&s.ea(t.mutations)}function Rf(e){return jf(e)&&!$f(e).x_()&&e.Ta.length>0}function Lf(e){$f(e).start()}function Of(e){return p(this,null,function*(){$f(e).ra()})}function Mf(e){return p(this,null,function*(){const t=$f(e);for(const s of e.Ta)t.ea(s.mutations)})}function Uf(e,t,s){return p(this,null,function*(){const r=e.Ta.shift(),n=am.from(r,t,s);yield If(e,()=>e.remoteSyncer.applySuccessfulWrite(n)),yield Af(e)})}function Ff(e,t){return p(this,null,function*(){t&&$f(e).X_&&(yield function(e,t){return p(this,null,function*(){if(function(e){switch(e){case Vc.OK:return Oc(64938);case Vc.CANCELLED:case Vc.UNKNOWN:case Vc.DEADLINE_EXCEEDED:case Vc.RESOURCE_EXHAUSTED:case Vc.INTERNAL:case Vc.UNAVAILABLE:case Vc.UNAUTHENTICATED:return!1;case Vc.INVALID_ARGUMENT:case Vc.NOT_FOUND:case Vc.ALREADY_EXISTS:case Vc.PERMISSION_DENIED:case Vc.FAILED_PRECONDITION:case Vc.ABORTED:case Vc.OUT_OF_RANGE:case Vc.UNIMPLEMENTED:case Vc.DATA_LOSS:return!0;default:return Oc(15467,{code:e})}}(s=t.code)&&s!==Vc.ABORTED){const s=e.Ta.shift();$f(e).B_(),yield If(e,()=>e.remoteSyncer.rejectFailedWrite(s.batchId,t)),yield Af(e)}var s})}(e,t)),Rf(e)&&Lf(e)})}function Vf(e,t){return p(this,null,function*(){const s=Fc(e);s.asyncQueue.verifyOperationInProgress(),Dc(mf,"RemoteStore received new credentials");const r=jf(s);s.Ea.add(3),yield gf(s),r&&s.Ra.set("Unknown"),yield s.remoteSyncer.handleCredentialChange(t),s.Ea.delete(3),yield ff(s)})}function zf(e){return e.ma||(e.ma=function(e,t,s){const r=Fc(e);return r.sa(),new lf(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(e.datastore,e.asyncQueue,{Xo:kf.bind(null,e),t_:Sf.bind(null,e),r_:Ef.bind(null,e),H_:_f.bind(null,e)}),e.da.push(t=>p(this,null,function*(){t?(e.ma.B_(),Nf(e)?yf(e):e.Ra.set("Unknown")):(yield e.ma.stop(),Cf(e))}))),e.ma}function $f(e){return e.fa||(e.fa=function(e,t,s){const r=Fc(e);return r.sa(),new cf(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Of.bind(null,e),r_:Ff.bind(null,e),ta:Mf.bind(null,e),na:Uf.bind(null,e)}),e.da.push(t=>p(this,null,function*(){t?(e.fa.B_(),yield Af(e)):(yield e.fa.stop(),e.Ta.length>0&&(Dc(mf,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))}))),e.fa
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class Bf{constructor(e,t,s,r,n){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=n,this.deferred=new $c,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,n){const i=Date.now()+s,a=new Bf(e,t,i,r,n);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new zc(Vc.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qf(e,t){if(Pc("AsyncQueue",`${t}: ${e}`),Ed(e))return new zc(Vc.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Hf{static emptySet(e){return new Hf(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||ld.comparator(t.key,s.key):(e,t)=>ld.comparator(e.key,t.key),this.keyedMap=vh(),this.sortedSet=new Od(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Hf))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=s.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const s=new Hf;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Gf{constructor(){this.ga=new Od(ld.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?0!==e.type&&3===s.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==s.type?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):2===e.type&&2===s.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===s.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===s.type?this.ga=this.ga.remove(t):1===e.type&&2===s.type?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):0===e.type&&1===s.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Oc(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,s)=>{e.push(s)}),e}}class Wf{constructor(e,t,s,r,n,i,a,o,l){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=n,this.fromCache=i,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,s,r,n){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new Wf(e,t,Hf.emptySet(t),i,s,r,!0,!1,n)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Kf{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Qf{constructor(){this.queries=Jf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const s=Fc(e),r=s.queries;s.queries=Jf(),r.forEach((e,s)=>{for(const r of s.Sa)r.onError(t)})}(this,new zc(Vc.ABORTED,"Firestore shutting down"))}}function Jf(){return new ph(e=>ch(e),lh)}function Yf(e,t){return p(this,null,function*(){const s=Fc(e);let r=3;const n=t.query;let i=s.queries.get(n);i?!i.ba()&&t.Da()&&(r=2):(i=new Kf,r=t.Da()?0:1);try{switch(r){case 0:i.wa=yield s.onListen(n,!0);break;case 1:i.wa=yield s.onListen(n,!1);break;case 2:yield s.onFirstRemoteStoreListen(n)}}catch(a){const e=qf(a,`Initialization of query '${dh(t.query)}' failed`);return void t.onError(e)}s.queries.set(n,i),i.Sa.push(t),t.va(s.onlineState),i.wa&&t.Fa(i.wa)&&tg(s)})}function Xf(e,t){return p(this,null,function*(){const s=Fc(e),r=t.query;let n=3;const i=s.queries.get(r);if(i){const e=i.Sa.indexOf(t);e>=0&&(i.Sa.splice(e,1),0===i.Sa.length?n=t.Da()?0:1:!i.ba()&&t.Da()&&(n=2))}switch(n){case 0:return s.queries.delete(r),s.onUnlisten(r,!0);case 1:return s.queries.delete(r),s.onUnlisten(r,!1);case 2:return s.onLastRemoteStoreUnlisten(r);default:return}})}function Zf(e,t){const s=Fc(e);let r=!1;for(const n of t){const e=n.query,t=s.queries.get(e);if(t){for(const e of t.Sa)e.Fa(n)&&(r=!0);t.wa=n}}r&&tg(s)}function eg(e,t,s){const r=Fc(e),n=r.queries.get(t);if(n)for(const i of n.Sa)i.onError(s);r.queries.delete(t)}function tg(e){e.Ca.forEach(e=>{e.next()})}var sg,rg;(rg=sg||(sg={})).Ma="default",rg.Cache="cache";class ng{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const s of e.docChanges)3!==s.type&&t.push(s);e=new Wf(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const s="Offline"!==t;return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Wf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==sg.Cache}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ig{constructor(e){this.key=e}}class ag{constructor(e){this.key=e}}class og{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=kh(),this.mutatedKeys=kh(),this.eu=hh(e),this.tu=new Hf(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new Gf,r=t?t.tu:this.tu;let n=t?t.mutatedKeys:this.mutatedKeys,i=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),d=uh(this.query,t)?t:null,u=!!c&&this.mutatedKeys.has(c.key),h=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let m=!1;c&&d?c.data.isEqual(d.data)?u!==h&&(s.track({type:3,doc:d}),m=!0):this.su(c,d)||(s.track({type:2,doc:d}),m=!0,(o&&this.eu(d,o)>0||l&&this.eu(d,l)<0)&&(a=!0)):!c&&d?(s.track({type:0,doc:d}),m=!0):c&&!d&&(s.track({type:1,doc:c}),m=!0,(o||l)&&(a=!0)),m&&(d?(i=i.add(d),n=h?n.add(e):n.delete(e)):(i=i.delete(e),n=n.delete(e)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),n=n.delete(e.key),s.track({type:1,doc:e})}return{tu:i,iu:s,Cs:a,mutatedKeys:n}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const n=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort((e,t)=>function(e,t){const s=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oc(20277,{Rt:e})}};return s(e)-s(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(s),r=null!=r&&r;const a=t&&!r?this._u():[],o=0===this.Xa.size&&this.current&&!r?1:0,l=o!==this.Za;return this.Za=o,0!==i.length||l?{snapshot:new Wf(this.query,e.tu,n,i,e.mutatedKeys,0===o,l,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Gf,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=kh(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new ag(e))}),this.Xa.forEach(s=>{e.has(s)||t.push(new ig(s))}),t}cu(e){this.Ya=e.Qs,this.Xa=kh();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Wf.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const lg="SyncEngine";class cg{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class dg{constructor(e){this.key=e,this.hu=!1}}class ug{constructor(e,t,s,r,n,i){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=n,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new ph(e=>ch(e),lh),this.Iu=new Map,this.Eu=new Set,this.du=new Od(ld.comparator),this.Au=new Map,this.Ru=new Np,this.Vu={},this.mu=new Map,this.fu=dp.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}function hg(e,t,s=!0){return p(this,null,function*(){const r=Pg(e);let n;const i=r.Tu.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),n=i.view.lu()):n=yield pg(r,t,s,!0),n})}function mg(e,t){return p(this,null,function*(){const s=Pg(e);yield pg(s,t,!0,!1)})}function pg(e,t,s,r){return p(this,null,function*(){const n=yield function(e,t){const s=Fc(e);return s.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return s.Pi.getTargetData(e,t).next(n=>n?(r=n,Sd.resolve(r)):s.Pi.allocateTargetId(e).next(n=>(r=new sp(t,n,"TargetPurposeListen",e.currentSequenceNumber),s.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=s.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(s.Ms=s.Ms.insert(e.targetId,e),s.xs.set(t,e.targetId)),e})}(e.localStore,ih(t)),i=n.targetId,a=e.sharedClientState.addLocalQueryTarget(i,s);let o;return r&&(o=yield function(e,t,s,r,n){return p(this,null,function*(){e.pu=(t,s,r)=>function(e,t,s,r){return p(this,null,function*(){let n=t.view.ru(s);n.Cs&&(n=yield $p(e.localStore,t.query,!1).then(({documents:e})=>t.view.ru(e,n)));const i=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(n,e.isPrimaryClient,i,a);return Eg(e,t.targetId,o.au),o.snapshot})}(e,t,s,r);const i=yield $p(e.localStore,t,!0),a=new og(t,i.Qs),o=a.ru(i.documents),l=vm.createSynthesizedTargetChangeForCurrentChange(s,r&&"Offline"!==e.onlineState,n),c=a.applyChanges(o,e.isPrimaryClient,l);Eg(e,s,c.au);const d=new cg(t,s,a);return e.Tu.set(t,d),e.Iu.has(s)?e.Iu.get(s).push(t):e.Iu.set(s,[t]),c.snapshot})}(e,t,i,"current"===a,n.resumeToken)),e.isPrimaryClient&&s&&xf(e.remoteStore,n),o})}function fg(e,t,s){return p(this,null,function*(){const r=Fc(e),n=r.Tu.get(t),i=r.Iu.get(n.targetId);if(i.length>1)return r.Iu.set(n.targetId,i.filter(e=>!lh(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(n.targetId),r.sharedClientState.isActiveQueryTarget(n.targetId)||(yield zp(r.localStore,n.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(n.targetId),s&&vf(r.remoteStore,n.targetId),kg(r,n.targetId)}).catch(kd))):(kg(r,n.targetId),yield zp(r.localStore,n.targetId,!0))})}function gg(e,t){return p(this,null,function*(){const s=Fc(e),r=s.Tu.get(t),n=s.Iu.get(r.targetId);s.isPrimaryClient&&1===n.length&&(s.sharedClientState.removeLocalQueryTarget(r.targetId),vf(s.remoteStore,r.targetId))})}function xg(e,t,s){return p(this,null,function*(){const r=function(e){const t=Fc(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=yg.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ng.bind(null,t),t}(e);try{const e=yield function(e,t){const s=Fc(e),r=bd.now(),n=t.reduce((e,t)=>e.add(t.key),kh());let i,a;return s.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=gh(),l=kh();return s.Ns.getEntries(e,n).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>s.localDocuments.getOverlayedDocuments(e,o)).next(n=>{i=n;const a=[];for(const e of t){const t=Jh(e,i.get(e.key).overlayedDocument);null!=t&&a.push(new Zh(e.key,t,Su(t.value.mapValue),qh.exists(!0)))}return s.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(i,l);return s.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:bh(i)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,s){let r=e.Vu[e.currentUser.toKey()];r||(r=new Od(Zc)),r=r.insert(t,s),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,s),yield Ig(r,e.changes),yield Af(r.remoteStore)}catch(n){const e=qf(n,"Failed to persist write");s.reject(e)}})}function vg(e,t){return p(this,null,function*(){const s=Fc(e);try{const e=yield Fp(s.localStore,t);t.targetChanges.forEach((e,t)=>{const r=s.Au.get(t);r&&(Uc(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?Uc(r.hu,14607):e.removedDocuments.size>0&&(Uc(r.hu,42227),r.hu=!1))}),yield Ig(s,e,t)}catch(r){yield kd(r)}})}function bg(e,t,s){const r=Fc(e);if(r.isPrimaryClient&&0===s||!r.isPrimaryClient&&1===s){const e=[];r.Tu.forEach((s,r)=>{const n=r.view.va(t);n.snapshot&&e.push(n.snapshot)}),function(e,t){const s=Fc(e);s.onlineState=t;let r=!1;s.queries.forEach((e,s)=>{for(const n of s.Sa)n.va(t)&&(r=!0)}),r&&tg(s)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function wg(e,t,s){return p(this,null,function*(){const r=Fc(e);r.sharedClientState.updateQueryState(t,"rejected",s);const n=r.Au.get(t),i=n&&n.key;if(i){let e=new Od(ld.comparator);e=e.insert(i,Eu.newNoDocument(i,wd.min()));const s=kh().add(i),n=new xm(wd.min(),new Map,new Od(Zc),e,s);yield vg(r,n),r.du=r.du.remove(i),r.Au.delete(t),Tg(r)}else yield zp(r.localStore,t,!1).then(()=>kg(r,t,s)).catch(kd)})}function yg(e,t){return p(this,null,function*(){const s=Fc(e),r=t.batch.batchId;try{const e=yield function(e,t){const s=Fc(e);return s.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),n=s.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,s,r){const n=s.batch,i=n.keys();let a=Sd.resolve();return i.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const i=s.docVersions.get(e);Uc(null!==i,48541),t.version.compareTo(i)<0&&(n.applyToRemoteDocument(t,s),t.isValidDocument()&&(t.setReadTime(s.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,n))}(s,e,t,n).next(()=>n.apply(e)).next(()=>s.mutationQueue.performConsistencyCheck(e)).next(()=>s.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>s.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=kh();for(let s=0;s<e.mutationResults.length;++s)e.mutationResults[s].transformResults.length>0&&(t=t.add(e.batch.mutations[s].key));return t}(t))).next(()=>s.localDocuments.getDocuments(e,r))})}(s.localStore,t);Cg(s,r,null),jg(s,r),s.sharedClientState.updateMutationState(r,"acknowledged"),yield Ig(s,e)}catch(n){yield kd(n)}})}function Ng(e,t,s){return p(this,null,function*(){const r=Fc(e);try{const e=yield function(e,t){const s=Fc(e);return s.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return s.mutationQueue.lookupMutationBatch(e,t).next(t=>(Uc(null!==t,37113),r=t.keys(),s.mutationQueue.removeMutationBatch(e,t))).next(()=>s.mutationQueue.performConsistencyCheck(e)).next(()=>s.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>s.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>s.localDocuments.getDocuments(e,r))})}(r.localStore,t);Cg(r,t,s),jg(r,t),r.sharedClientState.updateMutationState(t,"rejected",s),yield Ig(r,e)}catch(n){yield kd(n)}})}function jg(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function Cg(e,t,s){const r=Fc(e);let n=r.Vu[r.currentUser.toKey()];if(n){const e=n.get(t);e&&(s?e.reject(s):e.resolve(),n=n.remove(t)),r.Vu[r.currentUser.toKey()]=n}}function kg(e,t,s=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),s&&e.Pu.yu(r,s);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Sg(e,t)})}function Sg(e,t){e.Eu.delete(t.path.canonicalString());const s=e.du.get(t);null!==s&&(vf(e.remoteStore,s),e.du=e.du.remove(t),e.Au.delete(s),Tg(e))}function Eg(e,t,s){for(const r of s)r instanceof ig?(e.Ru.addReference(r.key,t),_g(e,r)):r instanceof ag?(Dc(lg,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Sg(e,r.key)):Oc(19791,{wu:r})}function _g(e,t){const s=t.key,r=s.path.canonicalString();e.du.get(s)||e.Eu.has(r)||(Dc(lg,"New document in limbo: "+s),e.Eu.add(r),Tg(e))}function Tg(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const s=new ld(id.fromString(t)),r=e.fu.next();e.Au.set(r,new dg(s)),e.du=e.du.insert(s,r),xf(e.remoteStore,new sp(ih(th(s.path)),r,"TargetPurposeLimboResolution",_d.ce))}}function Ig(e,t,s){return p(this,null,function*(){const r=Fc(e),n=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((e,o)=>{a.push(r.pu(o,t,s).then(e=>{var t;if((e||s)&&r.isPrimaryClient){const n=e?!e.fromCache:null==(t=null==s?void 0:s.targetChanges.get(o.targetId))?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,n?"current":"not-current")}if(e){n.push(e);const t=Dp.As(o.targetId,e);i.push(t)}}))}),yield Promise.all(a),r.Pu.H_(n),yield function(e,t){return p(this,null,function*(){const s=Fc(e);try{yield s.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Sd.forEach(t,t=>Sd.forEach(t.Es,r=>s.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Sd.forEach(t.ds,r=>s.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(r){if(!Ed(r))throw r;Dc(Lp,"Failed to update sequence numbers: "+r)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=s.Ms.get(t),r=e.snapshotVersion,n=e.withLastLimboFreeSnapshotVersion(r);s.Ms=s.Ms.insert(t,n)}}})}(r.localStore,i))})}function Ag(e,t){return p(this,null,function*(){const s=Fc(e);if(!s.currentUser.isEqual(t)){Dc(lg,"User change. New user:",t.toKey());const e=yield Mp(s.localStore,t);s.currentUser=t,n="'waitForPendingWrites' promise is rejected due to a user change.",(r=s).mu.forEach(e=>{e.forEach(e=>{e.reject(new zc(Vc.CANCELLED,n))})}),r.mu.clear(),s.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),yield Ig(s,e.Ls)}var r,n})}function Dg(e,t){const s=Fc(e),r=s.Au.get(t);if(r&&r.hu)return kh().add(r.key);{let e=kh();const r=s.Iu.get(t);if(!r)return e;for(const t of r){const r=s.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Pg(e){const t=Fc(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=vg.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Dg.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=wg.bind(null,t),t.Pu.H_=Zf.bind(null,t.eventManager),t.Pu.yu=eg.bind(null,t.eventManager),t}class Rg{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(e){return p(this,null,function*(){this.serializer=rf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),yield this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)})}Fu(e,t){return null}Mu(e,t){return null}vu(e){return function(e,t,s,r){return new Op(e,t,s,r)}(this.persistence,new Rp,e.initialUser,this.serializer)}Cu(e){return new _p(Ip.mi,this.serializer)}Du(e){return new qp}terminate(){return p(this,null,function*(){var e,t;null==(e=this.gcScheduler)||e.stop(),null==(t=this.indexBackfillerScheduler)||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}Rg.provider={build:()=>new Rg};class Lg extends Rg{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Uc(this.persistence.referenceDelegate instanceof Ap,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new pp(s,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?cp.withCacheSize(this.cacheSizeBytes):cp.DEFAULT;return new _p(e=>Ap.mi(e,t),this.serializer)}}class Og{initialize(e,t){return p(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>bg(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ag.bind(null,this.syncEngine),yield function(e,t){return p(this,null,function*(){const s=Fc(e);t?(s.Ea.delete(2),yield ff(s)):t||(s.Ea.add(2),yield gf(s),s.Ra.set("Unknown"))})}(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return new Qf}createDatastore(e){const t=rf(e.databaseInfo.databaseId),s=(r=e.databaseInfo,new tf(r));var r;return function(e,t,s,r){return new uf(e,t,s,r)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return t=this.localStore,s=this.datastore,r=e.asyncQueue,n=e=>bg(this.syncEngine,e,0),i=Wp.v()?new Wp:new Hp,new pf(t,s,r,n,i);var t,s,r,n,i}createSyncEngine(e,t){return function(e,t,s,r,n,i,a){const o=new ug(e,t,s,r,n,i);return a&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return p(this,null,function*(){var e,t;yield function(e){return p(this,null,function*(){const t=Fc(e);Dc(mf,"RemoteStore shutting down."),t.Ea.add(5),yield gf(t),t.Aa.shutdown(),t.Ra.set("Unknown")})}(this.remoteStore),null==(e=this.datastore)||e.terminate(),null==(t=this.eventManager)||t.terminate()})}}Og.provider={build:()=>new Og};
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Mg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Pc("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ug="FirestoreClient";class Fg{constructor(e,t,s,r,n){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=_c.UNAUTHENTICATED,this.clientId=Xc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=n,this.authCredentials.start(s,e=>p(this,null,function*(){Dc(Ug,"Received user=",e.uid),yield this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(s,e=>(Dc(Ug,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $c;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>p(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=qf(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}function Vg(e,t){return p(this,null,function*(){e.asyncQueue.verifyOperationInProgress(),Dc(Ug,"Initializing OfflineComponentProvider");const s=e.configuration;yield t.initialize(s);let r=s.initialUser;e.setCredentialChangeListener(e=>p(this,null,function*(){r.isEqual(e)||(yield Mp(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t})}function zg(e,t){return p(this,null,function*(){e.asyncQueue.verifyOperationInProgress();const s=yield function(e){return p(this,null,function*(){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Dc(Ug,"Using user provided OfflineComponentProvider");try{yield Vg(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!("FirebaseError"===(s=n).name?s.code===Vc.FAILED_PRECONDITION||s.code===Vc.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&s instanceof DOMException)||22===s.code||20===s.code||11===s.code))throw n;Rc("Error using user provided cache. Falling back to memory cache: "+n),yield Vg(e,new Rg)}}else Dc(Ug,"Using default OfflineComponentProvider"),yield Vg(e,new Lg(void 0));var s;return e._offlineComponents})}(e);Dc(Ug,"Initializing OnlineComponentProvider"),yield t.initialize(s,e.configuration),e.setCredentialChangeListener(e=>Vf(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,s)=>Vf(t.remoteStore,s)),e._onlineComponents=t})}function $g(e){return p(this,null,function*(){return e._onlineComponents||(e._uninitializedComponentsProvider?(Dc(Ug,"Using user provided OnlineComponentProvider"),yield zg(e,e._uninitializedComponentsProvider._online)):(Dc(Ug,"Using default OnlineComponentProvider"),yield zg(e,new Og))),e._onlineComponents})}function Bg(e){return p(this,null,function*(){const t=yield $g(e),s=t.eventManager;return s.onListen=hg.bind(null,t.syncEngine),s.onUnlisten=fg.bind(null,t.syncEngine),s.onFirstRemoteStoreListen=mg.bind(null,t.syncEngine),s.onLastRemoteStoreUnlisten=gg.bind(null,t.syncEngine),s})}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function qg(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const Hg=new Map,Gg="firestore.googleapis.com",Wg=!0;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Kg{constructor(e){var t,s;if(void 0===e.host){if(void 0!==e.ssl)throw new zc(Vc.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Gg,this.ssl=Wg}else this.host=e.host,this.ssl=null!=(t=e.ssl)?t:Wg;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=lp;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new zc(Vc.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,s,r){if(!0===t&&!0===r)throw new zc(Vc.INVALID_ARGUMENT,`${e} and ${s} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qg(null!=(s=e.experimentalLongPollingOptions)?s:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new zc(Vc.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new zc(Vc.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new zc(Vc.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,s=e.experimentalLongPollingOptions,t.timeoutSeconds===s.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,s}}class Qg{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Kg({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new zc(Vc.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new zc(Vc.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Kg(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new qc;switch(e.type){case"firstParty":return new Kc(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new zc(Vc.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return p(this,null,function*(){"notTerminated"===this._terminateTask?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Hg.get(e);t&&(Dc("ComponentProvider","Removing Datastore"),Hg.delete(e),t.terminate())}(this),Promise.resolve()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Jg{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Jg(this.firestore,e,this._query)}}class Yg{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yg(this.firestore,e,this._key)}toJSON(){return{type:Yg._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(gd(t,Yg._jsonSchema))return new Yg(e,s||null,new ld(id.fromString(t.referencePath)))}}Yg._jsonSchemaVersion="firestore/documentReference/1.0",Yg._jsonSchema={type:fd("string",Yg._jsonSchemaVersion),referencePath:fd("string")};class Xg extends Jg{constructor(e,t,s){super(e,t,th(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yg(this.firestore,null,new ld(e))}withConverter(e){return new Xg(this.firestore,e,this._path)}}function Zg(e,t,...s){if(e=ir(e),cd("collection","path",t),e instanceof Qg){const r=id.fromString(t,...s);return ud(r),new Xg(e,null,r)}{if(!(e instanceof Yg||e instanceof Xg))throw new zc(Vc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(id.fromString(t,...s));return ud(r),new Xg(e.firestore,null,r)}}function ex(e,t,...s){if(e=ir(e),1===arguments.length&&(t=Xc.newId()),cd("doc","path",t),e instanceof Qg){const r=id.fromString(t,...s);return dd(r),new Yg(e,null,new ld(r))}{if(!(e instanceof Yg||e instanceof Xg))throw new zc(Vc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(id.fromString(t,...s));return dd(r),new Yg(e.firestore,e instanceof Xg?e.converter:null,new ld(r))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const tx="AsyncQueue";class sx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new nf(this,"async_queue_retry"),this._c=()=>{const e=sf();e&&Dc(tx,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=sf();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=sf();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new $c;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}lc(){return p(this,null,function*(){if(0!==this.Xu.length){try{yield this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(xN){if(!Ed(xN))throw xN;Dc(tx,"Operation failed with retryable error: "+xN)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}})}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,Pc("INTERNAL UNHANDLED ERROR: ",rx(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Bf.createAndSchedule(this,e,t,s,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&Oc(47125,{Pc:rx(this.nc)})}verifyOperationInProgress(){}Tc(){return p(this,null,function*(){let e;do{e=this.ac,yield e}while(e!==this.ac)})}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function rx(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}function nx(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const s=e;for(const r of t)if(r in s&&"function"==typeof s[r])return!0;return!1}(e,["next","error","complete"])}class ix extends Qg{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new sx,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return p(this,null,function*(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sx(e),this._firestoreClient=void 0,yield e}})}}function ax(e){if(e._terminated)throw new zc(Vc.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){var t,s,r;const n=e._freezeSettings(),i=(a=e._databaseId,o=(null==(t=e._app)?void 0:t.options.appId)||"",l=e._persistenceKey,new tu(a,o,l,(c=n).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,qg(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator));var a,o,l,c;e._componentsProvider||(null==(s=n.localCache)?void 0:s._offlineComponentProvider)&&(null==(r=n.localCache)?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider}),e._firestoreClient=new Fg(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e),e._firestoreClient}class ox{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ox(Bd.fromBase64String(e))}catch(t){throw new zc(Vc.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ox(Bd.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ox._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gd(e,ox._jsonSchema))return ox.fromBase64String(e.bytes)}}ox._jsonSchemaVersion="firestore/bytes/1.0",ox._jsonSchema={type:fd("string",ox._jsonSchemaVersion),bytes:fd("string")};
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class lx{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new zc(Vc.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new od(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class cx{constructor(e){this._methodName=e}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class dx{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new zc(Vc.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new zc(Vc.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Zc(this._lat,e._lat)||Zc(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:dx._jsonSchemaVersion}}static fromJSON(e){if(gd(e,dx._jsonSchema))return new dx(e.latitude,e.longitude)}}dx._jsonSchemaVersion="firestore/geoPoint/1.0",dx._jsonSchema={type:fd("string",dx._jsonSchemaVersion),latitude:fd("number"),longitude:fd("number")};
/**
     * @license
     * Copyright 2024 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class ux{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let s=0;s<e.length;++s)if(e[s]!==t[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ux._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gd(e,ux._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new ux(e.vectorValues);throw new zc(Vc.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ux._jsonSchemaVersion="firestore/vectorValue/1.0",ux._jsonSchema={type:fd("string",ux._jsonSchemaVersion),vectorValues:fd("object")};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const hx=/^__.*__$/;class mx{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return null!==this.fieldMask?new Zh(e,this.data,this.fieldMask,t,this.fieldTransforms):new Xh(e,this.data,t,this.fieldTransforms)}}class px{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Zh(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fx(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oc(40011,{Ac:e})}}class gx{constructor(e,t,s,r,n,i){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,void 0===n&&this.Rc(),this.fieldTransforms=n||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new gx(d(d({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const s=null==(t=this.path)?void 0:t.child(e),r=this.Vc({path:s,fc:!1});return r.gc(e),r}yc(e){var t;const s=null==(t=this.path)?void 0:t.child(e),r=this.Vc({path:s,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Dx(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(fx(this.Ac)&&hx.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class xx{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||rf(e)}Cc(e,t,s,r=!1){return new gx({Ac:e,methodName:t,Dc:s,path:od.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function vx(e){const t=e._freezeSettings(),s=rf(e._databaseId);return new xx(e._databaseId,!!t.ignoreUndefinedProperties,s)}function bx(e,t,s,r,n,i={}){const a=e.Cc(i.merge||i.mergeFields?2:0,t,s,n);_x("Data must be an object, but it was:",a,r);const o=Sx(r,a);let l,c;if(i.merge)l=new zd(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const n=Tx(t,r,s);if(!a.contains(n))throw new zc(Vc.INVALID_ARGUMENT,`Field '${n}' is specified in your field mask but missing from your input data.`);Px(e,n)||e.push(n)}l=new zd(e),c=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=a.fieldTransforms;return new mx(new ku(o),l,c)}class wx extends cx{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wx}}class yx extends cx{_toFieldTransform(e){return new $h(e.path,new Rh)}isEqual(e){return e instanceof yx}}class Nx extends cx{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Fh(e.serializer,Th(e.serializer,this.Fc));return new $h(e.path,t)}isEqual(e){return e instanceof Nx&&this.Fc===e.Fc}}function jx(e,t,s,r){const n=e.Cc(1,t,s);_x("Data must be an object, but it was:",n,r);const i=[],a=ku.empty();Rd(r,(e,r)=>{const o=Ax(t,e,s);r=ir(r);const l=n.yc(o);if(r instanceof wx)i.push(o);else{const e=kx(r,l);null!=e&&(i.push(o),a.set(o,e))}});const o=new zd(i);return new px(a,o,n.fieldTransforms)}function Cx(e,t,s,r,n,i){const a=e.Cc(1,t,s),o=[Tx(t,r,s)],l=[n];if(i.length%2!=0)throw new zc(Vc.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)o.push(Tx(t,i[h])),l.push(i[h+1]);const c=[],d=ku.empty();for(let h=o.length-1;h>=0;--h)if(!Px(c,o[h])){const e=o[h];let t=l[h];t=ir(t);const s=a.yc(e);if(t instanceof wx)c.push(e);else{const r=kx(t,s);null!=r&&(c.push(e),d.set(e,r))}}const u=new zd(c);return new px(d,u,a.fieldTransforms)}function kx(e,t){if(Ex(e=ir(e)))return _x("Unsupported field value:",t,e),Sx(e,t);if(e instanceof cx)return function(e,t){if(!fx(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);const s=e._toFieldTransform(t);s&&t.fieldTransforms.push(s)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const s=[];let r=0;for(const n of e){let e=kx(n,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),s.push(e),r++}return{arrayValue:{values:s}}}(e,t)}return function(e,t){if(null===(e=ir(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Th(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const s=bd.fromDate(e);return{timestampValue:Am(t.serializer,s)}}if(e instanceof bd){const s=new bd(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Am(t.serializer,s)}}if(e instanceof dx)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof ox)return{bytesValue:Dm(t.serializer,e._byteString)};if(e instanceof Yg){const s=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(s))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Lm(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof ux)return s=e,r=t,{mapValue:{fields:{[nu]:{stringValue:ou},[lu]:{arrayValue:{values:s.toArray().map(e=>{if("number"!=typeof e)throw r.Sc("VectorValues must only contain numeric values.");return Eh(r.serializer,e)})}}}}};var s,r;throw t.Sc(`Unsupported field value: ${md(e)}`)}(e,t)}function Sx(e,t){const s={};return Ld(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Rd(e,(e,r)=>{const n=kx(r,t.mc(e));null!=n&&(s[e]=n)}),{mapValue:{fields:s}}}function Ex(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof bd||e instanceof dx||e instanceof ox||e instanceof Yg||e instanceof cx||e instanceof ux)}function _x(e,t,s){if(!Ex(s)||!hd(s)){const r=md(s);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function Tx(e,t,s){if((t=ir(t))instanceof lx)return t._internalPath;if("string"==typeof t)return Ax(e,t);throw Dx("Field path arguments must be of type string or ",e,!1,void 0,s)}const Ix=new RegExp("[~\\*/\\[\\]]");function Ax(e,t,s){if(t.search(Ix)>=0)throw Dx(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,s);try{return new lx(...t.split("."))._internalPath}catch(r){throw Dx(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,s)}}function Dx(e,t,s,r,n){const i=r&&!r.isEmpty(),a=void 0!==n;let o=`Function ${t}() called with invalid data`;s&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${n}`),l+=")"),new zc(Vc.INVALID_ARGUMENT,o+e+l)}function Px(e,t){return e.some(e=>e.isEqual(t))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Rx{constructor(e,t,s,r,n){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=n}get id(){return this._key.path.lastSegment()}get ref(){return new Yg(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Lx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ox("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Lx extends Rx{data(){return super.data()}}function Ox(e,t){return"string"==typeof t?Ax(e,t):t instanceof lx?t._internalPath:t._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Mx(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new zc(Vc.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ux{}class Fx extends Ux{}function Vx(e,t,...s){let r=[];t instanceof Ux&&r.push(t),r=r.concat(s),function(e){const t=e.filter(e=>e instanceof Bx).length,s=e.filter(e=>e instanceof zx).length;if(t>1||t>0&&s>0)throw new zc(Vc.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const n of r)e=n._apply(e);return e}class zx extends Fx{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new zx(e,t,s)}_apply(e){const t=this._parse(e);return Jx(e._query,t),new Jg(e.firestore,e.converter,ah(e._query,t))}_parse(e){const t=vx(e.firestore),s=function(e,t,s,r,n,i,a){let o;if(n.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new zc(Vc.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){Qx(a,i);const t=[];for(const s of a)t.push(Kx(r,e,s));o={arrayValue:{values:t}}}else o=Kx(r,e,a)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Qx(a,i),o=function(e,t,s,r=!1){return kx(s,e.Cc(r?4:3,t))}(s,t,a,"in"===i||"not-in"===i);return Ru.create(n,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return s}}function $x(e,t,s){const r=t,n=Ox("where",e);return zx._create(n,r,s)}class Bx extends Ux{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Bx(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Lu.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let s=e;const r=t.getFlattenedFilters();for(const n of r)Jx(s,n),s=ah(s,n)}(e._query,t),new Jg(e.firestore,e.converter,ah(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class qx extends Fx{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new qx(e,t)}_apply(e){const t=function(e,t,s){if(null!==e.startAt)throw new zc(Vc.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new zc(Vc.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Au(t,s)}(e._query,this._field,this._direction);return new Jg(e.firestore,e.converter,function(e,t){const s=e.explicitOrderBy.concat([t]);return new eh(e.path,e.collectionGroup,s,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Hx(e,t="asc"){const s=t,r=Ox("orderBy",e);return qx._create(r,s)}class Gx extends Fx{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new Gx(e,t,s)}_apply(e){return new Jg(e.firestore,e.converter,oh(e._query,this._limit,this._limitType))}}function Wx(e){return function(e,t){if(t<=0)throw new zc(Vc.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}("limit",e),Gx._create("limit",e,"F")}function Kx(e,t,s){if("string"==typeof(s=ir(s))){if(""===s)throw new zc(Vc.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rh(t)&&-1!==s.indexOf("/"))throw new zc(Vc.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${s}' contains a '/' character.`);const r=t.path.child(id.fromString(s));if(!ld.isDocumentKey(r))throw new zc(Vc.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vu(e,new ld(r))}if(s instanceof Yg)return vu(e,s._key);throw new zc(Vc.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${md(s)}.`)}function Qx(e,t){if(!Array.isArray(e)||0===e.length)throw new zc(Vc.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Jx(e,t){const s=function(e,t){for(const s of e)for(const e of s.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==s)throw s===t.op?new zc(Vc.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new zc(Vc.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${s.toString()}' filters.`)}class Yx{convertValue(e,t="none"){switch(cu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gd(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wd(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Oc(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Rd(e,(e,r)=>{s[e]=this.convertValue(r,t)}),s}convertVectorValue(e){var t,s,r;const n=null==(r=null==(s=null==(t=e.fields)?void 0:t[lu].arrayValue)?void 0:s.values)?void 0:r.map(e=>Gd(e.doubleValue));return new ux(n)}convertGeoPoint(e){return new dx(Gd(e.latitude),Gd(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Zd(e);return null==s?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(eu(e));default:return null}}convertTimestamp(e){const t=Hd(e);return new bd(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=id.fromString(e);Uc(tp(s),9688,{name:e});const r=new ru(s.get(1),s.get(3)),n=new ld(s.popFirst(5));return r.isEqual(t)||Pc(`Document ${n} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),n}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xx(e,t,s){let r;return r=e?s&&(s.merge||s.mergeFields)?e.toFirestore(t,s):e.toFirestore(t):t,r}class Zx{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ev extends Rx{constructor(e,t,s,r,n,i){super(e,t,s,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=n}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new tv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Ox("DocumentSnapshot.get",e));if(null!==s)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new zc(Vc.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ev._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}ev._jsonSchemaVersion="firestore/documentSnapshot/1.0",ev._jsonSchema={type:fd("string",ev._jsonSchemaVersion),bundleSource:fd("string","DocumentSnapshot"),bundleName:fd("string"),bundle:fd("string")};class tv extends ev{data(e={}){return super.data(e)}}class sv{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Zx(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new tv(this._firestore,this._userDataWriter,s.key,s,new Zx(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new zc(Vc.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(s=>{const r=new tv(e._firestore,e._userDataWriter,s.doc.key,s.doc,new Zx(e._snapshot.mutatedKeys.has(s.doc.key),e._snapshot.fromCache),e.query.converter);return s.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let s=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new tv(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Zx(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let n=-1,i=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(s=s.add(t.doc),i=s.indexOf(t.doc.key)),{type:rv(t.type),doc:r,oldIndex:n,newIndex:i}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new zc(Vc.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=sv._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Xc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),s.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rv(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Oc(61501,{type:e})}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function nv(e){e=pd(e,Yg);const t=pd(e.firestore,ix);return function(e,t,s={}){const r=new $c;return e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return function(e,t,s,r,n){const i=new Mg({next:o=>{i.Nu(),t.enqueueAndForget(()=>Xf(e,a));const l=o.docs.has(s);!l&&o.fromCache?n.reject(new zc(Vc.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?n.reject(new zc(Vc.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):n.resolve(o)},error:e=>n.reject(e)}),a=new ng(th(s.path),i,{includeMetadataChanges:!0,qa:!0});return Yf(e,a)}(yield Bg(e),e.asyncQueue,t,s,r)})),r.promise}(ax(t),e._key).then(s=>mv(t,e,s))}sv._jsonSchemaVersion="firestore/querySnapshot/1.0",sv._jsonSchema={type:fd("string",sv._jsonSchemaVersion),bundleSource:fd("string","QuerySnapshot"),bundleName:fd("string"),bundle:fd("string")};class iv extends Yx{constructor(e){super(),this.firestore=e}convertBytes(e){return new ox(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yg(this.firestore,null,t)}}function av(e){e=pd(e,Jg);const t=pd(e.firestore,ix),s=ax(t),r=new iv(t);return Mx(e._query),function(e,t,s={}){const r=new $c;return e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return function(e,t,s,r,n){const i=new Mg({next:s=>{i.Nu(),t.enqueueAndForget(()=>Xf(e,a)),s.fromCache&&"server"===r.source?n.reject(new zc(Vc.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):n.resolve(s)},error:e=>n.reject(e)}),a=new ng(s,i,{includeMetadataChanges:!0,qa:!0});return Yf(e,a)}(yield Bg(e),e.asyncQueue,t,s,r)})),r.promise}(s,e._query).then(s=>new sv(t,r,e,s))}function ov(e,t,s){e=pd(e,Yg);const r=pd(e.firestore,ix),n=Xx(e.converter,t,s);return hv(r,[bx(vx(r),"setDoc",e._key,n,null!==e.converter,s).toMutation(e._key,qh.none())])}function lv(e,t,s,...r){e=pd(e,Yg);const n=pd(e.firestore,ix),i=vx(n);let a;return a="string"==typeof(t=ir(t))||t instanceof lx?Cx(i,"updateDoc",e._key,t,s,r):jx(i,"updateDoc",e._key,t),hv(n,[a.toMutation(e._key,qh.exists(!0))])}function cv(e){return hv(pd(e.firestore,ix),[new rm(e._key,qh.none())])}function dv(e,t){const s=pd(e.firestore,ix),r=ex(e),n=Xx(e.converter,t);return hv(s,[bx(vx(e.firestore),"addDoc",r._key,n,null!==e.converter,{}).toMutation(r._key,qh.exists(!1))]).then(()=>r)}function uv(e,...t){var s,r,n;e=ir(e);let i={includeMetadataChanges:!1,source:"default"},a=0;"object"!=typeof t[a]||nx(t[a])||(i=t[a++]);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(nx(t[a])){const e=t[a];t[a]=null==(s=e.next)?void 0:s.bind(e),t[a+1]=null==(r=e.error)?void 0:r.bind(e),t[a+2]=null==(n=e.complete)?void 0:n.bind(e)}let l,c,d;if(e instanceof Yg)c=pd(e.firestore,ix),d=th(e._key.path),l={next:s=>{t[a]&&t[a](mv(c,e,s))},error:t[a+1],complete:t[a+2]};else{const s=pd(e,Jg);c=pd(s.firestore,ix),d=s._query;const r=new iv(c);l={next:e=>{t[a]&&t[a](new sv(c,r,s,e))},error:t[a+1],complete:t[a+2]},Mx(e._query)}return function(e,t,s,r){const n=new Mg(r),i=new ng(t,n,s);return e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return Yf(yield Bg(e),i)})),()=>{n.Nu(),e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return Xf(yield Bg(e),i)}))}}(ax(c),d,o,l)}function hv(e,t){return function(e,t){const s=new $c;return e.asyncQueue.enqueueAndForget(()=>p(this,null,function*(){return xg(yield function(e){return $g(e).then(e=>e.syncEngine)}(e),t,s)})),s.promise}(ax(e),t)}function mv(e,t,s){const r=s.docs.get(t._key),n=new iv(e);return new ev(e,n,t._key,r,new Zx(s.hasPendingWrites,s.fromCache),t.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class pv{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=vx(e)}set(e,t,s){this._verifyNotCommitted();const r=fv(e,this._firestore),n=Xx(r.converter,t,s),i=bx(this._dataReader,"WriteBatch.set",r._key,n,null!==r.converter,s);return this._mutations.push(i.toMutation(r._key,qh.none())),this}update(e,t,s,...r){this._verifyNotCommitted();const n=fv(e,this._firestore);let i;return i="string"==typeof(t=ir(t))||t instanceof lx?Cx(this._dataReader,"WriteBatch.update",n._key,t,s,r):jx(this._dataReader,"WriteBatch.update",n._key,t),this._mutations.push(i.toMutation(n._key,qh.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=fv(e,this._firestore);return this._mutations=this._mutations.concat(new rm(t._key,qh.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new zc(Vc.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function fv(e,t){if((e=ir(e)).firestore!==t)throw new zc(Vc.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function gv(){return new yx("serverTimestamp")}function xv(e){return new Nx("increment",e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vv(e){return ax(e=pd(e,ix)),new pv(e,t=>hv(e,t))}!function(e,t=!0){Tc=jn,vn(new ar("firestore",(e,{instanceIdentifier:s,options:r})=>{const n=e.getProvider("app").getImmediate(),i=new ix(new Gc(e.getProvider("auth-internal")),new Jc(n,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new zc(Vc.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ru(e.options.projectId,t)}(n,s),n);return r=d({useFetchStreams:t},r),i._setSettings(r),i},"PUBLIC").setMultipleInstances(!0)),Sn(Sc,Ec,e),Sn(Sc,Ec,"esm2020")}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const bv="firebasestorage.googleapis.com",wv="storageBucket";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class yv extends Ks{constructor(e,t,s=0){super(Sv(e),`Firebase Storage: ${t} (${Sv(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,yv.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Sv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var Nv,jv,Cv,kv;function Sv(e){return"storage/"+e}function Ev(){return new yv(Nv.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function _v(e){return new yv(Nv.INVALID_ARGUMENT,e)}function Tv(){return new yv(Nv.APP_DELETED,"The Firebase app was deleted.")}function Iv(e){return new yv(Nv.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Av(e,t){return new yv(Nv.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function Dv(e){throw new yv(Nv.INTERNAL_ERROR,"Internal error: "+e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(jv=Nv||(Nv={})).UNKNOWN="unknown",jv.OBJECT_NOT_FOUND="object-not-found",jv.BUCKET_NOT_FOUND="bucket-not-found",jv.PROJECT_NOT_FOUND="project-not-found",jv.QUOTA_EXCEEDED="quota-exceeded",jv.UNAUTHENTICATED="unauthenticated",jv.UNAUTHORIZED="unauthorized",jv.UNAUTHORIZED_APP="unauthorized-app",jv.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",jv.INVALID_CHECKSUM="invalid-checksum",jv.CANCELED="canceled",jv.INVALID_EVENT_NAME="invalid-event-name",jv.INVALID_URL="invalid-url",jv.INVALID_DEFAULT_BUCKET="invalid-default-bucket",jv.NO_DEFAULT_BUCKET="no-default-bucket",jv.CANNOT_SLICE_BLOB="cannot-slice-blob",jv.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",jv.NO_DOWNLOAD_URL="no-download-url",jv.INVALID_ARGUMENT="invalid-argument",jv.INVALID_ARGUMENT_COUNT="invalid-argument-count",jv.APP_DELETED="app-deleted",jv.INVALID_ROOT_OPERATION="invalid-root-operation",jv.INVALID_FORMAT="invalid-format",jv.INTERNAL_ERROR="internal-error",jv.UNSUPPORTED_ENVIRONMENT="unsupported-environment";class Pv{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Pv.makeFromUrl(e,t)}catch(xN){return new Pv(e,"")}if(""===s.path)return s;throw r=e,new yv(Nv.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let s=null;const r="([A-Za-z0-9.\\-_]+)",n=new RegExp("^gs://"+r+"(/(.*))?$","i");function i(e){e.path_=decodeURIComponent(e.path)}const a=t.replace(/[.]/g,"\\."),o=[{regex:n,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp(`^https?://${t===bv?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:i}];for(let l=0;l<o.length;l++){const t=o[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let n=r[t.indices.path];n||(n=""),s=new Pv(e,n),t.postModify(s);break}}if(null==s)throw function(e){return new yv(Nv.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return s}}class Rv{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Lv(e){return"string"==typeof e||e instanceof String}function Ov(e){return Mv()&&e instanceof Blob}function Mv(){return"undefined"!=typeof Blob}function Uv(e,t,s,r){if(r<t)throw _v(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>s)throw _v(`Invalid value for '${e}'. Expected ${s} or less.`)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fv(e,t,s){let r=t;return null==s&&(r=`https://${t}`),`${s}://${r}/v0${e}`}function Vv(e){const t=encodeURIComponent;let s="?";for(const r in e)e.hasOwnProperty(r)&&(s=s+(t(r)+"=")+t(e[r])+"&");return s=s.slice(0,-1),s}(kv=Cv||(Cv={}))[kv.NO_ERROR=0]="NO_ERROR",kv[kv.NETWORK_ERROR=1]="NETWORK_ERROR",kv[kv.ABORT=2]="ABORT";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class zv{constructor(e,t,s,r,n,i,a,o,l,c,d,u=!0,h=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=r,this.successCodes_=n,this.additionalRetryCodes_=i,this.callback_=a,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=d,this.retry=u,this.isUsingEmulator=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new $v(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const r=e=>{const t=e.loaded,s=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,s)};null!==this.progressCallback_&&s.addUploadProgressListener(r),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(r),this.pendingConnection_=null;const t=s.getErrorCode()===Cv.NO_ERROR,n=s.getStatus();if(!t||
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e,t){const s=e>=500&&e<600,r=-1!==[408,429].indexOf(e),n=-1!==t.indexOf(e);return s||r||n}(n,this.additionalRetryCodes_)&&this.retry){const t=s.getErrorCode()===Cv.ABORT;return void e(!1,new $v(!1,null,t))}const i=-1!==this.successCodes_.indexOf(n);e(!0,new $v(i,s))})},t=(e,t)=>{const s=this.resolve_,r=this.reject_,n=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(n,n.getResponse());!
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(e){return void 0!==e}(e)?s():s(e)}catch(xN){r(xN)}else if(null!==n){const e=Ev();e.serverResponse=n.getErrorText(),this.errorCallback_?r(this.errorCallback_(n,e)):r(e)}else t.canceled?r(this.appDelete_?Tv():new yv(Nv.CANCELED,"User canceled the upload/download.")):r(new yv(Nv.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?t(0,new $v(!1,null,!0)):this.backoffId_=function(e,t,s){let r=1,n=null,i=null,a=!1,o=0;function l(){return 2===o}let c=!1;function d(...e){c||(c=!0,t.apply(null,e))}function u(t){n=setTimeout(()=>{n=null,e(m,l())},t)}function h(){i&&clearTimeout(i)}function m(e,...t){if(c)return void h();if(e)return h(),void d.call(null,e,...t);if(l()||a)return h(),void d.call(null,e,...t);let s;r<64&&(r*=2),1===o?(o=2,s=0):s=1e3*(r+Math.random()),u(s)}let p=!1;function f(e){p||(p=!0,h(),c||(null!==n?(e||(o=2),clearTimeout(n),u(0)):e||(o=1)))}return u(0),i=setTimeout(()=>{a=!0,f(!0)},s),f}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class $v{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function Bv(...e){const t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==t){const s=new t;for(let t=0;t<e.length;t++)s.append(e[t]);return s.getBlob()}if(Mv())return new Blob(e);throw new yv(Nv.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function qv(e){if("undefined"==typeof atob)throw t="base-64",new yv(Nv.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);var t;return atob(e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Hv={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Gv{constructor(e,t){this.data=e,this.contentType=t||null}}function Wv(e,t){switch(e){case Hv.RAW:return new Gv(Kv(t));case Hv.BASE64:case Hv.BASE64URL:return new Gv(Qv(e,t));case Hv.DATA_URL:return new Gv(function(e){const t=new Jv(e);return t.base64?Qv(Hv.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(xN){throw Av(Hv.DATA_URL,"Malformed data URL.")}return Kv(t)}(t.rest)}(t),new Jv(t).contentType)}throw Ev()}function Kv(e){const t=[];for(let s=0;s<e.length;s++){let r=e.charCodeAt(s);r<=127?t.push(r):r<=2047?t.push(192|r>>6,128|63&r):55296==(64512&r)?s<e.length-1&&56320==(64512&e.charCodeAt(s+1))?(r=65536|(1023&r)<<10|1023&e.charCodeAt(++s),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):t.push(239,191,189):56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Qv(e,t){switch(e){case Hv.BASE64:{const s=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(s||r)throw Av(e,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Hv.BASE64URL:{const s=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(s||r)throw Av(e,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let s;try{s=qv(t)}catch(xN){if(xN.message.includes("polyfill"))throw xN;throw Av(e,"Invalid character found")}const r=new Uint8Array(s.length);for(let n=0;n<s.length;n++)r[n]=s.charCodeAt(n);return r}class Jv{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Av(Hv.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;var r,n;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */null!=s&&(this.base64=(n=";base64",(r=s).length>=n.length&&r.substring(r.length-n.length)===n),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}class Yv{constructor(e,t){let s=0,r="";Ov(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(Ov(this.data_)){const i=this.data_,a=(r=e,n=t,(s=i).webkitSlice?s.webkitSlice(r,n):s.mozSlice?s.mozSlice(r,n):s.slice?s.slice(r,n):null);return null===a?null:new Yv(a)}{const s=new Uint8Array(this.data_.buffer,e,t-e);return new Yv(s,!0)}var s,r,n}static getBlob(...e){if(Mv()){const t=e.map(e=>e instanceof Yv?e.data_:e);return new Yv(Bv.apply(null,t))}{const t=e.map(e=>Lv(e)?Wv(Hv.RAW,e).data:e.data_);let s=0;t.forEach(e=>{s+=e.byteLength});const r=new Uint8Array(s);let n=0;return t.forEach(e=>{for(let t=0;t<e.length;t++)r[n++]=e[t]}),new Yv(r,!0)}}uploadData(){return this.data_}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xv(e){let t;try{t=JSON.parse(e)}catch(xN){return null}return function(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zv(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function eb(e,t){return t}class tb{constructor(e,t,s,r){this.server=e,this.local=t||e,this.writable=!!s,this.xform=r||eb}}let sb=null;function rb(){if(sb)return sb;const e=[];e.push(new tb("bucket")),e.push(new tb("generation")),e.push(new tb("metageneration")),e.push(new tb("name","fullPath",!0));const t=new tb("name");t.xform=function(e,t){return function(e){return!Lv(e)||e.length<2?e:Zv(e)}(t)},e.push(t);const s=new tb("size");return s.xform=function(e,t){return void 0!==t?Number(t):t},e.push(s),e.push(new tb("timeCreated")),e.push(new tb("updated")),e.push(new tb("md5Hash",null,!0)),e.push(new tb("cacheControl",null,!0)),e.push(new tb("contentDisposition",null,!0)),e.push(new tb("contentEncoding",null,!0)),e.push(new tb("contentLanguage",null,!0)),e.push(new tb("contentType",null,!0)),e.push(new tb("metadata","customMetadata",!0)),sb=e,sb}function nb(e,t,s){const r={type:"file"},n=s.length;for(let i=0;i<n;i++){const e=s[i];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const s=e.bucket,r=e.fullPath,n=new Pv(s,r);return t._makeStorageReference(n)}})}(r,e),r}function ib(e,t,s){const r=Xv(t);return null===r?null:nb(e,r,s)}class ab{constructor(e,t,s,r){this.url=e,this.method=t,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ob(e){if(!e)throw Ev()}function lb(e,t){return function(s,r){const n=ib(e,r,t);return ob(null!==n),function(e,t,s,r){const n=Xv(t);if(null===n)return null;if(!Lv(n.downloadTokens))return null;const i=n.downloadTokens;if(0===i.length)return null;const a=encodeURIComponent;return i.split(",").map(t=>{const n=e.bucket,i=e.fullPath;return Fv("/b/"+a(n)+"/o/"+a(i),s,r)+Vv({alt:"media",token:t})})[0]}(n,r,e.host,e._protocol)}}function cb(e){return function(t,s){let r;var n,i;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new yv(Nv.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new yv(Nv.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new yv(Nv.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(n=e.path,r=new yv(Nv.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")):r=s,r.status=t.getStatus(),r.serverResponse=s.serverResponse,r}}function ub(e){const t=cb(e);return function(s,r){let n=t(s,r);var i;return 404===s.getStatus()&&(i=e.path,n=new yv(Nv.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),n.serverResponse=r.serverResponse,n}}function hb(e,t,s,r,n){const i=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},o=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+o;const l=function(e,t,s){const r=Object.assign({},s);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}(t,r,n),c=function(e,t){const s={},r=t.length;for(let n=0;n<r;n++){const r=t[n];r.writable&&(s[r.server]=e[r.local])}return JSON.stringify(s)}(l,s),d="--"+o+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+c+"\r\n--"+o+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",u="\r\n--"+o+"--",h=Yv.getBlob(d,r,u);if(null===h)throw new yv(Nv.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.");const m={name:l.fullPath},p=Fv(i,e.host,e._protocol),f=e.maxUploadRetryTime,g=new ab(p,"POST",function(e,t){return function(s,r){const n=ib(e,r,t);return ob(null!==n),n}}(e,s),f);return g.urlParams=m,g.headers=a,g.body=h.uploadData(),g.errorHandler=cb(t),g}class mb{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Cv.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Cv.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Cv.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,r,n){if(this.sent_)throw Dv("cannot .send() more than once");if(Ms(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==n)for(const i in n)n.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,n[i].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Dv("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Dv("cannot .getStatus() before sending");try{return this.xhr_.status}catch(xN){return-1}}getResponse(){if(!this.sent_)throw Dv("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Dv("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class pb extends mb{initXhr(){this.xhr_.responseType="text"}}function fb(){return new pb}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gb{constructor(e,t){this._service=e,this._location=t instanceof Pv?t:Pv.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new gb(e,t)}get root(){const e=new Pv(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Zv(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new Pv(this._location.bucket,e);return new gb(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw Iv(e)}}function xb(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,s){const r=Fv(t.fullServerUrl(),e.host,e._protocol),n=e.maxOperationRetryTime,i=new ab(r,"GET",lb(e,s),n);return i.errorHandler=ub(t),i}(e.storage,e._location,rb());return e.storage.makeRequestWithTokens(t,fb).then(e=>{if(null===e)throw new yv(Nv.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function vb(e){e._throwIfRoot("deleteObject");const t=function(e,t){const s=Fv(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,n=new ab(s,"DELETE",function(e,t){},r);return n.successCodes=[200,204],n.errorHandler=ub(t),n}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,fb)}function bb(e,t){if(e instanceof Nb){const s=e;if(null==s._bucket)throw new yv(Nv.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+wv+"' property when initializing the app?");const r=new gb(s,s._bucket);return null!=t?bb(r,t):r}return void 0!==t?function(e,t){const s=function(e,t){const s=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?s:e+"/"+s}(e._location.path,t),r=new Pv(e._location.bucket,s);return new gb(e.storage,r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,t):e}function wb(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Nb)return new gb(e,t);throw _v("To use ref(service, url), the first argument must be a Storage instance.")}return bb(e,t)}function yb(e,t){const s=null==t?void 0:t[wv];return null==s?null:Pv.makeFromBucketSpec(s,e)}class Nb{constructor(e,t,s,r,n,i=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=r,this._firebaseVersion=n,this._isUsingEmulator=i,this._bucket=null,this._host=bv,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Pv.makeFromBucketSpec(r,this._host):yb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Pv.makeFromBucketSpec(this._url,e):this._bucket=yb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Uv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Uv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return p(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=yield e.getToken();if(null!==t)return t.accessToken}return null})}_getAppCheckToken(){return p(this,null,function*(){if(wn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new gb(this,e)}_makeRequest(e,t,s,r,n=!0){if(this._deleted)return new Rv(Tv());{const i=function(e,t,s,r,n,i,a=!0,o=!1){const l=Vv(e.urlParams),c=e.url+l,d=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(d,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(d,s),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(d,i),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(d,r),new zv(c,e.method,d,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n,a,o)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(e,this._appId,s,r,t,this._firebaseVersion,n,this._isUsingEmulator);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}makeRequestWithTokens(e,t){return p(this,null,function*(){const[s,r]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,r).getPromise()})}}const jb="@firebase/storage",Cb="0.14.0",kb="storage";function Sb(e=kn(),t){const s=bn(e=ir(e),kb).getImmediate({identifier:t}),r=Ps("storage");return r&&Eb(s,...r),s}function Eb(e,t,s,r={}){!function(e,t,s,r={}){e.host=`${t}:${s}`;const n=Ms(t);n&&(Us(`https://${e.host}/b`),$s("Storage",!0)),e._isUsingEmulator=!0,e._protocol=n?"https":"http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"==typeof i?i:Fs(i,e.app.options.projectId))}(e,t,s,r)}function _b(e,{instanceIdentifier:t}){const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),n=e.getProvider("app-check-internal");return new Nb(s,r,n,t,jn)}vn(new ar(kb,_b,"PUBLIC").setMultipleInstances(!0)),Sn(jb,Cb,""),Sn(jb,Cb,"esm2020");const Tb=Object.freeze(Object.defineProperty({__proto__:null,StorageError:yv,get StorageErrorCode(){return Nv},StringFormat:Hv,_FbsBlob:Yv,_Location:Pv,_dataFromString:Wv,_invalidArgument:_v,_invalidRootOperation:Iv,connectStorageEmulator:Eb,deleteObject:function(e){return vb(e=ir(e))},getDownloadURL:function(e){return xb(e=ir(e))},getStorage:Sb,ref:function(e,t){return wb(e=ir(e),t)},uploadBytes:function(e,t,s){return function(e,t,s){e._throwIfRoot("uploadBytes");const r=hb(e.storage,e._location,rb(),new Yv(t,!0),s);return e.storage.makeRequestWithTokens(r,fb).then(t=>({metadata:t,ref:e}))}(e=ir(e),t,s)}},Symbol.toStringTag,{value:"Module"}));
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Sn("firebase","12.1.0","app");const Ib={apiKey:"AIzaSyDkPhYGNEdBtRdEeWwHCWfCFtLWqmGBTO8",authDomain:"hackathon-8b0e1.firebaseapp.com",projectId:"hackathon-8b0e1",storageBucket:"hackathon-8b0e1.firebasestorage.app",messagingSenderId:"523976123580",appId:"1:523976123580:web:1f781a5403c7aa6540dcb9",measurementId:"G-GQHD2SXYJ2"},Ab=Cn(Ib);let Db;if("undefined"!=typeof window&&Ib.measurementId)try{Db=function(e=kn()){const t=bn(e=ir(e),ji);return t.isInitialized()?t.getImmediate():function(e,t={}){const s=bn(e,ji);if(s.isInitialized()){const e=s.getImmediate();if(Ys(t,s.getOptions()))return e;throw Si.create("already-initialized")}return s.initialize({options:t})}(e)}(Ab)}catch(vN){}const Pb=uc(Ab),Rb=new Mo,Lb=function(e){const t="object"==typeof e?e:kn(),s="string"==typeof e?e:su,r=bn(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const e=Ps("firestore");e&&function(e,t,s,r={}){var n;e=pd(e,Qg);const i=Ms(t),a=e._getSettings(),o=u(d({},a),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${s}`;i&&(Us(`https://${l}`),$s("Firestore",!0)),a.host!==Gg&&a.host!==l&&Rc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=u(d({},a),{host:l,ssl:i,emulatorOptions:r});if(!Ys(c,o)&&(e._setSettings(c),r.mockUserToken)){let t,s;if("string"==typeof r.mockUserToken)t=r.mockUserToken,s=_c.MOCK_USER;else{t=Fs(r.mockUserToken,null==(n=e._app)?void 0:n.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new zc(Vc.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new _c(i)}e._authCredentials=new Hc(new Bc(t,s))}}(r,...e)}return r}(Ab),Ob=Sb(Ab),Mb=Object.freeze(Object.defineProperty({__proto__:null,auth:Pb,db:Lb,googleProvider:Rb,signInWithEmailAndPassword:Qo,storage:Ob},Symbol.toStringTag,{value:"Module"})),Ub=f.createContext(),Fb=({children:t})=>{const[s,r]=f.useState(null),[n,i]=f.useState(!0),[a,o]=f.useState(null),[l,c]=f.useState(!1),[h,m]=f.useState(!1);f.useEffect(()=>{const t=Pb.onAuthStateChanged(t=>p(e,null,function*(){i(!0),o(null);try{if(t){const e=yield t.getIdToken(),s=ex(Lb,"users",t.uid),n=yield nv(s),i=n.exists()?n.data():{};i.username&&i.phone&&i.birthDate||m(!0),r(u(d({},t),{role:i.role||"cliente",displayName:i.displayName||t.displayName,profileData:i,idToken:e})),localStorage.getItem(`tour-${t.uid}`)||c(!0)}else r(null),c(!1),m(!1)}catch(e){o("Erro ao carregar dados do usuário"),r(t)}finally{i(!1)}}));return()=>t()},[]);const g={user:s,loading:n,error:a,isAuthenticated:!!s,isAdmin:"admin"===(null==s?void 0:s.role),isPsychologist:"psicologo"===(null==s?void 0:s.role),isClient:"cliente"===(null==s?void 0:s.role),isFirstTime:l,needsProfileCompletion:h,markTourAsSeen:()=>p(e,null,function*(){if(s){localStorage.setItem(`tour-${s.uid}`,"true"),c(!1);try{const e=ex(Lb,"users",s.uid);yield ov(e,{hasSeenTour:!0},{merge:!0})}catch(e){}}}),markProfileAsComplete:()=>p(e,null,function*(){if(s){m(!1);try{const e=ex(Lb,"users",s.uid),t=yield nv(e);if(t.exists()){const e=t.data();r(t=>u(d({},t),{profileData:e}))}}catch(e){}}})};return Je.jsx(Ub.Provider,{value:g,children:t})},Vb=()=>{const e=f.useContext(Ub);if(!e)throw new Error("useAuth deve ser usado dentro de AuthProvider");return e},zb=x.memo(({scrolled:e,scrollToSection:t})=>{const[s,r]=f.useState(!1),[n,i]=f.useState(!1),[a,o]=f.useState(!1),l=Ot(),c=f.useRef(null),d=f.useRef(null);f.useEffect(()=>{o(!0)},[]);const u=f.useCallback(()=>{r(e=>!e),i(!1)},[]),h=f.useCallback(()=>{r(!1),i(!1)},[]),m=f.useMemo(()=>[{name:"Início",action:"home",id:"home"},{name:"Recursos",action:"services",id:"services"},{name:"Comunidade",action:"projects",id:"community"},{name:"Depoimentos",action:"testimonials",id:"testimonials"},{name:"Missão",action:"about",id:"about"}],[]),p=f.useCallback(e=>{"home"===e?window.scrollTo({top:0,behavior:"smooth"}):t(e),h()},[t,h]),g=f.useCallback(()=>{l("/"),window.scrollTo({top:0,behavior:"smooth"}),h()},[l,h]),x=f.useCallback(()=>{t("contact"),h()},[t,h]);return f.useEffect(()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&h()};return s&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[s,h]),f.useEffect(()=>{const e=e=>{"Escape"===e.key&&h()};return s&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[s]),f.useEffect(()=>{s&&d.current&&d.current.focus()},[s]),f.useEffect(()=>(document.body.style.overflow=s?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[s]),Je.jsx("header",{className:"fixed top-2 md:top-4 left-1/2 -translate-x-1/2 z-50 w-full max-w-6xl px-4 md:px-6 transition-all duration-1000 transform "+(a?"translate-y-0 opacity-100":"-translate-y-8 opacity-0"),children:Je.jsxs("nav",{ref:c,className:`\n          bg-white/5 border border-white/10 rounded-2xl \n          shadow-lg shadow-black/20 transition-all duration-500 backdrop-blur-md\n          ${e?"bg-white/8 border-white/15 shadow-2xl shadow-black/30":"bg-white/5 border-white/20"}\n        `,role:"navigation","aria-label":"Navegação principal",children:[Je.jsxs("div",{className:"flex items-center justify-between px-5 md:px-6 py-3",children:[Je.jsxs("button",{onClick:g,className:"flex items-center space-x-3 md:space-x-4 group","aria-label":"Ir para página inicial",children:[Je.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-xl flex items-center justify-center transition-all duration-300 overflow-hidden bg-white/10 border border-white/20 backdrop-blur-md group-hover:bg-white/15 group-hover:border-white/30 group-hover:shadow-lg group-hover:shadow-white/10 group-hover:scale-105",children:Je.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-full h-full object-contain p-1 group-hover:scale-110 transition-transform duration-300",loading:"eager",width:"48",height:"48"})}),Je.jsx("span",{className:"text-lg md:text-xl font-light text-white tracking-wide group-hover:text-white/90 transition-colors",children:"Sereno"})]}),Je.jsxs("div",{className:"hidden lg:flex items-center space-x-6 xl:space-x-8",children:[m.map((e,t)=>Je.jsxs("button",{onClick:()=>p(e.action),className:"relative text-white/70 hover:text-white transition-all duration-300 text-sm font-light tracking-wide group","aria-label":`Ir para seção ${e.name}`,style:{transitionDelay:100*t+"ms"},children:[e.name,Je.jsx("div",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-white transition-all duration-300 group-hover:w-full"})]},e.name)),Je.jsx("button",{onClick:x,className:"group relative bg-white text-black px-6 py-2.5 rounded-lg transition-all duration-300 text-sm font-light tracking-wide transform hover:bg-white/90 hover:scale-105 backdrop-blur-md shadow-lg hover:shadow-xl","aria-label":"Ir para seção de contato",children:Je.jsx("span",{className:"relative z-10",children:"Começar Agora"})})]}),Je.jsx("button",{className:"lg:hidden text-white hover:bg-white/10 p-2.5 rounded-lg transition-all duration-300 backdrop-blur-md hover:scale-105",onClick:u,"aria-label":s?"Fechar menu":"Abrir menu","aria-expanded":s,"aria-controls":"mobile-menu","aria-haspopup":"true",children:s?Je.jsx(v,{className:"w-5 h-5"}):Je.jsx(b,{className:"w-5 h-5"})})]}),s&&Je.jsx("div",{id:"mobile-menu",className:"lg:hidden border-t border-white/10 px-5 py-5 bg-white/5 backdrop-blur-md animate-in slide-in-from-top-2 duration-300",role:"menu","aria-label":"Menu de navegação móvel",children:Je.jsxs("div",{className:"flex flex-col space-y-3",children:[m.map((e,t)=>Je.jsx("button",{ref:0===t?d:null,onClick:()=>p(e.action),className:"text-white/70 hover:text-white transition-all duration-300 py-2.5 text-sm text-left font-light tracking-wide hover:bg-white/5 rounded-lg px-3",role:"menuitem","aria-label":`Ir para seção ${e.name}`,style:{transitionDelay:100*t+"ms"},children:e.name},e.name)),Je.jsx("button",{onClick:x,className:"bg-white text-black px-6 py-3 rounded-lg hover:bg-white/90 transition-all duration-300 w-full text-sm font-light tracking-wide mt-3 backdrop-blur-md hover:scale-105",role:"menuitem","aria-label":"Ir para seção de contato",children:"Começar Agora"})]})})]})})});zb.displayName="Navbar";const $b=({color:e="#5E5E5E",speed:t=.5,direction:s="forward",scale:r=.8,opacity:n=.4,mouseInteractive:i=!1})=>{const a=f.useRef(null),o=f.useRef({x:0,y:0});return f.useEffect(()=>{if(!a.current)return;const l=e?1:0,c=e?(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255]:[1,.5,.2]})(e):[1,1,1],d="reverse"===s?-1:1,u=new He({webgl:2,alpha:!0,antialias:!1,dpr:Math.min(window.devicePixelRatio||1,2)}),h=u.gl,m=h.canvas;m.style.display="block",m.style.width="100%",m.style.height="100%",a.current.appendChild(m);const p=new Ge(h),f=new We(h,{vertex:"#version 300 es\nprecision highp float;\nin vec2 position;\nin vec2 uv;\nout vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = vec4(position, 0.0, 1.0);\n}\n",fragment:"#version 300 es\nprecision highp float;\nuniform vec2 iResolution;\nuniform float iTime;\nuniform vec3 uCustomColor;\nuniform float uUseCustomColor;\nuniform float uSpeed;\nuniform float uDirection;\nuniform float uScale;\nuniform float uOpacity;\nuniform vec2 uMouse;\nuniform float uMouseInteractive;\nout vec4 fragColor;\n\nvoid mainImage(out vec4 o, vec2 C) {\n  vec2 center = iResolution.xy * 0.5;\n  C = (C - center) / uScale + center;\n  \n  vec2 mouseOffset = (uMouse - center) * 0.0002;\n  C += mouseOffset * length(C - center) * step(0.5, uMouseInteractive);\n  \n  float i, d, z, T = iTime * uSpeed * uDirection;\n  vec3 O, p, S;\n\n  for (vec2 r = iResolution.xy, Q; ++i < 60.; O += o.w/d*o.xyz) {\n    p = z*normalize(vec3(C-.5*r,r.y)); \n    p.z -= 4.; \n    S = p;\n    d = p.y-T;\n    \n    p.x += .4*(1.+p.y)*sin(d + p.x*0.1)*cos(.34*d + p.x*0.05); \n    Q = p.xz *= mat2(cos(p.y+vec4(0,11,33,0)-T)); \n    z+= d = abs(sqrt(length(Q*Q)) - .25*(5.+S.y))/3.+8e-4; \n    o = 1.+sin(S.y+p.z*.5+S.z-length(S-p)+vec4(2,1,0,8));\n  }\n  \n  o.xyz = tanh(O/1e4);\n}\n\nbool finite1(float x){ return !(isnan(x) || isinf(x)); }\nvec3 sanitize(vec3 c){\n  return vec3(\n    finite1(c.r) ? c.r : 0.0,\n    finite1(c.g) ? c.g : 0.0,\n    finite1(c.b) ? c.b : 0.0\n  );\n}\n\nvoid main() {\n  vec4 o = vec4(0.0);\n  mainImage(o, gl_FragCoord.xy);\n  vec3 rgb = sanitize(o.rgb);\n  \n  float intensity = (rgb.r + rgb.g + rgb.b) / 3.0;\n  vec3 customColor = intensity * uCustomColor;\n  vec3 finalColor = mix(rgb, customColor, step(0.5, uUseCustomColor));\n  \n  float alpha = length(rgb) * uOpacity;\n  fragColor = vec4(finalColor, alpha);\n}",uniforms:{iTime:{value:0},iResolution:{value:new Float32Array([1,1])},uCustomColor:{value:new Float32Array(c)},uUseCustomColor:{value:l},uSpeed:{value:.4*t},uDirection:{value:d},uScale:{value:r},uOpacity:{value:n},uMouse:{value:new Float32Array([0,0])},uMouseInteractive:{value:i?1:0}}}),g=new Ke(h,{geometry:p,program:f}),x=e=>{if(!i)return;const t=a.current.getBoundingClientRect();o.current.x=e.clientX-t.left,o.current.y=e.clientY-t.top;const s=f.uniforms.uMouse.value;s[0]=o.current.x,s[1]=o.current.y};i&&a.current.addEventListener("mousemove",x);const v=()=>{const e=a.current.getBoundingClientRect(),t=Math.max(1,Math.floor(e.width)),s=Math.max(1,Math.floor(e.height));u.setSize(t,s);const r=f.uniforms.iResolution.value;r[0]=h.drawingBufferWidth,r[1]=h.drawingBufferHeight},b=new ResizeObserver(v);b.observe(a.current),v();let w=0;const y=performance.now(),N=e=>{let t=.001*(e-y);if("pingpong"===s){const e=Math.sin(.5*t)*d;f.uniforms.uDirection.value=e}f.uniforms.iTime.value=t,u.render({scene:g}),w=requestAnimationFrame(N)};return w=requestAnimationFrame(N),()=>{var e;cancelAnimationFrame(w),b.disconnect(),i&&a.current&&a.current.removeEventListener("mousemove",x);try{null==(e=a.current)||e.removeChild(m)}catch(xN){}}},[e,t,s,r,n,i]),Je.jsx("div",{ref:a,className:"w-full h-full overflow-hidden relative"})},Bb=x.memo(({scrollToSection:e})=>{const[t,s]=f.useState(!1),[r,n]=f.useState(!1);f.useEffect(()=>{s(!0);const e=setTimeout(()=>{n(!0)},500);return()=>clearTimeout(e)},[]);const i=f.useCallback(()=>{e("services")},[e]),a=f.useMemo(()=>[{icon:w,text:"Comunidade Segura"},{icon:y,text:"Apoio Profissional"},{icon:w,text:"Crescimento Pessoal"}],[]);return Je.jsxs("section",{className:"relative mt-20 pb-12 min-h-screen flex items-center z-20 ","aria-labelledby":"hero-title",role:"banner",children:[Je.jsx("div",{className:"container-responsive relative",children:Je.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[Je.jsxs("div",{className:"inline-flex items-center space-x-3 backdrop-blur-md bg-white/5 border border-white/10 rounded-full px-5 py-2.5 mb-6 md:mb-8 transition-all duration-1000 "+(t?"opacity-100 translate-y-0":"opacity-0 translate-y-8"),children:[Je.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),Je.jsx("span",{className:"text-white/80 text-xs md:text-sm font-light tracking-wider uppercase",children:"Saúde Mental • Comunidade • Apoio"})]}),Je.jsx("div",{className:"mb-6 md:mb-8",children:Je.jsxs("h1",{id:"hero-title",className:"text-3xl md:text-5xl lg:text-6xl font-extralight mb-4 md:mb-5 leading-[0.9] md:leading-[0.85] tracking-tight",children:[Je.jsx("span",{className:"block text-white transition-all duration-1000 delay-300 "+(t?"opacity-100 translate-y-0":"opacity-0 translate-y-12"),children:"Compartilhe,"}),Je.jsxs("span",{className:"block text-white transition-all duration-1000 delay-500 "+(t?"opacity-100 translate-y-0":"opacity-0 translate-y-12"),children:["Entenda-se,"," ",Je.jsx("span",{className:"font-semibold transition-all duration-1000 delay-700 "+(r?"opacity-100":"opacity-0"),children:"Evolua."})]})]})}),Je.jsx("p",{className:"text-base md:text-lg text-white/70 mb-8 md:mb-12 max-w-2xl mx-auto leading-relaxed font-light tracking-wide transition-all duration-1000 delay-1000 "+(t?"opacity-100 translate-y-0":"opacity-0 translate-y-8"),children:"Conecte-se com uma comunidade acolhedora, compartilhe suas experiências sem julgamentos e tenha acesso a profissionais de saúde mental verificados."}),Je.jsx("div",{className:"flex justify-center items-center space-x-6 mb-6 transition-all duration-1000 delay-1200 "+(t?"opacity-100 translate-y-0":"opacity-0 translate-y-8"),children:a.map((e,t)=>Je.jsxs("div",{className:"flex items-center space-x-2 text-white/60 text-xs md:text-sm",style:{animationDelay:1200+200*t+"ms"},children:[Je.jsx(e.icon,{className:"w-3.5 h-3.5 md:w-4 md:h-4","aria-hidden":"true"}),Je.jsx("span",{children:e.text})]},t))}),Je.jsx("div",{className:"flex justify-center items-center transition-all duration-1000 delay-1200 "+(t?"opacity-100 translate-y-0":"opacity-0 translate-y-8"),children:Je.jsx("button",{onClick:i,className:"group relative bg-transparent border border-white/30 text-white px-6 py-3 md:px-8 md:py-4 rounded-xl transition-all duration-300 text-sm md:text-base font-light tracking-wide hover:bg-white/5 backdrop-blur-md focus-ring hover:scale-105","aria-label":"Explorar recursos e funcionalidades da plataforma",children:Je.jsxs("span",{className:"relative z-10 flex items-center justify-center space-x-2 md:space-x-3",children:[Je.jsx("span",{children:"Explorar Recursos"}),Je.jsx(w,{className:"w-3.5 h-3.5 md:w-4 md:h-4 transition-all duration-300 group-hover:scale-110","aria-hidden":"true"})]})})}),Je.jsx("div",{className:"mt-12 transition-all duration-1000 delay-1500 "+(t?"opacity-100":"opacity-0"),children:Je.jsxs("div",{className:"flex flex-col items-center space-y-2 text-white/40 text-xs",children:[Je.jsx("span",{children:"Role para descobrir mais"}),Je.jsx("div",{className:"w-5 h-8 border-2 border-white/20 rounded-full flex justify-center",children:Je.jsx("div",{className:"w-1 h-2.5 bg-white/40 rounded-full mt-1.5 animate-bounce"})})]})})]})}),Je.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[Je.jsx("div",{className:"absolute top-16 left-8 w-1.5 h-1.5 bg-white/20 rounded-full transition-all duration-2000 delay-500 "+(t?"opacity-100 scale-100":"opacity-0 scale-0")}),Je.jsx("div",{className:"absolute top-32 right-16 w-1 h-1 bg-white/30 rounded-full transition-all duration-2000 delay-700 "+(t?"opacity-100 scale-100":"opacity-0 scale-0")}),Je.jsx("div",{className:"absolute bottom-32 left-16 w-1.5 h-1.5 bg-white/25 rounded-full transition-all duration-2000 delay-900 "+(t?"opacity-100 scale-100":"opacity-0 scale-0")})]})]})});Bb.displayName="HeroSection";const qb=x.memo(({icon:e,title:t,description:s,delay:r,inView:n})=>{const i=f.useCallback(()=>{},[t]);return Je.jsxs("div",{className:"glass-card p-6 md:p-8 transition-all duration-1000 transform hover:-translate-y-2 hover:shadow-xl hover:shadow-white/10 backdrop-blur-md cursor-pointer group "+(n?"translate-y-0 opacity-100":"translate-y-12 opacity-0"),style:{transitionDelay:`${r}ms`},onClick:i,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i())},role:"button",tabIndex:0,"aria-label":`Recurso: ${t}. ${s}`,children:[Je.jsx("div",{className:"flex items-center justify-center w-14 h-14 md:w-16 md:h-16 rounded-xl bg-white/5 border border-white/10 mb-5 backdrop-blur-md group-hover:bg-white/10 transition-all duration-300 group-hover:scale-110",children:Je.jsx(e,{className:"w-7 h-7 md:w-8 md:h-8 text-white/80 group-hover:text-white transition-colors duration-300","aria-hidden":"true"})}),Je.jsx("h3",{className:"text-lg md:text-xl font-light mb-3 text-white tracking-wide group-hover:text-white/90 transition-colors duration-300",children:t}),Je.jsx("p",{className:"text-white/70 leading-relaxed text-sm md:text-base font-light group-hover:text-white/80 transition-colors duration-300",children:s}),Je.jsx("div",{className:"mt-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:Je.jsx("div",{className:"w-10 h-0.5 bg-gradient-to-r from-white/30 to-white/10"})})]})});qb.displayName="FeatureCard",x.memo(({title:e,desc:t,icon:s,index:r,inView:n,delay:i})=>{const[a,o]=f.useState(!1),l=f.useCallback(()=>{o(!0)},[]),c=f.useCallback(()=>{o(!1)},[]),d=f.useCallback(()=>{},[e]),u=f.useCallback(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),d())},[d]);return Je.jsxs("div",{className:"group relative overflow-hidden rounded-xl aspect-square bg-white/5 border border-white/10 transition-all duration-1000 transform hover:scale-[1.02] hover:shadow-xl hover:shadow-white/10 backdrop-blur-md cursor-pointer "+(n?"translate-y-0 opacity-100":"translate-y-12 opacity-0"),style:{transitionDelay:`${i}ms`},onMouseEnter:l,onMouseLeave:c,onClick:d,onKeyDown:u,role:"button",tabIndex:0,"aria-label":`Grupo de comunidade: ${e}. ${t}`,children:[Je.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-6",children:Je.jsxs("div",{className:"text-center",children:[Je.jsx("div",{className:"w-16 h-16 md:w-18 md:h-18 rounded-xl bg-white/10 flex items-center justify-center mx-auto mb-4 border border-white/20 backdrop-blur-md transition-all duration-300 group-hover:bg-white/15 group-hover:border-white/30 group-hover:scale-110",children:Je.jsx(s,{className:"w-8 h-8 md:w-9 md:h-9 text-white/80 transition-all duration-300 group-hover:scale-110","aria-hidden":"true"})}),Je.jsx("h3",{className:"text-lg md:text-xl font-light mb-2 text-white tracking-wide transition-all duration-300 group-hover:text-white/90",children:e}),Je.jsx("p",{className:"text-white/70 text-sm md:text-base font-light transition-all duration-300 group-hover:text-white/80 leading-relaxed",children:t})]})}),Je.jsx("div",{className:"absolute inset-0 bg-black/80 transition-all duration-500 flex items-end p-6 "+(a?"opacity-100":"opacity-0"),children:Je.jsx("button",{className:"w-full bg-white text-black py-3 rounded-lg font-light transform transition-all duration-500 text-base tracking-wide backdrop-blur-md hover:bg-white/90 hover:scale-105",style:{transform:a?"translateY(0)":"translateY(4px)"},"aria-label":`Participar do grupo ${e}`,children:"Participar"})}),Je.jsx("div",{className:"absolute top-4 right-4 w-2.5 h-2.5 bg-white/40 rounded-full transition-all duration-300 "+(a?"opacity-100 scale-100":"opacity-0 scale-0")})]})}).displayName="CommunityCard";const Hb=x.memo(({name:e,role:t,content:s})=>Je.jsxs("div",{className:"glass-card p-8 md:p-10 hover:bg-white/10 transition-all duration-300 hover:scale-105",role:"article","aria-labelledby":"testimonial-author",children:[Je.jsx("div",{className:"flex justify-end mb-5",children:Je.jsx("div",{className:"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center",children:Je.jsx(N,{className:"w-5 h-5 text-white/60","aria-hidden":"true"})})}),Je.jsx("div",{className:"flex items-center mb-5",role:"img","aria-label":"Avaliação de 5 estrelas",children:[...Array(5)].map((e,t)=>Je.jsx(j,{className:"w-4 h-4 md:w-5 md:h-5 text-yellow-400 fill-current mr-1","aria-hidden":"true"},t))}),Je.jsx("blockquote",{className:"text-white/80 mb-6 italic text-base md:text-lg leading-relaxed font-light",children:Je.jsxs("p",{className:"relative",children:[Je.jsx("span",{className:"text-3xl text-white/20 absolute -left-2 -top-2",children:'"'}),s,Je.jsx("span",{className:"text-3xl text-white/20 absolute -right-2 -bottom-2",children:'"'})]})}),Je.jsxs("footer",{className:"flex items-center justify-between",children:[Je.jsxs("div",{children:[Je.jsx("p",{id:"testimonial-author",className:"font-semibold text-base md:text-lg text-white tracking-wide mb-1",children:e}),Je.jsx("p",{className:"text-white/60 text-sm font-light",children:t})]}),Je.jsx("div",{className:"w-10 h-px bg-gradient-to-r from-white/20 to-transparent"})]})]}));Hb.displayName="TestimonialCard";const Gb=()=>Je.jsx("footer",{className:"relative z-10 py-16 md:py-20 border-t border-white/10 bg-white/5 backdrop-blur-md",children:Je.jsxs("div",{className:"container mx-auto px-4 md:px-6 max-w-7xl",children:[Je.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 md:gap-12 mb-12",children:[Je.jsxs("div",{className:"lg:col-span-2",children:[Je.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[Je.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center overflow-hidden bg-white/10 border border-white/20 backdrop-blur-md",children:Je.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-full h-full object-contain p-1",loading:"lazy"})}),Je.jsxs("div",{children:[Je.jsx("span",{className:"text-2xl font-light text-white tracking-wide block",children:"Sereno"}),Je.jsx("p",{className:"text-white/60 text-sm font-light",children:"Saúde mental para todos"})]})]}),Je.jsx("p",{className:"text-white/70 text-base leading-relaxed max-w-md",children:"Conectando pessoas através da tecnologia e comunidade para promover o bem-estar mental e emocional."})]}),Je.jsxs("div",{children:[Je.jsx("h3",{className:"text-lg font-semibold text-white mb-6",children:"Links Rápidos"}),Je.jsxs("ul",{className:"space-y-3",children:[Je.jsx("li",{children:Je.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-all duration-300 text-sm font-light",children:"Sobre Nós"})}),Je.jsx("li",{children:Je.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-all duration-300 text-sm font-light",children:"Nossos Serviços"})}),Je.jsx("li",{children:Je.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-all duration-300 text-sm font-light",children:"Comunidade"})}),Je.jsx("li",{children:Je.jsx("a",{href:"#",className:"text-white/60 hover:text-white transition-all duration-300 text-sm font-light",children:"Blog"})})]})]}),Je.jsxs("div",{children:[Je.jsx("h3",{className:"text-lg font-semibold text-white mb-6",children:"Contato"}),Je.jsxs("ul",{className:"space-y-3",children:[Je.jsxs("li",{className:"flex items-center space-x-3 text-white/60 text-sm font-light",children:[Je.jsx(C,{className:"w-4 h-4"}),Je.jsx("span",{children:"contato@sereno.com"})]}),Je.jsxs("li",{className:"flex items-center space-x-3 text-white/60 text-sm font-light",children:[Je.jsx(k,{className:"w-4 h-4"}),Je.jsx("span",{children:"+55 (11) 99999-9999"})]}),Je.jsxs("li",{className:"flex items-center space-x-3 text-white/60 text-sm font-light",children:[Je.jsx(S,{className:"w-4 h-4"}),Je.jsx("span",{children:"São Paulo, SP"})]})]})]})]}),Je.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center pt-8 border-t border-white/10",children:[Je.jsxs("div",{className:"flex items-center space-x-6 mb-6 md:mb-0",children:[Je.jsx("a",{href:"#",className:"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center hover:bg-white/10 hover:border-white/20 transition-all duration-300",children:Je.jsx(E,{className:"w-5 h-5 text-white/60 hover:text-white"})}),Je.jsx("a",{href:"#",className:"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center hover:bg-white/10 hover:border-white/20 transition-all duration-300",children:Je.jsx(_,{className:"w-5 h-5 text-white/60 hover:text-white"})}),Je.jsx("a",{href:"#",className:"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center hover:bg-white/10 hover:border-white/20 transition-all duration-300",children:Je.jsx(T,{className:"w-5 h-5 text-white/60 hover:text-white"})}),Je.jsx("a",{href:"#",className:"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center hover:bg-white/10 hover:border-white/20 transition-all duration-300",children:Je.jsx(I,{className:"w-5 h-5 text-white/60 hover:text-white"})})]}),Je.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-6 mb-6 md:mb-0",children:[Je.jsx("a",{href:"#",className:"text-white/50 hover:text-white transition-all duration-300 text-sm font-light",children:"Termos de Uso"}),Je.jsx("a",{href:"#",className:"text-white/50 hover:text-white transition-all duration-300 text-sm font-light",children:"Política de Privacidade"}),Je.jsx("a",{href:"#",className:"text-white/50 hover:text-white transition-all duration-300 text-sm font-light",children:"Cookies"})]}),Je.jsxs("p",{className:"text-white/50 text-sm font-light text-center md:text-right",children:["© ",(new Date).getFullYear()," Sereno. Feito com ",Je.jsx(w,{className:"w-4 h-4 inline text-red-400"})," para você."]})]})]})}),Wb={cleanupAnonymousPosts(){return p(this,null,function*(){try{const e=Zg(Lb,"posts"),t=new Date(Date.now()-864e5),s=Vx(e,$x("isAnonymous","==",!0),$x("createdAt","<",t)),r=yield av(s);if(r.empty)return{deletedCount:0};const n=r.docs.map(e=>p(this,null,function*(){const t=e.id,s=Vx(Zg(Lb,"comments"),$x("postId","==",t)),r=(yield av(s)).docs.map(e=>cv(e.ref));return yield Promise.all(r),yield cv(e.ref),t})),i=yield Promise.all(n);return{deletedCount:i.length,deletedPostIds:i}}catch(e){throw e}})},cleanupPrivatePosts(){return p(this,null,function*(){try{const e=Zg(Lb,"posts"),t=new Date(Date.now()-6048e5),s=Vx(e,$x("visibility","==","private"),$x("createdAt","<",t)),r=yield av(s);if(r.empty)return{deletedCount:0};const n=r.docs.map(e=>p(this,null,function*(){const t=e.id,s=Vx(Zg(Lb,"comments"),$x("postId","==",t)),r=(yield av(s)).docs.map(e=>cv(e.ref));return yield Promise.all(r),yield cv(e.ref),t})),i=yield Promise.all(n);return{deletedCount:i.length,deletedPostIds:i}}catch(e){throw e}})},cleanupOldNotifications(){return p(this,null,function*(){try{const e=Zg(Lb,"notifications"),t=new Date;t.setDate(t.getDate()-30);const s=Vx(e,$x("createdAt","<",t)),r=yield av(s);if(r.empty)return;const n=vv(Lb);r.docs.forEach(e=>{n.delete(e.ref)}),yield n.commit()}catch(e){}})},runAllCleanups(){return p(this,null,function*(){try{yield Promise.all([this.cleanupAnonymousPosts(),this.cleanupPrivatePosts(),this.cleanupOldNotifications()])}catch(e){}})}};"undefined"!=typeof window&&(setInterval(()=>{Wb.runAllCleanups().catch(e=>{})},36e5),setTimeout(()=>{Wb.runAllCleanups().catch(e=>{})},3e5));const Kb=(e=.1,t="0px 0px -100px 0px")=>{const[s,r]=f.useState(null),[n,i]=f.useState(!1);return f.useEffect(()=>{if(!s)return;const r=new IntersectionObserver(([e])=>{e.isIntersecting&&i(!0)},{threshold:e,rootMargin:t});return r.observe(s),()=>r.disconnect()},[s,e,t]),[r,n]};function Qb(){const e=Ot(),[t,s]=f.useState(!1),[r,n]=f.useState(!1),[i,a]=Kb(.15,"0px 0px -50px 0px"),[o,l]=Kb(.15,"0px 0px -50px 0px"),[c,u]=Kb(.15,"0px 0px -50px 0px"),[h,m]=Kb(.15,"0px 0px -50px 0px"),[p,g]=Kb(.15,"0px 0px -50px 0px"),[v,b]=f.useState(0),[N,j]=f.useState({x:0,y:0}),S=f.useRef(null);f.useEffect(()=>{const e=e=>{j({x:e.clientX/window.innerWidth*2-1,y:e.clientY/window.innerHeight*2-1})};return window.addEventListener("mousemove",e,{passive:!0}),()=>window.removeEventListener("mousemove",e)},[]);const E=f.useMemo(()=>[{name:"Eduardo Silva Pimenta da Mota",role:"Usuário do Sereno",content:"O Sereno me ajudou a encontrar uma comunidade que entende o que estou passando. É incrível poder compartilhar sem medo de julgamentos."},{name:"Bruno de Medeiros Rodrigues",role:"Aluno de Sistemas da Informação",content:"O Sereno me permite alcançar mais pessoas que precisam de ajuda. A plataforma é intuitiva e segura."},{name:"Pedro Henrique Cavalcante dos Santos",role:"Membro da Comunidade",content:"Os grupos de apoio me deram força para enfrentar a ansiedade. Encontrei pessoas que realmente me entendem."}],[]),_=f.useMemo(()=>[{icon:w,title:"Compartilhamento Seguro",description:"Compartilhe seus sentimentos de forma anônima ou pública, em um ambiente livre de julgamentos e acolhedor."},{icon:A,title:"Grupos de Apoio",description:"Participe de comunidades temáticas focadas em desafios específicos como ansiedade, TDAH, autoconfiança e mais."},{icon:D,title:"Chat com Profissionais",description:"Conecte-se diretamente com psicólogos verificados para atendimento personalizado e orientação especializada."},{icon:P,title:"Autoavaliação Diária",description:"Acompanhe seu bem-estar mental através de questionários diários e gráficos de evolução personalizados."}],[]),T=f.useMemo(()=>[{title:"Ansiedade",desc:"Grupo de apoio para gerenciar ansiedade",icon:P,color:"from-white to-gray-200"},{title:"Autoconfiança",desc:"Desenvolvimento pessoal e autoestima",icon:y,color:"from-white to-gray-200"},{title:"TDAH & Foco",desc:"Estratégias e suporte para TDAH",icon:R,color:"from-white to-gray-200"}],[]),I=f.useCallback(()=>{const e=window.scrollY;s(e>50)},[]),O=f.useCallback(e=>{const t=document.getElementById(e);if(t){const e=120,s=t.getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:s,behavior:"smooth"})}},[]),M=f.useCallback(e=>{b(e),S.current&&(clearInterval(S.current),S.current=setInterval(()=>{b(e=>(e+1)%E.length)},8e3))},[E.length]);f.useEffect(()=>{n(!0),document.documentElement.style.scrollBehavior="smooth";let e=!1;const t=()=>{e||(requestAnimationFrame(()=>{I(),e=!1}),e=!0)};return window.addEventListener("scroll",t,{passive:!0}),S.current=setInterval(()=>{b(e=>(e+1)%E.length)},8e3),()=>{window.removeEventListener("scroll",t),document.documentElement.style.scrollBehavior="auto",S.current&&clearInterval(S.current)}},[I,E.length]);const U=x.memo(()=>Je.jsx("div",{className:"relative z-10 py-8",children:Je.jsxs("div",{className:"relative mx-8 md:mx-16 lg:mx-32",children:[Je.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"}),Je.jsx("div",{className:"absolute inset-0 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent blur-sm"}),Je.jsx("div",{className:"absolute left-1/4 -top-1 w-1 h-1 bg-white/30 rounded-full animate-pulse"}),Je.jsx("div",{className:"absolute left-3/4 -top-0.5 w-0.5 h-0.5 bg-white/20 rounded-full animate-pulse",style:{animationDelay:"1s"}})]})}));return Je.jsxs("div",{className:"min-h-screen bg-black text-white overflow-x-hidden relative",children:[Je.jsxs("div",{className:"fixed inset-0 pointer-events-none z-0",children:[Je.jsx("div",{className:"absolute top-1/4 left-1/4 w-48 h-48 bg-white/[0.01] rounded-full blur-2xl animate-pulse",style:{transform:`translate(${10*N.x}px, ${10*N.y}px)`,animationDuration:"6s"}}),Je.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-64 h-64 bg-white/[0.005] rounded-full blur-2xl animate-pulse",style:{transform:`translate(${-8*N.x}px, ${-8*N.y}px)`,animationDuration:"8s",animationDelay:"3s"}})]}),Je.jsx(zb,{scrolled:t,scrollToSection:O}),Je.jsxs("section",{className:"relative z-10 min-h-screen flex items-center justify-center",children:[Je.jsx("div",{style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:-1},children:Je.jsx($b,{color:"#5E5E5E",speed:.5,direction:"forward",scale:.8,opacity:.4,mouseInteractive:!1})}),Je.jsx(Bb,{scrollToSection:O,inView:r})]}),Je.jsx("section",{id:"services",ref:i,className:"relative z-10 py-16 md:py-24 min-h-screen flex items-center",children:Je.jsxs("div",{className:"container mx-auto px-4 md:px-6 max-w-6xl",children:[Je.jsxs("div",{className:"text-center mb-12 md:mb-16 relative",children:[Je.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-8",children:Je.jsx("div",{className:"w-16 h-px bg-gradient-to-r from-transparent via-white/30 to-transparent"})}),Je.jsx("h2",{className:"text-3xl md:text-5xl lg:text-6xl font-extralight mb-6 text-white transition-all duration-1000 transform "+(a?"translate-y-0 opacity-100":"translate-y-16 opacity-0"),children:"Como Funciona"}),Je.jsx("p",{className:"text-lg md:text-xl text-white/70 max-w-2xl mx-auto transition-all duration-1000 transform "+(a?"translate-y-0 opacity-100":"translate-y-12 opacity-0"),style:{transitionDelay:"0.2s"},children:"Descubra como o Sereno pode transformar sua jornada de saúde mental através da tecnologia e comunidade."}),Je.jsxs("div",{className:"absolute -bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:[Je.jsx("div",{className:"w-1 h-1 bg-white/20 rounded-full animate-pulse"}),Je.jsx("div",{className:"w-1 h-1 bg-white/20 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),Je.jsx("div",{className:"w-1 h-1 bg-white/20 rounded-full animate-pulse",style:{animationDelay:"1s"}})]})]}),Je.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-4 gap-6 md:gap-8",children:_.map((e,t)=>Je.jsx("div",{className:"group relative",children:Je.jsx(qb,{icon:e.icon,title:e.title,description:e.description,delay:150*t+400,inView:a})},e.title))})]})}),Je.jsx(U,{}),Je.jsx("section",{id:"projects",ref:o,className:"relative z-10 py-16 md:py-24 min-h-screen flex items-center",children:Je.jsxs("div",{className:"container mx-auto px-4 md:px-6 max-w-6xl",children:[Je.jsxs("div",{className:"text-center mb-12 md:mb-16 relative",children:[Je.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-8",children:Je.jsx("div",{className:"w-12 h-px bg-white/20"})}),Je.jsx("h2",{className:"text-3xl md:text-5xl lg:text-6xl font-extralight mb-6 text-white transition-all duration-1000 transform "+(l?"translate-y-0 opacity-100":"translate-y-16 opacity-0"),children:"Nossa Comunidade"}),Je.jsx("p",{className:"text-lg md:text-xl text-white/70 max-w-2xl mx-auto transition-all duration-1000 transform "+(l?"translate-y-0 opacity-100":"translate-y-12 opacity-0"),style:{transitionDelay:"0.2s"},children:"Conheça os grupos de apoio e espaços de conexão que fazem do Sereno um lugar especial."})]}),Je.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8 md:gap-10 lg:gap-12 mb-16",children:T.map((e,t)=>Je.jsxs("div",{className:"group relative transition-all duration-700 transform hover:scale-105 "+(l?"translate-y-0 opacity-100":"translate-y-12 opacity-0"),style:{transitionDelay:200*t+400+"ms"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/10 rounded-2xl blur-lg opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10"}),Je.jsxs("div",{className:"relative bg-white/5 border border-white/10 rounded-2xl p-8 md:p-10 lg:p-12 backdrop-blur-md hover:bg-white/10 hover:border-white/20 transition-all duration-500 cursor-pointer min-h-[280px] md:min-h-[320px] flex flex-col overflow-hidden",children:[Je.jsx("div",{className:"relative flex items-center justify-center w-20 h-20 md:w-24 md:h-24 rounded-2xl bg-white/10 border border-white/20 mb-8 backdrop-blur-md group-hover:bg-white/20 group-hover:scale-110 transition-all duration-500 mx-auto",children:Je.jsx(e.icon,{className:"w-10 h-10 md:w-12 md:h-12 text-white/80 group-hover:text-white transition-all duration-500"})}),Je.jsxs("div",{className:"relative text-center flex-1 flex flex-col justify-center",children:[Je.jsx("h3",{className:"text-xl md:text-2xl lg:text-3xl font-light mb-4 text-white group-hover:text-white/95 transition-colors duration-500",children:e.title}),Je.jsx("p",{className:"text-white/70 text-base md:text-lg leading-relaxed group-hover:text-white/85 transition-colors duration-500 mb-6",children:e.desc}),Je.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-all duration-500 transform translate-y-4 group-hover:translate-y-0",children:Je.jsxs("div",{className:"inline-flex items-center text-white/60 text-sm font-light group-hover:text-white/80 transition-colors duration-300",children:[Je.jsx("span",{className:"mr-2",children:"Participar"}),Je.jsx("svg",{className:"w-4 h-4 transition-all duration-300 group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Je.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})})]}),Je.jsx("div",{className:"absolute top-4 right-4 w-2 h-2 bg-white/20 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-500 group-hover:animate-pulse"}),Je.jsx("div",{className:"absolute bottom-4 left-4 w-1.5 h-1.5 bg-white/15 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-700 delay-300 group-hover:animate-pulse"})]})]},e.title))})]})}),Je.jsx(U,{}),Je.jsx("section",{id:"testimonials",ref:c,className:"relative z-10 py-16 md:py-24 min-h-screen flex items-center",children:Je.jsxs("div",{className:"container mx-auto px-4 md:px-6 max-w-4xl",children:[Je.jsxs("div",{className:"text-center mb-12 md:mb-16 relative",children:[Je.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-6",children:Je.jsx("div",{className:"w-8 h-8 border border-white/10 rounded-full flex items-center justify-center",children:Je.jsx("div",{className:"w-2 h-2 bg-white/20 rounded-full animate-pulse"})})}),Je.jsx("h2",{className:"text-3xl md:text-5xl lg:text-6xl font-extralight mb-6 text-white transition-all duration-1000 transform "+(u?"translate-y-0 opacity-100":"translate-y-16 opacity-0"),children:"O Que Nossos Usuários Dizem"}),Je.jsx("p",{className:"text-lg md:text-xl text-white/70 max-w-2xl mx-auto transition-all duration-1000 transform "+(u?"translate-y-0 opacity-100":"translate-y-12 opacity-0"),style:{transitionDelay:"0.2s"},children:"Histórias reais de pessoas que encontraram apoio e transformação através do Sereno."})]}),Je.jsxs("div",{className:"max-w-4xl mx-auto relative transition-all duration-700 transform "+(u?"translate-y-0 opacity-100":"translate-y-12 opacity-0"),style:{transitionDelay:"0.4s"},children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(Hb,d({},E[v])),Je.jsx("div",{className:"absolute -top-4 -left-4 text-4xl text-white/10 font-serif",children:'"'}),Je.jsx("div",{className:"absolute -bottom-4 -right-4 text-4xl text-white/10 font-serif rotate-180",children:'"'})]}),Je.jsx("div",{className:"flex justify-center mt-10 space-x-3",children:E.map((e,t)=>Je.jsx("button",{onClick:()=>M(t),className:"w-3 h-3 rounded-full transition-all duration-300 hover:scale-110 "+(t===v?"bg-white scale-125 shadow-lg shadow-white/30":"bg-white/30 hover:bg-white/50"),"aria-label":`Ver depoimento ${t+1}`},t))})]})]})}),Je.jsx(U,{}),Je.jsx("section",{id:"about",ref:h,className:"relative z-10 py-16 md:py-24 min-h-screen flex items-center",children:Je.jsx("div",{className:"container mx-auto px-4 md:px-6 max-w-6xl",children:Je.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-12 md:gap-16",children:[Je.jsxs("div",{className:"flex-1 transition-all duration-1000 transform "+(m?"translate-x-0 opacity-100":"-translate-x-16 opacity-0"),children:[Je.jsxs("div",{className:"relative",children:[Je.jsx("h2",{className:"text-3xl md:text-5xl lg:text-6xl font-extralight mb-6 text-white",children:"Nossa Missão"}),Je.jsx("div",{className:"absolute -left-4 top-0 w-0.5 h-16 bg-gradient-to-b from-white/30 to-transparent"})]}),Je.jsx("p",{className:"text-lg md:text-xl text-white/70 mb-6 leading-relaxed hover:text-white/80 transition-colors duration-300",children:"O Sereno nasceu da necessidade de democratizar o acesso à saúde mental. Acreditamos que todos merecem ter um espaço seguro para compartilhar, se conectar e receber apoio especializado quando necessário."}),Je.jsx("p",{className:"text-lg md:text-xl text-white/70 mb-8 leading-relaxed hover:text-white/80 transition-colors duration-300",children:"Nossa plataforma combina tecnologia, comunidade e profissionais verificados para criar um ecossistema completo de cuidado mental, onde cada pessoa pode encontrar o suporte que precisa para evoluir."}),Je.jsxs("button",{onClick:()=>O("contact"),className:"group bg-white text-black px-6 py-3 rounded-xl font-light transition-all duration-300 hover:bg-white/90 text-base tracking-wide hover:scale-105 hover:shadow-lg hover:shadow-white/20 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 to-white/30 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),Je.jsx("span",{className:"relative group-hover:mr-2 transition-all duration-300",children:"Saiba Mais"}),Je.jsx("span",{className:"relative opacity-0 group-hover:opacity-100 transition-all duration-300",children:"→"})]})]}),Je.jsx("div",{className:"flex-1 transition-all duration-700 transform "+(m?"translate-x-0 opacity-100":"translate-x-16 opacity-0"),style:{transitionDelay:"0.3s"},children:Je.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{icon:L,label:"Segurança"},{icon:w,label:"Cuidado"},{icon:P,label:"Inteligência"},{icon:A,label:"Comunidade"}].map((e,t)=>Je.jsxs("div",{className:"group aspect-square rounded-xl bg-white/5 border border-white/10 backdrop-blur-md flex flex-col items-center justify-center hover:bg-white/10 transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-white/10 cursor-pointer",style:{transitionDelay:100*t+"ms"},children:[Je.jsx(e.icon,{className:"w-12 h-12 text-white/80 group-hover:text-white group-hover:scale-110 transition-all duration-300 mb-2"}),Je.jsx("span",{className:"text-white/60 group-hover:text-white/80 text-sm font-light transition-all duration-300",children:e.label})]},e.label))})})]})})}),Je.jsx(U,{}),Je.jsx("section",{id:"contact",ref:p,className:"relative z-10 py-16 md:py-24 min-h-screen flex items-center",children:Je.jsxs("div",{className:"container mx-auto px-4 md:px-6 max-w-2xl",children:[Je.jsxs("div",{className:"text-center mb-12 md:mb-16 relative",children:[Je.jsx("div",{className:"absolute -top-8 left-1/4 opacity-10",children:Je.jsx(C,{className:"w-3 h-3 text-white"})}),Je.jsx("div",{className:"absolute -top-6 right-1/4 opacity-10",children:Je.jsx(k,{className:"w-2 h-2 text-white"})}),Je.jsx("h2",{className:"text-3xl md:text-5xl lg:text-6xl font-extralight mb-6 text-white transition-all duration-1000 transform "+(g?"translate-y-0 opacity-100":"translate-y-16 opacity-0"),children:"Vamos Conversar?"}),Je.jsx("p",{className:"text-lg md:text-xl text-white/70 max-w-2xl mx-auto transition-all duration-1000 transform "+(g?"translate-y-0 opacity-100":"translate-y-12 opacity-0"),style:{transitionDelay:"0.2s"},children:"Entre em contato e vamos conversar sobre como o Sereno pode ajudar você ou sua organização."})]}),Je.jsx("div",{className:"max-w-2xl mx-auto transition-all duration-700 transform "+(g?"translate-y-0 opacity-100":"translate-y-12 opacity-0"),style:{transitionDelay:"0.4s"},children:Je.jsx("div",{className:"group relative bg-white/5 border border-white/10 rounded-xl p-8 backdrop-blur-md hover:bg-white/10 transition-all duration-500",children:Je.jsxs("div",{className:"relative z-10",children:[Je.jsx("h3",{className:"text-2xl font-light mb-6 text-white text-center transition-all duration-300 group-hover:text-white/95",children:"Acesse sua Conta"}),Je.jsxs("div",{className:"space-y-4",children:[Je.jsx("button",{className:"w-full bg-white text-black py-4 rounded-xl font-light transition-all duration-300 hover:bg-white/90 text-base tracking-wide backdrop-blur-md hover:scale-105 hover:shadow-lg hover:shadow-white/20",onClick:()=>e("/login"),children:"Fazer Login"}),Je.jsxs("div",{className:"relative",children:[Je.jsx("div",{className:"absolute inset-0 flex items-center",children:Je.jsx("div",{className:"w-full border-t border-white/10"})}),Je.jsx("div",{className:"relative flex justify-center text-sm",children:Je.jsx("span",{className:"px-4 bg-black text-white/50 font-light",children:"ou"})})]}),Je.jsx("button",{className:"w-full bg-transparent border border-white/30 text-white py-4 rounded-xl font-light transition-all duration-300 hover:bg-white/5 text-base tracking-wide backdrop-blur-md hover:scale-105 hover:border-white/50 hover:shadow-lg hover:shadow-white/10",onClick:()=>e("/register"),children:"Criar Conta"})]}),Je.jsx("p",{className:"text-white/50 text-sm text-center mt-6 font-light transition-colors duration-300 group-hover:text-white/60",children:"Comece sua jornada de saúde mental hoje mesmo"})]})})})]})}),Je.jsx(Gb,{})]})}const Jb=()=>{const{groupId:t}=Mt(),s=Ot(),[r,n]=f.useState(null),[i,a]=f.useState([]),[o,l]=f.useState(!0),[c,h]=f.useState(null),[m,g]=f.useState(null),[x,b]=f.useState(!1),[y,N]=f.useState(!1),[j,C]=f.useState(!1),[k,E]=f.useState(!1),[_,T]=f.useState(""),[I,P]=f.useState(""),[R,L]=f.useState("all"),H={id:t,name:"Ansiedade & Estresse",description:"Um grupo de apoio para pessoas que lidam com ansiedade e estresse no dia a dia. Compartilhe suas experiências, receba apoio e aprenda estratégias de enfrentamento.",avatar:null,memberCount:1247,postCount:89,createdAt:new Date("2024-01-15"),rules:["Respeite todos os membros","Mantenha as discussões focadas no tema do grupo","Não compartilhe informações pessoais de outros","Seja gentil e acolhedor","Reporte comportamentos inadequados"],tags:["ansiedade","estresse","saúde mental","apoio","bem-estar"],privacy:"public",category:"Saúde Mental",location:"Online",meetingSchedule:"Toda quarta-feira às 20h",admins:["admin1","admin2"],members:["user1","user2","user3"]},G=[{id:1,author:{id:"user1",name:"Maria Santos",avatar:null},content:"Hoje foi um dia difícil no trabalho. A ansiedade estava muito alta durante uma reunião importante. Alguém tem alguma técnica de respiração que funcione bem para vocês?",timestamp:new Date(Date.now()-18e5),likes:12,comments:8,liked:!1,tags:["ansiedade","trabalho","técnicas"]},{id:2,author:{id:"user2",name:"João Silva",avatar:null},content:"Queria compartilhar uma vitória pessoal: consegui fazer uma apresentação em público sem ter um ataque de pânico! A terapia e os exercícios de mindfulness estão funcionando. Obrigado a todos pelo apoio!",timestamp:new Date(Date.now()-72e5),likes:45,comments:15,liked:!0,tags:["vitória","mindfulness","terapia"]},{id:3,author:{id:"user3",name:"Ana Costa",avatar:null},content:"Alguém já experimentou meditação guiada? Estou pensando em começar mas não sei por onde começar. Alguma recomendação de app ou canal no YouTube?",timestamp:new Date(Date.now()-144e5),likes:8,comments:12,liked:!1,tags:["meditação","dicas","apps"]}];f.useEffect(()=>{p(e,null,function*(){try{const e=auth.currentUser;if(!e)return void s("/login");h(e);const t=doc(db,"users",e.uid),r=yield getDoc(t);if(r.exists()){const t=r.data();g(t),b(H.members.includes(e.uid)),N(H.admins.includes(e.uid))}n(H),a(G)}catch(e){}finally{l(!1)}})},[t,s]);const W=i.filter(e=>{const t=e.content.toLowerCase().includes(I.toLowerCase())||e.author.name.toLowerCase().includes(I.toLowerCase()),s="all"===R||"popular"===R&&(Array.isArray(e.likes)?e.likes.length:0)>10||"recent"===R&&e.timestamp>new Date(Date.now()-864e5);return t&&s});return o?Je.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Je.jsx("div",{className:"text-white",children:"Carregando grupo..."})}):Je.jsxs("div",{className:"min-h-screen bg-black text-white",children:[Je.jsx("div",{className:"bg-black/95 backdrop-blur-sm border-b border-white/10 sticky top-0 z-50",children:Je.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:Je.jsxs("div",{className:"flex items-center justify-between h-16",children:[Je.jsxs("button",{onClick:()=>s("/home"),className:"flex items-center space-x-2 text-white/70 hover:text-white transition-colors",children:[Je.jsx(O,{className:"w-5 h-5"}),Je.jsx("span",{children:"Voltar"})]}),Je.jsx("h1",{className:"text-xl font-light",children:r.name}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[y&&Je.jsx("button",{onClick:()=>E(!0),className:"text-white/70 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",children:Je.jsx(M,{className:"w-5 h-5"})}),Je.jsx("button",{className:"text-white/70 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",children:Je.jsx(U,{className:"w-5 h-5"})})]})]})})}),Je.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[Je.jsx("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-8 mb-8 backdrop-blur-md",children:Je.jsxs("div",{className:"flex flex-col lg:flex-row items-start space-y-6 lg:space-y-0 lg:space-x-8",children:[Je.jsx("div",{className:"w-32 h-32 rounded-2xl bg-white/10 border border-white/20 flex items-center justify-center flex-shrink-0",children:r.avatar?Je.jsx("img",{src:r.avatar,alt:r.name,className:"w-full h-full object-cover rounded-2xl"}):Je.jsx(A,{className:"w-16 h-16 text-white/50"})}),Je.jsx("div",{className:"flex-1",children:Je.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Je.jsxs("div",{children:[Je.jsx("h2",{className:"text-3xl font-light mb-2",children:r.name}),Je.jsx("p",{className:"text-white/70 text-lg mb-4",children:r.description}),Je.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:r.tags.map((e,t)=>Je.jsxs("span",{className:"bg-white/10 px-3 py-1 rounded-full text-sm text-white/80",children:["#",e]},t))}),Je.jsxs("div",{className:"flex items-center space-x-6 text-sm text-white/60",children:[Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx(A,{className:"w-4 h-4"}),Je.jsxs("span",{children:[r.memberCount," membros"]})]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx(D,{className:"w-4 h-4"}),Je.jsxs("span",{children:[r.postCount," posts"]})]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx(F,{className:"w-4 h-4"}),Je.jsxs("span",{children:["Criado em ",r.createdAt.toLocaleDateString("pt-BR")]})]})]})]}),Je.jsxs("div",{className:"flex flex-col space-y-3",children:[x?Je.jsxs("button",{onClick:()=>p(e,null,function*(){try{b(!1),n(e=>u(d({},e),{memberCount:e.memberCount-1}))}catch(e){}}),className:"bg-red-600/20 border border-red-500/30 text-red-300 px-6 py-2 rounded-xl font-light hover:bg-red-600/30 transition-all duration-300",children:[Je.jsx(V,{className:"w-4 h-4 inline mr-2"}),"Sair do Grupo"]}):Je.jsxs("button",{onClick:()=>C(!0),className:"bg-white text-black px-6 py-2 rounded-xl font-light hover:bg-white/90 transition-all duration-300",children:[Je.jsx(z,{className:"w-4 h-4 inline mr-2"}),"Entrar no Grupo"]}),Je.jsxs("button",{className:"bg-white/10 border border-white/30 text-white px-6 py-2 rounded-xl font-light hover:bg-white/20 transition-all duration-300",children:[Je.jsx($,{className:"w-4 h-4 inline mr-2"}),"Compartilhar"]})]})]})})]})}),Je.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:[Je.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-md",children:[Je.jsx("h3",{className:"text-xl font-light mb-4",children:"Regras do Grupo"}),Je.jsx("ul",{className:"space-y-2 text-sm text-white/80",children:r.rules.map((e,t)=>Je.jsxs("li",{className:"flex items-start space-x-2",children:[Je.jsx("span",{className:"text-white/50 mt-1",children:"•"}),Je.jsx("span",{children:e})]},t))})]}),Je.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-md",children:[Je.jsx("h3",{className:"text-xl font-light mb-4",children:"Encontros"}),Je.jsxs("div",{className:"space-y-3 text-sm text-white/80",children:[Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx(F,{className:"w-4 h-4 text-white/50"}),Je.jsx("span",{children:r.meetingSchedule})]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx(S,{className:"w-4 h-4 text-white/50"}),Je.jsx("span",{children:r.location})]})]})]}),Je.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-md",children:[Je.jsx("h3",{className:"text-xl font-light mb-4",children:"Estatísticas"}),Je.jsxs("div",{className:"space-y-3 text-sm text-white/80",children:[Je.jsxs("div",{className:"flex justify-between",children:[Je.jsx("span",{children:"Membros ativos:"}),Je.jsx("span",{className:"text-white",children:"1,247"})]}),Je.jsxs("div",{className:"flex justify-between",children:[Je.jsx("span",{children:"Posts esta semana:"}),Je.jsx("span",{className:"text-white",children:"23"})]}),Je.jsxs("div",{className:"flex justify-between",children:[Je.jsx("span",{children:"Novos membros:"}),Je.jsx("span",{className:"text-white",children:"+12"})]})]})]})]}),Je.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-md",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h3",{className:"text-xl font-light",children:"Discussões"}),Je.jsxs("div",{className:"flex items-center space-x-4",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50 w-4 h-4"}),Je.jsx("input",{type:"text",placeholder:"Pesquisar posts...",value:I,onChange:e=>P(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg pl-10 pr-4 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 text-sm"})]}),Je.jsxs("select",{value:R,onChange:e=>L(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/30 text-sm",children:[Je.jsx("option",{value:"all",children:"Todos"}),Je.jsx("option",{value:"recent",children:"Recentes"}),Je.jsx("option",{value:"popular",children:"Populares"})]})]})]}),x&&Je.jsxs("div",{className:"bg-white/5 border border-white/20 rounded-xl p-4 mb-6",children:[Je.jsx("textarea",{placeholder:"Compartilhe algo com o grupo...",value:_,onChange:e=>T(e.target.value),rows:3,className:"w-full bg-transparent border-none text-white placeholder-white/50 focus:outline-none resize-none"}),Je.jsxs("div",{className:"flex items-center justify-between mt-3",children:[Je.jsx("div",{className:"text-xs text-white/50",children:"Use #hashtags para categorizar seu post"}),Je.jsx("button",{onClick:()=>p(e,null,function*(){if(_.trim())try{const e={id:Date.now(),author:{id:c.uid,name:(null==m?void 0:m.displayName)||c.displayName||"Usuário",avatar:c.photoURL},content:_,timestamp:new Date,likes:0,comments:0,liked:!1,tags:[]};a(t=>[e,...t]),T(""),n(e=>u(d({},e),{postCount:e.postCount+1}))}catch(e){}}),disabled:!_.trim(),className:"bg-white text-black px-4 py-2 rounded-lg font-light hover:bg-white/90 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:"Publicar"})]})]}),Je.jsx("div",{className:"space-y-4",children:0===W.length?Je.jsxs("div",{className:"text-center py-12",children:[Je.jsx(D,{className:"w-16 h-16 text-white/20 mx-auto mb-4"}),Je.jsx("p",{className:"text-white/50 text-lg",children:"Nenhum post encontrado"}),Je.jsx("p",{className:"text-white/30 text-sm mt-2",children:I||"all"!==R?"Tente ajustar os filtros de busca":"Seja o primeiro a iniciar uma discussão!"})]}):W.map(e=>Je.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 backdrop-blur-md",children:Je.jsxs("div",{className:"flex items-start space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:e.author.avatar?Je.jsx("img",{src:e.author.avatar,alt:"",className:"w-full h-full rounded-full"}):Je.jsx("span",{className:"text-white/70",children:e.author.name.charAt(0)})}),Je.jsxs("div",{className:"flex-1 min-w-0",children:[Je.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Je.jsx("span",{className:"font-medium text-white",children:e.author.name}),Je.jsxs("span",{className:"text-white/50 text-sm",children:[e.timestamp.toLocaleDateString("pt-BR")," às ",e.timestamp.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]}),Je.jsx("p",{className:"text-white/90 mb-3 leading-relaxed",children:e.content}),e.tags.length>0&&Je.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:e.tags.map((e,t)=>Je.jsxs("span",{className:"bg-white/10 px-2 py-1 rounded-full text-xs text-white/60",children:["#",e]},t))}),Je.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[Je.jsxs("button",{onClick:()=>{return t=e.id,void a(e=>e.map(e=>e.id===t?u(d({},e),{liked:!e.liked,likes:e.liked?Array.isArray(e.likes)?e.likes.filter(e=>"current-user"!==e):[]:Array.isArray(e.likes)?[...e.likes,"current-user"]:["current-user"]}):e));var t},className:"flex items-center space-x-1 transition-colors "+(e.liked?"text-red-400":"text-white/60 hover:text-white"),children:[Je.jsx(w,{className:"w-4 h-4 "+(e.liked?"fill-current":"")}),Je.jsx("span",{children:Array.isArray(e.likes)?e.likes.length:0})]}),Je.jsxs("button",{className:"flex items-center space-x-1 text-white/60 hover:text-white transition-colors",children:[Je.jsx(D,{className:"w-4 h-4"}),Je.jsx("span",{children:e.commentCount||0})]}),Je.jsx("button",{className:"text-white/60 hover:text-white transition-colors",children:Je.jsx($,{className:"w-4 h-4"})})]})]})]})},e.id))})]})]}),j&&Je.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:Je.jsxs("div",{className:"bg-black/95 border border-white/10 rounded-2xl p-6 max-w-md w-full",children:[Je.jsx("h3",{className:"text-xl font-light mb-4",children:"Entrar no Grupo"}),Je.jsxs("p",{className:"text-white/70 mb-6",children:['Você está prestes a entrar no grupo "',r.name,'". Ao entrar, você concorda em seguir as regras do grupo e manter um ambiente respeitoso.']}),Je.jsxs("div",{className:"flex space-x-3",children:[Je.jsx("button",{onClick:()=>p(e,null,function*(){try{b(!0),C(!1),n(e=>u(d({},e),{memberCount:e.memberCount+1}))}catch(e){}}),className:"bg-white text-black px-4 py-2 rounded-xl font-light hover:bg-white/90 transition-all duration-300 flex-1",children:"Entrar no Grupo"}),Je.jsx("button",{onClick:()=>C(!1),className:"bg-transparent border border-white/30 text-white px-4 py-2 rounded-xl font-light hover:bg-white/10 transition-all duration-300",children:"Cancelar"})]})]})}),k&&Je.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:Je.jsxs("div",{className:"bg-black/95 border border-white/10 rounded-2xl p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h3",{className:"text-xl font-light",children:"Configurações do Grupo"}),Je.jsx("button",{onClick:()=>E(!1),className:"text-white/50 hover:text-white transition-colors",children:Je.jsx(v,{className:"w-5 h-5"})})]}),Je.jsxs("div",{className:"space-y-6",children:[Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-lg font-light mb-3",children:"Informações Básicas"}),Je.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-white/70 text-sm mb-2",children:"Nome do Grupo"}),Je.jsx("input",{type:"text",defaultValue:r.name,className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-white/70 text-sm mb-2",children:"Categoria"}),Je.jsx("input",{type:"text",defaultValue:r.category,className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"})]})]})]}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-lg font-light mb-3",children:"Descrição"}),Je.jsx("textarea",{defaultValue:r.description,rows:3,className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 resize-none"})]}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-lg font-light mb-3",children:"Regras"}),Je.jsxs("div",{className:"space-y-2",children:[r.rules.map((e,t)=>Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("input",{type:"text",defaultValue:e,className:"flex-1 bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"}),Je.jsx("button",{className:"text-red-400 hover:text-red-300 p-1",children:Je.jsx(q,{className:"w-4 h-4"})})]},t)),Je.jsx("button",{className:"text-white/70 hover:text-white text-sm",children:"+ Adicionar regra"})]})]}),Je.jsxs("div",{className:"flex space-x-3",children:[Je.jsx("button",{className:"bg-white text-black px-4 py-2 rounded-xl font-light hover:bg-white/90 transition-all duration-300 flex-1",children:"Salvar Alterações"}),Je.jsx("button",{onClick:()=>E(!1),className:"bg-transparent border border-white/30 text-white px-4 py-2 rounded-xl font-light hover:bg-white/10 transition-all duration-300",children:"Cancelar"})]})]})]})})]})};function Yb(e){var t,s,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(s=Yb(e[t]))&&(r&&(r+=" "),r+=s)}else for(s in e)e[s]&&(r&&(r+=" "),r+=s);return r}const Xb=(e,t)=>{var s;if(0===e.length)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),i=n?Xb(e.slice(1),n):void 0;if(i)return i;if(0===t.validators.length)return;const a=e.join("-");return null==(s=t.validators.find(({validator:e})=>e(a)))?void 0:s.classGroupId},Zb=/^\[(.+)\]$/,ew=e=>{if(Zb.test(e)){const t=Zb.exec(e)[1],s=null==t?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}},tw=e=>{const{theme:t,prefix:s}=e,r={nextPart:new Map,validators:[]};return iw(Object.entries(e.classGroups),s).forEach(([e,s])=>{sw(s,r,e,t)}),r},sw=(e,t,s,r)=>{e.forEach(e=>{if("string"!=typeof e)return"function"==typeof e?nw(e)?void sw(e(r),t,s,r):void t.validators.push({validator:e,classGroupId:s}):void Object.entries(e).forEach(([e,n])=>{sw(n,rw(t,e),s,r)});(""===e?t:rw(t,e)).classGroupId=s})},rw=(e,t)=>{let s=e;return t.split("-").forEach(e=>{s.nextPart.has(e)||s.nextPart.set(e,{nextPart:new Map,validators:[]}),s=s.nextPart.get(e)}),s},nw=e=>e.isThemeGetter,iw=(e,t)=>t?e.map(([e,s])=>[e,s.map(e=>"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,s])=>[t+e,s])):e)]):e,aw=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,s=new Map,r=new Map;const n=(n,i)=>{s.set(n,i),t++,t>e&&(t=0,r=s,s=new Map)};return{get(e){let t=s.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(n(e,t),t):void 0},set(e,t){s.has(e)?s.set(e,t):n(e,t)}}},ow=e=>{const{separator:t,experimentalParseClassName:s}=e,r=1===t.length,n=t[0],i=t.length,a=e=>{const s=[];let a,o=0,l=0;for(let u=0;u<e.length;u++){let c=e[u];if(0===o){if(c===n&&(r||e.slice(u,u+i)===t)){s.push(e.slice(l,u)),l=u+i;continue}if("/"===c){a=u;continue}}"["===c?o++:"]"===c&&o--}const c=0===s.length?e:e.substring(l),d=c.startsWith("!");return{modifiers:s,hasImportantModifier:d,baseClassName:d?c.substring(1):c,maybePostfixModifierPosition:a&&a>l?a-l:void 0}};return s?e=>s({className:e,parseClassName:a}):a},lw=e=>{if(e.length<=1)return e;const t=[];let s=[];return e.forEach(e=>{"["===e[0]?(t.push(...s.sort(),e),s=[]):s.push(e)}),t.push(...s.sort()),t},cw=e=>d({cache:aw(e.cacheSize),parseClassName:ow(e)},(e=>{const t=tw(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:e=>{const s=e.split("-");return""===s[0]&&1!==s.length&&s.shift(),Xb(s,t)||ew(e)},getConflictingClassGroupIds:(e,t)=>{const n=s[e]||[];return t&&r[e]?[...n,...r[e]]:n}}})(e)),dw=/\s+/;function uw(){let e,t,s=0,r="";for(;s<arguments.length;)(e=arguments[s++])&&(t=hw(e))&&(r&&(r+=" "),r+=t);return r}const hw=e=>{if("string"==typeof e)return e;let t,s="";for(let r=0;r<e.length;r++)e[r]&&(t=hw(e[r]))&&(s&&(s+=" "),s+=t);return s};function mw(e,...t){let s,r,n,i=function(o){const l=t.reduce((e,t)=>t(e),e());return s=cw(l),r=s.cache.get,n=s.cache.set,i=a,a(o)};function a(e){const t=r(e);if(t)return t;const i=((e,t)=>{const{parseClassName:s,getClassGroupId:r,getConflictingClassGroupIds:n}=t,i=[],a=e.trim().split(dw);let o="";for(let l=a.length-1;l>=0;l-=1){const e=a[l],{modifiers:t,hasImportantModifier:c,baseClassName:d,maybePostfixModifierPosition:u}=s(e);let h=Boolean(u),m=r(h?d.substring(0,u):d);if(!m){if(!h){o=e+(o.length>0?" "+o:o);continue}if(m=r(d),!m){o=e+(o.length>0?" "+o:o);continue}h=!1}const p=lw(t).join(":"),f=c?p+"!":p,g=f+m;if(i.includes(g))continue;i.push(g);const x=n(m,h);for(let s=0;s<x.length;++s){const e=x[s];i.push(f+e)}o=e+(o.length>0?" "+o:o)}return o})(e,s);return n(e,i),i}return function(){return i(uw.apply(null,arguments))}}const pw=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},fw=/^\[(?:([a-z-]+):)?(.+)\]$/i,gw=/^\d+\/\d+$/,xw=new Set(["px","full","screen"]),vw=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,bw=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ww=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,yw=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Nw=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,jw=e=>kw(e)||xw.has(e)||gw.test(e),Cw=e=>Uw(e,"length",Fw),kw=e=>Boolean(e)&&!Number.isNaN(Number(e)),Sw=e=>Uw(e,"number",kw),Ew=e=>Boolean(e)&&Number.isInteger(Number(e)),_w=e=>e.endsWith("%")&&kw(e.slice(0,-1)),Tw=e=>fw.test(e),Iw=e=>vw.test(e),Aw=new Set(["length","size","percentage"]),Dw=e=>Uw(e,Aw,Vw),Pw=e=>Uw(e,"position",Vw),Rw=new Set(["image","url"]),Lw=e=>Uw(e,Rw,$w),Ow=e=>Uw(e,"",zw),Mw=()=>!0,Uw=(e,t,s)=>{const r=fw.exec(e);return!!r&&(r[1]?"string"==typeof t?r[1]===t:t.has(r[1]):s(r[2]))},Fw=e=>bw.test(e)&&!ww.test(e),Vw=()=>!1,zw=e=>yw.test(e),$w=e=>Nw.test(e),Bw=mw(()=>{const e=pw("colors"),t=pw("spacing"),s=pw("blur"),r=pw("brightness"),n=pw("borderColor"),i=pw("borderRadius"),a=pw("borderSpacing"),o=pw("borderWidth"),l=pw("contrast"),c=pw("grayscale"),d=pw("hueRotate"),u=pw("invert"),h=pw("gap"),m=pw("gradientColorStops"),p=pw("gradientColorStopPositions"),f=pw("inset"),g=pw("margin"),x=pw("opacity"),v=pw("padding"),b=pw("saturate"),w=pw("scale"),y=pw("sepia"),N=pw("skew"),j=pw("space"),C=pw("translate"),k=()=>["auto",Tw,t],S=()=>[Tw,t],E=()=>["",jw,Cw],_=()=>["auto",kw,Tw],T=()=>["","0",Tw],I=()=>[kw,Tw];return{cacheSize:500,separator:":",theme:{colors:[Mw],spacing:[jw,Cw],blur:["none","",Iw,Tw],brightness:I(),borderColor:[e],borderRadius:["none","","full",Iw,Tw],borderSpacing:S(),borderWidth:E(),contrast:I(),grayscale:T(),hueRotate:I(),invert:T(),gap:S(),gradientColorStops:[e],gradientColorStopPositions:[_w,Cw],inset:k(),margin:k(),opacity:I(),padding:S(),saturate:I(),scale:I(),sepia:T(),skew:I(),space:S(),translate:S()},classGroups:{aspect:[{aspect:["auto","square","video",Tw]}],container:["container"],columns:[{columns:[Iw]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",Tw]}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[f]}],"inset-x":[{"inset-x":[f]}],"inset-y":[{"inset-y":[f]}],start:[{start:[f]}],end:[{end:[f]}],top:[{top:[f]}],right:[{right:[f]}],bottom:[{bottom:[f]}],left:[{left:[f]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ew,Tw]}],basis:[{basis:k()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Tw]}],grow:[{grow:T()}],shrink:[{shrink:T()}],order:[{order:["first","last","none",Ew,Tw]}],"grid-cols":[{"grid-cols":[Mw]}],"col-start-end":[{col:["auto",{span:["full",Ew,Tw]},Tw]}],"col-start":[{"col-start":_()}],"col-end":[{"col-end":_()}],"grid-rows":[{"grid-rows":[Mw]}],"row-start-end":[{row:["auto",{span:[Ew,Tw]},Tw]}],"row-start":[{"row-start":_()}],"row-end":[{"row-end":_()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Tw]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Tw]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal","start","end","center","between","around","evenly","stretch"]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[j]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[j]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Tw,t]}],"min-w":[{"min-w":[Tw,t,"min","max","fit"]}],"max-w":[{"max-w":[Tw,t,"none","full","min","max","fit","prose",{screen:[Iw]},Iw]}],h:[{h:[Tw,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Tw,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Tw,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Tw,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Iw,Cw]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Sw]}],"font-family":[{font:[Mw]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Tw]}],"line-clamp":[{"line-clamp":["none",kw,Sw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",jw,Tw]}],"list-image":[{"list-image":["none",Tw]}],"list-style-type":[{list:["none","disc","decimal",Tw]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","none","wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",jw,Cw]}],"underline-offset":[{"underline-offset":["auto",jw,Tw]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:S()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Tw]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Tw]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",Pw]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Dw]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Lw]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:["solid","dashed","dotted","double","none","hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["","solid","dashed","dotted","double","none"]}],"outline-offset":[{"outline-offset":[jw,Tw]}],"outline-w":[{outline:[jw,Cw]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:E()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[jw,Cw]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Iw,Ow]}],"shadow-color":[{shadow:[Mw]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Iw,Tw]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[u]}],saturate:[{saturate:[b]}],sepia:[{sepia:[y]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[y]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Tw]}],duration:[{duration:I()}],ease:[{ease:["linear","in","out","in-out",Tw]}],delay:[{delay:I()}],animate:[{animate:["none","spin","ping","pulse","bounce",Tw]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[Ew,Tw]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Tw]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Tw]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":S()}],"scroll-mx":[{"scroll-mx":S()}],"scroll-my":[{"scroll-my":S()}],"scroll-ms":[{"scroll-ms":S()}],"scroll-me":[{"scroll-me":S()}],"scroll-mt":[{"scroll-mt":S()}],"scroll-mr":[{"scroll-mr":S()}],"scroll-mb":[{"scroll-mb":S()}],"scroll-ml":[{"scroll-ml":S()}],"scroll-p":[{"scroll-p":S()}],"scroll-px":[{"scroll-px":S()}],"scroll-py":[{"scroll-py":S()}],"scroll-ps":[{"scroll-ps":S()}],"scroll-pe":[{"scroll-pe":S()}],"scroll-pt":[{"scroll-pt":S()}],"scroll-pr":[{"scroll-pr":S()}],"scroll-pb":[{"scroll-pb":S()}],"scroll-pl":[{"scroll-pl":S()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Tw]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[jw,Cw,Sw]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}});function qw(...e){return Bw(function(){for(var e,t,s=0,r="",n=arguments.length;s<n;s++)(e=arguments[s])&&(t=Yb(e))&&(r&&(r+=" "),r+=t);return r}(e))}const Hw=f.forwardRef((e,t)=>{var s=e,{className:r,type:n="text",variant:i="default",size:a="default",error:o,label:l,helperText:c,leftIcon:u,rightIcon:m,onLeftIconClick:p,onRightIconClick:f}=s,g=h(s,["className","type","variant","size","error","label","helperText","leftIcon","rightIcon","onLeftIconClick","onRightIconClick"]);const x=qw("w-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-black",{default:"bg-black/50 border border-white/20 text-white placeholder-white/50 focus:border-white/50 focus:ring-white/50",glass:"bg-white/10 backdrop-blur-md border border-white/20 text-white placeholder-white/50 focus:border-white/50 focus:ring-white/50",filled:"bg-white/5 border border-white/10 text-white placeholder-white/50 focus:border-white/50 focus:ring-white/50",outline:"bg-transparent border-2 border-white/20 text-white placeholder-white/50 focus:border-white/50 focus:ring-white/50"}[i],{sm:"px-3 py-2 text-sm rounded-lg",default:"px-4 py-3 text-base rounded-xl",lg:"px-6 py-4 text-lg rounded-2xl"}[a],o?"border-red-500 focus:border-red-500 focus:ring-red-500":"",r),v=u&&p,b=m&&f;return Je.jsxs("div",{className:"w-full",children:[l&&Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:l}),Je.jsxs("div",{className:"relative",children:[v&&Je.jsx("button",{type:"button",onClick:p,className:"absolute left-3 top-1/2 transform -translate-y-1/2 p-1 text-white/50 hover:text-white/70 transition-colors focus:outline-none focus:ring-2 focus:ring-white/50 focus:ring-offset-2 focus:ring-offset-black rounded","aria-label":"Ação do ícone esquerdo",children:Je.jsx(u,{className:"w-4 h-4"})}),Je.jsx("input",d({type:n,className:qw(x,v&&"pl-10",b&&"pr-10"),ref:t},g)),b&&Je.jsx("button",{type:"button",onClick:f,className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-1 text-white/50 hover:text-white/70 transition-colors focus:outline-none focus:ring-2 focus:ring-white/50 focus:ring-offset-2 focus:ring-offset-black rounded","aria-label":"Ação do ícone direito",children:Je.jsx(m,{className:"w-4 h-4"})})]}),o&&Je.jsx("p",{className:"mt-1 text-sm text-red-400",children:o}),c&&!o&&Je.jsx("p",{className:"mt-1 text-sm text-white/50",children:c})]})});Hw.displayName="Input";const Gw=x.forwardRef((e,t)=>{var s=e,{className:r,variant:n="default",padding:i="md",hover:a=!1,children:o}=s,l=h(s,["className","variant","padding","hover","children"]);const c=a?"hover:bg-white/10 hover:border-white/20 hover:scale-[1.02]":"";return Je.jsx("div",u(d({ref:t,className:qw("rounded-2xl transition-all duration-300",{default:"bg-white/5 border border-white/10",glass:"bg-white/10 backdrop-blur-md border border-white/20",elevated:"bg-white/5 border border-white/10 shadow-2xl",bordered:"bg-transparent border-2 border-white/20"}[n],{none:"",sm:"p-4",md:"p-6",lg:"p-8"}[i],c,r)},l),{children:o}))});Gw.displayName="Card";const Ww=x.forwardRef((e,t)=>{var s=e,{className:r}=s,n=h(s,["className"]);return Je.jsx("div",d({ref:t,className:qw("flex flex-col space-y-1.5 pb-4",r)},n))}),Kw=x.forwardRef((e,t)=>{var s=e,{className:r}=s,n=h(s,["className"]);return Je.jsx("h3",d({ref:t,className:qw("text-lg font-semibold leading-none tracking-tight text-white",r)},n))}),Qw=x.forwardRef((e,t)=>{var s=e,{className:r}=s,n=h(s,["className"]);return Je.jsx("p",d({ref:t,className:qw("text-sm text-white/70",r)},n))}),Jw=x.forwardRef((e,t)=>{var s=e,{className:r}=s,n=h(s,["className"]);return Je.jsx("div",d({ref:t,className:qw("pt-0",r)},n))}),Yw=x.forwardRef((e,t)=>{var s=e,{className:r}=s,n=h(s,["className"]);return Je.jsx("div",d({ref:t,className:qw("flex items-center pt-4",r)},n))});Gw.Header=Ww,Gw.Title=Kw,Gw.Description=Qw,Gw.Content=Jw,Gw.Footer=Yw;const Xw=({trigger:e,duration:t=3e3})=>{const s=f.useRef(null),r=f.useRef([]),n=f.useRef(null);return f.useEffect(()=>{if(!e)return;const i=s.current,a=i.getContext("2d"),o=()=>{i.width=window.innerWidth,i.height=window.innerHeight};o(),window.addEventListener("resize",o);const l=["#667eea","#764ba2","#f093fb","#4facfe","#00f2fe","#43e97b","#38f9d7"];class c{constructor(){this.x=Math.random()*i.width,this.y=-10,this.w=10*Math.random()+5,this.h=5*Math.random()+2,this.rotation=360*Math.random(),this.rotationSpeed=10*Math.random()-5,this.speedX=6*Math.random()-3,this.speedY=3*Math.random()+2,this.gravity=.1,this.color=l[Math.floor(Math.random()*l.length)],this.opacity=1,this.fadeSpeed=.02*Math.random()+.01}update(){this.x+=this.speedX,this.y+=this.speedY,this.speedY+=this.gravity,this.rotation+=this.rotationSpeed,this.opacity-=this.fadeSpeed,(this.x>i.width||this.x<0)&&(this.speedX*=-.8),this.y>i.height&&(this.speedY*=-.6,this.y=i.height)}draw(){a.save(),a.translate(this.x,this.y),a.rotate(this.rotation*Math.PI/180),a.globalAlpha=this.opacity,a.fillStyle=this.color,a.fillRect(-this.w/2,-this.h/2,this.w,this.h),a.restore()}isDead(){return this.opacity<=0||this.y>i.height+50}}r.current=[];for(let e=0;e<150;e++)r.current.push(new c);const d=()=>{a.clearRect(0,0,i.width,i.height),r.current=r.current.filter(e=>(e.update(),e.draw(),!e.isDead())),r.current.length>0&&(n.current=requestAnimationFrame(d))};d();const u=setTimeout(()=>{n.current&&cancelAnimationFrame(n.current)},t);return()=>{window.removeEventListener("resize",o),n.current&&cancelAnimationFrame(n.current),clearTimeout(u)}},[e,t]),Je.jsx("canvas",{ref:s,className:"fixed inset-0 pointer-events-none z-50",style:{background:"transparent"}})},Zw=()=>{const[t,s]=f.useState([]),[r,n]=f.useState([]),[i,a]=f.useState(""),[o,l]=f.useState("all"),[c,h]=f.useState(!1),[m,g]=f.useState(0);Vb(),f.useEffect(()=>{const e=[{id:"1",name:"Ansiedade e Bem-estar",description:"Grupo de apoio para pessoas que lidam com ansiedade. Compartilhe experiências e aprenda técnicas de relaxamento.",memberCount:127,maxMembers:200,isPrivate:!1,category:"Saúde Mental",tags:["ansiedade","bem-estar","apoio"],createdAt:"2024-01-15",lastActivity:"2024-01-20",isMember:!1,isFeatured:!0,rating:4.8},{id:"2",name:"Psicólogos em Ação",description:"Comunidade exclusiva para psicólogos trocarem experiências e discutirem casos clínicos.",memberCount:45,maxMembers:100,isPrivate:!0,category:"Profissional",tags:["psicologia","casos clínicos","profissional"],createdAt:"2024-01-10",lastActivity:"2024-01-19",isMember:!0,isFeatured:!1,rating:4.9},{id:"3",name:"Meditação e Mindfulness",description:"Aprenda técnicas de meditação e mindfulness para melhorar sua saúde mental e qualidade de vida.",memberCount:89,maxMembers:150,isPrivate:!1,category:"Bem-estar",tags:["meditação","mindfulness","bem-estar"],createdAt:"2024-01-12",lastActivity:"2024-01-18",isMember:!1,isFeatured:!0,rating:4.7},{id:"4",name:"Depressão - Juntos Somos Mais Fortes",description:"Espaço seguro para compartilhar experiências sobre depressão e encontrar apoio mútuo.",memberCount:203,maxMembers:300,isPrivate:!1,category:"Saúde Mental",tags:["depressão","apoio","comunidade"],createdAt:"2024-01-05",lastActivity:"2024-01-21",isMember:!1,isFeatured:!0,rating:4.9},{id:"5",name:"Relacionamentos Saudáveis",description:"Discussões sobre como construir e manter relacionamentos saudáveis e equilibrados.",memberCount:156,maxMembers:250,isPrivate:!1,category:"Relacionamentos",tags:["relacionamentos","saudável","comunicação"],createdAt:"2024-01-08",lastActivity:"2024-01-20",isMember:!1,isFeatured:!1,rating:4.6}],t=e.filter(e=>e.isMember);s(e),n(t)},[]);const x=f.useCallback(()=>p(e,null,function*(){}),[]),v=f.useCallback(()=>p(e,null,function*(){}),[]),b=f.useCallback(t=>p(e,null,function*(){t.preventDefault();try{const e=u(d({},w),{id:Date.now().toString(),memberCount:1,isMember:!0,category:"Personalizado",tags:[],createdAt:(new Date).toISOString().split("T")[0],lastActivity:(new Date).toISOString().split("T")[0],isFeatured:!1,rating:0});s(t=>[e,...t]),n(t=>[e.id,...t]),h(!1),y({name:"",description:"",isPrivate:!1,maxMembers:50}),g(e=>e+1)}catch(e){}}),[w]),[w,y]=f.useState({name:"",description:"",isPrivate:!1,maxMembers:50}),N=t.filter(e=>{const t=e.name.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase()),s="all"===o||"public"===o&&!e.isPrivate||"private"===o&&e.isPrivate||"member"===o&&e.isMember||"featured"===o&&e.isFeatured;return t&&s}),C=t.filter(e=>e.isFeatured);return Je.jsxs(Je.Fragment,{children:[Je.jsx(Xw,{trigger:m}),Je.jsx("div",{className:"min-h-screen bg-black py-8 animation-initial animate-fade-in-up animation-delay-100",children:Je.jsxs("div",{className:"max-w-7xl mx-auto",children:[Je.jsxs("div",{className:"mb-8 text-center",children:[Je.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2 section-header",children:"Explorar Grupos da Comunidade"}),Je.jsx("p",{className:"text-lg text-gray-600",children:"Conecte-se com pessoas que compartilham interesses similares e participe de grupos de apoio"})]}),C.length>0&&Je.jsxs("div",{className:"mb-8",children:[Je.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Je.jsx(j,{className:"w-6 h-6 text-yellow-500"}),Je.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Grupos em Destaque"})]}),Je.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(e=>Je.jsx(ey,{group:e,onJoin:x,onLeave:v,isUserGroup:e.isMember,isFeatured:!0},e.id))})]}),Je.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-8",children:[Je.jsx("div",{className:"flex-1",children:Je.jsx(Hw,{type:"text",placeholder:"Pesquisar grupos...",value:i,onChange:e=>a(e.target.value),leftIcon:B,className:"w-full"})}),Je.jsxs("div",{className:"flex gap-2",children:[Je.jsxs("select",{value:o,onChange:e=>l(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[Je.jsx("option",{value:"all",children:"Todos os Grupos"}),Je.jsx("option",{value:"featured",children:"Em Destaque"}),Je.jsx("option",{value:"public",children:"Grupos Públicos"}),Je.jsx("option",{value:"private",children:"Grupos Privados"}),Je.jsx("option",{value:"member",children:"Meus Grupos"})]}),Je.jsxs("button",{onClick:()=>h(!0),className:"btn-primary flex items-center gap-2",children:[Je.jsx(H,{className:"w-5 h-5"}),"Criar Grupo"]})]})]}),r.length>0&&Je.jsxs("div",{className:"mb-8",children:[Je.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 section-header",children:"Meus Grupos"}),Je.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(e=>{const s=t.find(t=>t.id===e);return s?Je.jsx(ey,{group:s,onLeave:v,isUserGroup:!0},s.id):null})})]}),Je.jsxs("div",{children:[Je.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 section-header",children:"member"===o?"Meus Grupos":"Todos os Grupos"}),Je.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(e=>Je.jsx(ey,{group:e,onJoin:x,onLeave:v,isUserGroup:e.isMember},e.id))})]}),c&&Je.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Je.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[Je.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Criar Novo Grupo"}),Je.jsxs("form",{onSubmit:b,className:"space-y-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Grupo"}),Je.jsx(Hw,{type:"text",value:w.name,onChange:e=>y(t=>u(d({},t),{name:e.target.value})),placeholder:"Digite o nome do grupo",required:!0})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição"}),Je.jsx("textarea",{value:w.description,onChange:e=>y(t=>u(d({},t),{description:e.target.value})),placeholder:"Descreva o propósito do grupo",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",required:!0})]}),Je.jsx("div",{className:"flex items-center gap-4",children:Je.jsxs("label",{className:"flex items-center",children:[Je.jsx("input",{type:"checkbox",checked:w.isPrivate,onChange:e=>y(t=>u(d({},t),{isPrivate:e.target.checked})),className:"mr-2"}),"Grupo Privado"]})}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Máximo de Membros"}),Je.jsx(Hw,{type:"number",value:w.maxMembers,onChange:e=>y(t=>u(d({},t),{maxMembers:parseInt(e.target.value)})),min:"2",max:"1000"})]}),Je.jsxs("div",{className:"flex gap-3 pt-4",children:[Je.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancelar"}),Je.jsx("button",{type:"submit",className:"flex-1 btn-primary",children:"Criar Grupo"})]})]})]})})]})})]})},ey=({group:e,onJoin:t,onLeave:s,isUserGroup:r,isFeatured:n=!1})=>Je.jsx(Gw,{className:"group hover:shadow-lg transition-all duration-300",children:Je.jsxs("div",{className:"p-6",children:[Je.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Je.jsxs("div",{className:"flex items-center gap-2",children:[Je.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center",children:Je.jsx(A,{className:"w-5 h-5 text-black"})}),Je.jsxs("div",{children:[Je.jsx("h3",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:e.name}),Je.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.isPrivate?Je.jsxs(Je.Fragment,{children:[Je.jsx(G,{className:"w-4 h-4"}),Je.jsx("span",{children:"Privado"})]}):Je.jsxs(Je.Fragment,{children:[Je.jsx(W,{className:"w-4 h-4"}),Je.jsx("span",{children:"Público"})]}),n&&Je.jsx(j,{className:"w-4 h-4 text-yellow-500"})]})]})]}),e.isMember&&Je.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:"Membro"})]}),Je.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3",children:e.description}),Je.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[Je.jsxs("span",{children:[e.memberCount,"/",e.maxMembers," membros"]}),Je.jsxs("div",{className:"flex items-center gap-2",children:[Je.jsx(j,{className:"w-4 h-4 text-yellow-500"}),Je.jsx("span",{children:e.rating})]})]}),Je.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:e.tags.slice(0,3).map((e,t)=>Je.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e},t))}),Je.jsx("div",{className:"flex gap-2",children:r?Je.jsx("button",{onClick:()=>s(e.id),className:"flex-1 px-4 py-2 border border-red-300 text-red-700 rounded-lg hover:bg-red-50 transition-colors",children:"Sair do Grupo"}):Je.jsx("button",{onClick:()=>t(e.id),className:"flex-1 btn-primary",children:"Entrar no Grupo"})})]})}),ty=()=>{const e=f.useRef(null),t=f.useRef(null),s=f.useRef(0),r=f.useCallback((e,t)=>{let s;return function(){const r=arguments,n=this;s||(e.apply(n,r),s=!0,setTimeout(()=>s=!1,t))}},[]),n=f.useCallback(()=>window.innerWidth<=768,[]);return f.useEffect(()=>{const t=e.current;if(!t)return;const i=t.getContext("2d");let a;const o=r(()=>{const e=window.devicePixelRatio||1,s=t.getBoundingClientRect();t.width=s.width*e,t.height=s.height*e,i.scale(e,e),t.style.width=s.width+"px",t.style.height=s.height+"px"},100);o(),window.addEventListener("resize",o,{passive:!0});const l=[],c=n()?25:50,d=n()?3:5;class u{constructor(){this.x=Math.random()*t.width,this.y=Math.random()*t.height,this.size=1.5*Math.random()+.5,this.speedX=(.3*Math.random()-.15)*(n()?.5:1),this.speedY=(.3*Math.random()-.15)*(n()?.5:1),this.opacity=.2*Math.random()+.05,this.connections=0}update(){this.x+=this.speedX,this.y+=this.speedY,this.x>t.width&&(this.x=0),this.x<0&&(this.x=t.width),this.y>t.height&&(this.y=0),this.y<0&&(this.y=t.height)}draw(){i.save(),i.globalAlpha=this.opacity,i.fillStyle="rgba(255, 255, 255, 0.6)",i.beginPath(),i.arc(this.x,this.y,this.size,0,2*Math.PI),i.fill(),i.restore()}}for(let e=0;e<c;e++)l.push(new u);const h=e=>{if(e-s.current<16)return void(a=requestAnimationFrame(h));s.current=e,i.clearRect(0,0,t.width,t.height);const r=i.createRadialGradient(t.width/2,t.height/2,0,t.width/2,t.height/2,t.width/2);r.addColorStop(0,"rgba(255, 255, 255, 0.015)"),r.addColorStop(1,"rgba(255, 255, 255, 0)"),i.fillStyle=r,i.fillRect(0,0,t.width,t.height),l.forEach(e=>{e.update(),e.draw(),e.connections=0}),l.forEach((e,t)=>{if(!(e.connections>=d))for(let s=t+1;s<l.length;s++){if(l[s].connections>=d)continue;const t=e.x-l[s].x,r=e.y-l[s].y,a=Math.sqrt(t*t+r*r);a<(n()?80:100)&&(i.save(),i.globalAlpha=((n()?80:100)-a)/(n()?80:100)*.08,i.strokeStyle="rgba(255, 255, 255, 0.2)",i.lineWidth=.3,i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(l[s].x,l[s].y),i.stroke(),i.restore(),e.connections++,l[s].connections++)}}),a=requestAnimationFrame(h)};return h(0),()=>{window.removeEventListener("resize",o),a&&cancelAnimationFrame(a)}},[]),f.useEffect(()=>{const e=()=>{document.hidden&&t.current&&cancelAnimationFrame(t.current)};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]),Je.jsx("canvas",{ref:e,className:"fixed inset-0 pointer-events-none z-0",style:{opacity:.25,willChange:"transform",backfaceVisibility:"hidden"},"aria-hidden":"true"})},sy={},ry=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in sy)return;sy[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,s&&n.setAttribute("nonce",s),document.head.appendChild(n),t?new Promise((t,s)=>{n.addEventListener("load",t),n.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})},ny=[{id:"1",content:"Hoje foi um dia incrível! Consegui enfrentar uma situação que me causava muita ansiedade. A terapia está realmente fazendo diferença na minha vida. É incrível como pequenos passos podem levar a grandes mudanças! 💪✨",author:"Maria Silva",userId:"user1",avatar:null,createdAt:new Date("2024-01-15T10:00:00"),updatedAt:new Date("2024-01-15T10:00:00"),likes:["user2","user3"],commentCount:2,shares:1,tags:["ansiedade","terapia","progresso"],isAnonymous:!1,visibility:"public",isEdited:!1},{id:"2",content:"Estou me sentindo um pouco perdido ultimamente. Alguém mais já passou por isso? Às vezes parece que estou andando em círculos...",author:"João Santos",userId:"user2",avatar:null,createdAt:new Date("2024-01-15T09:30:00"),updatedAt:new Date("2024-01-15T09:30:00"),likes:["user1"],commentCount:1,shares:0,tags:["reflexão","apoio"],isAnonymous:!1,visibility:"public",isEdited:!1},{id:"3",content:"Dica do dia: respiração 4-7-8. Inspire por 4 segundos, segure por 7, expire por 8. Funciona muito bem para momentos de estresse! 🧘‍♀️",author:"Ana Costa",userId:"user3",avatar:null,createdAt:new Date("2024-01-15T09:00:00"),updatedAt:new Date("2024-01-15T09:00:00"),likes:["user1","user2","user4"],commentCount:0,shares:3,tags:["dica","respiração","estresse"],isAnonymous:!1,visibility:"public",isEdited:!1},{id:"4",content:"Post anônimo para testar funcionalidade",author:"Usuário Anônimo",userId:"user1",avatar:null,createdAt:new Date("2024-01-15T08:30:00"),updatedAt:new Date("2024-01-15T08:30:00"),likes:[],commentCount:0,shares:0,tags:["teste"],isAnonymous:!0,visibility:"anonymous",isEdited:!1}],iy=[{id:"user1",displayName:"Maria Silva",email:"maria@email.com",photoURL:null,role:"cliente",bio:"Em busca de equilíbrio mental e emocional",location:"São Paulo, SP",createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-15")},{id:"user2",displayName:"João Santos",email:"joao@email.com",photoURL:null,role:"cliente",bio:"Aprendendo a lidar com a ansiedade",location:"Rio de Janeiro, RJ",createdAt:new Date("2024-01-05"),updatedAt:new Date("2024-01-15")},{id:"user3",displayName:"Ana Costa",email:"ana@email.com",photoURL:null,role:"cliente",bio:"Psicóloga em formação, apaixonada por ajudar pessoas",location:"Belo Horizonte, MG",createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-15")}],ay=[{id:"1",postId:"1",authorId:"user2",authorName:"João Santos",authorAvatar:null,content:"Que ótimo que está se sentindo melhor! A terapia realmente faz diferença.",likes:[],createdAt:new Date("2024-01-15T10:05:00")},{id:"2",postId:"1",authorId:"user3",authorName:"Ana Costa",authorAvatar:null,content:"Continue assim! O progresso é gradual mas muito gratificante.",likes:["user1"],createdAt:new Date("2024-01-15T10:10:00")}],oy={createUserProfile(e,t){return p(this,null,function*(){try{const s=ex(Lb,"users",e);return yield lv(s,u(d({},t),{createdAt:gv(),updatedAt:gv()})),{success:!0,userId:e}}catch(s){throw s}})},getUserProfile(e){return p(this,null,function*(){try{const t=ex(Lb,"users",e),s=yield nv(t);return s.exists()?d({id:s.id},s.data()):null}catch(t){return iy.find(t=>t.id===e)||null}})},updateUserProfile(e,t){return p(this,null,function*(){try{const s=ex(Lb,"users",e);return yield lv(s,u(d({},t),{updatedAt:gv()})),{success:!0}}catch(s){throw s}})},updateUserBasicProfile(e,t){return p(this,null,function*(){try{const s=ex(Lb,"users",e);return yield lv(s,{displayName:t.displayName,username:t.username,bio:t.bio,phone:t.phone,birthDate:t.birthDate,updatedAt:gv()}),{success:!0}}catch(s){throw s}})},getUsersByRole(e){return p(this,null,function*(){try{const t=Vx(Zg(Lb,"users"),$x("role","==",e));return(yield av(t)).docs.map(e=>d({id:e.id},e.data()))}catch(t){return iy.filter(t=>t.role===e)}})}},ly={createPost(e){return p(this,null,function*(){try{const t=Zg(Lb,"posts");return{success:!0,postId:(yield dv(t,u(d({},e),{createdAt:gv(),updatedAt:gv(),likes:[],commentCount:0,shares:0,isEdited:!1}))).id}}catch(t){throw t}})},deletePost(e){return p(this,null,function*(){try{const t=ex(Lb,"posts",e),s=yield nv(t);if(s.exists()){s.data(),yield cv(t);const r=Vx(Zg(Lb,"comments"),$x("postId","==",e)),n=(yield av(r)).docs.map(e=>cv(e.ref));return yield Promise.all(n),!0}return!1}catch(t){throw t}})},getPosts(e=20,t=0){return p(this,null,function*(){try{let t=Vx(Zg(Lb,"posts"),Hx("createdAt","desc"),Wx(e));const s=yield av(t);return s.docs.map(e=>d({id:e.id},e.data())).filter(e=>"public"===e.visibility)}catch(s){return"failed-precondition"===s.code||s.code,ny.filter(e=>"public"===e.visibility).slice(t,t+e)}})},getUserPosts(e,t=50,s=null){return p(this,null,function*(){try{let r=Vx(Zg(Lb,"posts"),Hx("createdAt","desc"),Wx(t));const n=yield av(r);return n.docs.map(e=>d({id:e.id},e.data())).filter(t=>s===e?t.userId===e:t.userId===e&&"public"===t.visibility)}catch(r){return"failed-precondition"===r.code||r.code,ny.filter(t=>s===e?t.userId===e:t.userId===e&&"public"===t.visibility).slice(0,t)}})},togglePostLike(e,t){return p(this,null,function*(){try{const r=ex(Lb,"posts",e),n=yield nv(r);if(n.exists()){const i=n.data(),a=i.likes||[];if(a.includes(t))yield lv(r,{likes:a.filter(e=>e!==t),updatedAt:gv()});else if(yield lv(r,{likes:[...a,t],updatedAt:gv()}),i.userId!==t)try{yield dy.createLikeNotification(e,i.userId,t,"Usuário")}catch(s){}return!0}return!1}catch(s){throw s}})}},cy={recordMood(e,t){return p(this,null,function*(){try{const s=Zg(Lb,"moods");return{success:!0,moodId:(yield dv(s,u(d({userId:e},t),{recordedAt:gv()}))).id}}catch(s){throw s}})},getUserMoodHistory(e,t=30){return p(this,null,function*(){try{const s=Vx(Zg(Lb,"moods"),Hx("recordedAt","desc"),Wx(t)),r=yield av(s);return r.docs.map(e=>d({id:e.id},e.data())).filter(t=>t.userId===e)}catch(s){return"failed-precondition"===s.code||s.code,[]}})},getMoodStats(e,t="week"){return p(this,null,function*(){try{const s=Vx(Zg(Lb,"moods"),Hx("recordedAt","desc")),r=(yield av(s)).docs.map(e=>e.data()).filter(t=>t.userId===e),n=new Date;let i=[];if("week"===t){const e=new Date(n.getTime()-6048e5);i=r.filter(t=>{var s;return(null==(s=t.recordedAt)?void 0:s.toDate())>e})}else if("month"===t){const e=new Date(n.getTime()-2592e6);i=r.filter(t=>{var s;return(null==(s=t.recordedAt)?void 0:s.toDate())>e})}const a=i.reduce((e,t)=>e+(t.intensity||0),0),o=i.length>0?a/i.length:0;return{totalEntries:i.length,averageMood:Math.round(10*o)/10,period:t,moods:i}}catch(s){return"failed-precondition"===s.code||s.code,{totalEntries:0,averageMood:0,period:t,moods:[]}}})}},dy={createNotification(e){return p(this,null,function*(){try{const t=Zg(Lb,"notifications");return{success:!0,notificationId:(yield dv(t,u(d({},e),{createdAt:gv(),read:!1}))).id}}catch(t){throw t}})},getUserNotifications(e,t=50){return p(this,null,function*(){try{const s=Vx(Zg(Lb,"notifications"),Hx("createdAt","desc"),Wx(t)),r=yield av(s);return r.docs.map(e=>d({id:e.id},e.data())).filter(t=>t.recipientId===e)}catch(s){return"failed-precondition"===s.code||s.code,[]}})},markNotificationAsRead(e){return p(this,null,function*(){try{const t=ex(Lb,"notifications",e);return yield lv(t,{read:!0,readAt:gv()}),!0}catch(t){throw t}})},markAllNotificationsAsRead(e){return p(this,null,function*(){try{const t=Vx(Zg(Lb,"notifications"),Hx("createdAt","desc")),s=yield av(t),r=vv(Lb);return s.docs.filter(t=>{const s=t.data();return s.recipientId===e&&!s.read}).forEach(e=>{r.update(e.ref,{read:!0,readAt:gv()})}),yield r.commit(),!0}catch(t){return"failed-precondition"===t.code||"unimplemented"===t.code}})},deleteNotification(e){return p(this,null,function*(){try{const t=ex(Lb,"notifications",e);return yield cv(t),!0}catch(t){throw t}})},clearAllNotifications(e){return p(this,null,function*(){try{const t=Vx(Zg(Lb,"notifications"),Hx("createdAt","desc")),s=yield av(t),r=vv(Lb);return s.docs.filter(t=>t.data().recipientId===e).forEach(e=>{r.delete(e.ref)}),yield r.commit(),!0}catch(t){return"failed-precondition"===t.code||"unimplemented"===t.code}})},createLikeNotification(e,t,s,r){return p(this,null,function*(){if(t!==s)try{yield this.createNotification({type:"like",title:"Curtida no seu post",message:`${r} curtiu seu post`,recipientId:t,senderId:s,senderName:r,postId:e,actionUrl:`/post/${e}`})}catch(n){}})},createCommentNotification(e,t,s,r,n){return p(this,null,function*(){if(t!==s)try{yield this.createNotification({type:"comment",title:"Novo comentário",message:`${r} comentou: "${n.substring(0,50)}${n.length>50?"...":""}"`,recipientId:t,senderId:s,senderName:r,postId:e,commentContent:n,actionUrl:`/post/${e}`})}catch(i){}})},createFollowNotification(e,t,s){return p(this,null,function*(){try{yield this.createNotification({type:"follow",title:"Novo seguidor",message:`${t} começou a te seguir`,recipientId:s,senderId:e,senderName:t,actionUrl:`/user-profile/${e}`})}catch(r){}})}},uy={addComment(e,t){return p(this,null,function*(){try{const r=Zg(Lb,"comments"),n=yield dv(r,u(d({postId:e},t),{createdAt:gv(),likes:[],isHidden:!1,isReported:!1,reportedBy:[],reportReasons:[]})),i=ex(Lb,"posts",e),a=yield nv(i);if(a.exists()){const r=a.data();if(yield lv(i,{commentCount:xv(1)}),r.userId!==t.userId)try{yield dy.createCommentNotification(e,r.userId,t.userId,"Usuário",t.content)}catch(s){}}return{success:!0,commentId:n.id}}catch(s){throw s}})},editComment(e,t){return p(this,null,function*(){try{const s=ex(Lb,"comments",e);return yield lv(s,{content:t,updatedAt:gv(),isEdited:!0}),!0}catch(s){throw s}})},deleteComment(e){return p(this,null,function*(){try{const t=ex(Lb,"comments",e),s=yield nv(t);if(s.exists()){const e=s.data();yield cv(t);const r=ex(Lb,"posts",e.postId);return yield lv(r,{commentCount:xv(-1)}),!0}return!1}catch(t){throw t}})},toggleCommentVisibility(e){return p(this,null,function*(){try{const t=ex(Lb,"comments",e),s=yield nv(t);if(s.exists()){const e=s.data().isHidden||!1;return yield lv(t,{isHidden:!e,updatedAt:gv()}),!0}return!1}catch(t){throw t}})},reportComment(e,t){return p(this,null,function*(){var s;try{const r=ex(Lb,"comments",e),n=yield nv(r);if(n.exists()){const e=n.data(),i=e.reportedBy||[],a=e.reportReasons||[];return yield lv(r,{isReported:!0,reportedBy:[...i,null==(s=auth.currentUser)?void 0:s.uid],reportReasons:[...a,t],updatedAt:gv()}),!0}return!1}catch(r){throw r}})},toggleCommentLike(e,t){return p(this,null,function*(){try{const s=ex(Lb,"comments",e),r=yield nv(s);if(r.exists()){const e=r.data().likes||[];return e.includes(t)?yield lv(s,{likes:e.filter(e=>e!==t),updatedAt:gv()}):yield lv(s,{likes:[...e,t],updatedAt:gv()}),!0}return!1}catch(s){throw s}})},getPostComments(e,t=50){return p(this,null,function*(){try{const s=Vx(Zg(Lb,"comments"),Hx("createdAt","asc"),Wx(t)),r=yield av(s);return r.docs.map(e=>d({id:e.id},e.data())).filter(t=>t.postId===e)}catch(s){return"failed-precondition"===s.code||s.code,ay.filter(t=>t.postId===e).slice(0,t)}})}},hy={createDiaryEntry(e){return p(this,null,function*(){try{const t=Zg(Lb,"diaryEntries");return{success:!0,entryId:(yield dv(t,u(d({},e),{createdAt:gv(),updatedAt:gv()}))).id}}catch(t){throw t}})},getUserDiaryEntries(e,t=50){return p(this,null,function*(){try{const r=Zg(Lb,"diaryEntries");try{const s=Vx(r,$x("userId","==",e),Hx("createdAt","desc"),Wx(t));return(yield av(s)).docs.map(e=>d({id:e.id},e.data()))}catch(s){if("failed-precondition"===s.code||"unimplemented"===s.code){const s=Vx(r,Hx("createdAt","desc"),Wx(2*t)),n=yield av(s);return n.docs.map(e=>d({id:e.id},e.data())).filter(t=>t.userId===e).slice(0,t)}throw s}}catch(r){return[]}})},updateDiaryEntry(e,t){return p(this,null,function*(){try{const s=ex(Lb,"diaryEntries",e);return yield lv(s,u(d({},t),{updatedAt:gv()})),{success:!0}}catch(s){throw s}})},deleteDiaryEntry(e){return p(this,null,function*(){try{const t=ex(Lb,"diaryEntries",e);return yield cv(t),{success:!0}}catch(t){throw t}})}},my={uploadPostImage(e,t){return p(this,null,function*(){try{const{storage:s}=yield ry(()=>p(this,null,function*(){const{storage:e}=yield Promise.resolve().then(()=>Mb);return{storage:e}}),[]),{ref:r,uploadBytes:n,getDownloadURL:i}=yield ry(()=>p(this,null,function*(){const{ref:e,uploadBytes:t,getDownloadURL:s}=yield Promise.resolve().then(()=>Tb);return{ref:e,uploadBytes:t,getDownloadURL:s}}),void 0);if(!e||!e.type.startsWith("image/"))throw new Error("Arquivo deve ser uma imagem");if(e.size>5242880)throw new Error("Imagem deve ter menos de 5MB");const a=Date.now(),o=`posts/${t}/${a}_${e.name}`,l=r(s,o),c=yield n(l,e);return{success:!0,url:yield i(c.ref),fileName:o,size:e.size,type:e.type}}catch(s){throw s}})},deletePostImage(e){return p(this,null,function*(){try{const{storage:t}=yield ry(()=>p(this,null,function*(){const{storage:e}=yield Promise.resolve().then(()=>Mb);return{storage:e}}),void 0),{ref:s,deleteObject:r}=yield ry(()=>p(this,null,function*(){const{ref:e,deleteObject:t}=yield Promise.resolve().then(()=>Tb);return{ref:e,deleteObject:t}}),void 0),n=s(t,e);return yield r(n),{success:!0}}catch(t){throw t}})},validateImageFile(e){const t=[];e.type.startsWith("image/")||t.push("Arquivo deve ser uma imagem"),e.size>5242880&&t.push("Imagem deve ter menos de 5MB");const s="."+e.name.split(".").pop().toLowerCase();return[".jpg",".jpeg",".png",".gif",".webp"].includes(s)||t.push("Formato de imagem não suportado. Use: JPG, PNG, GIF ou WebP"),{isValid:0===t.length,errors:t}}},py={convertTimestamp:e=>e&&e.toDate?e.toDate():e,formatDate(e,t={}){return(e instanceof Date?e:this.convertTimestamp(e)).toLocaleDateString("pt-BR",d(d({},{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),t))},getRelativeTime(e){const t=new Date,s=e instanceof Date?e:this.convertTimestamp(e),r=t-s,n=Math.floor(r/6e4),i=Math.floor(r/36e5),a=Math.floor(r/864e5);return n<1?"Agora mesmo":n<60?`${n}m atrás`:i<24?`${i}h atrás`:a<7?`${a}d atrás`:this.formatDate(s,{year:"numeric",month:"short",day:"numeric"})}},fy=()=>{const[t,s]=f.useState({username:"",birthDate:"",phone:"",bio:"",profilePhotoURL:"",bannerPhotoURL:""}),[r,n]=f.useState(!1),[i,a]=f.useState(null),[o,l]=f.useState(null),[c,h]=f.useState(null),[m,g]=f.useState(null),x=Ot(),b=f.useRef(),w=f.useRef();f.useEffect(()=>{const t=Pb.onAuthStateChanged(t=>p(e,null,function*(){if(t){a(t);const e=ex(Lb,"users",t.uid),s=yield nv(e);if(s.exists()){const e=s.data();if(l(e),e.username&&e.phone&&e.birthDate)return void x("/home")}}else x("/login")}));return()=>t()},[x]);const y=e=>{const{name:r,value:n}=e.target;s(u(d({},t),{[r]:n}))},N=(e,t)=>{const r=e.target.files[0];if(r){if(!r.type.startsWith("image/"))return void alert("Por favor, selecione apenas arquivos de imagem.");if(r.size>2097152)return void alert("A imagem deve ter no máximo 2MB para upload direto.");const e=new FileReader;e.onload=e=>{const r=e.target.result;"profile"===t?(s(e=>u(d({},e),{profilePhotoURL:r})),h(r)):(s(e=>u(d({},e),{bannerPhotoURL:r})),g(r))},e.readAsDataURL(r)}},j=e=>{"profile"===e?(s(e=>u(d({},e),{profilePhotoURL:""})),h(null)):(s(e=>u(d({},e),{bannerPhotoURL:""})),g(null))};return i?Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden text-white",children:[Je.jsx(ty,{}),Je.jsxs("div",{className:"relative w-full max-w-2xl z-10",children:[Je.jsx("button",{type:"button",onClick:()=>{Pb.signOut(),x("/login")},className:"absolute -top-2 -left-2 p-2 text-white/80 hover:text-white transition-colors","aria-label":"Sair e voltar para login",children:Je.jsx(O,{className:"w-6 h-6"})}),Je.jsxs("div",{className:"text-center mb-6",children:[Je.jsx("div",{className:"flex items-center justify-center mb-3",children:Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/10 border border-white/20 flex items-center justify-center backdrop-blur-md",children:Je.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-full h-full object-contain p-1",loading:"eager"})})}),Je.jsx("h1",{className:"text-2xl font-semibold text-white mb-1",children:"Sereno"}),Je.jsx("p",{className:"text-white/60 text-sm",children:"Complete seu perfil"})]}),Je.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 shadow-2xl",children:[Je.jsxs("div",{className:"mb-6",children:[Je.jsxs("h2",{className:"text-xl font-light text-white mb-2",children:["Bem-vindo, ",i.displayName||i.email,"!"]}),Je.jsx("p",{className:"text-white/60 text-sm",children:"Para continuar, precisamos de algumas informações adicionais"})]}),Je.jsxs("form",{onSubmit:s=>p(e,null,function*(){if(s.preventDefault(),t.username&&t.birthDate&&t.phone)if(/^[a-zA-Z0-9_]{3,20}$/.test(t.username)){n(!0);try{const s=ex(Lb,"users",i.uid),r={username:t.username.toLowerCase(),birthDate:t.birthDate,phone:t.phone,bio:t.bio||"",profilePhotoURL:t.profilePhotoURL||(null==o?void 0:o.profilePhotoURL)||null,bannerPhotoURL:t.bannerPhotoURL||(null==o?void 0:o.bannerPhotoURL)||null,updatedAt:gv(),createdAt:(null==o?void 0:o.createdAt)||gv(),email:i.email,displayName:i.displayName||i.email,role:"cliente",isProfileComplete:!0};yield ov(s,r,{merge:!0});try{yield dy.createNotification({type:"welcome",title:"Bem-vindo ao Sereno! 🎉",message:"Seu perfil foi criado com sucesso. Comece a explorar a plataforma e conectar-se com outros usuários.",recipientId:i.uid,senderId:"system",senderName:"Sereno",actionUrl:"/home"})}catch(e){}x("/connected")}catch(e){alert(`Erro ao salvar os dados: ${e.message}`)}finally{n(!1)}}else alert("O username deve ter entre 3 e 20 caracteres e conter apenas letras, números e underscore (_).");else alert("Por favor, preencha todos os campos obrigatórios.")}),className:"space-y-6",children:[Je.jsxs("div",{className:"space-y-4",children:[Je.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Fotos do Perfil (Opcional)"}),Je.jsxs("div",{className:"space-y-2",children:[Je.jsx("label",{className:"block text-sm font-light text-white/80",children:"Foto do Banner"}),Je.jsxs("div",{className:"relative",children:[Je.jsx("div",{className:"w-full h-32 bg-white/10 border-2 border-dashed border-white/20 rounded-lg flex items-center justify-center overflow-hidden",children:m?Je.jsx("img",{src:m,alt:"Preview do banner",className:"w-full h-full object-cover"}):Je.jsxs("div",{className:"text-center",children:[Je.jsx(K,{className:"w-8 h-8 text-white/40 mx-auto mb-2"}),Je.jsx("p",{className:"text-white/60 text-sm",children:"Clique para selecionar uma imagem"})]})}),Je.jsx("button",{type:"button",onClick:()=>{var e;return null==(e=w.current)?void 0:e.click()},className:"absolute inset-0 w-full h-full bg-black/50 opacity-0 hover:opacity-100 transition-opacity flex items-center justify-center",children:Je.jsx(Q,{className:"w-6 h-6 text-white"})}),m&&Je.jsx("button",{type:"button",onClick:()=>j("banner"),className:"absolute top-2 right-2 p-1 bg-red-500 hover:bg-red-600 rounded-full text-white transition-colors",children:Je.jsx(v,{className:"w-4 h-4"})}),Je.jsx("input",{ref:w,type:"file",accept:"image/*",onChange:e=>N(e,"banner"),className:"hidden"})]}),Je.jsx("p",{className:"text-xs text-white/50",children:"Tamanho máximo: 2MB. Formatos: JPG, PNG, GIF"})]}),Je.jsxs("div",{className:"space-y-2",children:[Je.jsx("label",{className:"block text-sm font-light text-white/80",children:"Foto de Perfil"}),Je.jsxs("div",{className:"flex items-center space-x-4",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx("div",{className:"w-24 h-24 bg-white/10 border-2 border-dashed border-white/20 rounded-full flex items-center justify-center overflow-hidden",children:c?Je.jsx("img",{src:c,alt:"Preview da foto de perfil",className:"w-full h-full object-cover"}):Je.jsx(J,{className:"w-12 h-12 text-white/40"})}),Je.jsx("button",{type:"button",onClick:()=>{var e;return null==(e=b.current)?void 0:e.click()},className:"absolute inset-0 w-full h-full bg-black/50 opacity-0 hover:opacity-100 transition-opacity flex items-center justify-center rounded-full",children:Je.jsx(Y,{className:"w-6 h-6 text-white"})}),c&&Je.jsx("button",{type:"button",onClick:()=>j("profile"),className:"absolute -top-1 -right-1 p-1 bg-red-500 hover:bg-red-600 rounded-full text-white transition-colors",children:Je.jsx(v,{className:"w-3 h-3"})}),Je.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:e=>N(e,"profile"),className:"hidden"})]}),Je.jsx("div",{className:"flex-1",children:Je.jsx("p",{className:"text-white/60 text-sm",children:"Selecione uma foto para seu perfil"})})]}),Je.jsx("p",{className:"text-xs text-white/50",children:"Tamanho máximo: 2MB. Formatos: JPG, PNG, GIF"})]})]}),Je.jsxs("div",{className:"space-y-4",children:[Je.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Informações Básicas"}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"username",className:"block text-xs font-light text-white/80",children:"Username *"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"text",id:"username",name:"username",value:t.username,onChange:y,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"seu_username",required:!0,minLength:3,maxLength:20,pattern:"[a-zA-Z0-9_]{3,20}"})]}),Je.jsx("p",{className:"text-xs text-white/50 mt-1",children:"3-20 caracteres, apenas letras, números e _"})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"birthDate",className:"block text-xs font-light text-white/80",children:"Data de Nascimento *"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"date",id:"birthDate",name:"birthDate",value:t.birthDate,onChange:y,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",required:!0})]})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"phone",className:"block text-xs font-light text-white/80",children:"Telefone *"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"tel",id:"phone",name:"phone",value:t.phone,onChange:y,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"(11) 99999-9999",required:!0})]})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"bio",className:"block text-xs font-light text-white/80",children:"Biografia"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(ee,{className:"absolute left-3 top-3 w-4 h-4 text-white/50"}),Je.jsx("textarea",{id:"bio",name:"bio",value:t.bio,onChange:y,rows:3,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm resize-none",placeholder:"Conte um pouco sobre você...",maxLength:200})]}),Je.jsxs("p",{className:"text-xs text-white/50 mt-1",children:[t.bio.length,"/200 caracteres"]})]})]}),Je.jsx("button",{type:"submit",disabled:r,className:"w-full py-2.5 px-4 bg-white text-black hover:bg-white/90 disabled:bg-white/60 font-medium rounded-lg transition-all duration-200 transform hover:scale-[1.02] disabled:scale-100 disabled:cursor-not-allowed shadow-lg text-sm",children:r?"Salvando...":"Completar Perfil"})]}),Je.jsx("div",{className:"mt-4 text-center",children:Je.jsx("p",{className:"text-white/70 text-xs",children:"Estes dados são necessários para personalizar sua experiência"})})]}),Je.jsx("div",{className:"mt-6 text-center text-white/50 text-xs",children:Je.jsxs("p",{children:["Conecte-se, Entenda-se, ",Je.jsx("span",{className:"text-white",children:"Evolua."})]})})]})]}):Je.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Je.jsx("div",{className:"text-white",children:"Carregando..."})})},gy=()=>{const t=Ot(),{markProfileAsComplete:s}=Vb(),[r,n]=f.useState(2);return f.useEffect(()=>{p(e,null,function*(){try{yield s()}catch(e){}});const r=setTimeout(()=>{t("/home")},2e3),i=setInterval(()=>{n(e=>e<=1?(clearInterval(i),0):e-1)},1e3);return()=>{clearTimeout(r),clearInterval(i)}},[t,s]),Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden text-white",children:[Je.jsx(ty,{}),Je.jsx("div",{className:"relative w-full max-w-lg z-10 text-center",children:Je.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-8 shadow-2xl",children:[Je.jsx("div",{className:"flex justify-center mb-6",children:Je.jsx("div",{className:"w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center",children:Je.jsx(te,{className:"w-12 h-12 text-green-400"})})}),Je.jsx("h1",{className:"text-3xl font-light mb-3 text-white",children:"Perfil Completo!"}),Je.jsx("p",{className:"text-white/70 text-lg mb-6",children:"Seu perfil foi criado com sucesso. Bem-vindo ao Sereno!"}),Je.jsxs("div",{className:"space-y-3 mb-8",children:[Je.jsxs("div",{className:"flex items-center justify-center space-x-2 text-white/60",children:[Je.jsx(J,{className:"w-4 h-4"}),Je.jsx("span",{children:"Perfil personalizado configurado"})]}),Je.jsxs("div",{className:"flex items-center justify-center space-x-2 text-white/60",children:[Je.jsx(y,{className:"w-4 h-4"}),Je.jsx("span",{children:"Pronto para explorar a plataforma"})]})]}),Je.jsxs("div",{className:"text-center mb-6",children:[Je.jsx("p",{className:"text-white/50 text-sm mb-2",children:"Redirecionando automaticamente em:"}),Je.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[r," segundos"]})]}),Je.jsx("button",{onClick:()=>{t("/home")},className:"w-full py-3 px-6 bg-white/10 border border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-200 transform hover:scale-[1.02] shadow-lg",children:"Ir para Home Agora (Teste)"})]})})]})},xy=()=>{const{user:t}=Vb(),[s,r]=f.useState(""),[n,i]=f.useState(""),[a,o]=f.useState([]),[l,c]=f.useState(!1),[d,u]=f.useState(null),[h,m]=f.useState("");f.useEffect(()=>{t&&g()},[t]);const g=()=>p(e,null,function*(){if(t)try{c(!0);const e=yield hy.getUserDiaryEntries(t.uid,20);o(e)}catch(e){}finally{c(!1)}}),x=()=>{u(null),m("")};return t?Je.jsxs("div",{className:"space-y-6 animation-initial animate-fade-in-up animation-delay-100",children:[Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Je.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Je.jsx(se,{className:"w-6 h-6 text-gray-400"}),Je.jsx("h2",{className:"text-xl font-semibold text-white",children:"Diário Evolutivo"})]}),Je.jsxs("div",{className:"mb-4",children:[Je.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Escolha uma reflexão para começar:"}),Je.jsx("div",{className:"space-y-2",children:["Como você se sentiu hoje?","Qual foi o melhor momento do seu dia?","O que você gostaria de melhorar amanhã?","Por que você está grato hoje?","Que desafio você enfrentou hoje?"].map((e,t)=>Je.jsx("button",{onClick:()=>i(e),className:"w-full text-left p-3 rounded-lg transition-all duration-200 "+(n===e?"bg-white/10 border border-white/20 text-white":"bg-gray-800/30 hover:bg-gray-700/30 text-gray-300"),children:Je.jsx("span",{className:"text-sm",children:e})},t))})]}),Je.jsxs("div",{className:"space-y-4",children:[n&&Je.jsx("div",{className:"bg-white/10 border border-white/20 rounded-lg p-3",children:Je.jsx("p",{className:"text-gray-300 text-sm font-medium",children:n})}),Je.jsx("textarea",{value:s,onChange:e=>r(e.target.value),placeholder:"Escreva seus pensamentos e sentimentos aqui...",className:"w-full bg-gray-800/50 border border-gray-600/50 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-200 min-h-[120px]"}),Je.jsx("div",{className:"flex justify-end",children:Je.jsxs("button",{onClick:()=>p(e,null,function*(){if(s.trim()&&n&&t)try{c(!0);const e={userId:t.uid,prompt:n,content:s.trim(),userName:t.displayName||"Usuário",userEmail:t.email};yield hy.createDiaryEntry(e),yield g(),r(""),i("");const a=document.querySelector("[data-save-entry]");a&&(a.innerHTML='<Check className="w-4 h-4" /><span>Salvo!</span>',setTimeout(()=>{a.innerHTML='<Send className="w-4 h-4" /><span>Salvar Reflexão</span>'},2e3))}catch(e){alert("Erro ao salvar reflexão. Tente novamente.")}finally{c(!1)}}),disabled:!s.trim()||!n||l,"data-save-entry":!0,className:"bg-gradient-to-r from-white to-gray-200 text-black px-6 py-2 rounded-lg font-medium hover:from-gray-200 hover:to-gray-300 transform hover:scale-105 transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[Je.jsx(re,{className:"w-4 h-4"}),Je.jsx("span",{children:"Salvar Reflexão"})]})})]})]}),Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Je.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Reflexões Recentes"}),l?Je.jsxs("div",{className:"text-center py-8",children:[Je.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto"}),Je.jsx("p",{className:"text-white/50 mt-2",children:"Carregando..."})]}):0===a.length?Je.jsxs("div",{className:"text-center py-12",children:[Je.jsx(se,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Je.jsx("h3",{className:"text-lg font-medium text-white/70 mb-2",children:"Nenhuma reflexão ainda"}),Je.jsx("p",{className:"text-white/50",children:"Comece escrevendo sua primeira reflexão acima"})]}):Je.jsx("div",{className:"space-y-3",children:a.map(t=>{return Je.jsx("div",{className:"bg-gray-800/30 rounded-lg p-4",children:d===t.id?Je.jsxs("div",{className:"space-y-3",children:[Je.jsx("div",{className:"bg-white/10 border border-white/20 rounded-lg p-3",children:Je.jsx("p",{className:"text-gray-300 text-sm font-medium",children:t.prompt})}),Je.jsx("textarea",{value:h,onChange:e=>m(e.target.value),className:"w-full bg-gray-800/50 border border-gray-600/50 rounded-lg p-3 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-200 min-h-[100px]"}),Je.jsxs("div",{className:"flex justify-end space-x-2",children:[Je.jsx("button",{onClick:x,className:"px-4 py-2 text-gray-300 hover:text-white transition-colors duration-200",children:Je.jsx(v,{className:"w-4 h-4"})}),Je.jsx("button",{onClick:()=>{return s=t.id,p(e,null,function*(){if(h.trim())try{c(!0),yield hy.updateDiaryEntry(s,{content:h.trim(),isEdited:!0}),yield g(),u(null),m("")}catch(e){alert("Erro ao editar reflexão. Tente novamente.")}finally{c(!1)}});var s},disabled:!h.trim()||l,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:Je.jsx(ne,{className:"w-4 h-4"})})]})]}):Je.jsx("div",{className:"space-y-3",children:Je.jsxs("div",{className:"flex items-start justify-between",children:[Je.jsxs("div",{className:"flex-1",children:[Je.jsx("p",{className:"text-white text-sm mb-2 font-medium",children:t.prompt}),Je.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:t.content}),Je.jsxs("div",{className:"flex items-center space-x-4 mt-3",children:[Je.jsx("p",{className:"text-gray-500 text-xs",children:(s=t.createdAt,s?py.formatDate(s,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Data não disponível")}),t.isEdited&&Je.jsx("span",{className:"text-gray-500 text-xs bg-gray-700/50 px-2 py-1 rounded",children:"Editado"})]})]}),Je.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[Je.jsx("button",{onClick:()=>(e=>{u(e.id),m(e.content)})(t),className:"p-2 text-gray-400 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-200",title:"Editar",children:Je.jsx(ie,{className:"w-4 h-4"})}),Je.jsx("button",{onClick:()=>{return s=t.id,p(e,null,function*(){if(confirm("Tem certeza que deseja excluir esta reflexão?"))try{c(!0),yield hy.deleteDiaryEntry(s),yield g()}catch(e){alert("Erro ao excluir reflexão. Tente novamente.")}finally{c(!1)}});var s},className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-400/10 rounded-lg transition-all duration-200",title:"Excluir",children:Je.jsx(q,{className:"w-4 h-4"})})]})]})})},t.id);var s})})]})]}):Je.jsxs("div",{className:"text-center py-12",children:[Je.jsx(se,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Je.jsx("h3",{className:"text-lg font-medium text-white/70 mb-2",children:"Faça login para usar o diário"}),Je.jsx("p",{className:"text-white/50",children:"Entre na sua conta para começar a escrever suas reflexões"})]})};function vy(){return Je.jsx(xy,{})}const by=()=>{var e;const t=Ot(),[s,r]=f.useState([]),[n,i]=f.useState([]),[a,o]=f.useState(""),[l,c]=f.useState("all"),[d,u]=f.useState("popular"),[h,m]=f.useState(!0),[p,g]=f.useState([]),x=[{id:1,name:"Ansiedade ",description:"Um espaço seguro para compartilhar experiências sobre ansiedade e encontrar apoio mútuo. Dicas, técnicas de respiração e muito mais.",icon:"🧘",memberCount:1250,category:"mental-health",isPrivate:!1,createdAt:new Date(2023,5,15),tags:["ansiedade","bem-estar","respiração","mindfulness"],lastActivity:new Date(Date.now()-72e5),moderators:["Dr. Ana Silva","Psic. Carlos Santos"],rules:["Seja respeitoso","Não dê conselhos médicos","Compartilhe experiências pessoais"]},{id:2,name:"Apoio Emocional",description:"Comunidade de apoio para pessoas que lidam com depressão. Aqui você não está sozinho(a).",icon:"🌱",memberCount:980,category:"mental-health",isPrivate:!1,createdAt:new Date(2023,4,10),tags:["depressão","apoio","suporte","recovery"],lastActivity:new Date(Date.now()-36e5),moderators:["Dra. Maria Costa"],rules:["Ambiente seguro","Sem julgamentos","Apoio mútuo"]},{id:3,name:"Meditação Diária",description:"Pratique meditação em grupo e compartilhe suas experiências de mindfulness.",icon:"🕯️",memberCount:750,category:"wellness",isPrivate:!1,createdAt:new Date(2023,3,20),tags:["meditação","mindfulness","paz","relaxamento"],lastActivity:new Date(Date.now()-108e5),moderators:["Mestre João"],rules:["Prática diária","Compartilhe experiências","Respeite o silêncio"]},{id:4,name:"Relacionamentos Saudáveis",description:"Discussões sobre relacionamentos, comunicação e desenvolvimento pessoal.",icon:"💝",memberCount:650,category:"relationships",isPrivate:!1,createdAt:new Date(2023,6,5),tags:["relacionamentos","comunicação","amor","família"],lastActivity:new Date(Date.now()-18e5),moderators:["Terapeuta Ana"],rules:["Respeito mútuo","Sem ataques pessoais","Compartilhe com responsabilidade"]},{id:5,name:"Autoestima e Confiança",description:"Construindo amor próprio e confiança juntos. Exercícios práticos e apoio.",icon:"⭐",memberCount:820,category:"self-improvement",isPrivate:!1,createdAt:new Date(2023,2,12),tags:["autoestima","confiança","amor próprio","crescimento"],lastActivity:new Date(Date.now()-27e5),moderators:["Coach Laura"],rules:["Positividade","Sem comparações","Celebre conquistas"]},{id:6,name:"Pais e Filhos",description:"Comunidade para pais compartilharem experiências na criação dos filhos.",icon:"👨‍👩‍👧‍👦",memberCount:1100,category:"family",isPrivate:!1,createdAt:new Date(2023,1,8),tags:["paternidade","filhos","educação","família"],lastActivity:new Date(Date.now()-12e5),moderators:["Psic. Infantil Maria"],rules:["Experiências construtivas","Sem julgamentos","Apoio parental"]},{id:7,name:"Carreira e Burnout",description:"Discussões sobre vida profissional, estresse no trabalho e equilíbrio.",icon:"💼",memberCount:890,category:"career",isPrivate:!1,createdAt:new Date(2023,7,18),tags:["carreira","burnout","trabalho","estresse"],lastActivity:new Date(Date.now()-144e5),moderators:["Coach Pedro"],rules:["Confidencialidade","Apoio profissional","Sem spam"]},{id:8,name:"Grupo VIP - Terapia",description:"Grupo privado para discussões mais profundas sobre terapia e crescimento.",icon:"🔒",memberCount:45,category:"therapy",isPrivate:!0,createdAt:new Date(2023,0,25),tags:["terapia","privado","crescimento","suporte"],lastActivity:new Date(Date.now()-36e5),moderators:["Dr. Ricardo"],rules:["Máxima confidencialidade","Aprovação necessária","Compromisso sério"]}],v=[{id:"all",name:"Todas",icon:W},{id:"mental-health",name:"Saúde Mental",icon:"🧠"},{id:"wellness",name:"Bem-estar",icon:"🌿"},{id:"relationships",name:"Relacionamentos",icon:"💕"},{id:"self-improvement",name:"Desenvolvimento",icon:"📈"},{id:"family",name:"Família",icon:"👨‍👩‍👧‍👦"},{id:"career",name:"Carreira",icon:"💼"},{id:"therapy",name:"Terapia",icon:"🔒"}];f.useEffect(()=>{setTimeout(()=>{r(x),i(x),m(!1)},1e3)},[]),f.useEffect(()=>{let e=s;switch("all"!==l&&(e=e.filter(e=>e.category===l)),a&&(e=e.filter(e=>e.name.toLowerCase().includes(a.toLowerCase())||e.description.toLowerCase().includes(a.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(a.toLowerCase())))),d){case"popular":e.sort((e,t)=>t.memberCount-e.memberCount);break;case"recent":e.sort((e,t)=>t.lastActivity-e.lastActivity);break;case"alphabetical":e.sort((e,t)=>e.name.localeCompare(t.name))}i(e)},[s,l,a,d]);const b=e=>{const t=new Date,s=Math.floor((t-e)/6e4);return s<60?`${s}m atrás`:s<1440?`${Math.floor(s/60)}h atrás`:`${Math.floor(s/1440)}d atrás`};return h?Je.jsx("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:Je.jsxs("div",{className:"flex items-center justify-center py-12",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("span",{className:"ml-3 text-white/70",children:"Carregando comunidades..."})]})}):Je.jsxs("div",{className:"min-h-screen bg-black py-8 animation-initial animate-fade-in-up animation-delay-100",children:[Je.jsx("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:Je.jsxs("div",{className:"flex items-center space-x-4",children:[Je.jsx("button",{onClick:()=>t(-1),className:"p-2 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg transition-colors",children:Je.jsx(O,{className:"w-5 h-5 text-white"})}),Je.jsxs("div",{children:[Je.jsx("h1",{className:"text-3xl font-bold text-white",children:"Explorar Comunidades"}),Je.jsx("p",{className:"text-white/70",children:"Encontre grupos que combinam com seus interesses"})]})]})}),Je.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6",children:[Je.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[Je.jsxs("div",{className:"flex-1 relative",children:[Je.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/50"}),Je.jsx("input",{type:"text",placeholder:"Buscar comunidades, tags, temas...",value:a,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),Je.jsx("div",{className:"flex items-center space-x-4",children:Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx(ae,{className:"w-5 h-5 text-white/70"}),Je.jsxs("select",{value:d,onChange:e=>u(e.target.value),className:"bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[Je.jsx("option",{value:"popular",children:"Mais Populares"}),Je.jsx("option",{value:"recent",children:"Recentes"}),Je.jsx("option",{value:"alphabetical",children:"A-Z"})]})]})})]}),Je.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:v.map(e=>Je.jsxs("button",{onClick:()=>c(e.id),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all "+(l===e.id?"bg-blue-600 text-white":"bg-white/5 text-white/70 hover:bg-white/10 hover:text-white"),children:[Je.jsx("span",{className:"mr-2",children:"string"==typeof e.icon?e.icon:"🌐"}),e.name]},e.id))})]}),Je.jsx("div",{className:"flex items-center justify-between",children:Je.jsxs("div",{children:[Je.jsxs("h2",{className:"text-xl font-semibold text-white",children:[n.length," comunidades encontradas"]}),Je.jsxs("p",{className:"text-white/60 text-sm",children:["all"!==l&&`Categoria: ${null==(e=v.find(e=>e.id===l))?void 0:e.name}`,a&&` • Busca: "${a}"`]})]})}),Je.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>{const t=p.includes(e.id);return Je.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6 hover:bg-white/15 transition-all duration-200",children:[Je.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-12 h-12 rounded-full bg-white flex items-center justify-center text-2xl",children:e.icon}),Je.jsxs("div",{children:[Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("h3",{className:"font-bold text-white text-lg",children:e.name}),e.isPrivate&&Je.jsx(G,{className:"w-4 h-4 text-yellow-400"})]}),Je.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/60",children:[Je.jsx(A,{className:"w-4 h-4"}),Je.jsxs("span",{children:[e.memberCount.toLocaleString()," membros"]})]})]})]}),Je.jsx("button",{onClick:()=>{e.id},className:"w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200 cursor-pointer bg-white hover:bg-gray-100",title:t?"Sair da comunidade":"Entrar na comunidade",children:t?Je.jsx(ne,{className:"w-5 h-5 text-black"}):Je.jsx(H,{className:"w-5 h-5 text-black"})})]}),Je.jsx("p",{className:"text-white/80 text-sm leading-relaxed mb-4 line-clamp-3",children:e.description}),Je.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.tags.slice(0,3).map((e,t)=>Je.jsxs("span",{className:"px-2 py-1 bg-white/10 rounded-full text-xs text-white/70 border border-white/20",children:["#",e]},t)),e.tags.length>3&&Je.jsxs("span",{className:"px-2 py-1 bg-white/5 rounded-full text-xs text-white/50",children:["+",e.tags.length-3]})]}),Je.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-white/10",children:[Je.jsxs("div",{className:"flex items-center space-x-2 text-xs text-white/50",children:[Je.jsx(oe,{className:"w-3 h-3"}),Je.jsx("span",{children:b(e.lastActivity)})]}),Je.jsxs("div",{className:"flex items-center space-x-1 text-xs text-white/50",children:[Je.jsx(j,{className:"w-3 h-3"}),Je.jsx("span",{children:"Moderado"})]})]}),Je.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[Je.jsx("p",{className:"text-xs text-white/50 mb-1",children:"Moderadores:"}),Je.jsx("div",{className:"flex flex-wrap gap-1",children:e.moderators.map((e,t)=>Je.jsx("span",{className:"text-xs text-white bg-white/10 px-2 py-1 rounded",children:e},t))})]})]},e.id)})}),0===n.length&&Je.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-12 text-center",children:[Je.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),Je.jsx("h3",{className:"text-xl font-medium text-white mb-2",children:"Nenhuma comunidade encontrada"}),Je.jsx("p",{className:"text-white/70 mb-6",children:"Tente ajustar seus filtros ou termo de busca"}),Je.jsx("button",{onClick:()=>{o(""),c("all")},className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Limpar Filtros"})]}),Je.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6 text-center",children:[Je.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Não encontrou o que procura?"}),Je.jsx("p",{className:"text-white/70 mb-4",children:"Sugira uma nova comunidade ou entre em contato conosco"}),Je.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[Je.jsx("button",{className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:"Sugerir Comunidade"}),Je.jsx("button",{className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 text-white rounded-lg font-medium transition-colors",children:"Entrar em Contato"})]})]})]})},wy=()=>{const[t,s]=f.useState([]),[r,n]=f.useState(!0),[i,a]=f.useState(null),[o,l]=f.useState(!0),{user:c}=Vb(),h=f.useCallback(()=>p(e,null,function*(){try{n(!0),a(null);const e=yield ly.getPosts(20),t=e.map(e=>u(d({},e),{createdAt:py.convertTimestamp(e.createdAt),updatedAt:e.updatedAt?py.convertTimestamp(e.updatedAt):void 0}));s(t),l(20===e.length)}catch(e){a(e instanceof Error?e.message:"Erro ao carregar posts")}finally{n(!1)}}),[]),m=f.useCallback(()=>p(e,null,function*(){if(!r&&o)try{n(!0);const e=yield ly.getPosts(20,t.length);if(0===e.length)return void l(!1);const r=e.map(e=>u(d({},e),{createdAt:py.convertTimestamp(e.createdAt),updatedAt:e.updatedAt?py.convertTimestamp(e.updatedAt):void 0}));s(e=>[...e,...r]),l(20===e.length)}catch(e){a(e instanceof Error?e.message:"Erro ao carregar mais posts")}finally{n(!1)}}),[r,o,t.length]),g=f.useCallback(t=>p(e,null,function*(){if(!c)throw new Error("Usuário não autenticado");try{const e=yield ly.createPost(t);if(e.success){const r=u(d({id:e.postId},t),{isAnonymous:!1,createdAt:new Date,likes:[],commentCount:0,shares:0,isEdited:!1});return s(e=>[r,...e]),!0}return!1}catch(e){throw e}}),[c]),x=f.useCallback(t=>p(e,null,function*(){if(!c)throw new Error("Usuário não autenticado");try{return!!(yield ly.deletePost(t))&&(s(e=>e.filter(e=>e.id!==t)),!0)}catch(e){throw e}}),[c]),v=f.useCallback(t=>p(e,null,function*(){if(!c)return!1;try{const e=yield ly.togglePostLike(t,c.uid);return e&&s(e=>e.map(e=>{if(e.id===t){const t=e.likes.includes(c.uid)?e.likes.filter(e=>e!==c.uid):[...e.likes,c.uid];return u(d({},e),{likes:t})}return e})),e}catch(e){return!1}}),[c]),b=f.useCallback(e=>{if(!c)return!1;const s=t.find(t=>t.id===e);return!!s&&s.likes.includes(c.uid)},[t,c]),w=f.useCallback((t,r)=>p(e,null,function*(){if(!c)throw new Error("Usuário não autenticado");try{const e={authorId:c.uid,authorName:c.displayName||c.email||"Usuário",authorAvatar:c.photoURL,content:r.trim()},n=yield uy.addComment(t,e);return n.success?(s(e=>e.map(e=>e.id===t?u(d({},e),{commentCount:e.commentCount+1}):e)),n.commentId):null}catch(e){throw e}}),[c]),y=f.useCallback(t=>p(e,null,function*(){try{return(yield uy.getPostComments(t)).map(e=>u(d({},e),{createdAt:py.convertTimestamp(e.createdAt)}))}catch(e){throw e}}),[]);return f.useEffect(()=>{h()},[h]),{posts:t,loading:r,error:i,hasMore:o,loadMorePosts:m,createPost:g,deletePost:x,togglePostLike:v,isPostLiked:b,addComment:w,getPostComments:y,refreshPosts:h}},yy=({onPostCreated:t,onCancel:s,isModal:r=!1})=>{const{user:n}=Vb(),{createPost:i}=wy(),[a,o]=f.useState(""),[l,c]=f.useState(""),[d,u]=f.useState("public"),[h,m]=f.useState(!1),[g,x]=f.useState(""),[b,w]=f.useState(null),[y,N]=f.useState(null),[j,C]=f.useState(!1),k=f.useRef(null),S=()=>{w(null),N(null),k.current&&(k.current.value="")};return Je.jsxs("div",{className:r?"":"bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6",children:[!r&&Je.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Compartilhe algo..."}),Je.jsxs("form",{onSubmit:s=>p(e,null,function*(){if(s.preventDefault(),a.trim()){m(!0),x("");try{let s=null;if(b&&(s=yield p(e,null,function*(){if(!b)return null;C(!0);try{return yield my.uploadPostImage(b,n.uid)}catch(e){return x(`Erro ao fazer upload da imagem: ${e.message}`),null}finally{C(!1)}}),!s))return void m(!1);const r={content:a.trim(),tags:l.trim()?l.trim().split(",").map(e=>e.trim().replace("#","")):[],visibility:d,userId:n.uid,author:n.displayName||n.email||"Usuário",avatar:n.photoURL,image:s?{url:s.url,fileName:s.fileName,size:s.size,type:s.type}:null};(yield i(r))&&(o(""),c(""),u("public"),w(null),N(null),k.current&&(k.current.value=""),t&&t(r))}catch(r){x("Erro ao criar post. Tente novamente.")}finally{m(!1)}}else x("Por favor, escreva algo para postar.")}),className:"space-y-4",children:[Je.jsxs("div",{children:[Je.jsx("textarea",{value:a,onChange:e=>o(e.target.value),placeholder:"O que você gostaria de compartilhar hoje?",className:"w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30",rows:4,maxLength:500}),Je.jsx("div",{className:"flex justify-between items-center mt-2",children:Je.jsxs("span",{className:"text-xs text-white/50",children:[a.length,"/500 caracteres"]})})]}),y&&Je.jsxs("div",{className:"relative",children:[Je.jsx("img",{src:y,alt:"Preview da imagem",className:"w-full max-h-64 object-cover rounded-lg border border-white/20"}),Je.jsx("button",{type:"button",onClick:S,className:"absolute top-2 right-2 p-2 bg-black/50 hover:bg-black/70 text-white rounded-full transition-colors duration-200","aria-label":"Remover imagem",children:Je.jsx(v,{className:"w-4 h-4"})})]}),Je.jsxs("div",{children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Adicione tags (separadas por vírgula)",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30"})]}),Je.jsx("p",{className:"text-xs text-white/50 mt-1",children:"Ex: ansiedade, terapia, bem-estar"})]}),Je.jsxs("div",{className:"space-y-3",children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Visibilidade do Post"}),Je.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{value:"public",label:"Público",icon:Je.jsx(ce,{className:"w-4 h-4"})},{value:"private",label:"Privado",icon:Je.jsx(de,{className:"w-4 h-4"})}].map(e=>Je.jsxs("button",{type:"button",onClick:()=>{return t=e.value,void u(t);var t},className:"p-3 rounded-lg border transition-all duration-200 flex flex-col items-center space-y-2 "+(d===e.value?"border-white/50 bg-white/20 text-white":"border-white/20 bg-white/5 text-white/70 hover:bg-white/10 hover:text-white"),children:[e.icon,Je.jsx("span",{className:"text-xs font-medium",children:e.label})]},e.value))}),Je.jsx("p",{className:"text-xs text-white/60",children:(()=>{switch(d){case"public":default:return"Todos podem ver este post";case"private":return"Apenas você pode ver este post"}})()})]}),g&&Je.jsx("div",{className:"text-red-400 text-sm bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-2",children:g}),Je.jsxs("div",{className:"flex items-center justify-between pt-4",children:[Je.jsxs("div",{className:"flex items-center space-x-4",children:[Je.jsx("button",{type:"button",onClick:()=>{var e;return null==(e=k.current)?void 0:e.click()},className:"p-2 rounded-full transition-all duration-200 "+(b?"text-green-400 hover:text-green-300 hover:bg-green-400/10":"text-white/50 hover:text-white hover:bg-white/10"),disabled:h||j,title:"Adicionar imagem",children:j?Je.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}):b?Je.jsx(K,{className:"w-5 h-5"}):Je.jsx(Q,{className:"w-5 h-5"})}),Je.jsx("input",{ref:k,type:"file",accept:"image/*",className:"hidden",onChange:e=>{const t=e.target.files[0];if(!t)return;const s=my.validateImageFile(t);if(!s.isValid)return void x(s.errors.join(", "));const r=new FileReader;r.onload=e=>{N(e.target.result),w(t),x("")},r.readAsDataURL(t)},disabled:h||j}),b&&Je.jsx("button",{type:"button",onClick:S,className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-400/10 rounded-full transition-all duration-200",disabled:h||j,title:"Remover imagem",children:Je.jsx(q,{className:"w-5 h-5"})})]}),Je.jsxs("div",{className:"flex items-center space-x-3",children:[r&&s&&Je.jsx("button",{type:"button",onClick:()=>{s&&s()},className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors",disabled:h||j,children:"Cancelar"}),Je.jsx("button",{type:"submit",disabled:h||j||!a.trim(),className:"px-6 py-2 bg-white text-black rounded-lg font-medium transition-all duration-200 transform hover:scale-[1.02] disabled:bg-white/30 disabled:scale-100 disabled:cursor-not-allowed flex items-center space-x-2",children:h||j?Je.jsxs(Je.Fragment,{children:[Je.jsx("div",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"}),Je.jsx("span",{children:j?"Enviando imagem...":"Postando..."})]}):Je.jsxs(Je.Fragment,{children:[Je.jsx(re,{className:"w-4 h-4"}),Je.jsx("span",{children:"Postar"})]})})]})]})]})]})},Ny=e=>{let t=null,s=null;try{const{useUserPosts:e}=require("../contexts/UserPostsContext");s=e(),t=null==s?void 0:s.addUserPost}catch(r){}return Je.jsx(yy,u(d({},e),{onPostCreated:s=>{if(t){const e=u(d({id:Date.now().toString()},s),{createdAt:new Date,likes:[],commentCount:0,shares:0,isEdited:!1});t(e)}e.onPostCreated&&e.onPostCreated(s)}}))},jy=({postId:t})=>{const[s,r]=f.useState(""),[n,i]=f.useState(!1),[a,o]=f.useState(null),[l,c]=f.useState(null),[h,m]=f.useState(null),[g,x]=f.useState(""),[v,b]=f.useState(null),[y,N]=f.useState(""),j=f.useRef(null),{user:C}=Vb(),{comments:k,loading:S,error:E,addComment:_,editComment:T,deleteComment:I,toggleCommentLike:A,isCommentLiked:D,hideComment:P,reportComment:R}=(t=>{const[s,r]=f.useState([]),[n,i]=f.useState(!0),[a,o]=f.useState(null),[l,c]=f.useState(!0),{user:h}=Vb(),m=f.useCallback(()=>p(e,null,function*(){if(t)try{i(!0),o(null);const e=yield uy.getPostComments(t,50),s=e.map(e=>u(d({},e),{createdAt:py.convertTimestamp(e.createdAt),updatedAt:e.updatedAt?py.convertTimestamp(e.updatedAt):void 0}));r(s),c(50===e.length)}catch(e){o(e instanceof Error?e.message:"Erro ao carregar comentários")}finally{i(!1)}}),[t]),g=f.useCallback((s,n=!1)=>p(e,null,function*(){if(!h||!t)throw new Error("Usuário não autenticado ou post não especificado");try{const e={authorId:h.uid,authorName:n?"Usuário Anônimo":h.displayName||h.email||"Usuário",authorAvatar:n?null:h.photoURL,content:s.trim(),isAnonymous:n},i=yield uy.addComment(t,e);if(i.success){const s=u(d({id:i.commentId,postId:t},e),{likes:[],createdAt:new Date,isHidden:!1,isReported:!1});return r(e=>[s,...e]),i.commentId}return null}catch(e){throw e}}),[h,t]),x=f.useCallback((t,s)=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield uy.editComment(t,s))&&(r(e=>e.map(e=>e.id===t?u(d({},e),{content:s,isEdited:!0,updatedAt:new Date}):e)),!0)}catch(e){throw e}}),[h]),v=f.useCallback(t=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield uy.deleteComment(t))&&(r(e=>e.filter(e=>e.id!==t)),!0)}catch(e){throw e}}),[h]),b=f.useCallback(t=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield uy.toggleCommentVisibility(t))&&(r(e=>e.map(e=>e.id===t?u(d({},e),{isHidden:!e.isHidden}):e)),!0)}catch(e){throw e}}),[h]),w=f.useCallback((t,s)=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield uy.reportComment(t,s))&&(r(e=>e.map(e=>e.id===t?u(d({},e),{isReported:!0,reportedBy:[...e.reportedBy||[],h.uid],reportReasons:[...e.reportReasons||[],s]}):e)),!0)}catch(e){throw e}}),[h]),y=f.useCallback(t=>p(e,null,function*(){if(!h)throw new Error("Usuário não autenticado");try{return!!(yield uy.toggleCommentLike(t,h.uid))&&(r(e=>e.map(e=>{if(e.id===t){const t=e.likes.includes(h.uid);return u(d({},e),t?{likes:e.likes.filter(e=>e!==h.uid)}:{likes:[...e.likes,h.uid]})}return e})),!0)}catch(e){throw e}}),[h]),N=f.useCallback(e=>{if(!h)return!1;const t=s.find(t=>t.id===e);return!!t&&t.likes.includes(h.uid)},[h,s]);return f.useEffect(()=>{m()},[m]),{comments:s,loading:n,error:a,hasMore:l,loadMoreComments:m,addComment:g,editComment:x,deleteComment:v,hideComment:b,reportComment:w,toggleCommentLike:y,isCommentLiked:N,refreshComments:m}})(t),L=e=>{const t=new Date-e,s=Math.floor(t/6e4),r=Math.floor(t/36e5),n=Math.floor(t/864e5);return s<1?"Agora mesmo":s<60?`${s}m atrás`:r<24?`${r}h atrás`:n<7?`${n}d atrás`:e.toLocaleDateString("pt-BR")},O=e=>C&&(e.authorId===C.uid||"admin"===C.role),M=e=>C&&(e.authorId===C.uid||"admin"===C.role),F=e=>C&&e.authorId!==C.uid;return f.useEffect(()=>{const e=e=>{a&&!e.target.closest(".comment-menu")&&o(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[a]),S?Je.jsxs("div",{className:"text-center text-white/50 py-8",children:[Je.jsx("div",{className:"loading-spinner mx-auto mb-4"}),"Carregando comentários..."]}):E?Je.jsxs("div",{className:"text-center text-red-400 py-8",children:["Erro ao carregar comentários: ",E]}):Je.jsxs("div",{className:"space-y-6",children:[Je.jsx("div",{className:"bg-white/5 rounded-lg p-4",children:Je.jsx("form",{onSubmit:t=>p(e,null,function*(){t.preventDefault(),s.trim()&&(yield _(s,n))&&(r(""),i(!1))}),className:"space-y-3",children:Je.jsxs("div",{className:"flex items-start space-x-3",children:[Je.jsx("div",{className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:(null==C?void 0:C.photoURL)?Je.jsx("img",{src:C.photoURL,alt:C.displayName,className:"w-8 h-8 rounded-full"}):Je.jsx(J,{className:"w-4 h-4 text-white/70"})}),Je.jsxs("div",{className:"flex-1 min-w-0",children:[Je.jsx("textarea",{ref:j,value:s,onChange:e=>r(e.target.value),placeholder:"Adicione um comentário...",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30",rows:3}),Je.jsxs("div",{className:"flex items-center justify-between mt-2",children:[Je.jsxs("label",{className:"flex items-center space-x-2 text-sm text-white/70 cursor-pointer",children:[Je.jsx("input",{type:"checkbox",checked:n,onChange:e=>i(e.target.checked),className:"w-4 h-4 rounded border-white/30 bg-white/10 text-white focus:ring-white/30"}),Je.jsx("span",{children:"Comentar anonimamente"})]}),Je.jsxs("button",{type:"submit",disabled:!s.trim(),className:"flex items-center space-x-2 px-4 py-2 bg-white text-black rounded-lg font-medium transition-all duration-200 transform hover:scale-[1.02] disabled:bg-white/30 disabled:scale-100 disabled:cursor-not-allowed",children:[Je.jsx(re,{className:"w-4 h-4"}),Je.jsx("span",{children:"Comentar"})]})]})]})]})})}),Je.jsx("div",{className:"space-y-4",children:0===k.length?Je.jsx("div",{className:"text-center text-white/50 py-8",children:"Nenhum comentário ainda. Seja o primeiro a comentar!"}):k.map(t=>{var s;return Je.jsx("div",{className:"bg-white/5 rounded-lg p-4 "+(t.isHidden?"opacity-50":""),children:Je.jsxs("div",{className:"flex items-start space-x-3",children:[Je.jsx("div",{className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:t.authorAvatar?Je.jsx("img",{src:t.authorAvatar,alt:t.authorName,className:"w-8 h-8 rounded-full"}):Je.jsx(J,{className:"w-4 h-4 text-white/70"})}),Je.jsxs("div",{className:"flex-1 min-w-0",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("h5",{className:"font-medium text-white",children:t.authorName}),t.isAnonymous&&Je.jsx("span",{className:"text-xs bg-white/20 text-white/70 px-2 py-1 rounded-full",children:"Anônimo"}),Je.jsx("span",{className:"text-xs text-white/50",children:L(t.createdAt)}),t.isEdited&&Je.jsx("span",{className:"text-xs text-white/30",children:"(editado)"})]}),Je.jsxs("div",{className:"relative comment-menu",children:[Je.jsx("button",{onClick:()=>o(a===t.id?null:t.id),className:"p-1 text-white/50 hover:text-white transition-colors rounded-full hover:bg-white/10",children:Je.jsx(U,{className:"w-4 h-4"})}),a===t.id&&Je.jsx("div",{className:"absolute right-0 top-8 bg-white/10 backdrop-blur-lg border border-white/20 rounded-lg shadow-xl z-10 min-w-[160px]",children:Je.jsxs("div",{className:"py-1",children:[O(t)&&Je.jsxs("button",{onClick:()=>{m(t.id),x(t.content),o(null)},className:"w-full px-4 py-2 text-left text-white hover:bg-white/20 transition-colors flex items-center space-x-2",children:[Je.jsx(ue,{className:"w-4 h-4"}),Je.jsx("span",{children:"Editar"})]}),O(t)&&Je.jsxs("button",{onClick:()=>{return s=t.id,p(e,null,function*(){window.confirm("Tem certeza que deseja deletar este comentário?")&&(yield I(s))&&o(null)});var s},className:"w-full px-4 py-2 text-left text-red-400 hover:bg-red-500/20 transition-colors flex items-center space-x-2",children:[Je.jsx(q,{className:"w-4 h-4"}),Je.jsx("span",{children:"Deletar"})]}),M(t)&&Je.jsxs("button",{onClick:()=>{return s=t.id,p(e,null,function*(){(yield P(s))&&o(null)});var s},className:"w-full px-4 py-2 text-left text-white hover:bg-white/20 transition-colors flex items-center space-x-2",children:[Je.jsx(de,{className:"w-4 h-4"}),Je.jsx("span",{children:t.isHidden?"Mostrar":"Ocultar"})]}),F(t)&&Je.jsxs("button",{onClick:()=>b(t.id),className:"w-full px-4 py-2 text-left text-orange-400 hover:bg-orange-500/20 transition-colors flex items-center space-x-2",children:[Je.jsx(he,{className:"w-4 h-4"}),Je.jsx("span",{children:"Reportar"})]})]})})]})]}),h===t.id?Je.jsxs("div",{className:"space-y-3",children:[Je.jsx("textarea",{value:g,onChange:e=>x(e.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30",rows:3}),Je.jsxs("div",{className:"flex space-x-2",children:[Je.jsx("button",{onClick:()=>{return s=t.id,p(e,null,function*(){g.trim()&&(yield T(s,g))&&(m(null),x(""))});var s},className:"px-3 py-1 bg-white text-black rounded-lg text-sm font-medium hover:bg-white/90 transition-colors",children:"Salvar"}),Je.jsx("button",{onClick:()=>{m(null),x("")},className:"px-3 py-1 bg-white/10 text-white rounded-lg text-sm font-medium hover:bg-white/20 transition-colors",children:"Cancelar"})]})]}):Je.jsx("p",{className:"text-white/90 leading-relaxed",children:t.content}),Je.jsxs("div",{className:"flex items-center space-x-4 mt-3",children:[Je.jsxs("button",{onClick:()=>{return s=t.id,p(e,null,function*(){yield A(s)});var s},className:"flex items-center space-x-1 transition-colors "+(D(t.id)?"text-red-400":"text-white/50 hover:text-white"),children:[Je.jsx(w,{className:"w-4 h-4 "+(D(t.id)?"fill-current":"")}),Je.jsx("span",{className:"text-sm",children:(null==(s=t.likes)?void 0:s.length)||0})]}),Je.jsxs("button",{onClick:()=>c(l===t.id?null:t.id),className:"flex items-center space-x-1 text-white/50 hover:text-white transition-colors",children:[Je.jsx(me,{className:"w-4 h-4"}),Je.jsx("span",{className:"text-sm",children:"Responder"})]})]}),l===t.id&&Je.jsx("div",{className:"mt-3 pl-6 border-l-2 border-white/20",children:Je.jsxs("div",{className:"flex items-start space-x-3",children:[Je.jsx("div",{className:"w-6 h-6 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:(null==C?void 0:C.photoURL)?Je.jsx("img",{src:C.photoURL,alt:C.displayName,className:"w-6 h-6 rounded-full"}):Je.jsx(J,{className:"w-3 h-3 text-white/70"})}),Je.jsxs("div",{className:"flex-1",children:[Je.jsx("textarea",{placeholder:"Responder ao comentário...",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30",rows:2}),Je.jsxs("div",{className:"flex items-center justify-between mt-2",children:[Je.jsxs("label",{className:"flex items-center space-x-2 text-sm text-white/70 cursor-pointer",children:[Je.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-white/30 bg-white/10 text-white focus:ring-white/30"}),Je.jsx("span",{children:"Responder anonimamente"})]}),Je.jsx("button",{className:"px-3 py-1 bg-white text-black rounded-lg text-sm font-medium hover:bg-white/90 transition-colors",children:"Responder"})]})]})]})})]})]})},t.id)})}),v&&Je.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Je.jsxs("div",{className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-xl p-6 max-w-md w-full",children:[Je.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Je.jsx(pe,{className:"w-6 h-6 text-orange-400"}),Je.jsx("h3",{className:"text-xl font-medium text-white",children:"Reportar Comentário"})]}),Je.jsx("p",{className:"text-white/70 mb-4",children:"Por favor, informe o motivo pelo qual está reportando este comentário:"}),Je.jsx("textarea",{value:y,onChange:e=>N(e.target.value),placeholder:"Descreva o motivo do report...",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 resize-none focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 mb-4",rows:3}),Je.jsxs("div",{className:"flex space-x-3",children:[Je.jsx("button",{onClick:()=>{b(null),N("")},className:"flex-1 px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors",children:"Cancelar"}),Je.jsx("button",{onClick:()=>{return t=v,p(e,null,function*(){y.trim()?(yield R(t,y))&&(b(null),N(""),o(null)):alert("Por favor, informe o motivo do report.")});var t},className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors",children:"Reportar"})]})]})})]})},Cy=()=>{Ot();const{user:t}=Vb(),[s,r]=f.useState(null),[n,i]=f.useState(null);f.useState(new Set);const{posts:a,loading:o,error:l,hasMore:c,loadMorePosts:d,togglePostLike:u,isPostLiked:h,deletePost:m}=wy(),g=e=>{if(!e)return"Agora mesmo";const t=new Date,s=e.toDate?e.toDate():new Date(e),r=t-s,n=Math.floor(r/6e4),i=Math.floor(r/36e5),a=Math.floor(r/864e5);return n<1?"Agora mesmo":n<60?`${n}m atrás`:i<24?`${i}h atrás`:a<7?`${a}d atrás`:s.toLocaleDateString("pt-BR")};return o&&0===a.length?Je.jsxs("div",{className:"flex items-center justify-center py-20",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("span",{className:"ml-3 text-white/70",children:"Carregando posts..."})]}):l&&0===a.length?Je.jsxs("div",{className:"text-center py-20",children:[Je.jsx("div",{className:"w-24 h-24 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:Je.jsx(he,{className:"w-12 h-12 text-red-400"})}),Je.jsx("h3",{className:"text-xl text-white/60 mb-2",children:"Erro ao carregar posts"}),Je.jsx("p",{className:"text-white/40 mb-6",children:l}),Je.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-colors",children:"Tentar novamente"})]}):0===a.length?Je.jsxs("div",{className:"text-center py-20",children:[Je.jsx("div",{className:"w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4",children:Je.jsx(D,{className:"w-12 h-12 text-white/30"})}),Je.jsx("h3",{className:"text-xl text-white/60 mb-2",children:"Nenhum post ainda"}),Je.jsx("p",{className:"text-white/40",children:"Seja o primeiro a compartilhar algo!"})]}):Je.jsxs("div",{className:"space-y-6",children:[a.map(a=>{var o,l,c;return Je.jsxs("article",{className:"bg-white/5 border border-white/10 rounded-xl p-6 hover:bg-white/10 transition-all",children:[Je.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg",children:a.isAnonymous?"?":(null==(o=a.author)?void 0:o.charAt(0))||"U"}),Je.jsxs("div",{children:[Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("h3",{className:"text-white font-semibold",children:a.isAnonymous?"Usuário Anônimo":a.author}),a.isAnonymous&&Je.jsx("span",{className:"px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full",children:"Anônimo"}),"private"===a.visibility&&Je.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full",children:"Privado"})]}),Je.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/60",children:[Je.jsx(oe,{className:"w-3 h-3"}),Je.jsx("span",{children:g(a.createdAt)}),a.isEdited&&Je.jsx("span",{className:"text-xs text-white/40",children:"(editado)"})]})]})]}),t&&(a.userId===t.uid||"admin"===t.role)&&Je.jsxs("div",{className:"relative",children:[Je.jsx("button",{onClick:()=>r(s===a.id?null:a.id),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:Je.jsx(U,{className:"w-4 h-4 text-white/60"})}),s===a.id&&Je.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white/10 backdrop-blur-xl border border-white/20 rounded-lg shadow-xl z-10",children:[Je.jsxs("button",{onClick:()=>(a.id,void r(null)),className:"w-full px-4 py-2 text-left text-white hover:bg-white/10 flex items-center space-x-2 rounded-t-lg",children:[Je.jsx(ue,{className:"w-4 h-4"}),Je.jsx("span",{children:"Editar"})]}),Je.jsxs("button",{onClick:()=>{return t=a.id,p(e,null,function*(){if(window.confirm("Tem certeza que deseja deletar este post?")){i(t);try{(yield m(t))&&r(null)}catch(e){}finally{i(null)}}});var t},disabled:n===a.id,className:"w-full px-4 py-2 text-left text-red-400 hover:bg-red-500/20 flex items-center space-x-2 rounded-b-lg disabled:opacity-50",children:[Je.jsx(q,{className:"w-4 h-4"}),Je.jsx("span",{children:n===a.id?"Deletando...":"Deletar"})]})]})]})]}),Je.jsxs("div",{className:"mb-4",children:[Je.jsx("p",{className:"text-white/90 text-lg leading-relaxed mb-3",children:a.content}),a.tags&&a.tags.length>0&&Je.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map((e,t)=>Je.jsxs("span",{className:"px-3 py-1 bg-blue-500/20 text-blue-400 text-sm rounded-full border border-blue-500/30",children:["#",e]},t))})]}),Je.jsx("div",{className:"flex items-center justify-between text-sm text-white/60 mb-4",children:Je.jsx("div",{className:"flex items-center space-x-4",children:Je.jsxs("span",{children:[(null==(l=a.likes)?void 0:l.length)||0," curtidas"]})})}),Je.jsx("div",{className:"flex items-center justify-between pt-4 border-t border-white/10",children:Je.jsx("div",{className:"flex items-center space-x-6",children:Je.jsxs("button",{onClick:()=>{return s=a.id,p(e,null,function*(){t&&(yield u(s))});var s},disabled:!t,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all ${h(a.id)?"bg-red-500/20 text-red-400 border border-red-500/30":"text-white/70 hover:text-white hover:bg-white/10"} ${t?"":"opacity-50 cursor-not-allowed"}`,children:[Je.jsx(w,{className:"w-5 h-5 "+(h(a.id)?"fill-current":"")}),Je.jsx("span",{className:"font-medium",children:h(a.id)?"Curtido":"Curtir"}),(null==(c=a.likes)?void 0:c.length)>0&&Je.jsxs("span",{className:"text-sm",children:["(",a.likes.length,")"]})]})})})]},a.id)}),c&&Je.jsx("div",{className:"text-center",children:Je.jsx("button",{onClick:d,disabled:o,className:"px-8 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-colors disabled:opacity-50",children:o?"Carregando...":"Carregar mais posts"})})]})},ky=e=>{const t=((e=1e3)=>{const[t,s]=f.useState(new Date);return f.useEffect(()=>{const t=setInterval(()=>{s(new Date)},e);return()=>clearInterval(t)},[e]),t})(6e4),s=f.useMemo(()=>{const s=t.getHours(),r=e||"Usuário";return s<12?{text:`Bom dia, ${r}!`,icon:fe,period:"morning"}:s<18?{text:`Boa tarde, ${r}!`,icon:fe,period:"afternoon"}:{text:`Boa noite, ${r}!`,icon:ge,period:"evening"}},[t,e]);return u(d({},s),{currentTime:t,formattedDate:t.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})},Sy="psychologists",Ey="PsychologistAccount",_y="patients",Ty="sessions",Iy="evaluations";class Ay{constructor(){this.currentUser=Pb.currentUser}getRecommendedPsychologists(e=4){return p(this,null,function*(){try{const t=Vx(Zg(Lb,Ey),$x("isAvailable","==",!0),Hx("rating","desc"),Hx("yearsExperience","desc"),Wx(e)),s=yield av(t),r=[];return s.forEach(e=>{const t=e.data();r.push({id:e.id,name:t.displayName||"Psicólogo",specialty:t.specialty||"Psicologia Clínica",experience:t.yearsExperience?`${t.yearsExperience} anos`:"5 anos",rating:t.rating||5,bio:t.bio||"Psicólogo especializado em atendimento clínico",crp:t.crp||"CRP não informado",acceptsOnline:t.acceptsOnline||!1,avatar:t.avatar||"👨‍⚕️",initials:this.generateInitials(t.displayName||"Psicólogo")})}),r.sort((e,t)=>{if(t.rating!==e.rating)return t.rating-e.rating;const s=parseInt(e.experience)||0;return(parseInt(t.experience)||0)-s}),r}catch(t){try{const t=Vx(Zg(Lb,Ey),$x("isAvailable","==",!0)),s=yield av(t),r=[];return s.forEach(e=>{const t=e.data();r.push({id:e.id,name:t.displayName||"Psicólogo",specialty:t.specialty||"Psicologia Clínica",experience:t.yearsExperience?`${t.yearsExperience} anos`:"5 anos",rating:t.rating||5,bio:t.bio||"Psicólogo especializado em atendimento clínico",crp:t.crp||"CRP não informado",acceptsOnline:t.acceptsOnline||!1,avatar:t.avatar||"👨‍⚕️",initials:this.generateInitials(t.displayName||"Psicólogo")})}),r.sort((e,t)=>{if(t.rating!==e.rating)return t.rating-e.rating;const s=parseInt(e.experience)||0;return(parseInt(t.experience)||0)-s}),r.slice(0,e)}catch(s){return[]}}})}generateInitials(e){if(!e)return"PS";const t=e.trim().split(" ");return 1===t.length?t[0].substring(0,2).toUpperCase():`${t[0].charAt(0)}${t[t.length-1].charAt(0)}`.toUpperCase()}getPsychologistData(e){return p(this,null,function*(){try{const t=ex(Lb,Sy,e),s=yield nv(t);if(s.exists())return d({id:s.id},s.data());throw new Error("Psicólogo não encontrado")}catch(t){throw t}})}updatePsychologistData(e,t){return p(this,null,function*(){try{const s=ex(Lb,Sy,e);return yield lv(s,u(d({},t),{updatedAt:gv()})),!0}catch(s){throw s}})}getPatients(e){return p(this,null,function*(){try{const t=Vx(Zg(Lb,_y),$x("psychologistId","==",e),Hx("createdAt","desc")),s=yield av(t),r=[];return s.forEach(e=>{r.push(d({id:e.id},e.data()))}),r}catch(t){throw t}})}addPatient(e,t){return p(this,null,function*(){try{return(yield dv(Zg(Lb,_y),u(d({},t),{psychologistId:e,createdAt:gv(),status:"active",progress:0}))).id}catch(s){throw s}})}updatePatient(e,t){return p(this,null,function*(){try{const s=ex(Lb,_y,e);return yield lv(s,u(d({},t),{updatedAt:gv()})),!0}catch(s){throw s}})}getSessions(e){return p(this,arguments,function*(e,t={}){try{let s=Vx(Zg(Lb,Ty),$x("psychologistId","==",e));t.status&&(s=Vx(s,$x("status","==",t.status))),t.date&&(s=Vx(s,$x("date",">=",t.date))),s=Vx(s,Hx("date","asc"),Hx("time","asc"));const r=yield av(s),n=[];return r.forEach(e=>{n.push(d({id:e.id},e.data()))}),n}catch(s){throw s}})}createSession(e,t){return p(this,null,function*(){try{return(yield dv(Zg(Lb,Ty),u(d({},t),{psychologistId:e,createdAt:gv(),status:"pending"}))).id}catch(s){throw s}})}updateSessionStatus(e,t){return p(this,null,function*(){try{const s=ex(Lb,Ty,e);return yield lv(s,{status:t,updatedAt:gv()}),!0}catch(s){throw s}})}getDashboardStats(e){return p(this,null,function*(){try{const t=Vx(Zg(Lb,_y),$x("psychologistId","==",e),$x("status","==","active")),s=(yield av(t)).size,r=new Date,n=new Date(r.getFullYear(),r.getMonth(),1),i=Vx(Zg(Lb,Ty),$x("psychologistId","==",e),$x("date",">=",n),$x("status","==","completed")),a=(yield av(i)).size,o=Vx(Zg(Lb,Iy),$x("psychologistId","==",e)),l=yield av(o);let c=0,d=0;l.forEach(e=>{const t=e.data();t.rating&&(c+=t.rating,d++)});const u=d>0?(c/d).toFixed(1):0,h=new Date;h.setDate(h.getDate()-7);const m=Vx(Zg(Lb,_y),$x("psychologistId","==",e),$x("createdAt",">=",h)),p=yield av(m);return{activePatients:s,totalSessions:a,successRate:87,avgSessionTime:45,rating:u,newPatients:p.size}}catch(t){throw t}})}getPatientProgress(e){return p(this,null,function*(){try{const t=Vx(Zg(Lb,"progress"),$x("patientId","==",e),Hx("date","desc"),Wx(10)),s=yield av(t),r=[];return s.forEach(e=>{r.push(d({id:e.id},e.data()))}),r}catch(t){throw t}})}addSessionEvaluation(e,t,s){return p(this,null,function*(){try{return(yield dv(Zg(Lb,Iy),u(d({},s),{psychologistId:e,sessionId:t,createdAt:gv()}))).id}catch(r){throw r}})}subscribeToPatients(e,t){return uv(Vx(Zg(Lb,_y),$x("psychologistId","==",e),Hx("createdAt","desc")),e=>{const s=[];e.forEach(e=>{s.push(d({id:e.id},e.data()))}),t(s)})}subscribeToSessions(e,t){return uv(Vx(Zg(Lb,Ty),$x("psychologistId","==",e),Hx("date","asc"),Hx("time","asc")),e=>{const s=[];e.forEach(e=>{s.push(d({id:e.id},e.data()))}),t(s)})}markTourAsSeen(e){return p(this,null,function*(){try{const t=ex(Lb,Sy,e);return yield lv(t,{hasSeenTour:!0,updatedAt:gv()}),!0}catch(t){throw t}})}}const Dy=new Ay,Py=t=>p(e,null,function*(){try{const e=new Ay;return{success:!0,data:yield e.getPatients(t)}}catch(e){return{success:!1,error:e.message}}}),Ry=(t,...s)=>p(e,[t,...s],function*(e,t={}){try{const s=new Ay;return{success:!0,data:yield s.getSessions(e,t)}}catch(s){return{success:!1,error:s.message}}}),Ly=x.memo(({showWelcomeMessage:t=!1})=>{f.useState(0);const[s,r]=f.useState(!0),[n,i]=f.useState([]),[a,o]=f.useState(!0),{user:l}=Vb(),c=Ot(),{text:d,icon:u,formattedDate:h}=ky((null==l?void 0:l.username)||(null==l?void 0:l.displayName));f.useEffect(()=>{if(t){r(!0);const e=setTimeout(()=>{r(!1)},1500);return()=>clearTimeout(e)}},[t]);const[m,g]=f.useState(!1);f.useEffect(()=>{if(t&&s){const e=setTimeout(()=>{g(!0)},1e3);return()=>clearTimeout(e)}g(!1)},[t,s]);const[x,v]=f.useState(null),[b,y]=f.useState(!1),N=f.useMemo(()=>[{frase:"A jornada de mil milhas começa com um único passo.",autor:"Lao Tzu"},{frase:"A felicidade não é algo pronto. Ela vem das suas próprias ações.",autor:"Dalai Lama"},{frase:"Cada dia é uma nova oportunidade para ser melhor.",autor:"Desconhecido"},{frase:"A mente é como um paraquedas. Só funciona quando está aberta.",autor:"Frank Zappa"},{frase:"O bem-estar começa com a aceitação de quem você é.",autor:"Desconhecido"}],[]),C=f.useCallback(()=>p(e,null,function*(){try{o(!0);const e=yield Dy.getRecommendedPsychologists(4);i(e)}catch(e){i([])}finally{o(!1)}}),[]);f.useEffect(()=>{C()},[C]);const k=f.useCallback(()=>p(e,null,function*(){y(!0);try{yield new Promise(e=>setTimeout(e,500));const e=Math.floor(Math.random()*N.length);v(N[e])}catch(vN){v(null)}finally{y(!1)}}),[N]);f.useEffect(()=>{k()},[k]);const S=f.useCallback(()=>{k()},[k]),E=f.useCallback(e=>{c(`/home/profile/${e.id}`)},[c]),_=f.useCallback(()=>{},[]);return Je.jsxs(Gw,{variant:"glass",padding:"lg",className:"mb-8 animation-initial animate-fade-in-up",children:[s&&Je.jsx(Gw.Header,{children:Je.jsxs("div",{className:"text-center mb-6 animation-initial animate-fade-in-up animation-delay-100 "+(t&&m?"welcome-greeting-fade-out":""),children:[Je.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[Je.jsx(u,{className:"w-6 h-6 text-gray-400","aria-hidden":"true"}),Je.jsx("h2",{className:"text-2xl font-bold text-white",children:d})]}),Je.jsx("time",{className:"text-gray-400",dateTime:(new Date).toISOString(),children:h})]})}),Je.jsxs(Gw.Content,{children:[Je.jsx(Gw,{variant:"glass",padding:"lg",className:"mb-6 animation-initial animate-fade-in-up animation-delay-200",children:Je.jsxs("div",{onKeyDown:_,tabIndex:0,role:"region","aria-label":"Mensagem motivacional","aria-live":"polite",children:[Je.jsx("div",{className:"text-center min-h-[100px] flex flex-col justify-center",children:b?Je.jsx("div",{className:"text-white/70",children:"Carregando frase..."}):x?Je.jsxs(Je.Fragment,{children:[Je.jsxs("blockquote",{className:"text-white text-lg leading-relaxed mb-3",children:['"',x.frase,'"']}),Je.jsxs("cite",{className:"text-gray-300 text-sm font-medium not-italic",children:["- ",x.autor]})]}):Je.jsx("div",{className:"text-white/70",children:"Não foi possível carregar a frase agora."})}),Je.jsx("div",{className:"flex items-center justify-center mt-6",children:Je.jsx("button",{onClick:S,className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors focus-ring","aria-label":"Atualizar frase",children:"Nova frase"})}),Je.jsxs("div",{className:"text-center mt-4",children:[Je.jsx("p",{className:"text-sm text-gray-300",children:"Ajudando na construção da sua própria história!"}),Je.jsx("div",{className:"flex justify-center space-x-1 mt-2",role:"img","aria-label":"Corações de apoio",children:[...Array(3)].map((e,t)=>Je.jsx(w,{className:"w-4 h-4 text-gray-400 fill-current","aria-hidden":"true"},t))})]})]})}),Je.jsxs(Gw,{variant:"glass",padding:"lg",children:[Je.jsx(Gw.Header,{children:Je.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Psicólogos Recomendados"})}),Je.jsx(Gw.Content,{children:a?Je.jsxs("div",{className:"flex items-center justify-center py-8",children:[Je.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}),Je.jsx("span",{className:"text-white/70 ml-3",children:"Carregando psicólogos..."})]}):0===n.length?Je.jsxs("div",{className:"text-center py-8",children:[Je.jsx(J,{className:"w-12 h-12 text-white/30 mx-auto mb-3"}),Je.jsx("p",{className:"text-white/70 text-sm",children:"Nenhum psicólogo disponível no momento"}),Je.jsx("p",{className:"text-white/50 text-xs mt-1",children:"Tente novamente mais tarde"})]}):Je.jsx("div",{className:"space-y-4",children:n.map(e=>Je.jsx("article",{className:"bg-white/5 border border-white/10 rounded-xl p-4 hover:bg-white/10 transition-all duration-200 group cursor-pointer",onClick:()=>E(e),children:Je.jsxs("div",{className:"flex items-start space-x-4",children:[Je.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform duration-200",children:Je.jsx("span",{className:"text-white font-bold text-sm",children:e.initials})}),Je.jsxs("div",{className:"flex-1 min-w-0",children:[Je.jsxs("div",{className:"flex items-start justify-between mb-2",children:[Je.jsxs("div",{children:[Je.jsx("h3",{className:"text-white font-semibold text-base group-hover:text-white/90 transition-colors duration-200",children:e.name}),Je.jsx("p",{className:"text-gray-300 text-sm mt-1",children:e.specialty})]}),Je.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-500/20 px-2 py-1 rounded-lg",children:[Je.jsx(j,{className:"w-3 h-3 text-yellow-400 fill-current"}),Je.jsx("span",{className:"text-yellow-400 text-xs font-medium",children:e.rating})]})]}),Je.jsxs("p",{className:"text-gray-400 text-xs mb-3",children:["Experiência: ",e.experience]}),Je.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.acceptsOnline&&Je.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-500/20 text-green-400 border border-green-400/20",children:[Je.jsx(D,{className:"w-3 h-3 mr-1"}),"Online"]}),Je.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-400 border border-blue-400/20",children:[Je.jsx(F,{className:"w-3 h-3 mr-1"}),"Disponível"]})]})]}),Je.jsx("button",{onClick:t=>{t.stopPropagation(),E(e)},className:"px-4 py-2 bg-white text-black rounded-lg font-medium hover:bg-gray-100 transition-colors duration-200 flex-shrink-0 group-hover:scale-105 transform","aria-label":`Ver perfil de ${e.name}`,children:"Ver Perfil"})]})},e.id))})})]})]})]})});function Oy(){return Je.jsxs(Je.Fragment,{children:[Je.jsx(Ly,{}),Je.jsx(Ny,{}),Je.jsx(Cy,{})]})}Ly.displayName="WelcomeScreen";const My=()=>{var t,s;const[r,n]=f.useState(""),[i,a]=f.useState(""),[o,l]=f.useState("track"),[c,h]=f.useState(null);f.useState([]);const[m,g]=f.useState(!1),[x,v]=f.useState(""),[b,w]=f.useState("week"),[y,N]=f.useState(!1),[j,C]=f.useState(""),[k,S]=f.useState(""),[E,_]=f.useState("individual"),[T,I]=f.useState(""),[P,L]=f.useState(null),[O,M]=f.useState([]),[U,V]=f.useState(!1),[z,$]=f.useState(0),[G,W]=f.useState((new Date).getFullYear()),[K,Q]=f.useState((new Date).getMonth()),[J,Y]=f.useState(null),[X,Z]=f.useState({}),[ee,te]=f.useState(!1),se=[{emoji:"😊",label:"Feliz",value:"happy",color:"bg-green-500"},{emoji:"😔",label:"Triste",value:"sad",color:"bg-blue-500"},{emoji:"😡",label:"Raiva",value:"angry",color:"bg-red-500"},{emoji:"😰",label:"Medo",value:"fear",color:"bg-yellow-500"},{emoji:"😌",label:"Paz",value:"peace",color:"bg-purple-500"},{emoji:"❤️",label:"Amor",value:"love",color:"bg-pink-500"}],re=e=>Object.entries(e).map(([e,t])=>({id:e,date:new Date(e),mood:t.mood,cause:t.cause,intensity:t.intensity||5,notes:`Humor registrado em ${new Date(e).toLocaleDateString("pt-BR")}`,timestamp:t.timestamp})).sort((e,t)=>t.date-e.date),ne=e=>{if(0===e.length)return 0;e.sort((e,t)=>e.date-t.date);let t=0,s=new Date;const r=(new Date).toISOString().split("T")[0];if(!X[r])return 0;for(let n=0;n<30;n++){const e=new Date(s);e.setDate(s.getDate()-n);const r=e.toISOString().split("T")[0];if(!X[r])break;t++}return t},ie=e=>{const t=new Date;t.setDate(t.getDate()-7);const s=e.filter(e=>e.date>=t);if(0===s.length)return"Nenhuma entrada ainda";const r=s.reduce((e,t)=>(t.intensity||5)>(e.intensity||5)?t:e),n=se.find(e=>e.value===r.mood);return n?n.label:"Indefinido"},ae=e=>{const t=[];if(0===e.length)return t;const s={};e.forEach(e=>{s[e.mood]=(s[e.mood]||0)+1});const r=Object.entries(s).reduce((e,t)=>s[e[0]]>s[t[0]]?e:t);if(r){const e=se.find(e=>e.value===r[0]);t.push({id:"frequent",title:"Humor mais frequente",value:e?e.label:"Indefinido",icon:xe,color:"text-green-400"})}const n={};e.forEach(e=>{n[e.cause]=(n[e.cause]||0)+1});const i=Object.entries(n).reduce((e,t)=>n[e[0]]>n[t[0]]?e:t);return i&&t.push({id:"cause",title:"Causa mais comum",value:i[0],icon:A,color:"text-purple-400"}),t},le=()=>((e,t)=>{if(!t.trim())return e;const s=t.toLowerCase();return e.filter(e=>{var t;return e.cause.toLowerCase().includes(s)||e.notes.toLowerCase().includes(s)||(null==(t=se.find(t=>t.value===e.mood))?void 0:t.label.toLowerCase().includes(s))})})(((e,t)=>{const s=new Date,r=new Date;switch(t){case"week":r.setDate(s.getDate()-7);break;case"month":r.setMonth(s.getMonth()-1);break;case"year":r.setFullYear(s.getFullYear()-1);break;default:return e}return e.filter(e=>e.date>=r)})(re(X),b),x),ce=()=>(()=>{const e=re(X);if(0===e.length)return[];const t={};e.forEach(e=>{t[e.mood]=(t[e.mood]||0)+1});const s=e.length;return Object.entries(t).map(([e,t])=>{const r=Math.round(t/s*100),n=se.find(t=>t.value===e);return{mood:(null==n?void 0:n.label)||e,color:(null==n?void 0:n.color)||"bg-gray-500",percentage:r,count:t,trend:"up"}}).sort((e,t)=>t.percentage-e.percentage)})(),de=()=>(()=>{const e=re(X);if(0===e.length)return{goals:[],insights:[]};const t=ne(e),s=ie(e),r=ae(e);return{goals:[{id:"consecutive",title:"Meta: 7 dias consecutivos",progress:t,target:7,icon:R,color:"text-blue-400"}],insights:[{id:"weekly",title:"Melhor humor da semana",value:s,icon:ke,color:"text-yellow-400"},...r]}})(),ue=e=>{"prev"===e?0===K?(Q(11),W(G-1)):Q(K-1):11===K?(Q(0),W(G+1)):Q(K+1)},he=e=>{W(G+e)},me=()=>p(e,null,function*(){try{te(!0);const e=Pb.currentUser;if(!e)return;const t=Vx(Zg(Lb,"users",e.uid,"moods"),Hx("timestamp","desc"));return uv(t,e=>{const t={};e.forEach(e=>{const s=e.data();t[s.date]={mood:s.mood,cause:s.cause,intensity:s.intensity||5,timestamp:s.timestamp}}),Z(t)})}catch(e){}finally{te(!1)}}),pe=((e,t)=>{var s,r;const n=((e,t)=>new Date(e,t+1,0).getDate())(e,t),i=((e,t)=>new Date(e,t,1).getDay())(e,t),a=[],o=new Date,l=o.getFullYear()===e&&o.getMonth()===t;for(let c=0;c<i;c++)a.push({day:null,mood:null,intensity:null,date:null,isToday:!1});for(let c=1;c<=n;c++){const n=new Date(e,t,c).toISOString().split("T")[0],i=l&&o.getDate()===c;a.push({day:c,mood:(null==(s=X[n])?void 0:s.mood)||null,intensity:(null==(r=X[n])?void 0:r.intensity)||null,date:n,isToday:i})}return a})(G,K),fe=(t,s)=>{var r,n;t&&s&&(r=t,n=s,p(e,null,function*(){if(r&&n)try{V(!0);const e=Vx(Zg(Lb,"PsychologistAccount"),$x("isAvailable","==",!0)),t=yield av(e),s=[];t.forEach(e=>{const t=e.data(),r=t.availableSlots||["09:00","14:00","16:00"];r.includes(n)&&s.push({id:e.id,name:t.displayName||t.name||"Psicólogo",specialty:t.specialty||t.approach||"Psicologia Clínica",experience:t.yearsExperience?`${t.yearsExperience} anos`:"5 anos",rating:t.rating||5,availableSlots:r,avatar:t.avatar||"👨‍⚕️",description:t.bio||t.description||"Psicólogo especializado em atendimento clínico",email:t.email,phone:t.phone||"",crp:t.crp||"CRP não informado",education:t.education||"Psicologia",languages:t.languages||["Português"],isAvailable:!1!==t.isAvailable,selectedTime:n,approach:t.approach||t.specialty||"",certifications:t.certifications||[],insurance:t.insurance||!1,virtualSessions:!1!==t.virtualSessions,inPersonSessions:!1!==t.inPersonSessions,totalSessions:t.totalSessions||0,acceptsOnline:t.acceptsOnline||!1})}),s.sort((e,t)=>{if(t.rating!==e.rating)return t.rating-e.rating;const s=parseInt(e.experience)||0;return(parseInt(t.experience)||0)-s}),M(s),s.length}catch(e){M([])}finally{V(!1)}else M([])}),L(null))};f.useEffect(()=>{p(e,null,function*(){yield p(e,null,function*(){try{const e=Pb.currentUser;if(e){const t=ex(Lb,"users",e.uid),s=yield nv(t);s.exists()&&h(s.data())}}catch(e){}}),yield me(),yield p(e,null,function*(){try{const e=Vx(Zg(Lb,"PsychologistAccount"),$x("isAvailable","==",!0));return(yield av(e)).size}catch(e){return 0}})})},[]),f.useEffect(()=>{Pb.currentUser&&me()},[G,K]),f.useEffect(()=>{"scheduling"!==o&&(M([]),L(null),$(0),C(""),S(""))},[o]);const ge=e=>{const t=se.find(t=>t.value===e);return t?t.color:"bg-gray-500"},Se=e=>{switch(e){case"happy":return"😊";case"sad":return"😔";case"angry":return"😡";case"fear":return"😰";case"peace":return"😌";case"love":return"❤️";default:return"😐"}},Ee=(()=>{const e=Object.values(X).filter(e=>{var t;const s=new Date((null==(t=e.timestamp)?void 0:t.toDate())||e.timestamp);return s.getMonth()===K&&s.getFullYear()===G}),t=e.length,s=t>0?e.reduce((e,t)=>e+({happy:8,sad:3,angry:2,fear:4,peace:7,love:9}[t.mood]||5),0)/t:0;return{totalEntries:t,averageMood:Math.round(10*s)/10}})();return Je.jsx("div",{className:"min-h-screen bg-black py-8 px-4 sm:px-6 lg:px-8",children:Je.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[Je.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl hover:bg-white/15 hover:border-white/30 hover:shadow-3xl transition-all duration-500 hover:-translate-y-1 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700 animate-pulse"}),Je.jsx("div",{className:"absolute top-4 right-8 w-1 h-1 bg-white/30 rounded-full opacity-0 group-hover:opacity-100 group-hover:animate-bounce transition-opacity duration-300",style:{animationDelay:"0.3s"}}),Je.jsx("div",{className:"absolute top-8 right-16 w-0.5 h-0.5 bg-white/20 rounded-full opacity-0 group-hover:opacity-100 group-hover:animate-bounce transition-opacity duration-300",style:{animationDelay:"0.6s"}}),Je.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 relative z-10",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(xe,{className:"w-7 h-7 text-gray-400 group-hover:text-white transition-all duration-300 group-hover:rotate-12 group-hover:scale-110"}),Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover:opacity-100 group-hover:animate-pulse transition-all duration-500"})]}),Je.jsx("h2",{className:"text-2xl font-bold text-white group-hover:tracking-wide transition-all duration-300",children:"Rastreador de Humor"})]}),Je.jsxs("button",{onClick:()=>g(!m),className:"group/add bg-white/10 border border-white/30 text-white px-5 py-2.5 rounded-lg hover:bg-white/20 transition-all duration-300 text-sm hover:scale-110 hover:shadow-lg relative overflow-hidden flex items-center justify-center",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent opacity-0 group-hover/add:opacity-100 transition-opacity duration-300 group-hover/add:animate-pulse"}),Je.jsx(H,{className:"w-4 h-4 inline mr-2 group-hover/add:rotate-90 group-hover/add:scale-125 transition-all duration-300 relative z-10"}),Je.jsx("span",{className:"relative z-10 group-hover/add:font-medium transition-all duration-300",children:"Registrar Humor"})]})]}),Je.jsx("div",{className:"flex flex-wrap gap-2 bg-white/5 rounded-xl p-1.5 relative z-10",children:[{id:"track",label:"Rastreamento"},{id:"history",label:"Histórico"},{id:"analytics",label:"Análises"},{id:"scheduling",label:"Agendar Sessão"}].map((e,t)=>Je.jsxs("button",{onClick:()=>l(e.id),className:"group/tab flex-1 min-w-[120px] px-4 py-3 rounded-xl text-sm font-medium transition-all duration-300 hover:scale-105 relative overflow-hidden "+(o===e.id?"bg-white text-black shadow-lg":"text-white/70 hover:text-white hover:bg-white/10"),style:{animationDelay:100*t+"ms"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 group-hover/tab:opacity-100 transition-opacity duration-300"}),Je.jsx("span",{className:"relative z-10 group-hover/tab:tracking-wide transition-all duration-300",children:e.label})]},e.id))})]}),m&&Je.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl hover:bg-white/15 hover:border-white/30 transition-all duration-500 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),Je.jsxs("div",{className:"flex items-center justify-between mb-8 relative z-10",children:[Je.jsx("h3",{className:"text-xl font-semibold text-white group-hover:tracking-wide transition-all duration-300",children:J&&X[J.date]?"Editar Humor":"Registrar Humor"}),Je.jsxs("button",{onClick:()=>g(!1),className:"group/close text-white/50 hover:text-white hover:scale-125 hover:rotate-90 transition-all duration-300 p-2",children:[Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover/close:opacity-100 transition-opacity duration-300"}),"✕"]})]}),Je.jsxs("div",{className:"space-y-8 relative z-10",children:[Je.jsxs("div",{children:[Je.jsx("p",{className:"text-sm text-gray-300 mb-4 group-hover:text-white/90 transition-colors duration-300",children:"Escolha uma Opção:"}),Je.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:se.map((e,t)=>Je.jsxs("button",{onClick:()=>n(e.value),className:"group/mood flex flex-col items-center space-y-3 p-4 rounded-2xl transition-all duration-300 hover:scale-110 hover:-translate-y-1 hover:shadow-lg relative overflow-hidden "+(r===e.value?"bg-white/10 border border-white/20 scale-105 shadow-lg":"bg-gray-800/30 hover:bg-gray-700/50"),style:{animationDelay:100*t+"ms",transform:"translateZ(0)"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent opacity-0 group-hover/mood:opacity-100 transition-opacity duration-300"}),Je.jsx("span",{className:"text-3xl group-hover/mood:scale-125 group-hover/mood:rotate-12 transition-all duration-300 relative z-10",children:e.emoji}),Je.jsx("span",{className:"text-sm text-gray-300 group-hover/mood:text-white group-hover/mood:font-medium transition-all duration-300 relative z-10",children:e.label}),Je.jsx("div",{className:"absolute top-1 right-1 w-1 h-1 bg-white/40 rounded-full opacity-0 group-hover/mood:opacity-100 group-hover/mood:animate-ping transition-opacity duration-300"})]},e.value))})]}),Je.jsxs("div",{children:[Je.jsx("p",{className:"text-sm text-gray-300 mb-4 group-hover:text-white/90 transition-colors duration-300",children:"Principal Causa:"}),Je.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:["Sono","Eu Mesmo(a)","Família","Saúde","Amizades","Estudos","Lazer","Trabalho","Relação","Luto","Finanças","Outras"].map((e,t)=>Je.jsxs("button",{onClick:()=>a(e),className:"group/cause p-3 rounded-xl text-xs transition-all duration-300 hover:scale-105 hover:-translate-y-0.5 relative overflow-hidden "+(i===e?"bg-white/10 border border-white/20 text-white":"bg-gray-800/30 hover:bg-gray-700/50 text-gray-300 hover:text-white"),style:{animationDelay:50*t+"ms"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover/cause:opacity-100 transition-opacity duration-300"}),Je.jsx("span",{className:"relative z-10 group-hover/cause:font-medium transition-all duration-300",children:e})]},e))})]}),Je.jsxs("button",{onClick:()=>p(e,null,function*(){var t,s;if(r&&i)try{te(!0);const o=(null==J?void 0:J.date)||(new Date).toISOString().split("T")[0],l=X[o],c={mood:r,cause:i,intensity:5,timestamp:l?X[o].timestamp:new Date,updatedAt:new Date};(yield(t=o,s=c,p(e,null,function*(){try{const e=Pb.currentUser;if(!e)return!1;const r=ex(Lb,"users",e.uid,"moods",t);return yield ov(r,u(d({},s),{date:t,timestamp:new Date,userId:e.uid})),!0}catch(e){return!1}})))?(Z(e=>u(d({},e),{[o]:c})),g(!1),n(""),a(""),Y(null)):alert(`Erro ao ${l?"editar":"salvar"} humor. Tente novamente.`)}catch(o){alert(`Erro ao ${(null==J?void 0:J.date)&&X[J.date]?"editar":"registrar"} humor. Tente novamente.`)}finally{te(!1)}}),disabled:!r||!i||ee,className:"group/submit w-full bg-gradient-to-r from-white to-gray-200 text-black py-4 px-4 rounded-xl font-bold hover:from-gray-200 hover:to-gray-300 transform hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-xl relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent opacity-0 group-hover/submit:opacity-100 transition-opacity duration-300 group-hover/submit:animate-pulse"}),Je.jsx("span",{className:"relative z-10 group-hover/submit:tracking-wider group-hover/submit:font-bold transition-all duration-300",children:ee?"Salvando...":J&&X[J.date]?"ATUALIZAR":"REGISTRAR"})]})]})]}),"track"===o&&Je.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[Je.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl hover:bg-white/15 hover:border-white/30 hover:shadow-3xl transition-all duration-500 hover:-translate-y-1 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700 z-0"}),Je.jsxs("div",{className:"flex flex-col items-center mb-6 relative z-20",children:[Je.jsxs("h3",{className:"text-2xl font-semibold text-white group-hover:tracking-wide transition-all duration-300 mb-4 text-center",children:[(_e=K,["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][_e])," de ",G]}),Je.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsxs("button",{onClick:()=>he(-1),className:"group/year p-2 text-gray-400 hover:text-white hover:scale-125 hover:rotate-12 transition-all duration-300 bg-white/5 rounded-lg hover:bg-white/10 relative z-30",title:"Ano anterior",children:[Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover/year:opacity-100 transition-opacity duration-300 z-0"}),Je.jsx(ve,{className:"w-4 h-4 relative z-10"})]}),Je.jsx("span",{className:"text-sm text-gray-300 px-3 py-1 font-medium bg-white/5 rounded-lg",children:G}),Je.jsxs("button",{onClick:()=>he(1),className:"group/year p-2 text-gray-400 hover:text-white hover:scale-125 hover:-rotate-12 transition-all duration-300 bg-white/5 rounded-lg hover:bg-white/10 relative z-30",title:"Próximo ano",children:[Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover/year:opacity-100 transition-opacity duration-300 z-0"}),Je.jsx(be,{className:"w-4 h-4 relative z-10"})]})]}),Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsxs("button",{onClick:()=>ue("prev"),className:"group/nav p-2 text-gray-400 hover:text-white hover:scale-125 hover:rotate-12 transition-all duration-300 bg-white/5 rounded-lg hover:bg-white/10 relative z-30",title:"Mês anterior",children:[Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover/nav:opacity-100 transition-opacity duration-300 z-0"}),Je.jsx(we,{className:"w-4 h-4 relative z-10"})]}),Je.jsxs("button",{onClick:()=>{const e=new Date;W(e.getFullYear()),Q(e.getMonth()),Y({day:e.getDate(),date:e.toISOString().split("T")[0]})},className:"group/today px-4 py-2 text-blue-400 hover:text-blue-300 hover:scale-105 transition-all duration-300 bg-blue-500/10 rounded-lg hover:bg-blue-500/20 text-sm font-medium relative z-30",title:"Voltar para hoje",children:[Je.jsx("div",{className:"absolute -inset-2 bg-blue-500/10 rounded-full opacity-0 group-hover/today:opacity-100 transition-opacity duration-300 z-0"}),Je.jsx("span",{className:"relative z-10",children:"Hoje"})]}),Je.jsxs("button",{onClick:()=>ue("next"),className:"group/nav p-2 text-gray-400 hover:text-white hover:scale-125 hover:-rotate-12 transition-all duration-300 bg-white/5 rounded-lg hover:bg-white/10 relative z-30",title:"Próximo mês",children:[Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover/nav:opacity-100 transition-opacity duration-300 z-0"}),Je.jsx(ye,{className:"w-4 h-4 relative z-10"})]})]})]})]}),Je.jsx("div",{className:"grid grid-cols-7 gap-1 mb-3 relative z-20",children:["D","S","T","Q","Q","S","S"].map((e,t)=>Je.jsx("div",{className:"text-center text-xs text-gray-400 p-2 group-hover:text-white/70 transition-colors duration-300 font-medium",children:e},`${e}-${t}`))}),Je.jsx("div",{className:"grid grid-cols-7 gap-1 relative z-20",children:pe.map((e,t)=>Je.jsx("button",{onClick:()=>((e,t)=>{e&&t&&Y({day:e,date:t})})(e.day,e.date),disabled:!e.day,className:"group/day aspect-square flex flex-col items-center justify-center text-sm rounded-xl transition-all duration-300 hover:scale-110 hover:-translate-y-1 hover:shadow-lg relative z-30 "+(e.day?e.mood?`${ge(e.mood)} text-white`:(null==J?void 0:J.date)===e.date?"bg-white/20 border border-white/30 text-white":e.isToday?"bg-blue-500/20 border border-blue-400/30 text-blue-300":"text-gray-300 hover:bg-gray-700/50 hover:text-white":"invisible"),style:{animationDelay:20*t+"ms"},children:e.day&&Je.jsxs(Je.Fragment,{children:[Je.jsx("span",{className:"text-xs group-hover/day:font-bold transition-all duration-300",children:e.day}),e.mood&&Je.jsx("span",{className:"text-xs opacity-75 group-hover/day:opacity-100 group-hover/day:scale-110 transition-all duration-300",children:Se(e.mood)}),e.isToday&&!e.mood&&Je.jsx("span",{className:"text-xs text-blue-400 group-hover/day:scale-110 transition-all duration-300",children:"•"}),!e.mood&&!e.isToday&&Je.jsx("span",{className:"text-xs text-gray-500 group-hover/day:text-gray-400 transition-colors duration-300",children:"+"})]})},t))}),Je.jsxs("div",{className:"mt-6 pt-4 border-t border-white/10 relative z-20",children:[Je.jsx("h4",{className:"text-sm text-white/70 mb-3",children:"Legenda:"}),Je.jsx("div",{className:"flex flex-wrap gap-2",children:se.map(e=>Je.jsxs("div",{className:"flex items-center space-x-1.5",children:[Je.jsx("div",{className:`w-3 h-3 rounded-full ${e.color}`}),Je.jsx("span",{className:"text-xs text-white/60",children:e.label})]},e.value))})]}),J&&Je.jsx("div",{className:"mt-4 p-4 bg-white/10 rounded-lg border border-white/20 relative z-20",children:Je.jsxs("div",{className:"text-center",children:[Je.jsx("span",{className:"text-sm text-white/70",children:"Data selecionada:"}),Je.jsx("div",{className:"text-white font-medium mt-1",children:new Date(J.date).toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),X[J.date]?Je.jsxs("div",{className:"mt-3 p-3 bg-white/5 rounded-lg border border-white/10",children:[Je.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[Je.jsx("span",{className:"text-2xl",children:Se(X[J.date].mood)}),Je.jsx("span",{className:"text-white font-medium",children:null==(t=se.find(e=>e.value===X[J.date].mood))?void 0:t.label})]}),Je.jsxs("div",{className:"text-white/70 text-sm mb-3",children:["Causa: ",Je.jsx("span",{className:"text-white font-medium",children:X[J.date].cause})]}),Je.jsxs("div",{className:"flex items-center justify-center space-x-2 text-xs text-white/50",children:[Je.jsx(oe,{className:"w-3 h-3"}),Je.jsxs("span",{children:["Registrado em: ",new Date((null==(s=X[J.date].timestamp)?void 0:s.toDate())||X[J.date].timestamp).toLocaleString("pt-BR")]})]}),Je.jsx("button",{onClick:()=>{n(X[J.date].mood),a(X[J.date].cause),g(!0)},className:"mt-3 text-xs text-yellow-400 hover:text-yellow-300 underline transition-colors duration-300 relative z-30",children:"Editar humor"})]}):Je.jsx("button",{onClick:()=>g(!0),className:"mt-3 text-sm text-blue-400 hover:text-blue-300 underline transition-colors duration-300 relative z-30",children:"Registrar humor nesta data"})]})})]}),Je.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl hover:bg-white/15 hover:border-white/30 hover:shadow-3xl transition-all duration-500 hover:-translate-y-1 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),Je.jsx("h3",{className:"text-xl font-semibold text-white mb-6 group-hover:tracking-wide transition-all duration-300 relative z-10",children:"Resumo da Semana"}),Je.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 relative z-10",children:[{emoji:"😊",title:"Humor Médio",value:`${Ee.averageMood}/10`},{emoji:"📊",title:"Entradas",value:`${Ee.totalEntries} este mês`}].map((e,t)=>Je.jsxs("div",{className:"group/stat text-center p-6 bg-white/5 rounded-xl hover:bg-white/10 hover:scale-105 hover:-translate-y-1 transition-all duration-300 hover:shadow-lg relative overflow-hidden",style:{animationDelay:200*t+"ms"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent opacity-0 group-hover/stat:opacity-100 transition-opacity duration-300"}),Je.jsx("div",{className:"text-3xl mb-3 group-hover/stat:scale-125 group-hover/stat:rotate-12 transition-all duration-300 relative z-10",children:e.emoji}),Je.jsx("div",{className:"text-white font-medium group-hover/stat:tracking-wide transition-all duration-300 relative z-10",children:e.title}),Je.jsx("div",{className:"text-white/70 text-sm group-hover/stat:text-white group-hover/stat:font-medium transition-all duration-300 relative z-10",children:e.value})]},e.title))})]})]}),"history"===o&&Je.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl hover:bg-white/15 hover:border-white/30 hover:shadow-3xl transition-all duration-500 hover:-translate-y-1 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),Je.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8 relative z-10",children:[Je.jsx("h3",{className:"text-xl font-semibold text-white group-hover:tracking-wide transition-all duration-300",children:"Histórico de Humor"}),Je.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[Je.jsxs("div",{className:"relative group/search flex-grow sm:flex-grow-0",children:[Je.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50 w-4 h-4 group-hover/search:text-white/80 group-hover/search:scale-125 group-hover/search:rotate-90 transition-all duration-300"}),Je.jsx("input",{type:"text",placeholder:"Pesquisar entradas...",value:x,onChange:e=>v(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg pl-10 pr-4 py-2.5 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 text-sm hover:bg-white/15 hover:border-white/30 focus:scale-105 transition-all duration-300 w-full"}),Je.jsx("div",{className:"absolute inset-0 rounded-lg ring-1 ring-white/0 group-hover/search:ring-white/20 transition-all duration-300 pointer-events-none"})]}),Je.jsxs("select",{value:b,onChange:e=>w(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-white/30 text-sm hover:bg-white/15 hover:border-white/30 hover:scale-105 transition-all duration-300",children:[Je.jsx("option",{value:"week",children:"Esta semana"}),Je.jsx("option",{value:"month",children:"Este mês"}),Je.jsx("option",{value:"year",children:"Este ano"})]})]})]}),Je.jsx("div",{className:"space-y-5 relative z-10",children:0===le().length?Je.jsxs("div",{className:"text-center py-16 group/empty",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(xe,{className:"w-20 h-20 text-white/30 mx-auto mb-6 group-hover:text-white/50 transition-all duration-500 group-hover:scale-110 group-hover:rotate-12"}),Je.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:Je.jsx("div",{className:"w-24 h-24 bg-white/5 rounded-full opacity-0 group-hover:opacity-100 group-hover:animate-pulse transition-opacity duration-500"})})]}),Je.jsx("h3",{className:"text-xl font-medium text-white/70 mb-3 group-hover:text-white/90 transition-colors duration-300",children:"Nenhuma entrada de humor"}),Je.jsx("p",{className:"text-white/50 group-hover:text-white/70 transition-colors duration-300",children:"Comece registrando seu humor usando o botão acima"})]}):le().map((t,s)=>Je.jsxs("div",{className:"group/entry bg-white/5 border border-white/10 rounded-xl p-5 hover:bg-white/10 hover:border-white/20 hover:scale-[1.02] hover:-translate-y-1 transition-all duration-300 hover:shadow-lg relative overflow-hidden",style:{animationDelay:100*s+"ms"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover/entry:opacity-100 transition-opacity duration-300"}),Je.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[Je.jsxs("div",{className:"flex items-center space-x-4",children:[Je.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center ${ge(t.mood)} group-hover/entry:scale-110 group-hover/entry:rotate-6 transition-all duration-300`,children:Je.jsx("span",{className:"text-2xl group-hover/entry:scale-125 transition-all duration-300",children:Se(t.mood)})}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"font-medium text-white group-hover/entry:tracking-wide transition-all duration-300",children:t.cause}),Je.jsx("p",{className:"text-sm text-white/70 group-hover/entry:text-white/90 transition-colors duration-300",children:t.notes}),Je.jsxs("div",{className:"flex items-center space-x-2 text-xs text-white/50 mt-2 group-hover/entry:text-white/70 transition-colors duration-300",children:[Je.jsx(oe,{className:"w-3 h-3 group-hover/entry:rotate-12 transition-all duration-300"}),Je.jsx("span",{children:t.date.toLocaleDateString("pt-BR")}),Je.jsx("span",{children:"•"}),Je.jsxs("span",{children:["Intensidade: ",t.intensity,"/10"]})]})]})]}),Je.jsx("div",{className:"flex space-x-3",children:Je.jsxs("button",{onClick:()=>(t=>p(e,null,function*(){if(confirm("Tem certeza que deseja excluir esta entrada de humor?"))try{te(!0);const e=Pb.currentUser;if(!e)return void alert("Usuário não autenticado");const s=ex(Lb,"users",e.uid,"moods",t.id);yield cv(s),Z(e=>{const s=d({},e);return delete s[t.id],s}),alert("Entrada de humor excluída com sucesso!")}catch(e){alert("Erro ao excluir entrada de humor. Tente novamente.")}finally{te(!1)}}))(t),className:"group/delete text-white/50 hover:text-white p-2 hover:scale-125 hover:rotate-12 transition-all duration-300",children:[Je.jsx("div",{className:"absolute -inset-2 bg-red-500/10 rounded-full opacity-0 group-hover/delete:opacity-100 transition-opacity duration-300"}),Je.jsx(q,{className:"w-4 h-4"})]})})]})]},t.id))})]}),"analytics"===o&&Je.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[Je.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl hover:bg-white/15 hover:border-white/30 hover:shadow-3xl transition-all duration-500 hover:-translate-y-1 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),Je.jsxs("div",{className:"flex items-center space-x-3 mb-6 relative z-10",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(Ne,{className:"w-6 h-6 text-gray-400 group-hover:text-white transition-all duration-300 group-hover:rotate-12 group-hover:scale-110"}),Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover:opacity-100 group-hover:animate-pulse transition-all duration-500"})]}),Je.jsx("h3",{className:"text-xl font-semibold text-white group-hover:tracking-wide transition-all duration-300",children:"Estatísticas Mensais"})]}),Je.jsx("div",{className:"space-y-4 relative z-10",children:0===ce().length?Je.jsxs("div",{className:"text-center py-12 group/empty",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(Ne,{className:"w-16 h-16 text-white/30 mx-auto mb-4 group-hover:text-white/50 transition-all duration-500 group-hover:scale-110 group-hover:rotate-12"}),Je.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:Je.jsx("div",{className:"w-20 h-20 bg-white/5 rounded-full opacity-0 group-hover:opacity-100 group-hover:animate-pulse transition-opacity duration-500"})})]}),Je.jsx("p",{className:"text-white/50 group-hover:text-white/70 transition-colors duration-300",children:"Nenhuma estatística disponível"}),Je.jsx("p",{className:"text-white/30 text-sm group-hover:text-white/50 transition-colors duration-300",children:"Registre seu humor para ver análises"})]}):ce().map((e,t)=>Je.jsxs("div",{className:"group/stat flex items-center justify-between hover:bg-white/5 p-4 rounded-xl hover:scale-105 transition-all duration-300 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover/stat:opacity-100 transition-opacity duration-300"}),Je.jsxs("div",{className:"flex items-center space-x-4 relative z-10",children:[Je.jsx("div",{className:`w-5 h-5 rounded ${e.color} group-hover/stat:scale-125 group-hover/stat:rotate-12 transition-all duration-300`}),Je.jsx("span",{className:"text-sm text-gray-300 group-hover/stat:text-white group-hover/stat:font-medium transition-all duration-300",children:e.mood})]}),Je.jsxs("div",{className:"flex items-center space-x-2 relative z-10",children:[Je.jsxs("span",{className:"text-sm text-gray-400 group-hover/stat:text-white/90 transition-colors duration-300",children:[e.percentage,"%"]}),"up"===e.trend?Je.jsx(je,{className:"w-4 h-4 text-green-400 group-hover/stat:scale-125 group-hover/stat:rotate-12 transition-all duration-300"}):Je.jsx(Ce,{className:"w-4 h-4 text-red-400 group-hover/stat:scale-125 group-hover/stat:-rotate-12 transition-all duration-300"})]})]},t))})]}),Je.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl hover:bg-white/15 hover:border-white/30 hover:shadow-3xl transition-all duration-500 hover:-translate-y-1 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),Je.jsx("h3",{className:"text-xl font-semibold text-white mb-6 group-hover:tracking-wide transition-all duration-300 relative z-10",children:"Metas e Insights"}),Je.jsxs("div",{className:"space-y-6 relative z-10",children:[0===de().goals.length?Je.jsxs("div",{className:"text-center py-12 group/empty",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(R,{className:"w-16 h-16 text-white/30 mx-auto mb-4 group-hover:text-white/50 transition-all duration-500 group-hover:scale-110 group-hover:rotate-12"}),Je.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:Je.jsx("div",{className:"w-20 h-20 bg-white/5 rounded-full opacity-0 group-hover:opacity-100 group-hover:animate-pulse transition-opacity duration-500"})})]}),Je.jsx("p",{className:"text-white/50 group-hover:text-white/70 transition-colors duration-300",children:"Nenhuma meta definida"}),Je.jsx("p",{className:"text-white/30 text-sm group-hover:text-white/50 transition-colors duration-300",children:"Comece registrando seu humor para definir metas"})]}):de().goals.map((e,t)=>Je.jsxs("div",{className:"group/goal flex items-center space-x-4 p-4 bg-white/5 rounded-xl hover:bg-white/10 hover:scale-105 hover:-translate-y-1 transition-all duration-300 hover:shadow-lg relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover/goal:opacity-100 transition-opacity duration-300"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(R,{className:"w-6 h-6 text-blue-400 group-hover/goal:scale-125 group-hover/goal:rotate-12 transition-all duration-300"}),Je.jsx("div",{className:"absolute -inset-2 bg-blue-400/10 rounded-full opacity-0 group-hover/goal:opacity-100 transition-opacity duration-300"})]}),Je.jsxs("div",{className:"relative z-10",children:[Je.jsx("div",{className:"text-white font-medium group-hover/goal:tracking-wide transition-all duration-300",children:e.title}),Je.jsxs("div",{className:"text-white/70 text-sm group-hover/goal:text-white/90 transition-colors duration-300",children:["Progresso: ",e.progress,"/",e.target," dias"]})]})]},e.id)),0===de().insights.length?Je.jsxs("div",{className:"text-center py-12 group/empty",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(ke,{className:"w-16 h-16 text-white/30 mx-auto mb-4 group-hover:text-white/50 transition-all duration-500 group-hover:scale-110 group-hover:rotate-12"}),Je.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:Je.jsx("div",{className:"w-20 h-20 bg-white/5 rounded-full opacity-0 group-hover:opacity-100 group-hover:animate-pulse transition-opacity duration-500"})})]}),Je.jsx("p",{className:"text-white/50 group-hover:text-white/70 transition-colors duration-300",children:"Nenhuma meta definida"}),Je.jsx("p",{className:"text-white/30 text-sm group-hover:text-white/50 transition-colors duration-300",children:"Comece registrando seu humor para definir metas"})]}):de().insights.map((e,t)=>Je.jsxs("div",{className:"group/insight flex items-center space-x-4 p-4 bg-white/5 rounded-xl hover:bg-white/10 hover:scale-105 hover:-translate-y-1 transition-all duration-300 hover:shadow-lg relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover/insight:opacity-100 transition-opacity duration-300"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(e.icon,{className:`w-6 h-6 ${e.color} group-hover/insight:scale-125 group-hover/insight:rotate-12 transition-all duration-300`}),Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover/insight:opacity-100 transition-opacity duration-300"})]}),Je.jsxs("div",{className:"relative z-10",children:[Je.jsx("div",{className:"text-white font-medium group-hover/insight:tracking-wide transition-all duration-300",children:e.title}),Je.jsx("div",{className:"text-white/70 text-sm group-hover/insight:text-white/90 transition-colors duration-300",children:e.value})]})]},e.id))]})]})]}),"scheduling"===o&&Je.jsxs("div",{className:"group bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl hover:bg-white/15 hover:border-white/30 hover:shadow-3xl transition-all duration-500 hover:-translate-y-1 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),Je.jsxs("div",{className:"flex items-center space-x-3 mb-8 relative z-10",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(D,{className:"w-6 h-6 text-gray-400 group-hover:text-white transition-all duration-300 group-hover:rotate-12 group-hover:scale-110"}),Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover:opacity-100 group-hover:animate-pulse transition-all duration-500"})]}),Je.jsx("h3",{className:"text-xl font-semibold text-white group-hover:tracking-wide transition-all duration-300",children:"Agendar Sessão com Psicólogo"})]}),Je.jsxs("div",{className:"space-y-8 relative z-10",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-4 group-hover:text-white/90 transition-colors duration-300",children:"Tipo de Sessão:"}),Je.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"individual",label:"Sessão Individual",description:"Acompanhamento personalizado"},{id:"couple",label:"Terapia de Casal",description:"Para relacionamentos"},{id:"family",label:"Terapia Familiar",description:"Para toda a família"},{id:"group",label:"Grupo Terapêutico",description:"Compartilhando experiências"}].map((e,t)=>Je.jsxs("button",{onClick:()=>_(e.id),className:"group/session p-4 rounded-xl border transition-all duration-300 text-left hover:scale-105 hover:-translate-y-1 hover:shadow-lg relative overflow-hidden "+(E===e.id?"bg-white/10 border-white/30 text-white":"bg-gray-800/30 border-gray-600/30 text-gray-300 hover:bg-gray-700/50 hover:text-white"),style:{animationDelay:100*t+"ms"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover/session:opacity-100 transition-opacity duration-300"}),Je.jsx("div",{className:"font-medium text-sm group-hover/session:tracking-wide transition-all duration-300 relative z-10",children:e.label}),Je.jsx("div",{className:"text-xs text-gray-400 mt-2 group-hover/session:text-white/70 transition-colors duration-300 relative z-10",children:e.description}),Je.jsx("div",{className:"absolute top-2 right-2 w-1 h-1 bg-white/40 rounded-full opacity-0 group-hover/session:opacity-100 group-hover/session:animate-ping transition-opacity duration-300"})]},e.id))})]}),Je.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[Je.jsxs("div",{children:[Je.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Je.jsx("label",{className:"text-sm font-medium text-gray-300 group-hover:text-white/90 transition-colors duration-300",children:"Data:"}),Je.jsxs("div",{className:"flex items-center space-x-2 relative z-30",children:[Je.jsxs("button",{onClick:()=>{z>0&&($(e=>e-1),C(""),L(null),M([]))},disabled:0===z,className:"group/nav p-2 text-gray-400 hover:text-white hover:scale-125 hover:rotate-12 transition-all duration-300 bg-white/5 rounded-lg hover:bg-white/10 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:hover:rotate-0 relative z-30",title:"Semana anterior",children:[Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover/nav:opacity-100 transition-opacity duration-300 z-0"}),Je.jsx(we,{className:"w-4 h-4 relative z-10"})]}),Je.jsxs("button",{onClick:()=>{$(0),C(""),L(null),M([])},className:"group/today px-3 py-1.5 text-blue-400 hover:text-blue-300 hover:scale-105 transition-all duration-300 bg-blue-500/10 rounded-lg hover:bg-blue-500/20 text-xs font-medium relative z-30",title:"Voltar para esta semana",children:[Je.jsx("div",{className:"absolute -inset-2 bg-blue-500/10 rounded-full opacity-0 group-hover/today:opacity-100 transition-opacity duration-300 z-0"}),Je.jsx("span",{className:"relative z-10",children:"Hoje"})]}),Je.jsxs("button",{onClick:()=>{$(e=>e+1),C(""),L(null),M([])},className:"group/nav p-2 text-gray-400 hover:text-white hover:scale-125 hover:-rotate-12 transition-all duration-300 bg-white/5 rounded-lg hover:bg-white/10 relative z-30",title:"Próxima semana",children:[Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full opacity-0 group-hover/nav:opacity-100 transition-opacity duration-300 z-0"}),Je.jsx(ye,{className:"w-4 h-4 relative z-10"})]})]})]}),Je.jsx("div",{className:"text-center mb-3",children:Je.jsx("span",{className:"text-xs text-white/60",children:0===z?"Esta semana (começando hoje)":1===z?"Próxima semana (segunda a domingo)":`${z} semanas à frente (segunda a domingo)`})}),Je.jsx("div",{className:"grid grid-cols-7 gap-2",children:((e=0)=>{const t=[],s=new Date;let r;if(0===e)r=new Date(s);else{const t=(8-s.getDay())%7,n=new Date(s);n.setDate(s.getDate()+t),r=new Date(n),r.setDate(n.getDate()+7*e)}for(let n=0;n<7;n++){const e=new Date(r);e.setDate(r.getDate()+n),t.push({date:e.toISOString().split("T")[0],day:e.toLocaleDateString("pt-BR",{weekday:"short"}),dayNumber:e.getDate(),fullDay:e.toLocaleDateString("pt-BR",{weekday:"long"}),month:e.toLocaleDateString("pt-BR",{month:"short"}),isToday:e.toDateString()===s.toDateString()})}return t})(z).map((e,t)=>Je.jsxs("button",{onClick:()=>{C(e.date),k&&fe(e.date,k)},className:"group/date p-3 rounded-xl text-center transition-all duration-300 hover:scale-110 hover:-translate-y-1 hover:shadow-lg relative overflow-hidden "+(j===e.date?"bg-white text-black shadow-lg":e.isToday?"bg-blue-500/20 border border-blue-400/30 text-blue-300":"bg-gray-800/30 text-gray-300 hover:bg-gray-700/50 hover:text-white"),style:{animationDelay:100*t+"ms"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent opacity-0 group-hover/date:opacity-100 transition-opacity duration-300 z-0"}),Je.jsx("div",{className:"text-xs text-gray-400 group-hover/date:font-medium transition-all duration-300 relative z-10",children:e.day}),Je.jsx("div",{className:"font-medium group-hover/date:font-bold group-hover/date:scale-110 transition-all duration-300 relative z-10",children:e.dayNumber}),e.month&&Je.jsx("div",{className:"text-xs text-gray-500 group-hover/date:text-gray-700 transition-colors duration-300 relative z-10",children:e.month}),e.isToday&&Je.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-blue-400 rounded-full animate-pulse"})]},e.date))})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-4 group-hover:text-white/90 transition-colors duration-300",children:"Horário:"}),Je.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:["09:00","10:00","11:00","14:00","15:00","16:00","17:00"].map((e,t)=>Je.jsxs("button",{onClick:()=>{S(e),j&&fe(j,e)},className:"group/time p-4 rounded-xl text-center transition-all duration-300 hover:scale-105 hover:-translate-y-1 hover:shadow-lg relative overflow-hidden "+(k===e?"bg-white text-black shadow-lg":"bg-gray-800/30 text-gray-300 hover:bg-gray-700/50 hover:text-white"),style:{animationDelay:100*t+"ms"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent opacity-0 group-hover/time:opacity-100 transition-opacity duration-300"}),Je.jsx("span",{className:"relative z-10 group-hover/time:font-bold group-hover/time:tracking-wide transition-all duration-300",children:e})]},e))})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-4 group-hover:text-white/90 transition-colors duration-300",children:"Escolha seu Psicólogo:"}),j&&k?U?Je.jsxs("div",{className:"text-center py-8",children:[Je.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-4"}),Je.jsx("p",{className:"text-white/70",children:"Buscando psicólogos disponíveis..."})]}):0===O.length?Je.jsxs("div",{className:"text-center py-8",children:[Je.jsx(A,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Je.jsx("p",{className:"text-white/70",children:"Nenhum psicólogo disponível para este horário"}),Je.jsx("p",{className:"text-white/50 text-sm",children:"Tente outro horário ou data"}),Je.jsxs("div",{className:"mt-4 space-y-3",children:[Je.jsx("div",{className:"p-3 bg-yellow-500/10 border border-yellow-400/20 rounded-lg",children:Je.jsx("p",{className:"text-yellow-400 text-xs",children:"💡 Dica: Psicólogos são mostrados apenas quando estão disponíveis no horário selecionado"})}),Je.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-400/20 rounded-lg",children:Je.jsx("p",{className:"text-blue-400 text-xs",children:"🔍 Buscando psicólogos na coleção 'PsychologistAccount'"})}),Je.jsx("div",{className:"p-3 bg-green-500/10 border border-green-400/20 rounded-lg",children:Je.jsx("p",{className:"text-green-400 text-xs",children:"✅ Verifique se há psicólogos cadastrados na coleção PsychologistAccount"})})]})]}):Je.jsxs("div",{className:"space-y-4",children:[Je.jsx("div",{className:"text-center p-3 bg-green-500/10 border border-green-400/20 rounded-lg",children:Je.jsxs("p",{className:"text-green-400 text-sm font-medium",children:["✨ ",O.length," psicólogo",O.length>1?"s":""," disponível",O.length>1?"eis":""," para ",k]})}),Je.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:O.map((e,t)=>Je.jsxs("button",{onClick:()=>L(e),className:"group/psychologist p-4 rounded-xl border transition-all duration-300 text-left hover:scale-105 hover:-translate-y-1 hover:shadow-lg relative overflow-hidden "+((null==P?void 0:P.id)===e.id?"bg-white/10 border-white/30 text-white ring-2 ring-white/30":"bg-gray-800/30 border-gray-600/30 text-gray-300 hover:bg-gray-700/50 hover:text-white"),style:{animationDelay:100*t+"ms"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent opacity-0 group-hover/psychologist:opacity-100 transition-opacity duration-300"}),Je.jsxs("div",{className:"flex items-start justify-between mb-3 relative z-10",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("span",{className:"text-2xl group-hover/psychologist:scale-125 transition-all duration-300",children:e.avatar}),Je.jsxs("div",{children:[Je.jsx("div",{className:"font-medium text-sm group-hover/psychologist:tracking-wide transition-all duration-300",children:e.name}),Je.jsx("div",{className:"text-xs text-gray-400 group-hover/psychologist:text-white/70 transition-colors duration-300",children:e.specialty})]})]}),Je.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-500/20 px-2 py-1 rounded-lg",children:[Je.jsx("span",{className:"text-yellow-400 text-xs",children:"⭐"}),Je.jsx("span",{className:"text-yellow-400 text-xs font-medium",children:e.rating})]})]}),Je.jsxs("div",{className:"space-y-2 relative z-10",children:[Je.jsxs("div",{className:"text-xs text-gray-400 group-hover/psychologist:text-white/70 transition-colors duration-300",children:[Je.jsx("span",{className:"font-medium",children:"Experiência:"})," ",e.experience]}),Je.jsx("div",{className:"text-xs text-gray-400 group-hover/psychologist:text-white/70 transition-colors duration-300",children:e.description}),Je.jsxs("div",{className:"space-y-1",children:[e.crp&&"CRP não informado"!==e.crp&&Je.jsxs("div",{className:"text-xs text-gray-400 group-hover/psychologist:text-white/70 transition-colors duration-300",children:[Je.jsx("span",{className:"font-medium",children:"CRP:"})," ",e.crp]}),e.education&&"Psicologia"!==e.education&&Je.jsxs("div",{className:"text-xs text-gray-400 group-hover/psychologist:text-white/70 transition-colors duration-300",children:[Je.jsx("span",{className:"font-medium",children:"Formação:"})," ",e.education]}),e.languages&&e.languages.length>0&&"Português"!==e.languages[0]&&Je.jsxs("div",{className:"text-xs text-gray-400 group-hover/psychologist:text-white/70 transition-colors duration-300",children:[Je.jsx("span",{className:"font-medium",children:"Idiomas:"})," ",e.languages.join(", ")]}),e.approach&&Je.jsxs("div",{className:"text-xs text-gray-400 group-hover/psychologist:text-white/70 transition-colors duration-300",children:[Je.jsx("span",{className:"font-medium",children:"Abordagem:"})," ",e.approach]})]}),Je.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10",children:[Je.jsx("div",{className:"text-xs text-gray-400 mb-2 group-hover/psychologist:text-white/70 transition-colors duration-300",children:"Horário selecionado:"}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("span",{className:"text-sm px-3 py-1 bg-green-500/20 border border-green-400/30 rounded-md text-green-400 font-medium",children:e.selectedTime}),Je.jsx("span",{className:"text-xs text-white/60",children:"✓ Disponível"})]})]}),(e.email||e.phone)&&Je.jsxs("div",{className:"mt-2 pt-2 border-t border-white/10",children:[Je.jsx("div",{className:"text-xs text-gray-400 mb-1 group-hover/psychologist:text-white/70 transition-colors duration-300",children:"Contato:"}),Je.jsxs("div",{className:"space-y-1",children:[e.email&&Je.jsxs("div",{className:"text-xs text-blue-400 group-hover/psychologist:text-blue-300 transition-colors duration-300",children:["📧 ",e.email]}),e.phone&&Je.jsxs("div",{className:"text-xs text-green-400 group-hover/psychologist:text-blue-300 transition-colors duration-300",children:["📞 ",e.phone]})]})]})]}),(null==P?void 0:P.id)===e.id&&Je.jsx("div",{className:"absolute top-3 right-3 w-3 h-3 bg-green-400 rounded-full animate-pulse"})]},e.id))})]}):Je.jsxs("div",{className:"text-center py-8",children:[Je.jsx(F,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Je.jsx("p",{className:"text-white/70",children:"Selecione uma data e horário primeiro"}),Je.jsx("p",{className:"text-white/50 text-sm",children:"Os psicólogos disponíveis aparecerão aqui"})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-4 group-hover:text-white/90 transition-colors duration-300",children:"Observações (opcional):"}),Je.jsxs("div",{className:"relative group/textarea",children:[Je.jsx("textarea",{value:T,onChange:e=>I(e.target.value),placeholder:"Descreva brevemente o que gostaria de abordar na sessão...",className:"w-full bg-gray-800/50 border border-gray-600/50 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-white/50 transition-all duration-300 min-h-[100px] hover:bg-gray-800/70 hover:border-gray-500/50 focus:scale-[1.01] hover:shadow-lg focus:shadow-xl"}),Je.jsx("div",{className:"absolute inset-0 rounded-xl ring-1 ring-white/0 group-hover/textarea:ring-white/20 group-focus-within/textarea:ring-white/40 transition-all duration-300 pointer-events-none"})]})]}),Je.jsx("div",{className:"flex justify-end pt-4",children:Je.jsxs("button",{onClick:()=>{j&&k&&E&&P?(C(""),S(""),_("individual"),I(""),L(null),$(0),N(!1),alert(`Sessão agendada com sucesso com ${P.name} para ${new Date(j).toLocaleDateString("pt-BR")} às ${k}! Em breve entraremos em contato para confirmar.`)):alert("Por favor, preencha todos os campos obrigatórios, incluindo a seleção do psicólogo.")},disabled:!(j&&k&&E&&P),className:"group/schedule bg-gradient-to-r from-green-500 to-green-600 text-white px-8 py-4 rounded-xl font-bold hover:from-green-600 hover:to-green-700 transform hover:scale-110 transition-all duration-300 flex items-center space-x-3 disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-xl hover:shadow-green-500/25 relative overflow-hidden disabled:hover:scale-100",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 group-hover/schedule:opacity-100 transition-opacity duration-300 group-hover/schedule:animate-pulse"}),Je.jsx(F,{className:"w-5 h-5 group-hover/schedule:rotate-12 group-hover/schedule:scale-125 transition-all duration-300 relative z-10"}),Je.jsx("span",{className:"relative z-10 group-hover/schedule:tracking-wide group-hover/schedule:font-bold transition-all duration-300",children:P?`Agendar com ${P.name.split(" ")[0]}`:"Agendar Sessão"}),Je.jsx("div",{className:"absolute -top-1 -right-1 w-1 h-1 bg-white/50 rounded-full opacity-0 group-hover/schedule:opacity-100 group-hover/schedule:animate-ping transition-opacity duration-300"}),Je.jsx("div",{className:"absolute -bottom-1 -left-1 w-0.5 h-0.5 bg-white/30 rounded-full opacity-0 group-hover/schedule:opacity-100 group-hover/schedule:animate-ping transition-opacity duration-300",style:{animationDelay:"0.2s"}})]})})]})]})]})});var _e},Uy=()=>{const{roomCode:e}=Mt(),t=Ot(),s=Pt(),[r,n]=f.useState(""),i=f.useRef(null),[a,o]=f.useState([]),{user:l}=Vb(),[c,h]=f.useState(""),[m,p]=f.useState(null),[g,x]=f.useState("");f.useState(""),f.useState("all");const[v,b]=f.useState("conversas"),[w,y]=f.useState(null);f.useState(!1);const[N,j]=f.useState("disconnected");f.useState({name:"",description:"",category:"saude-mental",isPrivate:!1,maxMembers:100});const C=f.useRef(null);f.useEffect(()=>{var e;null==(e=C.current)||e.scrollIntoView({behavior:"smooth"})},[a]),f.useEffect(()=>{e&&(n(e),p(e),h(e))},[e,s.pathname]);const k=f.useCallback(()=>{const e=null==l?void 0:l.uid;if(!e||!r)return null;const[t,s]=[e,r].sort();return`${t}_${s}`},[null==l?void 0:l.uid,r]);f.useEffect(()=>{const e=k();if(!e)return;j("connecting");const t=()=>{try{const s=(null==l?void 0:l.idToken)||localStorage.getItem("firebase_token"),r=`ws://localhost:8000/ws/chat/${e}/?token=${s}`,n=new WebSocket(r);i.current=n;const a=setTimeout(()=>{n.readyState===WebSocket.CONNECTING&&(n.close(),j("error"))},5e3);n.onopen=function(e){clearTimeout(a),j("connected"),n.send(JSON.stringify({type:"ping",message:"Teste de conexão"}))},n.onmessage=function(e){try{const t=JSON.parse(e.data);switch(t.type){case"connection_established":case"pong":case"error":break;case"chat_message":if(!t.is_own){const e={id:Date.now()+Math.random(),message:t.message,isOwn:!1,user:t.user_name||"Usuário",user_id:t.user_id,user_avatar:t.user_avatar,time:new Date(t.timestamp).toLocaleTimeString(),status:"delivered",timestamp:t.timestamp};o(t=>t.some(t=>t.message===e.message&&t.user_id===e.user_id&&Math.abs(new Date(t.timestamp)-new Date(e.timestamp))<1e3)?t:[...t,e])}break;case"message_sent":o(e=>e.map(e=>e.isOwn&&"sending"===e.status&&e.message===t.message?u(d({},e),{status:"delivered"}):e))}}catch(t){}},n.onclose=function(e){clearTimeout(a),j("disconnected"),i.current=null,1e3!==e.code&&setTimeout(()=>{k()&&t()},3e3)},n.onerror=function(e){clearTimeout(a),j("error"),i.current=null}}catch(s){j("error"),i.current=null}};return t(),()=>{i.current&&i.current.readyState===WebSocket.OPEN&&i.current.close(1e3,"Componente desmontado")}},[k,null==l?void 0:l.uid,null==l?void 0:l.idToken]);const S=e=>{switch(e){case"sending":return Je.jsx(oe,{className:"w-3 h-3 text-white/40 animate-pulse"});case"delivered":return Je.jsx(ne,{className:"w-3 h-3 text-white/60"});case"read":return Je.jsx(Ee,{className:"w-3 h-3 text-blue-400"});default:return null}},E=()=>{if(!g.trim())return;const e=g.trim(),t=(new Date).toISOString(),s={id:Date.now()+Math.random(),message:e,isOwn:!0,user:(null==l?void 0:l.displayName)||(null==l?void 0:l.name)||"Você",user_id:(null==l?void 0:l.uid)||"local_user",time:(new Date).toLocaleTimeString(),status:"sending",timestamp:t};o(e=>[...e,s]),x("");const r=i.current;if(r&&r.readyState===WebSocket.OPEN)try{const t={type:"chat_message",message:e};r.send(JSON.stringify(t)),setTimeout(()=>{o(e=>e.map(e=>e.id===s.id&&"sending"===e.status?u(d({},e),{status:"delivered"}):e))},500)}catch(n){o(e=>e.map(e=>e.id===s.id?u(d({},e),{status:"error"}):e))}else o(e=>e.map(e=>e.id===s.id?u(d({},e),{status:"offline"}):e))},_=(e,t,s)=>Je.jsxs("button",{onClick:()=>b(e),className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 "+(v===e?"bg-white/20 text-white":"bg-white/10 text-white/70 hover:text-white"),children:[Je.jsx(s,{className:"w-4 h-4"}),Je.jsx("span",{children:t})]}),T={total:a.length,own:a.filter(e=>e.isOwn).length,others:a.filter(e=>!e.isOwn).length,uniqueUsers:Array.from(new Set(a.filter(e=>!e.isOwn).map(e=>e.user_id))).length};return Je.jsxs("div",{className:"w-full",children:[Je.jsxs(Gw,{variant:"glass",padding:"lg",children:[Je.jsxs(Gw.Header,{children:[Je.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Je.jsx(D,{className:"w-6 h-6 text-gray-400"}),Je.jsx("h2",{className:"text-xl font-semibold text-white",children:e?`Chat - Sala: ${e}`:"Conversas em Tempo Real"}),e&&Je.jsx("div",{className:"flex items-center space-x-2",children:Je.jsxs("span",{className:"text-sm text-green-400 bg-green-400/10 px-2 py-1 rounded-full",children:["URL: /home/chat/",e]})})]}),Je.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Je.jsx(Hw,{type:"text",placeholder:"Digite o código da sala (ex: sala1208)",value:c,onChange:e=>h(e.target.value),variant:"glass",size:"sm",className:"flex-1"}),Je.jsx("button",{onClick:()=>{if(!c.trim())return;const e=c.trim();t(`/home/chat/${e}`,{replace:!0}),n(e),p(e)},disabled:!c.trim(),className:"px-3 py-2 bg-white text-black rounded-lg disabled:opacity-50",children:"Entrar"})]}),Je.jsx("div",{className:"flex items-center justify-between mb-4",children:Je.jsxs("div",{className:"flex items-center space-x-4",children:[_("conversas","Conversas",D),_("psicologos","Psicólogos",J),_("grupos","Grupos",A)]})})]}),Je.jsx(Gw.Content,{children:!r&&!e&&Je.jsxs("div",{className:"text-center py-12",children:[Je.jsx(D,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),Je.jsx("h3",{className:"text-lg font-medium text-white/70 mb-2",children:"Digite um código de sala para começar"}),Je.jsx("p",{className:"text-white/50",children:"Ou use a URL diretamente: /home/chat/nomeddasala"})]})})]}),(r||e)&&Je.jsxs(Gw,{variant:"glass",className:"overflow-hidden mt-4",children:[Je.jsx("div",{className:"bg-white/5 p-4 border-b border-white/10",children:Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("button",{onClick:()=>{p(null),y(null),n(""),t("/home/chat",{replace:!0})},className:"p-1 hover:bg-white/10 rounded-lg transition-colors",children:Je.jsx(O,{className:"w-5 h-5 text-white"})}),Je.jsx("div",{className:"w-10 h-10 bg-white/10 rounded-full flex items-center justify-center",children:Je.jsx(J,{className:"w-5 h-5 text-white"})}),Je.jsxs("div",{children:[Je.jsx("h3",{className:"font-medium text-white",children:"Conversa"}),Je.jsxs("p",{className:"text-sm text-white/70",children:["Sala: ",e||r]}),Je.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[Je.jsx("div",{className:`w-2 h-2 rounded-full ${(()=>{switch(N){case"connected":return"bg-green-400";case"connecting":return"bg-yellow-400 animate-pulse";case"error":return"bg-red-400";default:return"bg-gray-400"}})()}`}),Je.jsx("span",{className:"text-xs "+("connected"===N?"text-green-400":"connecting"===N?"text-yellow-400":"text-red-400"),children:(()=>{switch(N){case"connected":return"Online (Tempo Real)";case"connecting":return"Conectando...";case"error":return"Erro de Conexão";default:return"Desconectado"}})()})]})]})]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsxs("div",{className:"text-xs text-white/50 bg-white/10 px-2 py-1 rounded",children:["📊 ",T.total," msgs | 👤 ",T.own," suas | 👥 ",T.others," outros"]}),Je.jsx("button",{onClick:()=>{const e={id:Date.now()+Math.random(),message:"Mensagem de teste do usuário remoto",isOwn:!1,user:"Usuário Teste",user_id:"test_user_123",user_avatar:null,time:(new Date).toLocaleTimeString(),status:"delivered",timestamp:(new Date).toISOString()};o(t=>[...t,e])},className:"text-xs bg-blue-500/20 text-blue-300 px-2 py-1 rounded hover:bg-blue-500/30 transition-colors",title:"Adicionar mensagem de teste",children:"🧪 Teste"}),Je.jsx("button",{onClick:()=>{o(e=>e.filter(e=>e.isOwn))},className:"text-xs bg-orange-500/20 text-orange-300 px-2 py-1 rounded hover:bg-orange-500/30 transition-colors",title:"Limpar mensagens de outros usuários",children:"🧹 Outros"}),Je.jsx("button",{onClick:()=>{o([])},className:"text-xs bg-red-500/20 text-red-300 px-2 py-1 rounded hover:bg-red-500/30 transition-colors",title:"Limpar todas as mensagens",children:"🗑️ Tudo"})]})]})}),Je.jsx("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:a.length>0?Je.jsxs(Je.Fragment,{children:[a.map((e,t)=>Je.jsxs("div",{className:`flex ${e.isOwn?"justify-end":"justify-start"} mb-4`,children:[!e.isOwn&&Je.jsxs("div",{className:"flex flex-col items-center mr-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-white/10 border-2 border-white/20",children:e.user_avatar?Je.jsx("img",{src:e.user_avatar,alt:e.user,className:"w-full h-full object-cover"}):Je.jsx("div",{className:"w-full h-full flex items-center justify-center text-white/70 text-lg font-bold",children:e.user.charAt(0).toUpperCase()})}),Je.jsx("span",{className:"text-xs text-white/60 mt-1 max-w-20 truncate",children:e.user})]}),Je.jsxs("div",{className:"max-w-xs px-4 py-3 rounded-2xl relative "+(e.isOwn?"bg-blue-500 text-white rounded-br-md":"bg-white/10 text-white rounded-bl-md border border-white/20"),children:[Je.jsx("p",{className:"text-sm leading-relaxed",children:e.message}),Je.jsxs("div",{className:"flex items-center justify-between mt-2",children:[Je.jsx("span",{className:"text-xs "+(e.isOwn?"text-blue-100":"text-white/50"),children:e.time}),e.isOwn&&Je.jsxs("div",{className:"flex items-center space-x-1",children:[S(e.status),"error"===e.status&&Je.jsx("span",{className:"text-xs text-red-400",children:"Erro"}),"offline"===e.status&&Je.jsx("span",{className:"text-xs text-yellow-400",children:"Offline"})]})]})]}),e.isOwn&&Je.jsxs("div",{className:"flex flex-col items-center ml-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-blue-400 border-2 border-blue-300",children:Je.jsx("div",{className:"w-full h-full flex items-center justify-center text-white text-sm font-bold",children:"Eu"})}),Je.jsx("span",{className:"text-xs text-white/60 mt-1",children:"Você"})]})]},e.id)),Je.jsx("div",{ref:C})]}):Je.jsxs("div",{className:"text-center py-8",children:[Je.jsx(D,{className:"w-12 h-12 text-white/30 mx-auto mb-3"}),Je.jsx("p",{className:"text-white/50",children:"Nenhuma mensagem ainda"}),Je.jsx("p",{className:"text-sm text-white/30",children:"Comece a conversa!"})]})}),Je.jsxs("div",{className:"p-4 border-t border-white/10",children:[Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("button",{className:"p-2 text-white/50 hover:text-white hover:bg-white/10 rounded-lg transition-colors",children:Je.jsx(Se,{className:"w-5 h-5"})}),Je.jsx(Hw,{type:"text",value:g,onChange:e=>x(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),E())},placeholder:"Digite sua mensagem...",variant:"glass",size:"sm",className:"flex-1",disabled:"connected"!==N}),Je.jsx("button",{onClick:E,disabled:!g.trim()||"connected"!==N,className:"p-2 bg-white text-black rounded-lg hover:bg-white/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:Je.jsx(re,{className:"w-5 h-5"})})]}),"connected"!==N&&Je.jsx("div",{className:"text-xs text-yellow-400 mt-2 text-center",children:"connecting"===N?"Conectando ao servidor...":"Sem conexão com o servidor"})]})]})]})},Fy=()=>{const[t,s]=f.useState({email:"",password:""}),[r,n]=f.useState(!1),[i,a]=f.useState(!1),[o,l]=f.useState("user"),[c,h]=f.useState(null),[m,g]=f.useState(null),x=e=>{s(u(d({},t),{[e.target.name]:e.target.value}))},v=Ot(),b=()=>Je.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(8)].map((e,t)=>Je.jsx("div",{className:"absolute top-0 left-1/2 w-px h-full bg-gradient-to-b from-white/20 via-white/5 to-transparent transform-gpu origin-top",style:{transform:`translateX(-50%) rotate(${45*t}deg)`,animation:`pulse ${2+.5*t}s ease-in-out infinite alternate`}},t))});return Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden text-white",children:[Je.jsx(b,{}),Je.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(15)].map((e,t)=>Je.jsx("div",{className:"absolute w-1 h-1 bg-white/20 rounded-full animate-pulse",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:3*Math.random()+"s",animationDuration:2+2*Math.random()+"s"}},t))}),Je.jsxs("div",{className:"relative w-full max-w-md z-10 animate-fade-in animate-slide-up",children:[Je.jsx("button",{type:"button",onClick:()=>v("/"),className:"absolute -top-2 -left-2 p-2 text-white/80 hover:text-white transition-all duration-300 hover:scale-110 hover:rotate-12 group","aria-label":"Voltar para início",onMouseEnter:()=>g("back"),onMouseLeave:()=>g(null),children:Je.jsx(O,{className:"w-6 h-6 transition-all duration-300 "+("back"===m?"drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]":"")})}),Je.jsxs("div",{className:"text-center mb-6",children:[Je.jsx("div",{className:"flex items-center justify-center mb-3",children:Je.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/10 border border-white/20 flex items-center justify-center backdrop-blur-md hover:scale-110 hover:rotate-12 transition-all duration-500 hover:bg-white/20 hover:shadow-[0_0_20px_rgba(255,255,255,0.3)] group cursor-pointer overflow-hidden",children:Je.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-8 h-8 object-contain group-hover:brightness-110 transition-all duration-300"})})}),Je.jsx("h1",{className:"text-2xl font-semibold text-white mb-1 hover:text-white/90 transition-colors duration-300",children:"Sereno"}),Je.jsx("p",{className:"text-white/60 text-sm hover:text-white/80 transition-colors duration-300",children:"Sua Rede de Apoio em Saúde Mental"})]}),Je.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 shadow-2xl hover:bg-white/[0.07] hover:border-white/20 transition-all duration-500 hover:shadow-[0_20px_60px_rgba(255,255,255,0.1)] group",children:[Je.jsxs("div",{className:"mb-4",children:[Je.jsx("h2",{className:"text-xl font-light text-white mb-1 group-hover:text-white/95 transition-colors duration-300",children:"Acesse sua jornada"}),Je.jsx("p",{className:"text-white/60 text-sm group-hover:text-white/70 transition-colors duration-300",children:"Faça login para continuar sua evolução pessoal"})]}),Je.jsxs("div",{className:"mb-4",children:[Je.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[Je.jsx(y,{className:"w-3 h-3 text-white/40 animate-pulse"}),Je.jsx("span",{className:"text-xs text-white/60",children:"Tipo de usuário:"}),Je.jsx(y,{className:"w-3 h-3 text-white/40 animate-pulse",style:{animationDelay:"0.5s"}})]}),Je.jsxs("div",{className:"flex bg-white/10 rounded-lg p-1 border border-white/20 hover:border-white/30 transition-all duration-300 hover:bg-white/15",children:[Je.jsxs("button",{type:"button",onClick:()=>l("user"),className:"flex-1 flex items-center justify-center py-1.5 px-3 rounded-md transition-all duration-300 text-sm group "+("user"===o?"bg-white text-black shadow-lg scale-105 shadow-white/20":"text-white/70 hover:text-white hover:bg-white/10 hover:scale-105"),children:[Je.jsx(J,{className:"w-3 h-3 mr-1.5 transition-all duration-300 "+("user"===o?"animate-bounce":"group-hover:scale-110")}),"Usuário"]}),Je.jsxs("button",{type:"button",onClick:()=>l("psychologist"),className:"flex-1 flex items-center justify-center py-1.5 px-3 rounded-md transition-all duration-300 text-sm group "+("psychologist"===o?"bg-white text-black shadow-lg scale-105 shadow-white/20":"text-white/70 hover:text-white hover:bg-white/10 hover:scale-105"),children:[Je.jsx(P,{className:"w-3 h-3 mr-1.5 transition-all duration-300 "+("psychologist"===o?"animate-pulse":"group-hover:scale-110")}),"Profissional"]})]})]}),Je.jsxs("form",{onSubmit:s=>p(e,null,function*(){if(s.preventDefault(),t.email&&t.password){a(!0);try{(yield Qo(Pb,t.email,t.password)).user,alert("Login realizado com sucesso!"),v("psychologist"===o?"/psychologist-dashboard":"/home")}catch(e){let t="Erro ao fazer login.";switch(e.code){case"auth/user-not-found":t="Usuário não encontrado.";break;case"auth/wrong-password":t="Senha incorreta.";break;case"auth/invalid-email":t="Email inválido.";break;case"auth/too-many-requests":t="Muitas tentativas. Tente novamente mais tarde.";break;default:t=e.message}alert(t)}finally{a(!1)}}else alert("Por favor, preencha todos os campos.")}),className:"space-y-4",children:[Je.jsxs("div",{className:"space-y-1 group",children:[Je.jsx("label",{htmlFor:"email",className:"block text-xs font-light text-white/80 group-hover:text-white/90 transition-colors duration-300",children:"E-mail"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50 transition-all duration-300 "+("email"===c?"text-white/80 scale-110":"group-hover:text-white/70")}),Je.jsx("input",{type:"email",id:"email",name:"email",value:t.email,onChange:x,onFocus:()=>h("email"),onBlur:()=>h(null),className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300 text-sm hover:bg-black/60 hover:border-white/30 "+("email"===c?"scale-[1.02] shadow-[0_0_15px_rgba(255,255,255,0.1)]":""),placeholder:"seu@email.com",required:!0})]})]}),Je.jsxs("div",{className:"space-y-1 group",children:[Je.jsx("label",{htmlFor:"password",className:"block text-xs font-light text-white/80 group-hover:text-white/90 transition-colors duration-300",children:"Senha"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50 transition-all duration-300 "+("password"===c?"text-white/80 scale-110":"group-hover:text-white/70")}),Je.jsx("input",{type:r?"text":"password",id:"password",name:"password",value:t.password,onChange:x,onFocus:()=>h("password"),onBlur:()=>h(null),className:"w-full pl-9 pr-10 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300 text-sm hover:bg-black/60 hover:border-white/30 "+("password"===c?"scale-[1.02] shadow-[0_0_15px_rgba(255,255,255,0.1)]":""),placeholder:"••••••••",required:!0}),Je.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white transition-all duration-300 hover:scale-110",children:r?Je.jsx(de,{className:"w-4 h-4 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"}):Je.jsx(ce,{className:"w-4 h-4 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]"})})]})]}),Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsxs("label",{className:"flex items-center group cursor-pointer",children:[Je.jsx("input",{type:"checkbox",className:"w-3 h-3 rounded border-white/30 bg-black/40 text-white focus:ring-white/30 focus:ring-2 transition-all duration-300 hover:scale-110"}),Je.jsx("span",{className:"ml-2 text-xs text-white/70 group-hover:text-white/90 transition-colors duration-300",children:"Lembrar de mim"})]}),Je.jsx("button",{type:"button",onClick:()=>p(e,null,function*(){if(t.email)try{const{sendPasswordResetEmail:s}=yield ry(()=>p(e,null,function*(){const{sendPasswordResetEmail:e}=yield Promise.resolve().then(()=>mc);return{sendPasswordResetEmail:e}}),void 0);yield s(Pb,t.email),alert("Email de redefinição enviado! Verifique sua caixa de entrada.")}catch(s){let e="Erro ao enviar email de redefinição.";switch(s.code){case"auth/user-not-found":e="Usuário não encontrado com este email.";break;case"auth/invalid-email":e="Email inválido.";break;case"auth/too-many-requests":e="Muitas tentativas. Tente novamente mais tarde.";break;default:e=s.message}alert(e)}else alert("Digite seu e-mail para receber o link de redefinição.")}),className:"text-xs text-white/80 hover:text-white transition-all duration-300 hover:scale-105 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.3)]",children:"Esqueceu a senha?"})]}),Je.jsxs("button",{type:"submit",disabled:i,className:"w-full py-2.5 px-4 bg-white text-black hover:bg-white/90 disabled:bg-white/60 font-medium rounded-lg transition-all duration-300 transform hover:scale-[1.02] hover:shadow-[0_8px_30px_rgba(255,255,255,0.3)] disabled:scale-100 disabled:cursor-not-allowed shadow-lg text-sm group overflow-hidden relative",onMouseEnter:()=>g("submit"),onMouseLeave:()=>g(null),children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full transition-transform duration-1000 "+("submit"!==m||i?"":"translate-x-full")}),i?Je.jsxs("div",{className:"flex items-center justify-center",children:[Je.jsx("div",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin mr-2"}),"Entrando..."]}):Je.jsx("span",{className:"relative z-10",children:"Entrar"})]})]}),"user"===o&&Je.jsxs("div",{className:"mt-4 animate-fade-in",style:{animationDelay:"0.2s"},children:[Je.jsxs("div",{className:"relative",children:[Je.jsx("div",{className:"absolute inset-0 flex items-center",children:Je.jsx("div",{className:"w-full border-t border-white/10"})}),Je.jsx("div",{className:"relative flex justify-center text-xs",children:Je.jsx("span",{className:"px-4 bg-black text-white/60",children:"ou continue com"})})]}),Je.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2",children:Je.jsxs("button",{onClick:()=>p(e,null,function*(){a(!0);try{(yield _l(Pb,Rb)).user,alert("Login com Google realizado com sucesso!"),v("/home")}catch(e){let t="Erro ao fazer login com Google.";switch(e.code){case"auth/popup-closed-by-user":t="Login cancelado pelo usuário.";break;case"auth/popup-blocked":t="Popup bloqueado pelo navegador. Permita popups para este site.";break;case"auth/cancelled-popup-request":t="Muitas tentativas de login. Aguarde um momento.";break;case"auth/account-exists-with-different-credential":t="Uma conta já existe com este email usando outro método de login.";break;default:t=e.message}alert(t)}finally{a(!1)}}),type:"button",className:"flex items-center justify-center py-1.5 px-4 border border-white/20 rounded-lg text-white/80 hover:text-white hover:border-white/30 transition-all duration-300 text-sm hover:scale-[1.02] hover:bg-white/5 hover:shadow-[0_4px_20px_rgba(255,255,255,0.1)] group relative overflow-hidden",onMouseEnter:()=>g("google"),onMouseLeave:()=>g(null),children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 via-white/20 to-white/10 opacity-0 transition-opacity duration-300 "+("google"===m?"opacity-100":"")}),Je.jsxs("svg",{className:"w-4 h-4 mr-2 relative z-10 group-hover:scale-110 transition-transform duration-300",viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",children:[Je.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.37c-.23 1.22-.93 2.25-1.98 2.94v2.45h3.2c1.87-1.72 2.97-4.25 2.97-7.4z",fill:"#4285F4"}),Je.jsx("path",{d:"M12 23c2.7 0 4.96-.9 6.62-2.45l-3.2-2.45c-.9.6-2.06.96-3.42.96-2.63 0-4.85-1.77-5.64-4.15H3.01v2.6C4.65 20.98 8.06 23 12 23z",fill:"#34A853"}),Je.jsx("path",{d:"M6.36 14.91c-.2-.6-.32-1.24-.32-1.91s.12-1.31.32-1.91V8.49H3.01A11 11 0 0 0 2 12c0 1.76.42 3.41 1.01 4.91l3.35-2z",fill:"#FBBC05"}),Je.jsx("path",{d:"M12 5.27c1.47 0 2.8.51 3.84 1.5l2.88-2.88C16.94 2.23 14.7 1.32 12 1.32 8.06 1.32 4.65 3.34 3.01 6.09l3.35 2.6C7.15 7.31 9.37 5.27 12 5.27z",fill:"#EA4335"})]}),Je.jsx("span",{className:"relative z-10",children:"Google"})]})})]}),"psychologist"===o&&Je.jsx("div",{className:"mt-4 animate-fade-in",style:{animationDelay:"0.3s"},children:Je.jsxs("div",{className:"bg-white/10 border border-white/20 rounded-lg p-3 text-center hover:bg-white/15 hover:border-white/30 transition-all duration-300 hover:scale-[1.02] hover:shadow-[0_0_20px_rgba(255,255,255,0.2)] group",children:[Je.jsx(P,{className:"w-5 h-5 text-white mx-auto mb-1.5 group-hover:scale-110 group-hover:animate-pulse transition-transform duration-300"}),Je.jsx("p",{className:"text-white text-xs font-medium group-hover:text-white transition-colors duration-300",children:"Login Profissional"}),Je.jsx("p",{className:"text-white/80 text-xs group-hover:text-white transition-colors duration-300",children:"Psicólogos devem usar suas credenciais registradas"})]})}),Je.jsx("div",{className:"mt-4 text-center",children:Je.jsxs("p",{className:"text-white/70 text-sm",children:["Não tem uma conta?"," ",Je.jsx("button",{onClick:()=>v("/register"),className:"text-white hover:text-white/80 font-medium transition-all duration-300 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.5)] hover:scale-105 inline-block",children:"Cadastre-se"})]})})]}),Je.jsx("div",{className:"mt-6 text-center text-white/50 text-xs animate-fade-in",style:{animationDelay:"0.5s"},children:Je.jsxs("p",{className:"hover:text-white/70 transition-colors duration-300 cursor-default",children:["Conecte-se, Entenda-se, ",Je.jsx("span",{className:"text-white hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.3)] transition-all duration-300",children:"Evolua."})]})})]})]})},Vy=()=>{const[t,s]=f.useState([]),[r,n]=f.useState(0),[i,a]=f.useState(!0),{user:o}=Vb(),l=()=>p(e,null,function*(){if(!(null==o?void 0:o.uid))return s([]),n(0),void a(!1);try{a(!0);const e=yield dy.getUserNotifications(o.uid);s(e);const t=e.filter(e=>!e.read);n(t.length)}catch(e){s([]),n(0)}finally{a(!1)}});return f.useEffect(()=>{l()},[null==o?void 0:o.uid]),{notifications:t,unreadCount:r,loading:i,fetchNotifications:l,markAsRead:t=>p(e,null,function*(){try{yield dy.markNotificationAsRead(t),s(e=>e.map(e=>e.id===t?u(d({},e),{read:!0}):e)),n(e=>Math.max(0,e-1))}catch(e){}}),markAllAsRead:()=>p(e,null,function*(){if(null==o?void 0:o.uid)try{yield dy.markAllNotificationsAsRead(o.uid),s(e=>e.map(e=>u(d({},e),{read:!0}))),n(0)}catch(e){}}),deleteNotification:r=>p(e,null,function*(){try{yield dy.deleteNotification(r),s(e=>e.filter(e=>e.id!==r));const e=t.find(e=>e.id===r);e&&!e.read&&n(e=>Math.max(0,e-1))}catch(e){}}),clearAllNotifications:()=>p(e,null,function*(){if(null==o?void 0:o.uid)try{yield dy.clearAllNotifications(o.uid),s([]),n(0)}catch(e){}})}},zy=x.memo(({activeTab:t,setActiveTab:s,onStartTour:r})=>{const[n,i]=f.useState(!1),[a,o]=f.useState(!1),[l,c]=f.useState(""),{user:d,loading:u}=Vb(),{unreadCount:h}=Vy(),m=Ot(),g=f.useRef(null),x=f.useRef(null),w=f.useRef(null),y=f.useCallback(()=>{i(e=>!e),o(!1)},[]),N=f.useCallback(()=>{o(e=>!e),i(!1)},[]),j=f.useCallback(()=>{i(!1),o(!1)},[]),C=f.useMemo(()=>[{name:"Início",tab:"home",icon:Ae,path:"/home"},{name:"Chat",tab:"chat",icon:D,path:"/home/chat"},{name:"Diário",tab:"diary",icon:se,path:"/home/diary"},{name:"Humor",tab:"humor",icon:Ne,path:"/home/humor"},{name:"Grupos",tab:"groups",icon:F,path:"/home/groups"},{name:"Notificações",tab:"notifications",icon:_e,path:"/home/notifications"},{name:"Configurações",tab:"settings",icon:M,path:"/home/settings"},{name:"Meu Perfil",tab:"profile",icon:J,path:"/home/profile"}],[]),k=f.useCallback(e=>{m(e.path),j()},[m,j]),S=f.useCallback(()=>p(e,null,function*(){try{const{auth:t}=yield ry(()=>p(e,null,function*(){const{auth:e}=yield Promise.resolve().then(()=>Mb);return{auth:e}}),void 0);yield t.signOut(),m("/login"),j()}catch(t){alert("Erro ao sair. Tente novamente.")}}),[m,j]),E=f.useCallback(e=>{e.preventDefault(),l.trim()},[l]),_=f.useCallback(e=>{c(e.target.value)},[]);return f.useEffect(()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&x.current&&!x.current.contains(e.target)&&j()};return(n||a)&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[n,a,j]),f.useEffect(()=>{const e=e=>{"Escape"===e.key&&j()};return(n||a)&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[n,a,j]),f.useEffect(()=>(document.body.style.overflow=n?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[n]),u?Je.jsx("header",{className:"bg-black border-b border-white/20 sticky top-0 z-50",children:Je.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Je.jsxs("div",{className:"flex items-center justify-between h-16",children:[Je.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}),Je.jsx("span",{className:"text-white/70",children:"Carregando..."})]})})}):Je.jsx("header",{className:"bg-black border-b border-white/20 sticky top-0 z-30",children:Je.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[Je.jsxs("div",{className:"flex items-center justify-between h-16",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("button",{className:"lg:hidden p-2 text-white hover:bg-white/10 rounded-lg transition-colors duration-200",onClick:y,"aria-label":"Abrir menu de navegação","aria-expanded":n,"aria-controls":"mobile-menu",children:n?Je.jsx(v,{className:"w-5 h-5"}):Je.jsx(b,{className:"w-5 h-5"})}),Je.jsxs("button",{onClick:()=>m("/home"),className:"flex items-center space-x-3 group","aria-label":"Ir para página inicial",children:[Je.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/10 flex items-center justify-center",children:Je.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-5 h-5 object-contain group-hover:scale-105 transition-transform duration-200",loading:"eager"})}),Je.jsx("span",{className:"text-white font-semibold text-lg group-hover:text-white/90 transition-colors duration-200",children:"Sereno"})]}),Je.jsx("div",{className:"hidden lg:block ml-8",children:Je.jsx("form",{onSubmit:E,className:"relative",children:Je.jsx(Hw,{ref:w,type:"text",placeholder:"Pesquisar posts, grupos, pessoas...",value:l,onChange:_,variant:"glass",size:"sm",radius:"xl",className:"w-80",leftIcon:B,onLeftIconClick:()=>E({preventDefault:()=>{}}),"aria-label":"Pesquisar na plataforma"})})})]}),Je.jsxs("div",{className:"hidden lg:flex items-center space-x-4",children:[Je.jsxs("div",{className:"flex items-center space-x-5",children:[C.slice(0,4).map(e=>Je.jsx("button",{onClick:()=>k(e),className:"p-2 rounded-lg transition-colors duration-200 "+(t===e.tab?"bg-white/20 text-white":"text-white/70 hover:text-white hover:bg-white/10"),"aria-label":`Navegar para ${e.name}`,"aria-current":t===e.tab?"page":void 0,children:Je.jsx(e.icon,{className:"w-5 h-5","aria-hidden":"true"})},e.name)),Je.jsxs("button",{onClick:()=>k(C.find(e=>"notifications"===e.tab)),className:"p-2 rounded-lg transition-colors duration-200 relative "+("notifications"===t?"bg-white/20 text-white":"text-white/70 hover:text-white hover:bg-white/10"),"aria-label":"Ver notificações","aria-current":"notifications"===t?"page":void 0,children:[Je.jsx(_e,{className:"w-5 h-5","aria-hidden":"true"}),h>0&&Je.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:h})]}),Je.jsx("button",{onClick:()=>k(C.find(e=>"settings"===e.tab)),className:"p-2 rounded-lg transition-colors duration-200 "+("settings"===t?"bg-white/20 text-white":"text-white/70 hover:text-white hover:bg-white/10"),"aria-label":"Configurações","aria-current":"settings"===t?"page":void 0,children:Je.jsx(M,{className:"w-5 h-5","aria-hidden":"true"})}),Je.jsx("button",{onClick:r,className:"p-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors duration-200",title:"Iniciar tour do aplicativo","aria-label":"Iniciar tour do aplicativo",children:Je.jsx(Te,{className:"w-5 h-5","aria-hidden":"true"})})]}),d?Je.jsxs("div",{className:"relative",ref:x,children:[Je.jsxs("button",{className:"flex items-center space-x-3 text-white/70 hover:text-white transition-colors duration-200 p-2 rounded-lg hover:bg-white/10",onClick:N,"aria-label":"Menu do usuário","aria-expanded":a,"aria-haspopup":"true",children:[Je.jsx(J,{className:"w-5 h-5","aria-hidden":"true"}),Je.jsx("span",{className:"text-sm font-light",children:d.displayName||"Usuário"})]}),a&&Je.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-black border border-white/20 rounded-lg shadow-lg py-1 z-50",children:[Je.jsxs("button",{onClick:()=>{m("/home/profile"),o(!1)},className:"w-full text-left px-4 py-2 text-white hover:bg-white/10 transition-colors duration-200 flex items-center space-x-2","aria-label":"Ver meu perfil",children:[Je.jsx(J,{className:"w-4 h-4","aria-hidden":"true"}),Je.jsx("span",{children:"Meu Perfil"})]}),Je.jsxs("button",{onClick:()=>{m("/home/settings"),o(!1)},className:"w-full text-left px-4 py-2 text-white hover:bg-white/10 transition-colors duration-200 flex items-center space-x-2","aria-label":"Configurações do perfil",children:[Je.jsx(M,{className:"w-4 h-4","aria-hidden":"true"}),Je.jsx("span",{children:"Configurações"})]}),Je.jsxs("button",{onClick:S,className:"w-full text-left px-4 py-2 text-white hover:bg-white/10 transition-colors duration-200 flex items-center space-x-2","aria-label":"Sair da conta",children:[Je.jsx(Ie,{className:"w-4 h-4","aria-hidden":"true"}),Je.jsx("span",{children:"Sair"})]})]})]}):Je.jsx("button",{onClick:()=>m("/login"),className:"px-4 py-2 bg-white text-black rounded-lg font-medium hover:bg-gray-100 transition-colors duration-200","aria-label":"Fazer login",children:"Login"})]})]}),n&&Je.jsxs(Je.Fragment,{children:[Je.jsx("div",{className:"fixed inset-0 bg-black/60 z-40 lg:hidden",onClick:j,style:{opacity:n?1:0,transition:"opacity 150ms ease-in-out",pointerEvents:n?"auto":"none"}}),Je.jsxs("div",{ref:g,className:"fixed left-0 top-0 h-full w-80 bg-black/95 border-r border-white/20 z-50 lg:hidden transform transition-transform duration-200 ease-in-out flex flex-col",style:{transform:n?"translateX(0)":"translateX(-100%)",pointerEvents:n?"auto":"none"},children:[Je.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/20 flex-shrink-0",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/10 flex items-center justify-center",children:Je.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-5 h-5 object-contain"})}),Je.jsx("span",{className:"text-white font-semibold text-lg",children:"Sereno"})]}),Je.jsx("button",{onClick:j,className:"p-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors duration-200","aria-label":"Fechar menu",children:Je.jsx(v,{className:"w-5 h-5"})})]}),d&&Je.jsx("div",{className:"p-4 border-b border-white/20 flex-shrink-0",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-full bg-white/20 flex items-center justify-center",children:Je.jsx(J,{className:"w-5 h-5 text-white"})}),Je.jsxs("div",{className:"flex-1 min-w-0",children:[Je.jsx("div",{className:"text-white font-medium truncate text-sm",children:d.displayName||"Usuário"}),Je.jsx("div",{className:"text-white/60 text-xs truncate",children:d.email||""})]})]})}),Je.jsx("div",{className:"p-4 border-b border-white/20 flex-shrink-0",children:Je.jsx("form",{onSubmit:E,className:"relative",children:Je.jsx(Hw,{type:"text",placeholder:"Pesquisar...",value:l,onChange:_,variant:"glass",size:"sm",radius:"xl",className:"w-full",leftIcon:B,onLeftIconClick:()=>E({preventDefault:()=>{}}),"aria-label":"Pesquisar na plataforma"})})}),Je.jsx("div",{className:"flex-1 overflow-y-auto py-4 min-h-0",children:Je.jsxs("div",{className:"space-y-1 px-4",children:[C.map(e=>Je.jsxs("button",{onClick:()=>k(e),className:"w-full flex items-center justify-between p-3 rounded-lg transition-all duration-200 "+(t===e.tab?"bg-white/20 text-white":"text-white/80 hover:bg-white/10 hover:text-white"),"aria-label":`Navegar para ${e.name}`,"aria-current":t===e.tab?"page":void 0,children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"p-2 rounded-lg "+(t===e.tab?"bg-white/20":"bg-white/10"),children:Je.jsx(e.icon,{className:"w-4 h-4 "+(t===e.tab?"text-white":"text-white/70"),"aria-hidden":"true"})}),Je.jsx("span",{className:"font-medium text-sm",children:e.name})]}),Je.jsx(ye,{className:"w-4 h-4 text-white/40","aria-hidden":"true"})]},e.name)),Je.jsxs("button",{onClick:()=>{r(),j()},className:"w-full flex items-center justify-between p-3 rounded-lg text-white/80 hover:bg-white/10 hover:text-white transition-all duration-200","aria-label":"Ajuda e tour do aplicativo",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"p-2 rounded-lg bg-white/10",children:Je.jsx(Te,{className:"w-4 h-4 text-white/70","aria-hidden":"true"})}),Je.jsx("span",{className:"font-medium text-sm",children:"Ajuda e Tour"})]}),Je.jsx(ye,{className:"w-4 h-4 text-white/40","aria-hidden":"true"})]})]})}),Je.jsx("div",{className:"p-4 border-t border-white/20 flex-shrink-0",children:d?Je.jsxs("button",{onClick:S,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-white text-black rounded-lg font-medium hover:bg-gray-100 transition-colors duration-200","aria-label":"Sair da conta",children:[Je.jsx(Ie,{className:"w-4 h-4","aria-hidden":"true"}),Je.jsx("span",{children:"Sair"})]}):Je.jsx("button",{onClick:()=>{m("/login"),j()},className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-white text-black rounded-lg font-medium hover:bg-gray-100 transition-colors duration-200","aria-label":"Fazer login",children:Je.jsx("span",{children:"Login"})})})]})]})]})})});zy.displayName="Header";const $y=()=>{const e=f.useRef(null);return f.useEffect(()=>{const t=e.current,s=t.getContext("2d");let r;const n=()=>{t.width=window.innerWidth,t.height=window.innerHeight};n(),window.addEventListener("resize",n);const i=[];class a{constructor(e,t,s,r,n){this.y=e,this.amplitude=t,this.frequency=s,this.speed=r,this.color=n,this.offset=0,this.opacity=.1}update(){this.offset+=this.speed}draw(){s.beginPath(),s.moveTo(0,this.y);for(let r=0;r<=t.width;r+=2){const e=this.y+Math.sin((r+this.offset)*this.frequency)*this.amplitude;s.lineTo(r,e)}s.lineTo(t.width,t.height),s.lineTo(0,t.height),s.closePath();const e=s.createLinearGradient(0,this.y-this.amplitude,0,this.y+this.amplitude);e.addColorStop(0,`${this.color}00`),e.addColorStop(.5,`${this.color}${Math.floor(255*this.opacity).toString(16).padStart(2,"0")}`),e.addColorStop(1,`${this.color}00`),s.fillStyle=e,s.fill()}}i.push(new a(.3*t.height,30,.02,.5,"#ffffff")),i.push(new a(.6*t.height,40,.015,.3,"#ffffff")),i.push(new a(.8*t.height,25,.025,.7,"#ffffff"));const o=()=>{s.clearRect(0,0,t.width,t.height),i.forEach(e=>{e.update(),e.draw()}),r=requestAnimationFrame(o)};return o(),()=>{window.removeEventListener("resize",n),cancelAnimationFrame(r)}},[]),Je.jsx("canvas",{ref:e,className:"fixed inset-0 pointer-events-none z-0 animation-initial animate-fade-in-scale animation-delay-600",style:{background:"transparent"}})},By=({onOpenHumorTab:t})=>{const{user:s}=Vb(),[r,n]=f.useState([{day:"Seg",mood:0,energy:0},{day:"Ter",mood:0,energy:0},{day:"Qua",mood:0,energy:0},{day:"Qui",mood:0,energy:0},{day:"Sex",mood:0,energy:0},{day:"Sáb",mood:0,energy:0},{day:"Dom",mood:0,energy:0}]),[i,a]=f.useState(5),[o,l]=f.useState(5),[c,d]=f.useState(5),[u,h]=f.useState(!1),[m,g]=f.useState(null),x=10,v=f.useRef(null),[b,w]=f.useState(!1);f.useEffect(()=>{p(e,null,function*(){if(!s)return;const e=yield cy.getUserMoodHistory(s.uid,7),t=[0,0,0,0,0,0,0].map((t,s)=>{const r=["Seg","Ter","Qua","Qui","Sex","Sáb","Dom"][s],n=e.filter(e=>{var t;const r=(null==(t=e.recordedAt)?void 0:t.toDate)?e.recordedAt.toDate():new Date(e.recordedAt);return r&&r.getDay()===(s+1)%7});return{day:r,mood:n.length?Math.round(n.reduce((e,t)=>e+(t.intensity||0),0)/n.length):0,energy:n.length?Math.round(n.reduce((e,t)=>e+(t.energy||0),0)/n.length):0}});n(t)})},[s]);const y=({value:e,onChange:t,label:s})=>Je.jsxs("div",{className:"space-y-2 group/slider",children:[Je.jsxs("label",{className:"text-sm font-medium text-white/80 group-hover/slider:text-white transition-colors duration-300",children:[s,": ",e,"/10"]}),Je.jsxs("div",{className:"relative h-2 bg-white/10 rounded-full overflow-hidden group-hover/slider:bg-white/20 transition-all duration-300",children:[Je.jsx("div",{className:"absolute inset-0 bg-white/5 rounded-full"}),Je.jsx("div",{className:"absolute top-0 left-0 h-full bg-gradient-to-r from-white/60 to-white/80 rounded-full transition-all duration-300 group-hover/slider:from-white/80 group-hover/slider:to-white shadow-lg group-hover/slider:shadow-white/25",style:{width:e/x*100+"%"}}),Je.jsx("div",{className:"absolute top-1/2 w-5 h-5 bg-white rounded-full shadow-lg transform -translate-y-1/2 cursor-pointer transition-all duration-300 hover:scale-110 hover:shadow-xl group-hover/slider:scale-110 group-hover/slider:shadow-2xl group-hover/slider:shadow-white/40 ring-2 ring-white/20 group-hover/slider:ring-white/40",style:{left:e/x*100+"%",marginLeft:"-10px"},onMouseDown:e=>{const s=s=>{const r=e.currentTarget.parentElement.getBoundingClientRect(),n=Math.max(0,Math.min(x,Math.round((s.clientX-r.left)/r.width*x)));t(n)},r=()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",r)}}),Je.jsx("input",{type:"range",min:"0",max:"10",value:e,onChange:e=>t(parseInt(e.target.value)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),Je.jsxs("div",{className:"flex justify-between text-xs text-white/40 group-hover/slider:text-white/60 transition-colors duration-300",children:[Je.jsx("span",{children:"0"}),Je.jsx("span",{children:"5"}),Je.jsx("span",{children:"10"})]})]});return Je.jsxs("div",{className:"space-y-6 animation-initial animate-fade-in-right animation-delay-200",children:[Je.jsxs("div",{className:"group bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-xl border border-white/20 rounded-2xl p-6 hover:from-white/10 hover:to-white/15 transition-all duration-500 hover:shadow-2xl hover:shadow-white/5 hover:border-white/30 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700 animate-pulse"}),Je.jsxs("div",{className:"flex items-center space-x-2 mb-6 relative z-10",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(F,{className:"w-5 h-5 text-white/80 group-hover:text-white transition-colors duration-300 group-hover:scale-110"}),Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full blur opacity-0 group-hover:opacity-100 transition-all duration-500 group-hover:scale-150"}),Je.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-white/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),Je.jsx("h2",{className:"text-lg font-semibold text-white group-hover:text-white/90 transition-all duration-300 group-hover:tracking-wide",children:"Check-in Diário"}),m&&Je.jsxs("div",{className:"flex items-center space-x-2 ml-auto text-green-400 text-sm",children:[Je.jsx(te,{className:"w-4 h-4"}),Je.jsxs("span",{children:["Salvo às ",m.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]})]}),Je.jsxs("div",{className:"space-y-6 relative z-10",children:[Je.jsx(y,{value:i,onChange:a,label:"Intensidade"}),Je.jsx(y,{value:o,onChange:l,label:"Energia"}),Je.jsx(y,{value:c,onChange:d,label:"Estabilidade"}),Je.jsx("button",{onClick:()=>p(e,null,function*(){if(s)if(i<0||i>10||o<0||o>10||c<0||c>10)alert("Por favor, verifique se todos os valores estão entre 0 e 10");else{h(!0);try{const t={intensity:parseInt(i),energy:parseInt(o),stability:parseInt(c),notes:"Check-in diário",tags:["daily","checkin"],date:(new Date).toISOString().split("T")[0],timestamp:(new Date).toISOString()},r=yield cy.recordMood(s.uid,t);if(!r||!r.success)throw new Error("Falha ao salvar check-in no Firebase");g(new Date);try{const e=yield cy.getUserMoodHistory(s.uid,7),t=["Seg","Ter","Qua","Qui","Sex","Sáb","Dom"].map((t,s)=>{const r=e.filter(e=>{var t;const r=(null==(t=e.recordedAt)?void 0:t.toDate)?e.recordedAt.toDate():new Date(e.recordedAt);return r&&r.getDay()===(s+1)%7});return{day:t,mood:r.length?Math.round(r.reduce((e,t)=>e+(t.intensity||0),0)/r.length):0,energy:r.length?Math.round(r.reduce((e,t)=>e+(t.energy||0),0)/r.length):0}});n(t)}catch(e){}setTimeout(()=>{a(5),l(5),d(5)},1e3)}catch(t){let e="Erro ao salvar check-in. Tente novamente.";"permission-denied"===t.code?e="Erro de permissão. Verifique se você está logado.":"unavailable"===t.code?e="Serviço temporariamente indisponível. Tente novamente em alguns minutos.":"network-error"===t.code&&(e="Erro de conexão. Verifique sua internet."),alert(e)}finally{h(!1)}}else alert("Usuário não autenticado")}),disabled:u,className:`w-full py-3 px-4 rounded-xl font-medium transition-all duration-300 transform ${u?"bg-gray-500 text-gray-300 cursor-not-allowed scale-100":m?"bg-green-500 text-white hover:bg-green-600 hover:scale-105 hover:shadow-xl hover:shadow-green-500/25":"bg-gradient-to-r from-white to-gray-200 text-black hover:from-gray-200 hover:to-gray-300 hover:scale-105 hover:shadow-xl hover:shadow-white/25"} shadow-lg`,children:u?Je.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[Je.jsx("div",{className:"w-4 h-4 border-2 border-black border-t-transparent rounded-full animate-spin"}),Je.jsx("span",{children:"Salvando..."})]}):m?Je.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[Je.jsx(te,{className:"w-4 h-4"}),Je.jsx("span",{children:"Check-in Salvo!"})]}):"Salvar Check-in"})]}),Je.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-white/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"})]}),Je.jsxs("div",{ref:v,className:"group bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-xl border border-white/20 rounded-2xl p-6 hover:from-white/10 hover:to-white/15 transition-all duration-500 hover:shadow-2xl hover:shadow-white/5 hover:border-white/30 relative overflow-hidden "+(b?"ring-2 ring-white/50":""),children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700 animate-pulse"}),Je.jsxs("div",{className:"flex items-center space-x-2 mb-12 relative z-10",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(je,{className:"w-5 h-5 text-white/80 group-hover:text-white transition-colors duration-300 group-hover:scale-110"}),Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full blur opacity-0 group-hover:opacity-100 transition-all duration-500 group-hover:scale-150"}),Je.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-white/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),Je.jsx("h2",{className:"text-lg font-semibold text-white group-hover:text-white/90 transition-all duration-300 group-hover:tracking-wide",children:"Tendência Semanal"})]}),Je.jsxs("div",{className:"space-y-4 relative z-10",children:[Je.jsx("div",{className:"flex items-end justify-between h-32 px-2",children:r.map((e,t)=>Je.jsxs("div",{className:"flex flex-col items-center flex-1 group/day",children:[Je.jsxs("div",{className:"relative w-full max-w-[20px] flex flex-col items-center space-y-1",children:[Je.jsx("div",{className:"w-full bg-gradient-to-t from-gray-400/70 to-gray-300/70 rounded-sm transition-all duration-500 hover:from-gray-400 hover:to-gray-300 group-hover/day:scale-110 group-hover/day:shadow-lg group-hover/day:shadow-gray-400/25 relative overflow-hidden",style:{height:e.energy/x*80+"px",minHeight:"8px"},children:Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent opacity-0 group-hover/day:opacity-100 transition-opacity duration-500 group-hover/day:animate-pulse"})}),Je.jsx("div",{className:"w-full bg-gradient-to-t from-white/70 to-gray-200/70 rounded-sm transition-all duration-500 hover:from-white hover:to-gray-200 group-hover/day:scale-110 group-hover/day:shadow-lg group-hover/day:shadow-white/25 relative overflow-hidden",style:{height:e.mood/x*80+"px",minHeight:"8px"},children:Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent opacity-0 group-hover/day:opacity-100 transition-opacity duration-500 group-hover/day:animate-pulse"})})]}),Je.jsx("span",{className:"text-xs text-white/60 font-medium group-hover/day:text-white transition-colors duration-300 group-hover/day:scale-110 group-hover/day:font-semibold",children:e.day}),Je.jsx("div",{className:"absolute top-2 right-2 w-1 h-1 bg-white/30 rounded-full opacity-0 group-hover/day:opacity-100 group-hover/day:animate-bounce transition-opacity duration-300",style:{animationDelay:"0.2s"}}),Je.jsx("div",{className:"absolute top-4 right-6 w-0.5 h-0.5 bg-white/20 rounded-full opacity-0 group-hover/day:opacity-100 group-hover/day:animate-bounce transition-opacity duration-300",style:{animationDelay:"0.5s"}})]},t))}),Je.jsxs("div",{className:"flex items-center justify-center space-x-4 pt-4 border-t border-gray-700/30",children:[Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-white to-gray-200 rounded-sm"}),Je.jsx("span",{className:"text-xs text-gray-400",children:"Humor"})]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-gray-400 to-gray-500 rounded-sm"}),Je.jsx("span",{className:"text-xs text-gray-400",children:"Energia"})]})]})]}),Je.jsx("div",{className:"mt-6 pt-4 border-t border-gray-700/30 relative z-10",children:Je.jsxs("button",{onClick:()=>t("scheduling"),className:"w-full bg-white text-black px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-white/25 flex items-center justify-center space-x-2 text-sm transform",children:[Je.jsx(D,{className:"w-4 h-4"}),Je.jsx("span",{children:"Agendar Sessão"})]})})]})]})},qy=({message:e,type:t="info",duration:s=5e3,onClose:r,isVisible:n=!0})=>{const[i,a]=f.useState(!1);f.useEffect(()=>{if(n){a(!0);const e=setTimeout(()=>{o()},s);return()=>clearTimeout(e)}},[n,s]);const o=()=>{a(!1),setTimeout(()=>{null==r||r()},300)};return n?Je.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full transform transition-all duration-300 ease-out "+(i?"translate-x-0 opacity-100 scale-100":"translate-x-full opacity-0 scale-95"),children:Je.jsx("div",{className:`${(()=>{switch(t){case"success":return"bg-green-500/20 border-green-500/30";case"error":return"bg-red-500/20 border-red-500/30";case"warning":return"bg-yellow-500/20 border-yellow-500/30";default:return"bg-blue-500/20 border-blue-500/30"}})()} backdrop-blur-xl border rounded-xl p-4 shadow-2xl`,children:Je.jsxs("div",{className:"flex items-start space-x-3",children:[Je.jsx("div",{className:"flex-shrink-0",children:(()=>{switch(t){case"success":return Je.jsx(te,{className:"w-5 h-5 text-green-400"});case"error":return Je.jsx(pe,{className:"w-5 h-5 text-red-400"});case"warning":return Je.jsx(pe,{className:"w-5 h-5 text-yellow-400"});default:return Je.jsx(De,{className:"w-5 h-5 text-blue-400"})}})()}),Je.jsx("div",{className:"flex-1 min-w-0",children:Je.jsx("p",{className:"text-white text-sm leading-relaxed",children:e})}),Je.jsx("button",{onClick:o,className:"flex-shrink-0 p-1 text-white/60 hover:text-white transition-colors rounded-full hover:bg-white/10",children:Je.jsx(v,{className:"w-4 h-4"})})]})})}):null},Hy=({setActiveTab:e})=>{const t=Ot(),[s,r]=f.useState(0),[n,i]=f.useState(""),a=[{id:1,name:"Ansiedade",icon:"🧘‍♀️",memberCount:1250,description:"Compartilhe experiências e dicas para lidar com ansiedade"},{id:2,name:"Estresse",icon:"🌿",memberCount:980,description:"Um espaço seguro para falar sobre depressão"},{id:3,name:"Autoestima",icon:"✨",memberCount:820,description:"Construindo confiança e amor próprio"},{id:4,name:"Relacionamentos",icon:"💝",memberCount:650,description:"Discussões sobre relacionamentos saudáveis"},{id:5,name:"Meditação Diária",icon:"🕯️",memberCount:750,description:"Pratique meditação em grupo"}],[o,l]=x.useState([]),[c,d]=x.useState(!1),u=(h=5,[...a].sort((e,t)=>t.memberCount-e.memberCount).slice(0,h));var h;const m=[{id:1,name:"Maria Silva",status:"Online há 2 horas",friendshipTime:"Amigos há 3 meses",avatarBg:"bg-gradient-to-r from-gray-600 to-gray-800",initial:"M",profileImage:null},{id:2,name:"João Santos",status:"Online agora",friendshipTime:"Amigos há 1 mês",avatarBg:"bg-gradient-to-r from-gray-700 to-gray-900",initial:"J",profileImage:null},{id:3,name:"Ana Oliveira",status:"Offline",friendshipTime:"Amigos há 2 meses",avatarBg:"bg-gradient-to-r from-gray-500 to-gray-700",initial:"A",profileImage:null},{id:4,name:"Pedro Costa",status:"Online há 1 hora",friendshipTime:"Amigos há 4 meses",avatarBg:"bg-gradient-to-r from-gray-800 to-black",initial:"P",profileImage:null},{id:5,name:"Carla Ferreira",status:"Offline",friendshipTime:"Amigos há 3 meses",avatarBg:"bg-gradient-to-r from-gray-600 to-gray-800",initial:"C",profileImage:null},{id:6,name:"Rafael Martins",status:"Online há 30 minutos",friendshipTime:"Amigos há 2 meses",avatarBg:"bg-gradient-to-r from-gray-700 to-gray-900",initial:"R",profileImage:null},{id:7,name:"Juliana Lima",status:"Offline",friendshipTime:"Amigos há 1 mês",avatarBg:"bg-gradient-to-r from-gray-800 to-black",initial:"J",profileImage:null},{id:8,name:"Marcelo Santos",status:"Online há 1 hora",friendshipTime:"Amigos há 3 meses",avatarBg:"bg-gradient-to-r from-gray-600 to-gray-800",initial:"M",profileImage:null},{id:9,name:"Beatriz Costa",status:"Offline",friendshipTime:"Amigos há 2 meses",avatarBg:"bg-gradient-to-r from-gray-700 to-gray-900",initial:"B",profileImage:null},{id:10,name:"Lucas Oliveira",status:"Online há 20 minutos",friendshipTime:"Amigos há 1 mês",avatarBg:"bg-gradient-to-r from-gray-800 to-black",initial:"L",profileImage:null}].filter(e=>e.name.toLowerCase().includes(n.toLowerCase())),p=()=>{i("")};return c?Je.jsx("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-xl p-6",children:Je.jsxs("div",{className:"flex items-center justify-center py-8",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("span",{className:"ml-3 text-white/70",children:"Carregando..."})]})}):Je.jsxs(Je.Fragment,{children:[Je.jsx(Xw,{trigger:s}),Je.jsxs("div",{className:"space-y-6 animation-initial animate-fade-in-left animation-delay-100",children:[Je.jsxs("div",{className:"group bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-xl border border-white/20 rounded-2xl p-6 hover:from-white/10 hover:to-white/15 transition-all duration-500 hover:shadow-2xl hover:shadow-white/5",children:[Je.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx("div",{className:"w-5 h-5 text-white/80",children:Je.jsx(A,{className:"w-5 h-5"})}),Je.jsx("div",{className:"absolute -inset-1 bg-white/10 rounded-full blur opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),Je.jsx("h2",{className:"text-lg font-semibold text-white",children:"Grupos Sugeridos"})]}),Je.jsx("div",{className:"space-y-4",children:u.slice(0,3).map(e=>{const t=o.includes(e.id);return Je.jsxs("div",{className:"group/item relative flex items-center justify-between p-4 bg-gradient-to-r from-white/5 to-white/10 rounded-xl border border-white/10 hover:from-white/10 hover:to-white/15 hover:border-white/20 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-white/10",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-white to-white/90 flex items-center justify-center text-black font-bold text-xl shadow-lg group-hover/item:scale-110 transition-transform duration-300",children:e.icon}),Je.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-white/20 to-transparent rounded-xl blur opacity-0 group-hover/item:opacity-100 transition-opacity duration-300"})]}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"font-semibold text-white text-sm group-hover/item:text-white/90 transition-colors",children:e.name}),Je.jsxs("p",{className:"text-white/50 text-xs font-medium",children:[e.memberCount.toLocaleString()," membros"]})]})]}),Je.jsxs("button",{onClick:()=>{return t?(s=e.id,void l(e=>e.filter(e=>e!==s))):(e=>{l(t=>[...t,e]),r(e=>e+1)})(e.id);var s},className:"relative w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-300 cursor-pointer transform hover:scale-110 hover:rotate-3 "+(t?"bg-gradient-to-br from-green-500 to-green-600 hover:from-green-400 hover:to-green-500 shadow-lg shadow-green-500/25":"bg-gradient-to-br from-white to-white/90 hover:from-white/80 hover:to-white shadow-lg shadow-white/25"),title:t?"Sair da comunidade":"Entrar na comunidade",children:[t?Je.jsx(ne,{className:"w-5 h-5 text-white"}):Je.jsx(H,{className:"w-5 h-5 text-black"}),Je.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-white/20 to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300"})]})]},e.id)})}),Je.jsx("div",{className:"text-center pt-6",children:Je.jsx("button",{onClick:()=>t("/home/groups"),className:"px-6 py-3 bg-white text-black font-medium rounded-lg transition-all duration-200 hover:bg-gray-100 hover:shadow-lg hover:scale-105 transform",children:"Ver Comunidades"})})]}),Je.jsxs("div",{className:"group bg-gradient-to-br from-white/5 to-white/10 backdrop-blur-xl border border-white/20 rounded-2xl p-5 transition-all duration-500 hover:shadow-2xl hover:shadow-white/5 hover:border-white/30 relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700 animate-pulse"}),Je.jsxs("div",{className:"flex items-center space-x-3 mb-4 relative z-10",children:[Je.jsxs("div",{className:"relative",children:[Je.jsx(A,{className:"w-5 h-5 text-white/80 group-hover:text-white transition-colors duration-300 group-hover:scale-110"}),Je.jsx("div",{className:"absolute -inset-2 bg-white/10 rounded-full blur opacity-0 group-hover:opacity-100 transition-all duration-500 group-hover:scale-150"}),Je.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-white/20 to-transparent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),Je.jsx("h3",{className:"text-lg font-bold text-white group-hover:text-white/90 transition-all duration-300 group-hover:tracking-wide",children:"Lista de Amigos"})]}),Je.jsxs("div",{className:"mb-4 relative z-10",children:[Je.jsxs("div",{className:"relative group/search",children:[Je.jsx("input",{type:"text",placeholder:"Buscar amigos...",className:"w-full px-4 py-3 bg-transparent border border-white/10 hover:bg-white/20 focus:bg-white text-black placeholder-white/60 focus:placeholder-black/40 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-white/20 transition-all duration-300 hover:border-white/30 focus:border-white/40",value:n,onChange:e=>{i(e.target.value)},autoComplete:"off",spellCheck:"false"}),Je.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none",children:Je.jsx(B,{className:"w-4 h-4 text-white/40 group-hover/search:text-white/80 transition-all duration-300 group-hover/search:scale-110"})}),n&&Je.jsx("button",{onClick:p,className:"absolute right-12 top-1/2 transform -translate-y-1/2 w-5 h-5 bg-white/20 hover:bg-white/30 rounded-full flex items-center justify-center transition-all duration-200 hover:scale-110 cursor-pointer",title:"Limpar busca",children:Je.jsx("span",{className:"text-white/80 hover:text-white text-xs font-bold",children:"×"})})]}),n&&Je.jsx("div",{className:"mt-2 text-xs text-white/60",children:0===m.length?Je.jsx("span",{className:"text-red-400",children:"Nenhum amigo encontrado"}):1===m.length?Je.jsx("span",{children:"1 amigo encontrado"}):Je.jsxs("span",{children:[m.length," amigos encontrados"]})})]}),Je.jsx("div",{className:"space-y-3 max-h-48 overflow-y-auto custom-scrollbar pr-2 relative z-10",children:0===m.length&&n?Je.jsxs("div",{className:"text-center py-8",children:[Je.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-3",children:Je.jsx(B,{className:"w-8 h-8 text-white/30"})}),Je.jsxs("p",{className:"text-white/50 text-sm",children:['Nenhum amigo encontrado para "',n,'"']}),Je.jsx("button",{onClick:p,className:"mt-3 px-4 py-2 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white/70 hover:text-white transition-all duration-200 text-sm",children:"Limpar busca"})]}):m.map((e,t)=>Je.jsxs("div",{className:"group/friend relative p-3 bg-gradient-to-r from-white/5 to-white/10 rounded-xl border border-white/10 hover:from-white/15 hover:to-white/20 hover:border-white/30 transition-all duration-300 hover:scale-[1.01] hover:shadow-lg hover:shadow-white/20 transform hover:-translate-y-0.5 overflow-hidden",style:{animationDelay:30*t+"ms",transform:"translateZ(0)"},children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent opacity-0 group-hover/friend:opacity-100 transition-opacity duration-500 group-hover/friend:animate-pulse"}),Je.jsx("div",{className:"absolute top-2 right-2 w-1 h-1 bg-white/30 rounded-full opacity-0 group-hover/friend:opacity-100 group-hover/friend:animate-bounce transition-opacity duration-300",style:{animationDelay:"0.2s"}}),Je.jsx("div",{className:"absolute top-4 right-6 w-0.5 h-0.5 bg-white/20 rounded-full opacity-0 group-hover/friend:opacity-100 group-hover/friend:animate-bounce transition-opacity duration-300",style:{animationDelay:"0.5s"}}),Je.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[Je.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[Je.jsxs("div",{className:"relative flex-shrink-0",children:[Je.jsx("div",{className:`w-10 h-10 rounded-xl bg-gradient-to-br ${e.avatarBg} flex items-center justify-center text-white font-bold text-sm shadow-lg group-hover/friend:scale-105 transition-all duration-300 group-hover/friend:shadow-xl`,children:e.initial}),Je.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-white/20 to-white/5 rounded-xl blur-sm opacity-0 group-hover/friend:opacity-100 transition-all duration-500 group-hover/friend:scale-150"}),Je.jsx("div",{className:"absolute -inset-1 bg-white/10 rounded-xl opacity-0 group-hover/friend:opacity-100 transition-opacity duration-300"}),Je.jsx("div",{className:"absolute -inset-3 border border-white/20 rounded-xl opacity-0 group-hover/friend:opacity-100 group-hover/friend:animate-pulse transition-opacity duration-300"})]}),Je.jsxs("div",{className:"flex-1 min-w-0",children:[Je.jsx("h4",{className:"font-semibold text-white text-sm group-hover/friend:text-white transition-all duration-300 truncate group-hover/friend:tracking-wide",children:e.name}),Je.jsx("p",{className:"text-white/50 text-xs font-medium group-hover/friend:text-white/80 transition-all duration-300 truncate group-hover/friend:translate-x-0.5",children:e.status}),Je.jsx("span",{className:"text-white/40 text-xs font-medium group-hover/friend:text-white/70 transition-all duration-300 group-hover/friend:translate-x-0.5",children:e.friendshipTime})]})]}),Je.jsxs("button",{className:"group/msg relative w-9 h-9 rounded-xl bg-gradient-to-br from-white to-white/90 hover:from-white/90 hover:to-white flex items-center justify-center transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-white/30 flex-shrink-0 ml-3 overflow-hidden",children:[Je.jsx(D,{className:"w-4 h-4 text-black group-hover/msg:scale-110 transition-all duration-300 relative z-10"}),Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent opacity-0 group-hover/msg:opacity-100 transition-opacity duration-300 group-hover/msg:animate-pulse"}),Je.jsx("div",{className:"absolute inset-0 rounded-xl bg-white/20 scale-0 group-hover/msg:scale-150 transition-transform duration-300 opacity-50"}),Je.jsx("div",{className:"absolute -top-1 -right-1 w-1 h-1 bg-white rounded-full opacity-0 group-hover/msg:opacity-100 group-hover/msg:animate-ping transition-opacity duration-300"}),Je.jsx("div",{className:"absolute -bottom-1 -left-1 w-0.5 h-0.5 bg-white/80 rounded-full opacity-0 group-hover/msg:opacity-100 group-hover/msg:animate-ping transition-opacity duration-300",style:{animationDelay:"0.1s"}})]})]}),Je.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-white/30 to-transparent opacity-0 group-hover/friend:opacity-100 transition-opacity duration-500"})]},e.id))})]})]})]})},Gy=({isOpen:e,onClose:t,userRole:s="cliente",isFirstTime:r=!1})=>{const[n,i]=f.useState(0),[a,o]=f.useState(new Set),[l,c]=f.useState(!1),d=[{id:"welcome",title:"Bem-vindo ao Sereno! 🎉",description:"Vamos te ajudar a conhecer as principais funcionalidades do aplicativo para sua saúde mental.",icon:Ae,position:"center"},{id:"home",title:"Página Inicial",description:"Aqui você encontra posts da comunidade, grupos sugeridos e um resumo do seu humor diário.",icon:Ae,position:"center"},{id:"chat",title:"Chat e Suporte",description:"Conecte-se com psicólogos ou converse com outros usuários da comunidade para apoio emocional.",icon:D,position:"center"},{id:"diary",title:"Diário Evolutivo",description:"Registre seus pensamentos, sentimentos e reflexões diárias com prompts guiados.",icon:se,position:"center"},{id:"humor",title:"Rastreador de Humor",description:"Monitore seu humor diário, visualize tendências e receba insights sobre seu bem-estar emocional.",icon:Ne,position:"center"},{id:"sessions",title:"psicologo"===s?"Gerenciar Sessões":"Agendar Sessões",description:"psicologo"===s?"Gerencie sua agenda, visualize sessões agendadas e configure sua disponibilidade.":"Encontre psicólogos disponíveis e agende sessões de terapia online ou presencial.",icon:F,position:"center"},{id:"notifications",title:"Notificações",description:"Mantenha-se atualizado com mensagens, lembretes de sessões e atividades da comunidade.",icon:_e,position:"center"},{id:"settings",title:"Configurações",description:"Personalize seu perfil, gerencie notificações e configure suas preferências de privacidade.",icon:M,position:"center"},{id:"community",title:"Comunidade",description:"Participe de grupos de apoio, compartilhe experiências e conecte-se com pessoas que passam por situações similares.",icon:A,position:"center"}];f.useEffect(()=>{e&&(i(0),o(new Set),c(!1))},[e]);const u=()=>{c(!0),setTimeout(()=>{t()},600)};if(!e)return null;const h=d[n],m=h.icon,p=n===d.length-1,g=(n+1)/d.length*100;return Je.jsxs(Je.Fragment,{children:[Je.jsx("div",{className:`fixed inset-0 z-40 transition-all duration-800 ${r?"bg-black":"bg-black/80 backdrop-blur-sm"} ${l?"background-fade-out":"background-fade-in"}`}),Je.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:Je.jsxs("div",{className:"bg-black/95 border border-white/10 rounded-2xl p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto "+(l?"tour-modal-out":"tour-modal-in"),children:[Je.jsxs("div",{className:"mb-6",children:[Je.jsxs("div",{className:"flex items-center justify-between text-sm text-white/60 mb-2",children:[Je.jsxs("span",{className:"font-medium",children:["Passo ",n+1," de ",d.length]}),Je.jsxs("div",{className:"flex items-center space-x-6",children:[Je.jsxs("span",{className:"font-medium",children:[Math.round(g),"%"]}),Je.jsx("button",{onClick:u,className:"text-white/60 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-full hover:scale-110 transition-transform duration-200",title:"Fechar tour",children:Je.jsx(v,{className:"w-5 h-5"})})]})]}),Je.jsx("div",{className:"w-full bg-white/10 rounded-full h-2",children:Je.jsx("div",{className:"bg-white h-2 rounded-full transition-all duration-300",style:{width:`${g}%`}})})]}),Je.jsxs("div",{className:"text-center mb-8",children:[Je.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6",children:Je.jsx(m,{className:"w-10 h-10 text-black"})}),Je.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:h.title}),Je.jsx("p",{className:"text-white/80 text-lg leading-relaxed",children:h.description})]}),Je.jsx("div",{className:"flex justify-center space-x-2 mb-8",children:d.map((e,t)=>{return Je.jsx("button",{onClick:()=>i(t),className:"w-3 h-3 rounded-full transition-all duration-300 "+(t===n?"bg-white scale-125":(s=e.id,a.has(s)?"bg-white":"bg-white/20 hover:bg-white/40"))},e.id);var s})}),Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsx("button",{onClick:()=>{u()},className:"text-white/60 hover:text-white transition-colors text-sm",children:"Pular tour"}),Je.jsxs("div",{className:"flex space-x-3",children:[n>0&&Je.jsxs("button",{onClick:()=>{n>0&&i(n-1)},className:"flex items-center space-x-2 px-4 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-all duration-300",children:[Je.jsx(we,{className:"w-4 h-4"}),Je.jsx("span",{children:"Anterior"})]}),p?Je.jsxs("button",{onClick:()=>{o(e=>new Set([...e,d[n].id])),u()},className:"flex items-center space-x-2 px-6 py-2 bg-white text-black rounded-lg hover:bg-gray-100 transition-all duration-300",children:[Je.jsx(ne,{className:"w-4 h-4"}),Je.jsx("span",{children:"Começar a usar"})]}):Je.jsxs("button",{onClick:()=>{n<d.length-1&&(o(e=>new Set([...e,d[n].id])),i(n+1))},className:"flex items-center space-x-2 px-6 py-2 bg-white text-black rounded-lg hover:bg-gray-100 transition-all duration-300",children:[Je.jsx("span",{children:"Próximo"}),Je.jsx(ye,{className:"w-4 h-4"})]})]})]})]})})]})};function Wy({children:e,showSidebars:t=!0}){const[s,r]=f.useState(!1),[n,i]=f.useState(!1),[a,o]=f.useState(!1),{user:l,isFirstTime:c,markTourAsSeen:d}=Vb(),u=Ot(),h=Pt(),m=(()=>{const e=h.pathname;return"/home"===e?"home":"/home/profile"===e?"profile":"/home/sessions"===e?"sessions":"/home/diary"===e?"diary":"/home/humor"===e?"humor":"/home/chat"===e||e.startsWith("/home/chat/")?"chat":"/home/groups"===e?"groups":"/home/notifications"===e?"notifications":"/home/settings"===e?"settings":"home"})();f.useEffect(()=>{c&&l&&r(!0)},[c,l]),f.useEffect(()=>{if(c&&l){const e=setTimeout(()=>{o(!0)},2e3);return()=>clearTimeout(e)}},[c,l]);const g=e=>{u("home"===e?"/home":`/home/${e}`)};return Je.jsxs(Je.Fragment,{children:[Je.jsx($y,{}),Je.jsxs("div",{className:"min-h-screen bg-black lg:pb-8 pb-20",children:[Je.jsx(zy,{activeTab:m,setActiveTab:g,onStartTour:()=>{r(!0)}}),Je.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Je.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:t?"home"===m?Je.jsxs(Je.Fragment,{children:[Je.jsx("aside",{className:"lg:col-span-3",children:Je.jsx("div",{className:"sticky top-24",children:Je.jsx(Hy,{setActiveTab:g})})}),Je.jsx("section",{className:"lg:col-span-6 space-y-8",children:e}),Je.jsx("aside",{className:"lg:col-span-3",children:Je.jsx("div",{className:"sticky top-24",children:Je.jsx(By,{})})})]}):"profile"===m?Je.jsx("section",{className:"lg:col-span-12",children:Je.jsx("div",{className:"max-w-6xl mx-auto",children:e})}):Je.jsx("section",{className:"lg:col-span-12",children:Je.jsx("div",{className:"max-w-4xl mx-auto",children:e})}):null})}),Je.jsx(Gy,{isOpen:s,onClose:()=>p(this,null,function*(){r(!1),c&&(i(!0),yield d())}),userRole:(null==l?void 0:l.role)||"cliente",isFirstTime:c}),Je.jsx(qy,{message:"Bem-vindo ao Sereno! 🎉 Estamos felizes em tê-lo conosco nesta jornada de autoconhecimento e bem-estar.",type:"success",duration:8e3,isVisible:a,onClose:()=>{o(!1)}})]})]})}const Ky=()=>{const{notifications:e,unreadCount:t,loading:s,markAsRead:r,markAllAsRead:n,deleteNotification:i,clearAllNotifications:a}=Vy(),[o,l]=f.useState(!1),c=e=>{if(!e)return"Agora mesmo";const t=new Date,s=e.toDate?e.toDate():new Date(e),r=Math.floor((t-s)/6e4);if(r<1)return"Agora mesmo";if(r<60)return`${r}m atrás`;const n=Math.floor(r/60);if(n<24)return`${n}h atrás`;const i=Math.floor(n/24);return i<7?`${i}d atrás`:s.toLocaleDateString("pt-BR")};return s?Je.jsxs("div",{className:"flex items-center justify-center h-64",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("span",{className:"ml-3 text-white/70",children:"Carregando notificações..."})]}):0===e.length?Je.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[Je.jsx(_e,{className:"w-16 h-16 text-white/30 mb-4"}),Je.jsx("h3",{className:"text-xl font-semibold text-white/70 mb-2",children:"Nenhuma notificação"}),Je.jsx("p",{className:"text-white/50",children:"Você está em dia com tudo!"})]}):Je.jsxs("div",{className:"space-y-4",children:[Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx(_e,{className:"w-6 h-6 text-white"}),Je.jsxs("h2",{className:"text-xl font-semibold text-white",children:["Notificações",t>0&&Je.jsx("span",{className:"ml-2 px-2 py-1 bg-red-500 text-white text-sm rounded-full",children:t})]})]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[t>0&&Je.jsxs("button",{onClick:n,className:"px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 rounded-lg text-blue-400 transition-colors flex items-center space-x-2",children:[Je.jsx(ne,{className:"w-4 h-4"}),Je.jsx("span",{children:"Marcar todas como lidas"})]}),Je.jsxs("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded-lg text-red-400 transition-colors flex items-center space-x-2",children:[Je.jsx(q,{className:"w-4 h-4"}),Je.jsx("span",{children:"Limpar todas"})]})]})]}),Je.jsx("div",{className:"space-y-3",children:e.map(e=>{const{icon:t,color:s}=(e=>{switch(e){case"like":return{icon:w,color:"text-red-400"};case"comment":return{icon:D,color:"text-blue-400"};case"follow":return{icon:z,color:"text-green-400"};case"session":return{icon:F,color:"text-yellow-400"};case"mood":return{icon:w,color:"text-pink-400"};case"diary":return{icon:se,color:"text-purple-400"};case"welcome":return{icon:_e,color:"text-blue-400"};default:return{icon:_e,color:"text-gray-400"}}})(e.type);return Je.jsx("div",{className:"p-4 rounded-lg border transition-all "+(e.read?"bg-white/5 border-white/10 text-white/70":"bg-blue-500/10 border-blue-500/30 text-white"),children:Je.jsxs("div",{className:"flex items-start space-x-3",children:[Je.jsx("div",{className:`p-2 rounded-lg bg-white/10 ${s}`,children:Je.jsx(t,{className:"w-5 h-5"})}),Je.jsx("div",{className:"flex-1 min-w-0",children:Je.jsxs("div",{className:"flex items-start justify-between",children:[Je.jsxs("div",{className:"flex-1",children:[Je.jsx("p",{className:"font-medium mb-1",children:e.title}),Je.jsx("p",{className:"text-sm opacity-80 mb-2",children:e.message}),Je.jsx("span",{className:"text-xs opacity-60",children:c(e.createdAt)})]}),Je.jsxs("div",{className:"flex items-center space-x-2 ml-3",children:[!e.read&&Je.jsx("button",{onClick:()=>r(e.id),className:"p-1 hover:bg-white/10 rounded transition-colors",title:"Marcar como lida",children:Je.jsx(ne,{className:"w-4 h-4"})}),Je.jsx("button",{onClick:()=>i(e.id),className:"p-1 hover:bg-red-500/20 rounded transition-colors text-red-400",title:"Deletar notificação",children:Je.jsx(q,{className:"w-4 h-4"})})]})]})})]})},e.id)})}),o&&Je.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:Je.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md mx-4",children:[Je.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Limpar todas as notificações?"}),Je.jsx("p",{className:"text-white/70 mb-6",children:"Esta ação não pode ser desfeita. Todas as notificações serão removidas permanentemente."}),Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("button",{onClick:()=>l(!1),className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors",children:"Cancelar"}),Je.jsx("button",{onClick:()=>{a(),l(!1)},className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:"Limpar todas"})]})]})})]})},Qy=()=>{const{postId:t}=Mt(),s=Ot(),[r,n]=f.useState(null),[i,a]=f.useState(!0),[o,l]=f.useState(null),[c,h]=f.useState(null),[m,g]=f.useState(!1),[x,v]=f.useState(!1);f.useState(null);const{togglePostLike:b,isPostLiked:y,deletePost:N}=wy();return f.useEffect(()=>{p(e,null,function*(){var e,r;try{a(!0);const i=Pb.currentUser;if(!i)return void s("/login");l(i);const o=ex(Lb,"users",i.uid),c=yield nv(o);if(c.exists()){const e=c.data();h(e)}const m=ex(Lb,"posts",t),p=yield nv(m);if(!p.exists())return void s("/home");{const t=p.data(),s=u(d({id:p.id},t),{createdAt:(null==(e=t.createdAt)?void 0:e.toDate())||new Date,updatedAt:null==(r=t.updatedAt)?void 0:r.toDate()});n(s),v(s.userId===i.uid)}}catch(i){s("/home")}finally{a(!1)}})},[t,s]),i?Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("div",{className:"text-white ml-3",children:"Carregando post..."})]}):r?Je.jsxs("div",{className:"min-h-screen bg-black text-white",children:[Je.jsx("div",{className:"bg-white/10 backdrop-blur-sm border-b border-white/10 sticky top-0 z-10",children:Je.jsx("div",{className:"max-w-4xl mx-auto px-4 py-4",children:Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsxs("button",{onClick:()=>s("/home"),className:"flex items-center space-x-2 text-white/70 hover:text-white transition-colors",children:[Je.jsx(O,{className:"w-5 h-5"}),Je.jsx("span",{children:"Voltar"})]}),x&&Je.jsxs("div",{className:"relative",children:[Je.jsx("button",{onClick:()=>g(!m),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:Je.jsx(U,{className:"w-5 h-5"})}),m&&Je.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg shadow-lg py-1 z-20 min-w-[120px]",children:[Je.jsxs("button",{onClick:()=>{g(!1)},className:"w-full text-left px-3 py-2 text-sm text-white hover:bg-white/10 flex items-center space-x-2",children:[Je.jsx(ue,{className:"w-3 h-3"}),Je.jsx("span",{children:"Editar"})]}),Je.jsxs("button",{onClick:()=>{g(!1),window.confirm("Tem certeza que deseja deletar este post?")&&p(e,null,function*(){if(r)try{(yield N(r.id))&&s("/home")}catch(e){}})},className:"w-full text-left px-3 py-2 text-sm text-red-400 hover:bg-red-500/10 flex items-center space-x-2",children:[Je.jsx(q,{className:"w-3 h-3"}),Je.jsx("span",{children:"Deletar"})]})]})]})]})})}),Je.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6 mb-8",children:[Je.jsxs("div",{className:"flex items-start space-x-4 mb-6",children:[Je.jsx("div",{className:"w-12 h-12 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0",children:r.avatar?Je.jsx("img",{src:r.avatar,alt:r.author,className:"w-12 h-12 rounded-full"}):Je.jsx(J,{className:"w-6 h-6 text-white/70"})}),Je.jsxs("div",{className:"flex-1 min-w-0",children:[Je.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[Je.jsx("h3",{className:"font-semibold text-white",children:r.author}),r.isAnonymous&&Je.jsx("span",{className:"text-xs bg-white/20 text-white/70 px-2 py-1 rounded-full",children:"Anônimo"})]}),Je.jsxs("div",{className:"flex items-center space-x-4 text-sm text-white/50",children:[Je.jsxs("div",{className:"flex items-center space-x-1",children:[Je.jsx(oe,{className:"w-3 h-3"}),Je.jsx("span",{children:(e=>{const t=new Date-e,s=Math.floor(t/6e4),r=Math.floor(t/36e5),n=Math.floor(t/864e5);return s<1?"Agora mesmo":s<60?`${s}m atrás`:r<24?`${r}h atrás`:n<7?`${n}d atrás`:e.toLocaleDateString("pt-BR")})(r.createdAt)})]}),r.isEdited&&Je.jsx("span",{className:"text-white/30",children:"(editado)"})]})]})]}),Je.jsx("div",{className:"mb-6",children:Je.jsx("p",{className:"text-white/90 text-lg leading-relaxed whitespace-pre-wrap",children:r.content})}),r.tags&&r.tags.length>0&&Je.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:r.tags.map((e,t)=>Je.jsxs("span",{className:"inline-flex items-center space-x-1 bg-white/10 text-white/70 px-3 py-1 rounded-full text-sm",children:[Je.jsx(le,{className:"w-3 h-3"}),Je.jsx("span",{children:e})]},t))}),Je.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-white/10",children:[Je.jsxs("div",{className:"flex items-center space-x-6",children:[Je.jsxs("button",{onClick:()=>p(e,null,function*(){r&&(yield b(r.id))}),className:"flex items-center space-x-2 transition-colors "+(y(r.id)?"text-red-400":"text-white/50 hover:text-white"),children:[Je.jsx(w,{className:"w-5 h-5 "+(y(r.id)?"fill-current":"")}),Je.jsx("span",{children:Array.isArray(r.likes)?r.likes.length:0})]}),Je.jsxs("div",{className:"flex items-center space-x-2 text-white/50",children:[Je.jsx(D,{className:"w-5 h-5"}),Je.jsx("span",{children:r.commentCount||0})]}),Je.jsxs("button",{className:"flex items-center space-x-2 text-white/50 hover:text-white transition-colors",children:[Je.jsx($,{className:"w-5 h-5"}),Je.jsx("span",{children:r.shares||0})]})]}),Je.jsx("button",{className:"text-white/50 hover:text-white transition-colors",children:Je.jsx(he,{className:"w-5 h-5"})})]})]}),Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6",children:[Je.jsxs("h4",{className:"text-white font-semibold text-lg mb-6",children:["Comentários (",r.commentCount||0,")"]}),Je.jsx(jy,{postId:t})]})]})]}):Je.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Je.jsx("div",{className:"text-white",children:"Post não encontrado"})})},Jy=new class{uploadProfilePhoto(e,t){return p(this,null,function*(){if(!e)throw new Error("Arquivo inválido");if(!t)throw new Error("ID de usuário ausente");try{const s=yield this.fileToBase64(e),r=`profile_${t}_${Date.now()}`,n=ex(Lb,"users",t);return yield lv(n,{profilePhotoId:r,profilePhotoData:s,updatedAt:new Date}),{imageId:r,success:!0}}catch(s){throw new Error(`Falha no upload: ${s.message}`)}})}uploadBannerPhoto(e,t){return p(this,null,function*(){if(!e)throw new Error("Arquivo inválido");if(!t)throw new Error("ID de usuário ausente");try{const s=yield this.fileToBase64(e),r=`banner_${t}_${Date.now()}`,n=ex(Lb,"users",t);return yield lv(n,{bannerPhotoId:r,bannerPhotoData:s,updatedAt:new Date}),{imageId:r,success:!0}}catch(s){throw new Error(`Falha no upload: ${s.message}`)}})}replaceProfilePhoto(e,t,s=null){return p(this,null,function*(){try{return(yield this.uploadProfilePhoto(e,t)).imageId}catch(s){throw s}})}replaceBannerPhoto(e,t,s=null){return p(this,null,function*(){try{return(yield this.uploadBannerPhoto(e,t)).imageId}catch(s){throw s}})}deleteProfilePhoto(e,t){return p(this,null,function*(){try{const t=ex(Lb,"users",e);return yield lv(t,{profilePhotoId:null,profilePhotoData:null,updatedAt:new Date}),!0}catch(t){throw t}})}deleteBannerPhoto(e,t){return p(this,null,function*(){try{const t=ex(Lb,"users",e);return yield lv(t,{bannerPhotoId:null,bannerPhotoData:null,updatedAt:new Date}),!0}catch(t){throw t}})}getImageFromFirestore(e,t){return p(this,null,function*(){try{const s=ex(Lb,"users",t),r=yield nv(s);if(r.exists()){const t=r.data();if(e===t.profilePhotoId)return t.profilePhotoData;if(e===t.bannerPhotoId)return t.bannerPhotoData}return null}catch(s){return null}})}getUserImages(e){return p(this,null,function*(){try{const t=ex(Lb,"users",e),s=yield nv(t);if(s.exists()){const e=s.data();return{profilePhotoURL:e.profilePhotoData||null,bannerPhotoURL:e.bannerPhotoData||null,profilePhotoId:e.profilePhotoId||null,bannerPhotoId:e.bannerPhotoId||null}}return{profilePhotoURL:null,bannerPhotoURL:null,profilePhotoId:null,bannerPhotoId:null}}catch(t){return{profilePhotoURL:null,bannerPhotoURL:null,profilePhotoId:null,bannerPhotoId:null}}})}fileToBase64(e){return new Promise((t,s)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>s(e)})}validateFileSize(e,t){const s=1024*t*1024;if(e.size>s)throw new Error(`Arquivo muito grande. Máximo permitido: ${t}MB`);return!0}validateFileType(e){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(e.type))throw new Error("Tipo de arquivo não suportado. Use apenas imagens (JPEG, PNG, GIF, WebP)");return!0}},Yy=()=>{var t,s,r,n,i;const{user:a,loading:o}=Vb(),{createPost:l,deletePost:c}=wy(),[h,m]=f.useState(!1),[g,x]=f.useState(!1),[b,w]=f.useState([]),[y,N]=f.useState(!0),[j,C]=f.useState({displayName:"",username:"",bio:"",phone:"",birthDate:""}),S=f.useRef(null),E=f.useRef(null),[_,T]=f.useState(null),[I,A]=f.useState(null),{profilePhoto:D,bannerPhoto:P,loading:R,loadUserImages:L,updateImage:O}=(t=>{const[s,r]=f.useState(null),[n,i]=f.useState(null),[a,o]=f.useState(!1),[l,c]=f.useState(null),d=f.useCallback(()=>p(e,null,function*(){if(t){o(!0),c(null);try{const e=yield Jy.getUserImages(t);r(e.profilePhotoURL),i(e.bannerPhotoURL)}catch(e){c(e.message)}finally{o(!1)}}}),[t]),u=f.useCallback((s,r,n=null)=>p(e,null,function*(){if(!t||!s)return null;try{let e;return Jy.validateFileType(s),"profilePhoto"===r?Jy.validateFileSize(s,2):"bannerPhoto"===r&&Jy.validateFileSize(s,5),"profilePhoto"===r?e=yield Jy.replaceProfilePhoto(s,t,n):"bannerPhoto"===r&&(e=yield Jy.replaceBannerPhoto(s,t,n)),yield d(),e}catch(e){throw e}}),[t,d]),h=f.useCallback(()=>{r(null),i(null),c(null)},[]);return f.useEffect(()=>{t&&d()},[t,d]),{profilePhoto:s,bannerPhoto:n,loading:a,error:l,loadUserImages:d,updateImage:u,clearImages:h}})(null==a?void 0:a.uid);f.useEffect(()=>{a&&p(e,null,function*(){N(!0);try{const e=yield ly.getUserPosts(a.uid);w(e)}catch(e){alert("Erro ao carregar posts do perfil. Tente novamente.")}finally{N(!1)}})},[a]),f.useEffect(()=>{var e,t,s,r,n;a&&(C({displayName:a.displayName||(null==(e=a.profileData)?void 0:e.displayName)||"",username:(null==(t=a.profileData)?void 0:t.username)||"",bio:(null==(s=a.profileData)?void 0:s.bio)||"",phone:(null==(r=a.profileData)?void 0:r.phone)||"",birthDate:(null==(n=a.profileData)?void 0:n.birthDate)||""}),L())},[a,L]),f.useEffect(()=>{a&&!h&&p(e,null,function*(){try{const e=yield oy.getUserProfile(a.uid);e&&C({displayName:e.displayName||"",username:e.username||"",bio:e.bio||"",phone:e.phone||"",birthDate:e.birthDate||""})}catch(e){}})},[a,h]);const M=()=>{x(!0)},U=e=>{if(!e)return"";let t;if(e&&"object"==typeof e&&e.toDate)t=e.toDate();else if(e instanceof Date)t=e;else{if("string"!=typeof e&&"number"!=typeof e)return"Data inválida";t=new Date(e)}if(isNaN(t.getTime()))return"Data inválida";const s=new Date-t,r=Math.floor(s/6e4),n=Math.floor(s/36e5),i=Math.floor(s/864e5);return r<1?"Agora mesmo":r<60?`${r}m atrás`:n<24?`${n}h atrás`:i<7?`${i}d atrás`:t.toLocaleDateString("pt-BR")};return o||R?Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("div",{className:"text-white ml-3",children:"Carregando perfil..."})]}):a?Je.jsxs("div",{className:"min-h-screen bg-black relative",children:[Je.jsxs("div",{className:"relative h-64 bg-gradient-to-r from-blue-600 to-purple-600",children:[(I||P)&&Je.jsx("img",{src:I||P,alt:"Banner",className:"w-full h-full object-cover"}),Je.jsx("div",{className:"absolute inset-0 bg-black/20"}),h&&Je.jsxs("button",{onClick:()=>{var e;null==(e=E.current)||e.click()},className:"absolute top-4 right-4 px-4 py-2 bg-white/20 backdrop-blur-sm rounded-lg text-white hover:bg-white/30 transition-colors flex items-center space-x-2",children:[Je.jsx(Y,{className:"w-4 h-4"}),Je.jsx("span",{children:"Alterar Banner"})]})]}),Je.jsx("div",{className:"relative -mt-20 px-8",children:Je.jsxs("div",{className:"relative",children:[Je.jsx("div",{className:"w-40 h-40 rounded-full border-4 border-white bg-white/10 flex items-center justify-center overflow-hidden",children:_||D?Je.jsx("img",{src:_||D,alt:"Foto de perfil",className:"w-full h-full object-cover"}):Je.jsx(J,{className:"w-20 h-20 text-white/50"})}),h&&Je.jsx("button",{onClick:()=>{var e;null==(e=S.current)||e.click()},className:"absolute bottom-2 right-2 w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white/30 transition-colors",children:Je.jsx(Y,{className:"w-6 h-6 text-white"})})]})}),Je.jsx("div",{className:"px-8 pb-8",children:Je.jsxs("div",{className:"flex items-start justify-between mb-6",children:[Je.jsx("div",{className:"flex-1",children:h?Je.jsxs("div",{className:"space-y-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Nome"}),Je.jsx("input",{type:"text",value:j.displayName,onChange:e=>C(t=>u(d({},t),{displayName:e.target.value})),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:"Seu nome"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Username"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"text",value:j.username,onChange:e=>C(t=>u(d({},t),{username:e.target.value})),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:"seu_username"})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Biografia"}),Je.jsx("textarea",{value:j.bio,onChange:e=>C(t=>u(d({},t),{bio:e.target.value})),rows:3,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 resize-none",placeholder:"Conte um pouco sobre você..."})]}),Je.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Telefone"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"tel",value:j.phone,onChange:e=>C(t=>u(d({},t),{phone:e.target.value})),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:"(11) 99999-9999"})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Data de Nascimento"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"date",value:j.birthDate,onChange:e=>C(t=>u(d({},t),{birthDate:e.target.value})),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"})]})]})]}),Je.jsxs("div",{className:"flex space-x-3",children:[Je.jsxs("button",{onClick:()=>p(e,null,function*(){var e,t,s,r;try{if(_||I){if(_)try{const s=null==(e=S.current)?void 0:e.files[0];if(s){const e=null==(t=null==a?void 0:a.profileData)?void 0:t.profilePhotoId;yield O(s,"profilePhoto",e)}}catch(n){return void alert("Erro ao atualizar foto de perfil. Tente novamente.")}if(I)try{const e=null==(s=E.current)?void 0:s.files[0];if(e){const t=null==(r=null==a?void 0:a.profileData)?void 0:r.bannerPhotoId;yield O(e,"bannerPhoto",t)}}catch(n){return void alert("Erro ao substituir banner. Tente novamente.")}}try{yield oy.updateUserBasicProfile(a.uid,j)}catch(n){return void alert("Erro ao atualizar dados do perfil. Tente novamente.")}m(!1),T(null),A(null)}catch(n){alert("Erro ao salvar perfil. Tente novamente.")}}),className:"px-6 py-2 bg-white text-black rounded-lg font-medium hover:bg-white/90 transition-colors flex items-center space-x-2",children:[Je.jsx(Pe,{className:"w-4 h-4"}),Je.jsx("span",{children:"Salvar"})]}),Je.jsx("button",{onClick:()=>{var e,t,s,r,n;C({displayName:(null==a?void 0:a.displayName)||(null==(e=null==a?void 0:a.profileData)?void 0:e.displayName)||"",username:(null==(t=null==a?void 0:a.profileData)?void 0:t.username)||"",bio:(null==(s=null==a?void 0:a.profileData)?void 0:s.bio)||"",phone:(null==(r=null==a?void 0:a.profileData)?void 0:r.phone)||"",birthDate:(null==(n=null==a?void 0:a.profileData)?void 0:n.birthDate)||""}),m(!1),T(null),A(null),L()},className:"px-6 py-2 bg-white/10 text-white rounded-lg font-medium hover:bg-white/20 transition-colors",children:"Cancelar"})]})]}):Je.jsxs(Je.Fragment,{children:[Je.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:(null==a?void 0:a.displayName)||(null==(t=null==a?void 0:a.profileData)?void 0:t.displayName)||"Usuário"}),Je.jsxs("p",{className:"text-white/80 text-lg mb-3",children:["@",(null==(s=null==a?void 0:a.profileData)?void 0:s.username)||"usuario"]}),Je.jsx("p",{className:"text-white/70 mb-3",children:(null==(r=null==a?void 0:a.profileData)?void 0:r.bio)||"Nenhuma biografia adicionada"}),Je.jsxs("div",{className:"flex items-center space-x-6 text-sm text-white/60",children:[(null==(n=null==a?void 0:a.profileData)?void 0:n.phone)&&Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx(k,{className:"w-4 h-4"}),Je.jsx("span",{children:a.profileData.phone})]}),(null==(i=null==a?void 0:a.profileData)?void 0:i.birthDate)&&Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx(F,{className:"w-4 h-4"}),Je.jsx("span",{children:(e=>{if(!e)return"Data não disponível";try{let t;if(e&&"object"==typeof e&&e.toDate)t=e.toDate();else if(e instanceof Date)t=e;else{if("string"!=typeof e&&"number"!=typeof e)return"Data inválida";t=new Date(e)}return isNaN(t.getTime())?"Data inválida":t.toLocaleDateString("pt-BR",{year:"numeric",month:"long",day:"numeric"})}catch(t){return"Data inválida"}})(a.profileData.birthDate)})]})]})]})}),!h&&Je.jsxs("button",{onClick:()=>{m(!0)},className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-colors flex items-center space-x-2",children:[Je.jsx(ue,{className:"w-4 h-4"}),Je.jsx("span",{children:"Editar Perfil"})]})]})}),Je.jsxs("div",{className:"px-8 pb-8",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h2",{className:"text-2xl font-bold text-white",children:"Posts"}),Je.jsxs("button",{onClick:M,className:"px-6 py-3 bg-white hover:bg-gray-100 text-black rounded-lg font-medium transition-colors flex items-center space-x-2",children:[Je.jsx(H,{className:"w-4 h-4"}),Je.jsx("span",{children:"Criar Post"})]})]}),y?Je.jsxs("div",{className:"text-center py-16",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("p",{className:"text-white/60 mt-4",children:"Carregando posts..."})]}):0===b.length?Je.jsxs("div",{className:"text-center py-16",children:[Je.jsx("div",{className:"w-24 h-24 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4",children:Je.jsx(ee,{className:"w-12 h-12 text-white/30"})}),Je.jsx("h3",{className:"text-xl text-white/60 mb-2",children:"Nenhum post ainda"}),Je.jsx("p",{className:"text-white/40 mb-6",children:"Seus posts públicos aparecerão aqui. Posts anônimos não são exibidos no perfil."}),Je.jsxs("button",{onClick:M,className:"px-6 py-3 bg-white hover:bg-gray-100 text-black rounded-lg font-medium transition-colors flex items-center space-x-2 mx-auto",children:[Je.jsx(H,{className:"w-4 h-4"}),Je.jsx("span",{children:"Criar Primeiro Post"})]})]}):Je.jsx("div",{className:"space-y-6",children:b.map(t=>Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-6",children:[Je.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center",children:t.avatar?Je.jsx("img",{src:t.avatar,alt:t.author,className:"w-10 h-10 rounded-full"}):Je.jsx(J,{className:"w-5 h-5 text-white/70"})}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"font-medium text-white",children:t.author}),Je.jsx("p",{className:"text-sm text-white/50",children:U(t.createdAt)})]})]}),Je.jsx("button",{onClick:()=>{return s=t.id,p(e,null,function*(){if(window.confirm("Tem certeza que deseja deletar este post?"))try{(yield c(s))&&w(e=>e.filter(e=>e.id!==s))}catch(e){}});var s},className:"p-2 text-white/50 hover:text-red-400 transition-colors rounded-full hover:bg-white/10",children:Je.jsx(q,{className:"w-4 h-4"})})]}),Je.jsx("p",{className:"text-white/90 leading-relaxed mb-4",children:t.content}),t.tags&&t.tags.length>0&&Je.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((e,t)=>Je.jsx("span",{className:"inline-flex items-center space-x-1 bg-white/10 text-white/70 px-3 py-1 rounded-full text-sm",children:Je.jsxs("span",{children:["#",e]})},t))})]},t.id))})]}),g&&Je.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Je.jsxs("div",{className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h3",{className:"text-xl font-medium text-white",children:"Criar Novo Post"}),Je.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:Je.jsx(v,{className:"w-5 h-5 text-white/70"})})]}),Je.jsx(yy,{onPostCreated:t=>p(e,null,function*(){try{if(yield l(t)){x(!1);try{const e=yield ly.getUserPosts(a.uid);w(e)}catch(e){const s=u(d({id:Date.now().toString()},t),{createdAt:new Date,likes:[],commentCount:0,shares:0,isEdited:!1});w(e=>[s,...e])}}}catch(e){}}),onCancel:()=>x(!1),isModal:!0})]})}),Je.jsx("input",{ref:S,type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t)try{Jy.validateFileType(t),Jy.validateFileSize(t,2);const e=new FileReader;e.onload=e=>{T(e.target.result)},e.readAsDataURL(t)}catch(s){alert(s.message),e.target.value=""}},className:"hidden"}),Je.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t)try{Jy.validateFileType(t),Jy.validateFileSize(t,5);const e=new FileReader;e.onload=e=>{A(e.target.result)},e.readAsDataURL(t)}catch(s){alert(s.message),e.target.value=""}},className:"hidden"})]}):Je.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Je.jsxs("div",{className:"text-center",children:[Je.jsx("div",{className:"w-24 h-24 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:Je.jsx(J,{className:"w-12 h-12 text-red-400"})}),Je.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Usuário não autenticado"}),Je.jsx("p",{className:"text-white/60",children:"Faça login para acessar seu perfil"})]})})},Xy=()=>{const{user:t}=Vb(),[s,r]=f.useState([]),[n,i]=f.useState([]),[a,o]=f.useState(!0),[l,c]=f.useState(""),[h,m]=f.useState("all");f.useState(null);const[g,x]=f.useState(!1),[b,w]=f.useState(null),[y,N]=f.useState({recipientId:"",recipientName:"",subject:"",content:"",type:"text"});f.useEffect(()=>{j()},[null==t?void 0:t.uid]),f.useEffect(()=>{let e=s;l&&(e=e.filter(e=>{var t,s,r;return(null==(t=e.subject)?void 0:t.toLowerCase().includes(l.toLowerCase()))||(null==(s=e.content)?void 0:s.toLowerCase().includes(l.toLowerCase()))||(null==(r=e.senderName)?void 0:r.toLowerCase().includes(l.toLowerCase()))})),"unread"===h?e=e.filter(e=>!e.read):"read"===h&&(e=e.filter(e=>e.read)),i(e)},[s,l,h]);const j=()=>p(e,null,function*(){if(null==t?void 0:t.uid){o(!0);try{const s=yield(t.uid,p(e,null,function*(){try{return{success:!0,data:[]}}catch(e){return{success:!1,error:e.message}}}));s.success&&r(s.data)}catch(s){}finally{o(!1)}}}),S=t=>p(e,null,function*(){try{(yield p(e,null,function*(){try{return{success:!0}}catch(e){return{success:!1,error:e.message}}})).success&&j()}catch(t){}}),E=e=>{switch(e){case"phone":return Je.jsx(k,{className:"w-4 h-4"});case"video":return Je.jsx(Ue,{className:"w-4 h-4"});case"email":return Je.jsx(C,{className:"w-4 h-4"});default:return Je.jsx(D,{className:"w-4 h-4"})}},_=e=>{switch(e){case"phone":return"Chamada";case"video":return"Vídeo";case"email":return"Email";default:return"Mensagem"}},T=e=>{switch(e){case"phone":return"bg-green-500/20 text-green-400 border-green-500/30";case"video":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"email":return"bg-purple-500/20 text-purple-400 border-purple-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},I=e=>{const t=new Date(e),s=(new Date-t)/36e5;return s<24?t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):s<48?"Ontem":t.toLocaleDateString("pt-BR")};return a?Je.jsx("div",{className:"flex items-center justify-center h-64",children:Je.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}):Je.jsxs("div",{className:"space-y-6",children:[Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsxs("div",{children:[Je.jsx("h1",{className:"text-2xl font-bold text-white",children:"Mensagens"}),Je.jsx("p",{className:"text-white/60",children:"Gerencie suas comunicações com pacientes e colegas"})]}),Je.jsxs("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 bg-white text-black px-4 py-2 rounded-lg font-medium hover:bg-white/90 transition-all duration-300",children:[Je.jsx(H,{className:"w-4 h-4"}),"Nova Mensagem"]})]}),Je.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[Je.jsxs("div",{className:"flex-1 relative",children:[Je.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"text",placeholder:"Buscar mensagens...",value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300"})]}),Je.jsxs("select",{value:h,onChange:e=>m(e.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:"all",children:"Todas as mensagens"}),Je.jsx("option",{value:"unread",children:"Não lidas"}),Je.jsx("option",{value:"read",children:"Lidas"})]})]}),Je.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 border border-blue-500/30 flex items-center justify-center",children:Je.jsx(D,{className:"w-5 h-5 text-blue-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Total de Mensagens"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-500/20 border border-red-500/30 flex items-center justify-center",children:Je.jsx(oe,{className:"w-5 h-5 text-red-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>!e.read).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Não Lidas"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-500/20 border border-green-500/30 flex items-center justify-center",children:Je.jsx(Ee,{className:"w-5 h-5 text-green-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>e.read).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Lidas"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500/20 border border-purple-500/30 flex items-center justify-center",children:Je.jsx(k,{className:"w-5 h-5 text-purple-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"phone"===e.type||"video"===e.type).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Chamadas/Vídeos"})]})]})})]}),Je.jsxs("div",{className:"space-y-4",children:[n.map(e=>Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl overflow-hidden hover:bg-white/[0.07] transition-all duration-300 "+(e.read?"":"bg-white/10 border-white/30"),children:Je.jsxs("div",{className:"p-6",children:[Je.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Je.jsxs("div",{className:"flex items-start space-x-4",children:[Je.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/10 border border-white/20 flex items-center justify-center",children:E(e.type)}),Je.jsxs("div",{className:"flex-1",children:[Je.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[Je.jsx("h3",{className:"text-lg font-semibold "+(e.read?"text-white/80":"text-white"),children:e.subject||"Sem assunto"}),Je.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${T(e.type)}`,children:_(e.type)}),!e.read&&Je.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-500/20 text-red-400 border border-red-500/30",children:"Nova"})]}),Je.jsxs("p",{className:"text-white/60 text-sm",children:["De: ",e.senderName]}),Je.jsx("p",{className:"text-white/40 text-xs",children:I(e.createdAt)})]})]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[!e.read&&Je.jsx("button",{onClick:()=>S(e.id),className:"p-2 text-blue-400 hover:text-blue-300 hover:bg-blue-500/10 rounded-lg transition-colors duration-300",title:"Marcar como lida",children:Je.jsx(ne,{className:"w-4 h-4"})}),Je.jsx("button",{onClick:()=>{return t=e.id,void w(b===t?null:t);var t},className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-colors duration-300",children:b===e.id?Je.jsx(Re,{className:"w-4 h-4"}):Je.jsx(Le,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-colors duration-300",children:Je.jsx(me,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-colors duration-300",children:Je.jsx(U,{className:"w-4 h-4"})})]})]}),b===e.id&&Je.jsxs("div",{className:"border-t border-white/10 pt-4 space-y-4",children:[Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-sm font-medium text-white/80 mb-2",children:"Mensagem"}),Je.jsx("p",{className:"text-white/70 text-sm leading-relaxed",children:e.content})]}),Je.jsxs("div",{className:"flex space-x-3 pt-4",children:[Je.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-colors duration-300",children:[Je.jsx(me,{className:"w-4 h-4"}),Je.jsx("span",{className:"text-sm",children:"Responder"})]}),Je.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-colors duration-300",children:[Je.jsx(Oe,{className:"w-4 h-4"}),Je.jsx("span",{className:"text-sm",children:"Encaminhar"})]}),Je.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-colors duration-300",children:[Je.jsx(Me,{className:"w-4 h-4"}),Je.jsx("span",{className:"text-sm",children:"Arquivar"})]}),Je.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-red-500/10 border border-red-500/20 text-red-400 rounded-lg hover:bg-red-500/20 transition-colors duration-300",children:[Je.jsx(q,{className:"w-4 h-4"}),Je.jsx("span",{className:"text-sm",children:"Excluir"})]})]})]})]})},e.id)),0===n.length&&Je.jsxs("div",{className:"text-center py-12",children:[Je.jsx(D,{className:"w-12 h-12 text-white/40 mx-auto mb-4"}),Je.jsx("h3",{className:"text-lg font-medium text-white/60 mb-2",children:"Nenhuma mensagem encontrada"}),Je.jsx("p",{className:"text-white/40",children:"Comece enviando sua primeira mensagem"})]})]}),g&&Je.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:Je.jsxs("div",{className:"bg-gray-900 border border-white/20 rounded-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h2",{className:"text-xl font-semibold text-white",children:"Nova Mensagem"}),Je.jsx("button",{onClick:()=>x(!1),className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(v,{className:"w-5 h-5"})})]}),Je.jsxs("form",{onSubmit:s=>p(e,null,function*(){if(s.preventDefault(),null==t?void 0:t.uid)try{u(d({},y),{senderId:t.uid,senderName:t.displayName||"Psicólogo"}),(yield p(e,null,function*(){try{return{success:!0,data:{id:Date.now().toString()}}}catch(e){return{success:!1,error:e.message}}})).success&&(x(!1),N({recipientId:"",recipientName:"",subject:"",content:"",type:"text"}),j())}catch(r){}}),className:"space-y-4",children:[Je.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Tipo de Mensagem"}),Je.jsxs("select",{value:y.type,onChange:e=>N(u(d({},y),{type:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:"text",children:"Texto"}),Je.jsx("option",{value:"phone",children:"Chamada"}),Je.jsx("option",{value:"video",children:"Vídeo"}),Je.jsx("option",{value:"email",children:"Email"})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Nome do Destinatário"}),Je.jsx("input",{type:"text",required:!0,value:y.recipientName,onChange:e=>N(u(d({},y),{recipientName:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Nome do destinatário"})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Assunto"}),Je.jsx("input",{type:"text",value:y.subject,onChange:e=>N(u(d({},y),{subject:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Assunto da mensagem (opcional)"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Conteúdo da Mensagem"}),Je.jsx("textarea",{required:!0,value:y.content,onChange:e=>N(u(d({},y),{content:e.target.value})),rows:"6",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Digite sua mensagem..."})]}),Je.jsxs("div",{className:"flex space-x-3 pt-4",children:[Je.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-white/20 text-white rounded-lg hover:bg-white/10 transition-colors duration-300",children:"Cancelar"}),Je.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-white text-black rounded-lg font-medium hover:bg-white/90 transition-colors duration-300",children:[Je.jsx(re,{className:"w-4 h-4 inline mr-2"}),"Enviar"]})]})]})]})})]})},Zy=()=>{const{user:t}=Vb(),[s,r]=f.useState([]),[n,i]=f.useState([]),[a,o]=f.useState(!0),[l,c]=f.useState(""),[h,m]=f.useState("all"),[g,x]=f.useState(!1),[v,b]=f.useState({name:"",email:"",phone:"",birthDate:"",diagnosis:"",notes:""});f.useEffect(()=>{w()},[null==t?void 0:t.uid]),f.useEffect(()=>{let e=s;l&&(e=e.filter(e=>e.name.toLowerCase().includes(l.toLowerCase())||e.email.toLowerCase().includes(l.toLowerCase()))),"all"!==h&&(e=e.filter(e=>e.status===h)),i(e)},[s,l,h]);const w=()=>p(e,null,function*(){if(null==t?void 0:t.uid){o(!0);try{const e=yield Py(t.uid);e.success&&r(e.data)}catch(e){}finally{o(!1)}}}),y=e=>{switch(e){case"active":return"bg-green-500/20 text-green-400 border-green-500/30";case"inactive":return"bg-gray-500/20 text-gray-400 border-gray-500/30";case"urgent":return"bg-red-500/20 text-red-400 border-red-500/30";default:return"bg-blue-500/20 text-blue-400 border-blue-500/30"}},N=e=>{switch(e){case"active":return Je.jsx(te,{className:"w-4 h-4"});case"inactive":return Je.jsx(Ve,{className:"w-4 h-4"});case"urgent":return Je.jsx(Fe,{className:"w-4 h-4"});default:return Je.jsx(oe,{className:"w-4 h-4"})}},j=e=>{switch(e){case"active":return"Ativo";case"inactive":return"Inativo";case"urgent":return"Urgente";default:return"Pendente"}};return a?Je.jsx("div",{className:"flex items-center justify-center h-64",children:Je.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}):Je.jsxs("div",{className:"space-y-6",children:[Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsxs("div",{children:[Je.jsx("h1",{className:"text-2xl font-bold text-white",children:"Pacientes"}),Je.jsx("p",{className:"text-white/60",children:"Gerencie seus pacientes e acompanhe o progresso"})]}),Je.jsxs("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 bg-white text-black px-4 py-2 rounded-lg font-medium hover:bg-white/90 transition-all duration-300",children:[Je.jsx(H,{className:"w-4 h-4"}),"Novo Paciente"]})]}),Je.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[Je.jsxs("div",{className:"flex-1 relative",children:[Je.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"text",placeholder:"Buscar pacientes...",value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300"})]}),Je.jsxs("select",{value:h,onChange:e=>m(e.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:"all",children:"Todos os status"}),Je.jsx("option",{value:"active",children:"Ativos"}),Je.jsx("option",{value:"inactive",children:"Inativos"}),Je.jsx("option",{value:"urgent",children:"Urgentes"})]})]}),Je.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-500/20 border border-green-500/30 flex items-center justify-center",children:Je.jsx(A,{className:"w-5 h-5 text-green-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"active"===e.status).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Pacientes Ativos"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 border border-blue-500/30 flex items-center justify-center",children:Je.jsx(je,{className:"w-5 h-5 text-blue-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"urgent"===e.status).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Casos Urgentes"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-yellow-500/20 border border-yellow-500/30 flex items-center justify-center",children:Je.jsx(F,{className:"w-5 h-5 text-yellow-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>e.lastSession&&new Date(e.lastSession)>new Date(Date.now()-6048e5)).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Sessões Esta Semana"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500/20 border border-purple-500/30 flex items-center justify-center",children:Je.jsx(oe,{className:"w-5 h-5 text-purple-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>!e.lastSession||new Date(e.lastSession)<new Date(Date.now()-2592e6)).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Pendentes"})]})]})})]}),Je.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl overflow-hidden",children:[Je.jsx("div",{className:"overflow-x-auto",children:Je.jsxs("table",{className:"w-full",children:[Je.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:Je.jsxs("tr",{children:[Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Paciente"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Status"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Última Sessão"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Progresso"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Contato"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Ações"})]})}),Je.jsx("tbody",{className:"divide-y divide-white/10",children:n.map(e=>Je.jsxs("tr",{className:"hover:bg-white/5 transition-colors duration-200",children:[Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Je.jsxs("div",{className:"flex items-center",children:[Je.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:Je.jsx("span",{className:"text-white font-medium text-sm",children:e.name.charAt(0).toUpperCase()})}),Je.jsxs("div",{className:"ml-4",children:[Je.jsx("div",{className:"text-sm font-medium text-white",children:e.name}),Je.jsx("div",{className:"text-sm text-white/60",children:e.diagnosis||"Sem diagnóstico"})]})]})}),Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Je.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${y(e.status)}`,children:[N(e.status),Je.jsx("span",{className:"ml-1",children:j(e.status)})]})}),Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/60",children:e.lastSession?new Date(e.lastSession).toLocaleDateString("pt-BR"):"Nunca"}),Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("div",{className:"w-20 bg-white/20 rounded-full h-2",children:Je.jsx("div",{className:"h-2 rounded-full bg-white",style:{width:`${e.progress||0}%`}})}),Je.jsxs("span",{className:"text-sm text-white/60",children:[e.progress||0,"%"]})]})}),Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("button",{className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(k,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(C,{className:"w-4 h-4"})})]})}),Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("button",{className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(ce,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(ie,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(U,{className:"w-4 h-4"})})]})})]},e.id))})]})}),0===n.length&&Je.jsxs("div",{className:"text-center py-12",children:[Je.jsx(A,{className:"w-12 h-12 text-white/40 mx-auto mb-4"}),Je.jsx("h3",{className:"text-lg font-medium text-white/60 mb-2",children:"Nenhum paciente encontrado"}),Je.jsx("p",{className:"text-white/40",children:"Comece adicionando seu primeiro paciente"})]})]}),g&&Je.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:Je.jsxs("div",{className:"bg-gray-900 border border-white/20 rounded-xl p-6 w-full max-w-md mx-4",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h2",{className:"text-xl font-semibold text-white",children:"Novo Paciente"}),Je.jsx("button",{onClick:()=>x(!1),className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(X,{className:"w-5 h-5"})})]}),Je.jsxs("form",{onSubmit:s=>p(e,null,function*(){var r,n;if(s.preventDefault(),null==t?void 0:t.uid)try{(yield(r=t.uid,n=v,p(e,null,function*(){try{const e=new Ay;return{success:!0,data:{id:yield e.addPatient(r,n)}}}catch(e){return{success:!1,error:e.message}}}))).success&&(x(!1),b({name:"",email:"",phone:"",birthDate:"",diagnosis:"",notes:""}),w())}catch(i){}}),className:"space-y-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Nome Completo"}),Je.jsx("input",{type:"text",required:!0,value:v.name,onChange:e=>b(u(d({},v),{name:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Nome do paciente"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Email"}),Je.jsx("input",{type:"email",required:!0,value:v.email,onChange:e=>b(u(d({},v),{email:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"email@exemplo.com"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Telefone"}),Je.jsx("input",{type:"tel",value:v.phone,onChange:e=>b(u(d({},v),{phone:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"(11) 99999-9999"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Data de Nascimento"}),Je.jsx("input",{type:"date",value:v.birthDate,onChange:e=>b(u(d({},v),{birthDate:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Diagnóstico Inicial"}),Je.jsx("textarea",{value:v.diagnosis,onChange:e=>b(u(d({},v),{diagnosis:e.target.value})),rows:"3",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Descreva o diagnóstico inicial..."})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Observações"}),Je.jsx("textarea",{value:v.notes,onChange:e=>b(u(d({},v),{notes:e.target.value})),rows:"2",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Observações adicionais..."})]}),Je.jsxs("div",{className:"flex space-x-3 pt-4",children:[Je.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-white/20 text-white rounded-lg hover:bg-white/10 transition-colors duration-300",children:"Cancelar"}),Je.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-white text-black rounded-lg font-medium hover:bg-white/90 transition-colors duration-300",children:"Adicionar"})]})]})]})})]})},eN=({isOpen:t,onClose:s})=>{const{user:r}=Vb(),[n,i]=f.useState(0),a=[{title:"Bem-vindo ao seu Dashboard Profissional! 👋",description:"Olá! Vamos fazer um tour rápido para você conhecer todas as funcionalidades do seu painel de psicólogo.",icon:Je.jsx(j,{className:"w-8 h-8 text-yellow-400"}),highlight:null},{title:"Visão Geral - Seu Centro de Controle",description:"Aqui você encontra um resumo completo da sua prática: pacientes ativos, sessões realizadas, taxa de sucesso e muito mais.",icon:Je.jsx(Ne,{className:"w-8 h-8 text-blue-400"}),highlight:"overview",features:["Cards de monitoramento em tempo real","Gráficos de progresso dos pacientes","Estatísticas de desempenho","Resumo das próximas sessões"]},{title:"Gestão de Pacientes",description:"Gerencie todos os seus pacientes em um só lugar. Acompanhe progressos, histórico de sessões e informações importantes.",icon:Je.jsx(A,{className:"w-8 h-8 text-green-400"}),highlight:"patients",features:["Lista completa de pacientes","Status de tratamento","Histórico de sessões","Progresso individual"]},{title:"Agenda de Sessões",description:"Organize sua agenda profissional com facilidade. Agende, gerencie e acompanhe todas as suas sessões de terapia.",icon:Je.jsx(F,{className:"w-8 h-8 text-purple-400"}),highlight:"sessions",features:["Agendamento de sessões","Diferentes tipos de atendimento","Controle de status","Lembretes automáticos"]},{title:"Relatórios e Análises",description:"Crie relatórios detalhados sobre o progresso dos seus pacientes e analise dados para melhorar seus tratamentos.",icon:Je.jsx(je,{className:"w-8 h-8 text-orange-400"}),highlight:"reports",features:["Relatórios de progresso","Análises de tratamento","Métricas de sucesso","Exportação de dados"]},{title:"Sistema de Mensagens",description:"Comunique-se facilmente com seus pacientes através de mensagens, chamadas e videoconferências integradas.",icon:Je.jsx(D,{className:"w-8 h-8 text-pink-400"}),highlight:"messages",features:["Chat integrado","Chamadas de voz e vídeo","Notificações em tempo real","Histórico de conversas"]},{title:"Recursos Avançados",description:"Aproveite funcionalidades exclusivas para psicólogos: avaliações, planos de tratamento e muito mais.",icon:Je.jsx(xe,{className:"w-8 h-8 text-cyan-400"}),highlight:null,features:["Avaliações psicológicas","Planos de tratamento","Rastreamento de humor","Relatórios personalizados"]},{title:"Tudo Pronto! 🎉",description:"Agora você está pronto para usar todas as funcionalidades do seu dashboard profissional. Boa sorte com sua prática!",icon:Je.jsx(te,{className:"w-8 h-8 text-green-400"}),highlight:null}],o=()=>p(e,null,function*(){if(null==r?void 0:r.uid)try{yield(t=r.uid,p(e,null,function*(){try{const e=new Ay;return yield e.markTourAsSeen(t),{success:!0}}catch(e){return{success:!1,error:e.message}}}))}catch(n){}var t;s()}),l=a[n],c=0===n,d=n===a.length-1;return t?Je.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:Je.jsxs("div",{className:"bg-gray-900 border border-white/20 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[Je.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/10 border border-white/20 flex items-center justify-center",children:Je.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-6 h-6 object-contain"})}),Je.jsxs("div",{children:[Je.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tour do Dashboard"}),Je.jsxs("p",{className:"text-sm text-white/60",children:["Passo ",n+1," de ",a.length]})]})]}),Je.jsx("div",{className:"flex items-center space-x-2",children:Je.jsx("button",{onClick:()=>{o()},className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-colors duration-200",title:"Pular tour",children:Je.jsx(v,{className:"w-5 h-5"})})})]}),Je.jsxs("div",{className:"p-6",children:[Je.jsxs("div",{className:"text-center mb-6",children:[Je.jsx("div",{className:"flex justify-center mb-4",children:l.icon}),Je.jsx("h3",{className:"text-2xl font-bold text-white mb-3",children:l.title}),Je.jsx("p",{className:"text-white/70 text-lg leading-relaxed",children:l.description})]}),l.features&&Je.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 mb-6",children:[Je.jsx("h4",{className:"text-sm font-medium text-white/80 mb-3 text-center",children:"Funcionalidades desta seção:"}),Je.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:l.features.map((e,t)=>Je.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Je.jsx(te,{className:"w-4 h-4 text-green-400 flex-shrink-0"}),Je.jsx("span",{className:"text-sm",children:e})]},t))})]}),1===n&&Je.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 mb-6",children:Je.jsxs("div",{className:"flex items-start space-x-3",children:[Je.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:Je.jsx(j,{className:"w-3 h-3 text-blue-400"})}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-sm font-medium text-blue-400 mb-1",children:"Dica Pro"}),Je.jsx("p",{className:"text-blue-300 text-sm",children:"Use os filtros de data e status para encontrar rapidamente as informações que você precisa. Os dados são atualizados em tempo real!"})]})]})}),2===n&&Je.jsx("div",{className:"bg-green-500/10 border border-green-500/20 rounded-xl p-4 mb-6",children:Je.jsxs("div",{className:"flex items-start space-x-3",children:[Je.jsx("div",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:Je.jsx(A,{className:"w-3 h-3 text-green-400"})}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-sm font-medium text-green-400 mb-1",children:"Organização"}),Je.jsx("p",{className:"text-green-300 text-sm",children:"Mantenha seus pacientes organizados por status. Use as cores para identificar rapidamente casos urgentes, ativos ou inativos."})]})]})}),3===n&&Je.jsx("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-xl p-4 mb-6",children:Je.jsxs("div",{className:"flex items-start space-x-3",children:[Je.jsx("div",{className:"w-6 h-6 rounded-full bg-purple-500/20 flex items-center justify-center flex-shrink-0 mt-0.5",children:Je.jsx(F,{className:"w-3 h-3 text-purple-400"})}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-sm font-medium text-purple-400 mb-1",children:"Agendamento"}),Je.jsx("p",{className:"text-purple-300 text-sm",children:"Configure lembretes automáticos para suas sessões. O sistema notifica você e seus pacientes sobre compromissos próximos."})]})]})}),Je.jsxs("div",{className:"mb-6",children:[Je.jsxs("div",{className:"flex justify-between text-sm text-white/60 mb-2",children:[Je.jsx("span",{children:"Progresso do tour"}),Je.jsxs("span",{children:[Math.round((n+1)/a.length*100),"%"]})]}),Je.jsx("div",{className:"w-full bg-white/10 rounded-full h-2",children:Je.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-500",style:{width:(n+1)/a.length*100+"%"}})})]})]}),Je.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-white/10",children:[Je.jsxs("button",{onClick:()=>{n>0&&i(n-1)},disabled:c,className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-300 "+(c?"text-white/30 cursor-not-allowed":"text-white hover:bg-white/10"),children:[Je.jsx(we,{className:"w-4 h-4"}),Je.jsx("span",{children:"Anterior"})]}),Je.jsx("div",{className:"flex space-x-2",children:a.map((e,t)=>Je.jsx("button",{onClick:()=>i(t),className:"w-3 h-3 rounded-full transition-all duration-300 "+(t===n?"bg-white":"bg-white/30 hover:bg-white/50")},t))}),Je.jsxs("button",{onClick:()=>{n<a.length-1?i(n+1):o()},className:"flex items-center space-x-2 bg-white text-black px-6 py-2 rounded-lg font-medium hover:bg-white/90 transition-all duration-300",children:[Je.jsx("span",{children:d?"Finalizar":"Próximo"}),!d&&Je.jsx(ye,{className:"w-4 h-4"})]})]})]})}):null},tN=()=>{const{user:t}=Vb(),[s,r]=f.useState([]),[n,i]=f.useState([]),[a,o]=f.useState(!0),[l,c]=f.useState(""),[h,m]=f.useState("all"),[g,x]=f.useState("all"),[b,w]=f.useState(!1),[y,N]=f.useState(null),[j,C]=f.useState({title:"",type:"patient-progress",patientId:"",patientName:"",content:"",recommendations:"",nextSteps:""});f.useEffect(()=>{k()},[null==t?void 0:t.uid]),f.useEffect(()=>{let e=s;if(l&&(e=e.filter(e=>{var t,s;return e.title.toLowerCase().includes(l.toLowerCase())||(null==(t=e.patientName)?void 0:t.toLowerCase().includes(l.toLowerCase()))||(null==(s=e.content)?void 0:s.toLowerCase().includes(l.toLowerCase()))})),"all"!==h&&(e=e.filter(e=>e.type===h)),"week"===g){const t=new Date;t.setDate(t.getDate()-7),e=e.filter(e=>new Date(e.createdAt)>=t)}else if("month"===g){const t=new Date;t.setMonth(t.getMonth()-1),e=e.filter(e=>new Date(e.createdAt)>=t)}i(e)},[s,l,h,g]);const k=()=>p(e,null,function*(){if(null==t?void 0:t.uid){o(!0);try{const s=yield(t.uid,p(e,null,function*(){try{return{success:!0,data:[]}}catch(e){return{success:!1,error:e.message}}}));s.success&&r(s.data)}catch(s){}finally{o(!1)}}}),S=e=>{switch(e){case"patient-progress":return Je.jsx(A,{className:"w-4 h-4"});case"session-summary":return Je.jsx(oe,{className:"w-4 h-4"});case"treatment-plan":return Je.jsx(te,{className:"w-4 h-4"});case"assessment":return Je.jsx(Ne,{className:"w-4 h-4"});default:return Je.jsx(je,{className:"w-4 h-4"})}},E=e=>{switch(e){case"patient-progress":return"Progresso do Paciente";case"session-summary":return"Resumo da Sessão";case"treatment-plan":return"Plano de Tratamento";case"assessment":return"Avaliação";default:return"Relatório"}},_=e=>{switch(e){case"patient-progress":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"session-summary":return"bg-green-500/20 text-green-400 border-green-500/30";case"treatment-plan":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"assessment":return"bg-orange-500/20 text-orange-400 border-orange-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}};return a?Je.jsx("div",{className:"flex items-center justify-center h-64",children:Je.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}):Je.jsxs("div",{className:"space-y-6",children:[Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsxs("div",{children:[Je.jsx("h1",{className:"text-2xl font-bold text-white",children:"Relatórios"}),Je.jsx("p",{className:"text-white/60",children:"Analise dados e gere relatórios detalhados"})]}),Je.jsxs("button",{onClick:()=>w(!0),className:"flex items-center space-x-2 bg-white text-black px-4 py-2 rounded-lg font-medium hover:bg-white/90 transition-all duration-300",children:[Je.jsx(H,{className:"w-4 h-4"}),"Novo Relatório"]})]}),Je.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[Je.jsxs("div",{className:"flex-1 relative",children:[Je.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"text",placeholder:"Buscar relatórios...",value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300"})]}),Je.jsxs("select",{value:h,onChange:e=>m(e.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:"all",children:"Todos os tipos"}),Je.jsx("option",{value:"patient-progress",children:"Progresso do Paciente"}),Je.jsx("option",{value:"session-summary",children:"Resumo da Sessão"}),Je.jsx("option",{value:"treatment-plan",children:"Plano de Tratamento"}),Je.jsx("option",{value:"assessment",children:"Avaliação"})]}),Je.jsxs("select",{value:g,onChange:e=>x(e.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:"all",children:"Todas as datas"}),Je.jsx("option",{value:"week",children:"Última semana"}),Je.jsx("option",{value:"month",children:"Último mês"})]})]}),Je.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 border border-blue-500/30 flex items-center justify-center",children:Je.jsx(Ne,{className:"w-5 h-5 text-blue-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Total de Relatórios"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-500/20 border border-green-500/30 flex items-center justify-center",children:Je.jsx(A,{className:"w-5 h-5 text-green-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"patient-progress"===e.type).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Progresso de Pacientes"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500/20 border border-purple-500/30 flex items-center justify-center",children:Je.jsx(oe,{className:"w-5 h-5 text-purple-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"session-summary"===e.type).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Resumos de Sessões"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500/20 border border-orange-500/30 flex items-center justify-center",children:Je.jsx(je,{className:"w-5 h-5 text-orange-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"treatment-plan"===e.type).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Planos de Tratamento"})]})]})})]}),Je.jsxs("div",{className:"space-y-4",children:[n.map(e=>{return Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl overflow-hidden hover:bg-white/[0.07] transition-all duration-300",children:Je.jsxs("div",{className:"p-6",children:[Je.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Je.jsxs("div",{className:"flex items-start space-x-4",children:[Je.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/10 border border-white/20 flex items-center justify-center",children:S(e.type)}),Je.jsxs("div",{className:"flex-1",children:[Je.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[Je.jsx("h3",{className:"text-lg font-semibold text-white",children:e.title}),Je.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${_(e.type)}`,children:E(e.type)})]}),e.patientName&&Je.jsxs("p",{className:"text-white/60 text-sm",children:["Paciente: ",e.patientName]}),Je.jsxs("p",{className:"text-white/40 text-xs",children:["Criado em ",(t=e.createdAt,new Date(t).toLocaleDateString("pt-BR"))]})]})]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("button",{onClick:()=>{return t=e.id,void N(y===t?null:t);var t},className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-300",children:y===e.id?Je.jsx(Re,{className:"w-4 h-4"}):Je.jsx(Le,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-300",children:Je.jsx(ze,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-2 text-white/60 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-300",children:Je.jsx(U,{className:"w-4 h-4"})})]})]}),y===e.id&&Je.jsxs("div",{className:"border-t border-white/10 pt-4 space-y-4",children:[e.content&&Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-sm font-medium text-white/80 mb-2",children:"Conteúdo"}),Je.jsx("p",{className:"text-white/70 text-sm leading-relaxed",children:e.content})]}),e.recommendations&&Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-sm font-medium text-white/80 mb-2",children:"Recomendações"}),Je.jsx("p",{className:"text-white/70 text-sm leading-relaxed",children:e.recommendations})]}),e.nextSteps&&Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-sm font-medium text-white/80 mb-2",children:"Próximos Passos"}),Je.jsx("p",{className:"text-white/70 text-sm leading-relaxed",children:e.nextSteps})]}),Je.jsxs("div",{className:"flex space-x-3 pt-4",children:[Je.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-colors duration-300",children:[Je.jsx(ce,{className:"w-4 h-4"}),Je.jsx("span",{className:"text-sm",children:"Visualizar"})]}),Je.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-colors duration-300",children:[Je.jsx(ie,{className:"w-4 h-4"}),Je.jsx("span",{className:"text-sm",children:"Editar"})]}),Je.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-white/10 border border-white/20 text-white rounded-lg hover:bg-white/20 transition-colors duration-300",children:[Je.jsx(ze,{className:"w-4 h-4"}),Je.jsx("span",{className:"text-sm",children:"Exportar"})]})]})]})]})},e.id);var t}),0===n.length&&Je.jsxs("div",{className:"text-center py-12",children:[Je.jsx(je,{className:"w-12 h-12 text-white/40 mx-auto mb-4"}),Je.jsx("h3",{className:"text-lg font-medium text-white/60 mb-2",children:"Nenhum relatório encontrado"}),Je.jsx("p",{className:"text-white/40",children:"Comece criando seu primeiro relatório"})]})]}),b&&Je.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:Je.jsxs("div",{className:"bg-gray-900 border border-white/20 rounded-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h2",{className:"text-xl font-semibold text-white",children:"Novo Relatório"}),Je.jsx("button",{onClick:()=>w(!1),className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(v,{className:"w-5 h-5"})})]}),Je.jsxs("form",{onSubmit:s=>p(e,null,function*(){if(s.preventDefault(),null==t?void 0:t.uid)try{u(d({},j),{psychologistId:t.uid}),(yield p(e,null,function*(){try{return{success:!0,data:{id:Date.now().toString()}}}catch(e){return{success:!1,error:e.message}}})).success&&(w(!1),C({title:"",type:"patient-progress",patientId:"",patientName:"",content:"",recommendations:"",nextSteps:""}),k())}catch(r){}}),className:"space-y-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Título do Relatório"}),Je.jsx("input",{type:"text",required:!0,value:j.title,onChange:e=>C(u(d({},j),{title:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Título do relatório"})]}),Je.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Tipo de Relatório"}),Je.jsxs("select",{value:j.type,onChange:e=>C(u(d({},j),{type:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:"patient-progress",children:"Progresso do Paciente"}),Je.jsx("option",{value:"session-summary",children:"Resumo da Sessão"}),Je.jsx("option",{value:"treatment-plan",children:"Plano de Tratamento"}),Je.jsx("option",{value:"assessment",children:"Avaliação"})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Nome do Paciente"}),Je.jsx("input",{type:"text",value:j.patientName,onChange:e=>C(u(d({},j),{patientName:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Nome do paciente (opcional)"})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Conteúdo do Relatório"}),Je.jsx("textarea",{value:j.content,onChange:e=>C(u(d({},j),{content:e.target.value})),rows:"4",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Descreva o conteúdo do relatório..."})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Recomendações"}),Je.jsx("textarea",{value:j.recommendations,onChange:e=>C(u(d({},j),{recommendations:e.target.value})),rows:"3",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Recomendações baseadas no relatório..."})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Próximos Passos"}),Je.jsx("textarea",{value:j.nextSteps,onChange:e=>C(u(d({},j),{nextSteps:e.target.value})),rows:"3",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Próximos passos a serem tomados..."})]}),Je.jsxs("div",{className:"flex space-x-3 pt-4",children:[Je.jsx("button",{type:"button",onClick:()=>w(!1),className:"flex-1 px-4 py-2 border border-white/20 text-white rounded-lg hover:bg-white/10 transition-colors duration-300",children:"Cancelar"}),Je.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-white text-black rounded-lg font-medium hover:bg-white/90 transition-colors duration-300",children:"Criar Relatório"})]})]})]})})]})},sN=()=>{const{user:t}=Vb(),[s,r]=f.useState([]),[n,i]=f.useState([]),[a,o]=f.useState(!0),[l,c]=f.useState(""),[h,m]=f.useState("all"),[g,x]=f.useState("all"),[b,w]=f.useState(!1);f.useState(new Date);const[y,N]=f.useState({patientId:"",patientName:"",scheduledDate:"",scheduledTime:"",duration:50,type:"online",notes:"",status:"scheduled"});f.useEffect(()=>{j()},[null==t?void 0:t.uid]),f.useEffect(()=>{let e=s;if(l&&(e=e.filter(e=>{var t;return e.patientName.toLowerCase().includes(l.toLowerCase())||(null==(t=e.notes)?void 0:t.toLowerCase().includes(l.toLowerCase()))})),"all"!==h&&(e=e.filter(e=>e.status===h)),"today"===g){const t=new Date;e=e.filter(e=>new Date(e.scheduledDate).toDateString()===t.toDateString())}else if("week"===g){const t=new Date,s=new Date(t.getTime()+6048e5);e=e.filter(e=>{const r=new Date(e.scheduledDate);return r>=t&&r<=s})}i(e)},[s,l,h,g]);const j=()=>p(e,null,function*(){if(null==t?void 0:t.uid){o(!0);try{const e=yield Ry(t.uid);e.success&&r(e.data)}catch(e){}finally{o(!1)}}}),C=(t,s)=>p(e,null,function*(){try{const r=yield((t,s)=>p(e,null,function*(){try{const e=new Ay;return yield e.updateSessionStatus(t,s.status),{success:!0}}catch(e){return{success:!1,error:e.message}}}))(t,{status:s});r.success&&j()}catch(r){}}),E=e=>{switch(e){case"completed":return"bg-green-500/20 text-green-400 border-green-500/30";case"scheduled":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"cancelled":return"bg-red-500/20 text-red-400 border-red-500/30";case"in-progress":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},_=e=>{switch(e){case"completed":return Je.jsx(te,{className:"w-4 h-4"});case"scheduled":default:return Je.jsx(oe,{className:"w-4 h-4"});case"cancelled":return Je.jsx(Ve,{className:"w-4 h-4"});case"in-progress":return Je.jsx(Fe,{className:"w-4 h-4"})}},T=e=>{switch(e){case"completed":return"Concluída";case"scheduled":return"Agendada";case"cancelled":return"Cancelada";case"in-progress":return"Em Andamento";default:return"Pendente"}},I=e=>{switch(e){case"online":default:return Je.jsx(Ue,{className:"w-4 h-4"});case"phone":return Je.jsx(k,{className:"w-4 h-4"});case"in-person":return Je.jsx(S,{className:"w-4 h-4"})}},A=e=>{switch(e){case"online":default:return"Online";case"phone":return"Telefone";case"in-person":return"Presencial"}},D=e=>new Date(e).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});return a?Je.jsx("div",{className:"flex items-center justify-center h-64",children:Je.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}):Je.jsxs("div",{className:"space-y-6",children:[Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsxs("div",{children:[Je.jsx("h1",{className:"text-2xl font-bold text-white",children:"Sessões"}),Je.jsx("p",{className:"text-white/60",children:"Gerencie sua agenda de sessões de terapia"})]}),Je.jsxs("button",{onClick:()=>w(!0),className:"flex items-center space-x-2 bg-white text-black px-4 py-2 rounded-lg font-medium hover:bg-white/90 transition-all duration-300",children:[Je.jsx(H,{className:"w-4 h-4"}),"Nova Sessão"]})]}),Je.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[Je.jsxs("div",{className:"flex-1 relative",children:[Je.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"text",placeholder:"Buscar sessões...",value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300"})]}),Je.jsxs("select",{value:h,onChange:e=>m(e.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:"all",children:"Todos os status"}),Je.jsx("option",{value:"scheduled",children:"Agendadas"}),Je.jsx("option",{value:"in-progress",children:"Em Andamento"}),Je.jsx("option",{value:"completed",children:"Concluídas"}),Je.jsx("option",{value:"cancelled",children:"Canceladas"})]}),Je.jsxs("select",{value:g,onChange:e=>x(e.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:"all",children:"Todas as datas"}),Je.jsx("option",{value:"today",children:"Hoje"}),Je.jsx("option",{value:"week",children:"Esta semana"})]})]}),Je.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 border border-blue-500/30 flex items-center justify-center",children:Je.jsx(F,{className:"w-5 h-5 text-blue-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"scheduled"===e.status).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Agendadas"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-yellow-500/20 border border-yellow-500/30 flex items-center justify-center",children:Je.jsx(oe,{className:"w-5 h-5 text-yellow-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"in-progress"===e.status).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Em Andamento"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-500/20 border border-green-500/30 flex items-center justify-center",children:Je.jsx(te,{className:"w-5 h-5 text-green-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"completed"===e.status).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Concluídas"})]})]})}),Je.jsx("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500/20 border border-purple-500/30 flex items-center justify-center",children:Je.jsx(oe,{className:"w-5 h-5 text-purple-400"})}),Je.jsxs("div",{children:[Je.jsx("div",{className:"text-2xl font-bold text-white",children:s.filter(e=>"scheduled"===e.status&&new Date(e.scheduledDate)>new Date).length}),Je.jsx("div",{className:"text-sm text-white/60",children:"Próximas"})]})]})})]}),Je.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-xl overflow-hidden",children:[Je.jsx("div",{className:"overflow-x-auto",children:Je.jsxs("table",{className:"w-full",children:[Je.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:Je.jsxs("tr",{children:[Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Paciente"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Data & Hora"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Tipo"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Duração"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Status"}),Je.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/60 uppercase tracking-wider",children:"Ações"})]})}),Je.jsx("tbody",{className:"divide-y divide-white/10",children:n.map(e=>{return Je.jsxs("tr",{className:"hover:bg-white/5 transition-colors duration-200",children:[Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Je.jsxs("div",{className:"flex items-center",children:[Je.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:Je.jsx("span",{className:"text-white font-medium text-sm",children:e.patientName.charAt(0).toUpperCase()})}),Je.jsxs("div",{className:"ml-4",children:[Je.jsx("div",{className:"text-sm font-medium text-white",children:e.patientName}),Je.jsx("div",{className:"text-sm text-white/60",children:e.notes||"Sem observações"})]})]})}),Je.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[Je.jsx("div",{className:"text-sm text-white",children:(t=e.scheduledDate,new Date(t).toLocaleDateString("pt-BR"))}),Je.jsx("div",{className:"text-sm text-white/60",children:D(e.scheduledDate)})]}),Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Je.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white/10 text-white/80 border border-white/20",children:[I(e.type),Je.jsx("span",{className:"ml-1",children:A(e.type)})]})}),Je.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/60",children:[e.duration," min"]}),Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Je.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${E(e.status)}`,children:[_(e.status),Je.jsx("span",{className:"ml-1",children:T(e.status)})]})}),Je.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Je.jsxs("div",{className:"flex items-center space-x-2",children:["scheduled"===e.status&&Je.jsxs(Je.Fragment,{children:[Je.jsx("button",{onClick:()=>C(e.id,"in-progress"),className:"p-1 text-blue-400 hover:text-blue-300 hover:bg-blue-500/10 rounded transition-colors duration-200",title:"Iniciar sessão",children:Je.jsx($e,{className:"w-4 h-4"})}),Je.jsx("button",{onClick:()=>C(e.id,"cancelled"),className:"p-1 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded transition-colors duration-200",title:"Cancelar sessão",children:Je.jsx(Ve,{className:"w-4 h-4"})})]}),"in-progress"===e.status&&Je.jsx("button",{onClick:()=>C(e.id,"completed"),className:"p-1 text-green-400 hover:text-green-300 hover:bg-green-500/10 rounded transition-colors duration-200",title:"Finalizar sessão",children:Je.jsx(te,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(ce,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(ie,{className:"w-4 h-4"})}),Je.jsx("button",{className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(U,{className:"w-4 h-4"})})]})})]},e.id);var t})})]})}),0===n.length&&Je.jsxs("div",{className:"text-center py-12",children:[Je.jsx(F,{className:"w-12 h-12 text-white/40 mx-auto mb-4"}),Je.jsx("h3",{className:"text-lg font-medium text-white/60 mb-2",children:"Nenhuma sessão encontrada"}),Je.jsx("p",{className:"text-white/40",children:"Comece agendando sua primeira sessão"})]})]}),b&&Je.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:Je.jsxs("div",{className:"bg-gray-900 border border-white/20 rounded-xl p-6 w-full max-w-md mx-4",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h2",{className:"text-xl font-semibold text-white",children:"Nova Sessão"}),Je.jsx("button",{onClick:()=>w(!1),className:"p-1 text-white/60 hover:text-white hover:bg-white/10 rounded transition-colors duration-200",children:Je.jsx(v,{className:"w-5 h-5"})})]}),Je.jsxs("form",{onSubmit:s=>p(e,null,function*(){if(s.preventDefault(),null==t?void 0:t.uid)try{const s=u(d({},y),{psychologistId:t.uid,scheduledDate:new Date(y.scheduledDate+"T"+y.scheduledTime)}),r=yield(t=>p(e,null,function*(){try{const e=new Ay;return{success:!0,data:{id:yield e.createSession(t.psychologistId,t)}}}catch(e){return{success:!1,error:e.message}}}))(s);r.success&&(w(!1),N({patientId:"",patientName:"",scheduledDate:"",scheduledTime:"",duration:50,type:"online",notes:"",status:"scheduled"}),j())}catch(r){}}),className:"space-y-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Nome do Paciente"}),Je.jsx("input",{type:"text",required:!0,value:y.patientName,onChange:e=>N(u(d({},y),{patientName:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Nome do paciente"})]}),Je.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Data"}),Je.jsx("input",{type:"date",required:!0,value:y.scheduledDate,onChange:e=>N(u(d({},y),{scheduledDate:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Hora"}),Je.jsx("input",{type:"time",required:!0,value:y.scheduledTime,onChange:e=>N(u(d({},y),{scheduledTime:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300"})]})]}),Je.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Duração (min)"}),Je.jsxs("select",{value:y.duration,onChange:e=>N(u(d({},y),{duration:parseInt(e.target.value)})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:30,children:"30 min"}),Je.jsx("option",{value:45,children:"45 min"}),Je.jsx("option",{value:50,children:"50 min"}),Je.jsx("option",{value:60,children:"60 min"}),Je.jsx("option",{value:90,children:"90 min"})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Tipo"}),Je.jsxs("select",{value:y.type,onChange:e=>N(u(d({},y),{type:e.target.value})),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",children:[Je.jsx("option",{value:"online",children:"Online"}),Je.jsx("option",{value:"phone",children:"Telefone"}),Je.jsx("option",{value:"in-person",children:"Presencial"})]})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Observações"}),Je.jsx("textarea",{value:y.notes,onChange:e=>N(u(d({},y),{notes:e.target.value})),rows:"3",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300",placeholder:"Observações sobre a sessão..."})]}),Je.jsxs("div",{className:"flex space-x-3 pt-4",children:[Je.jsx("button",{type:"button",onClick:()=>w(!1),className:"flex-1 px-4 py-2 border border-white/20 text-white rounded-lg hover:bg-white/10 transition-colors duration-300",children:"Cancelar"}),Je.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-white text-black rounded-lg font-medium hover:bg-white/90 transition-colors duration-300",children:"Agendar"})]})]})]})})]})},rN=()=>{const t=Ot(),{user:s}=Vb(),[r,n]=f.useState("overview"),[i,a]=f.useState(""),[o,l]=f.useState(!1),[c,d]=f.useState(!0),[u,h]=f.useState({patients:[],sessions:[],stats:{activePatients:0,totalSessions:0,successRate:0,avgSessionTime:0,rating:0,newPatients:0}}),m=f.useMemo(()=>[{id:1,title:"Pacientes Ativos",subtitle:"Em tratamento",value:u.stats.activePatients.toString(),change:"+12%",trend:"up",icon:A,bars:[80,60,90,70,85]},{id:2,title:"Sessões Realizadas",subtitle:"Este mês",value:u.stats.totalSessions.toString(),change:"+8%",trend:"up",icon:F,bars:[65,85,70,90,75]},{id:3,title:"Taxa de Sucesso",subtitle:"Tratamentos",value:`${u.stats.successRate}%`,change:"+5%",trend:"up",icon:je,bars:[90,85,95,80,88]},{id:4,title:"Tempo Médio",subtitle:"Por sessão",value:`${u.stats.avgSessionTime}min`,change:"-3%",trend:"down",icon:oe,bars:[70,60,80,65,75]},{id:5,title:"Avaliações",subtitle:"Satisfação",value:u.stats.rating.toString(),change:"+0.2",trend:"up",icon:j,bars:[85,90,80,95,88]},{id:6,title:"Novos Pacientes",subtitle:"Esta semana",value:u.stats.newPatients.toString(),change:"+25%",trend:"up",icon:xe,bars:[60,75,85,70,80]}],[u.stats]),g=f.useMemo(()=>u.patients.slice(0,3),[u.patients]),x=f.useMemo(()=>u.sessions.slice(0,3),[u.sessions]),v=()=>{n("sessions")};return f.useEffect(()=>{localStorage.getItem(`psychologist-tour-${null==s?void 0:s.uid}`)||l(!0)},[null==s?void 0:s.uid]),f.useEffect(()=>{p(e,null,function*(){if(null==s?void 0:s.uid){d(!0);try{const r=yield(t=s.uid,p(e,null,function*(){try{const e=new Ay;return{success:!0,data:yield e.getDashboardStats(t)}}catch(e){return{success:!1,error:e.message}}}));let n={activePatients:0,totalSessions:0,successRate:87,avgSessionTime:45,rating:4.8,newPatients:0};r.success&&(n=r.data);const i=yield Py(s.uid);let a=[];i.success&&(a=i.data);const o=yield Ry(s.uid);let l=[];o.success&&(l=o.data),h({patients:a,sessions:l,stats:n})}catch(r){}finally{d(!1)}var t}})},[null==s?void 0:s.uid]),c?Je.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:Je.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[Je.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-b-2 border-white"}),Je.jsx("p",{className:"text-white/70 text-lg",children:"Carregando dados..."})]})}):Je.jsxs("div",{className:"min-h-screen bg-black text-white relative overflow-hidden",children:[Je.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(30)].map((e,t)=>Je.jsx("div",{className:"floating-particle",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:6*Math.random()+"s",animationDuration:4+4*Math.random()+"s"}},t))}),Je.jsx("header",{className:"bg-white/5 backdrop-blur-xl border-b border-white/10 px-6 py-5",children:Je.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[Je.jsxs("div",{className:"flex items-center space-x-4",children:[Je.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/10 border border-white/20 flex items-center justify-center",children:Je.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-8 h-8 object-contain"})}),Je.jsxs("div",{children:[Je.jsx("h1",{className:"text-2xl font-bold text-white",children:"MONITORAMENTO"}),Je.jsxs("p",{className:"text-base text-white/60",children:["Olá, ",(null==s?void 0:s.displayName)||"Psicólogo","! 👋"]})]})]}),Je.jsx("div",{className:"flex-1 max-w-md",children:Je.jsxs("div",{className:"relative",children:[Je.jsx(B,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/50"}),Je.jsx("input",{type:"text",placeholder:"Buscar pacientes, sessões...",value:i,onChange:e=>a(e.target.value),className:"w-full pl-12 pr-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-300"})]})}),Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("button",{className:"p-2.5 text-white/70 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-300",children:Je.jsx(_e,{className:"w-5 h-5"})}),Je.jsx("button",{className:"p-2.5 text-white/70 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-300",children:Je.jsx(M,{className:"w-5 h-5"})}),Je.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:Je.jsx(J,{className:"w-5 h-5 text-white"})}),Je.jsx("button",{onClick:()=>{t("/login")},className:"p-2.5 text-white/70 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-300",children:Je.jsx(Ie,{className:"w-5 h-5"})})]})]})}),Je.jsx("nav",{className:"bg-white/5 border-b border-white/10 px-6",children:Je.jsx("div",{className:"flex space-x-1",children:[{id:"overview",label:"Visão Geral",icon:Ne},{id:"patients",label:"Pacientes",icon:A},{id:"sessions",label:"Sessões",icon:F},{id:"reports",label:"Relatórios",icon:je},{id:"messages",label:"Mensagens",icon:D}].map(e=>Je.jsxs("button",{onClick:()=>n(e.id),className:"flex items-center space-x-2 py-4 px-4 border-b-2 transition-all duration-300 "+(r===e.id?"border-white text-white":"border-transparent text-white/60 hover:text-white/80"),children:[Je.jsx(e.icon,{className:"w-5 h-5"}),Je.jsx("span",{className:"text-sm font-medium",children:e.label})]},e.id))})}),Je.jsx("main",{className:"p-6",children:(()=>{switch(r){case"overview":return Je.jsxs("div",{className:"space-y-8",children:[Je.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(e=>Je.jsxs("div",{className:"monitoring-card bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 hover:bg-white/[0.07] hover:border-white/20 transition-all duration-500 hover:scale-[1.02] hover:shadow-[0_20px_60px_rgba(255,255,255,0.1)] group",children:[Je.jsxs("div",{className:"flex items-start justify-between mb-6",children:[Je.jsxs("div",{className:"flex items-center space-x-4",children:[Je.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/10 border border-white/20 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:Je.jsx(e.icon,{className:"w-6 h-6 text-white"})}),Je.jsxs("div",{children:[Je.jsx("h3",{className:"text-white font-medium text-base",children:e.title}),Je.jsx("p",{className:"text-white/60 text-sm",children:e.subtitle})]})]}),Je.jsxs("div",{className:"text-right text-white",children:[Je.jsx("div",{className:"text-xl font-bold",children:e.value}),Je.jsx("div",{className:"text-xs text-white/70",children:e.change})]})]}),Je.jsx("div",{className:"chart-container flex items-end justify-between space-x-1.5 h-20",children:e.bars.map((e,t)=>Je.jsx("div",{className:"chart-bar flex-1 bg-white/60 rounded-t-md group-hover:bg-white transition-all duration-300",style:{height:`${e}%`}},t))})]},e.id))}),Je.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[Je.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h3",{className:"text-xl font-bold text-white",children:"Pacientes Recentes"}),Je.jsxs("button",{onClick:()=>n("patients"),className:"text-white/60 hover:text-white text-sm font-medium transition-colors duration-300 flex items-center space-x-1",children:[Je.jsx("span",{children:"Ver todos"}),Je.jsx(ye,{className:"w-4 h-4"})]})]}),Je.jsxs("div",{className:"space-y-4",children:[g.map(e=>Je.jsxs("div",{onClick:()=>(e.id,void n("patients")),className:"flex items-center justify-between p-4 bg-white/5 rounded-xl hover:bg-white/10 transition-all duration-300 cursor-pointer group",children:[Je.jsxs("div",{className:"flex items-center space-x-4",children:[Je.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:Je.jsx(J,{className:"w-6 h-6 text-white"})}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-white font-medium text-base",children:e.name}),Je.jsxs("p",{className:"text-white/60 text-sm",children:["Última sessão: ",e.lastSession?new Date(e.lastSession).toLocaleDateString("pt-BR"):"Nunca"]})]})]}),Je.jsxs("div",{className:"text-right",children:[Je.jsxs("div",{className:"text-xs text-white/60 mb-2",children:["Próxima: ",e.nextSession||"Não agendada"]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("div",{className:"w-20 bg-white/20 rounded-full h-2.5",children:Je.jsx("div",{className:"h-2.5 rounded-full bg-white",style:{width:`${e.progress||0}%`}})}),Je.jsxs("span",{className:"text-xs text-white/60",children:[e.progress||0,"%"]})]})]})]},e.id)),0===g.length&&Je.jsxs("div",{className:"text-center py-10",children:[Je.jsx(A,{className:"w-12 h-12 text-white/40 mx-auto mb-4"}),Je.jsx("p",{className:"text-white/40 text-base",children:"Nenhum paciente ainda"})]})]})]}),Je.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsx("h3",{className:"text-xl font-bold text-white",children:"Próximas Sessões"}),Je.jsxs("button",{onClick:v,className:"flex items-center space-x-2 bg-white text-black px-4 py-2 rounded-xl text-sm font-bold hover:bg-white/90 transition-all duration-300",children:[Je.jsx(H,{className:"w-4 h-4"}),Je.jsx("span",{children:"Nova"})]})]}),Je.jsxs("div",{className:"space-y-4",children:[x.map(e=>Je.jsxs("div",{onClick:()=>(e.id,void n("sessions")),className:"flex items-center justify-between p-4 bg-white/5 rounded-xl hover:bg-white/10 transition-all duration-300 cursor-pointer group",children:[Je.jsxs("div",{className:"flex items-center space-x-4",children:[Je.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:Je.jsx(F,{className:"w-6 h-6 text-white"})}),Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-white font-medium text-base",children:e.patientName}),Je.jsxs("p",{className:"text-white/60 text-sm",children:[e.type||"Online"," • ",e.duration||50," min"]})]})]}),Je.jsxs("div",{className:"text-right",children:[Je.jsx("div",{className:"text-xl font-bold text-white",children:e.scheduledDate?new Date(e.scheduledDate).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):"--:--"}),Je.jsx("div",{className:"text-xs px-3 py-1 rounded-full "+("confirmed"===e.status?"bg-white/20 text-white":"bg-white/10 text-white/80"),children:"confirmed"===e.status?"Confirmado":"Pendente"})]})]},e.id)),0===x.length&&Je.jsxs("div",{className:"text-center py-10",children:[Je.jsx(F,{className:"w-12 h-12 text-white/40 mx-auto mb-4"}),Je.jsx("p",{className:"text-white/40 text-base",children:"Nenhuma sessão agendada"})]})]})]})]})]});case"patients":return Je.jsx(Zy,{});case"sessions":return Je.jsx(sN,{});case"reports":return Je.jsx(tN,{});case"messages":return Je.jsx(Xy,{});default:return null}})()}),Je.jsx(eN,{isOpen:o,onClose:()=>l(!1)}),Je.jsx("style",{children:"\n        .floating-particle {\n          position: absolute;\n          width: 6px;\n          height: 6px;\n          background: rgba(255, 255, 255, 0.15);\n          border-radius: 50%;\n          animation: float 6s infinite ease-in-out;\n        }\n        \n        @keyframes float {\n          0%, 100% {\n            transform: translateY(0px) translateX(0px);\n            opacity: 0;\n          }\n          50% {\n            transform: translateY(-30px) translateX(15px);\n            opacity: 1;\n          }\n        }\n        \n        .monitoring-card {\n          position: relative;\n          overflow: hidden;\n        }\n        \n        .monitoring-card::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: -100%;\n          width: 100%;\n          height: 100%;\n          background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);\n          transition: left 0.5s;\n        }\n        \n        .monitoring-card:hover::before {\n          left: 100%;\n        }\n        \n        .chart-bar {\n          transition: all 0.3s ease;\n        }\n        \n        .chart-bar:hover {\n          transform: scaleY(1.1);\n        }\n      "})]})},nN=()=>{const[t,s]=f.useState("cliente"),[r,n]=f.useState({name:"",username:"",email:"",birthDate:"",phone:"",password:"",confirmPassword:"",crp:"",specialty:"",yearsExperience:"",acceptsOnline:!1,bio:""}),[i,a]=f.useState(!1),[o,l]=f.useState(!1),[c,h]=f.useState(!1),[m,g]=f.useState(null),x=Ot(),v=e=>{const{name:t,value:s,type:i,checked:a}=e.target;n(u(d({},r),{[t]:"checkbox"===i?a:s}))};return Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center p-4 relative overflow-hidden text-white",children:[Je.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(8)].map((e,t)=>Je.jsx("div",{className:"absolute top-0 left-1/2 w-px h-full bg-gradient-to-b from-white/20 via-white/5 to-transparent transform-gpu origin-top",style:{transform:`translateX(-50%) rotate(${45*t}deg)`,animation:`pulse ${2+.5*t}s ease-in-out infinite alternate`}},t))}),Je.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(15)].map((e,t)=>Je.jsx("div",{className:"absolute w-1 h-1 bg-white/20 rounded-full animate-pulse",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:3*Math.random()+"s",animationDuration:2+2*Math.random()+"s"}},t))}),Je.jsxs("div",{className:"relative w-full max-w-md z-10 animate-fade-in animate-slide-up",children:[Je.jsx("button",{type:"button",onClick:()=>x("/"),className:"absolute -top-2 -left-2 p-2 text-white/80 hover:text-white transition-all duration-300 hover:scale-110 hover:rotate-12 group","aria-label":"Voltar para início",onMouseEnter:()=>g("back"),onMouseLeave:()=>g(null),children:Je.jsx(O,{className:"w-6 h-6 transition-all duration-300 "+("back"===m?"drop-shadow-[0_0_8px_rgba(255,255,255,0.5)]":"")})}),Je.jsxs("div",{className:"text-center mb-6",children:[Je.jsx("div",{className:"flex items-center justify-center mb-3",children:Je.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/10 border border-white/20 flex items-center justify-center backdrop-blur-md hover:scale-110 hover:rotate-12 transition-all duration-500 hover:bg-white/20 hover:shadow-[0_0_20px_rgba(255,255,255,0.3)] group cursor-pointer",children:Je.jsx("img",{src:"/Logo-Sereno3.png",alt:"Sereno Logo",className:"w-full h-full object-contain p-1",loading:"eager"})})}),Je.jsx("h1",{className:"text-2xl font-semibold text-white mb-1 hover:text-white/90 transition-colors duration-300",children:"Sereno"}),Je.jsx("p",{className:"text-white/60 text-sm hover:text-white/80 transition-colors duration-300",children:"Crie sua conta e comece hoje"})]}),Je.jsxs("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 shadow-2xl hover:bg-white/[0.07] hover:border-white/20 transition-all duration-500 hover:shadow-[0_20px_60px_rgba(255,255,255,0.1)] group",children:[Je.jsxs("div",{className:"mb-4",children:[Je.jsx("h2",{className:"text-xl font-light text-white mb-1 group-hover:text-white/95 transition-colors duration-300",children:"Criar Conta"}),Je.jsx("p",{className:"text-white/60 text-sm group-hover:text-white/70 transition-colors duration-300",children:"Leva menos de 2 minutos"})]}),Je.jsxs("div",{className:"mb-4",children:[Je.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[Je.jsx(y,{className:"w-3 h-3 text-white/40 animate-pulse"}),Je.jsx("span",{className:"text-xs text-white/60",children:"Tipo de usuário:"}),Je.jsx(y,{className:"w-3 h-3 text-white/40 animate-pulse",style:{animationDelay:"0.5s"}})]}),Je.jsxs("div",{className:"flex bg-white/10 rounded-lg p-1 border border-white/20 hover:border-white/30 transition-all duration-300 hover:bg-white/15",children:[Je.jsxs("button",{type:"button",onClick:()=>s("cliente"),className:"flex-1 flex items-center justify-center py-1.5 px-3 rounded-md transition-all duration-300 text-sm group "+("cliente"===t?"bg-white text-black shadow-lg scale-105 shadow-white/20":"text-white/70 hover:text-white hover:bg-white/10 hover:scale-105"),children:[Je.jsx(J,{className:"w-3 h-3 mr-1.5 transition-all duration-300 group-hover:scale-110"}),"Cliente"]}),Je.jsxs("button",{type:"button",onClick:()=>s("psicologo"),className:"flex-1 flex items-center justify-center py-1.5 px-3 rounded-md transition-all duration-300 text-sm group "+("psicologo"===t?"bg-white text-black shadow-lg scale-105 shadow-white/20":"text-white/70 hover:text-white hover:bg-white/10 hover:scale-105"),children:[Je.jsx(P,{className:"w-3 h-3 mr-1.5 transition-all duration-300 group-hover:scale-110"}),"Psicólogo"]})]})]}),Je.jsxs("form",{onSubmit:s=>p(e,null,function*(){if(s.preventDefault(),r.name&&r.username&&r.email&&r.birthDate&&r.phone&&r.password&&r.confirmPassword)if(r.password===r.confirmPassword)if(/^[a-zA-Z0-9_]{3,20}$/.test(r.username)){h(!0);try{const e=(yield Ko(Pb,r.email,r.password)).user;yield Jo(e,{displayName:r.name}),yield ov(ex(Lb,"users",e.uid),{displayName:r.name,username:r.username.toLowerCase(),email:r.email,birthDate:r.birthDate,phone:r.phone,role:t,createdAt:gv()}),"psicologo"===t&&(yield ov(ex(Lb,"PsychologistAccount",e.uid),{userId:e.uid,displayName:r.name,username:r.username.toLowerCase(),email:r.email,birthDate:r.birthDate,phone:r.phone,crp:r.crp,specialty:r.specialty,yearsExperience:r.yearsExperience,acceptsOnline:r.acceptsOnline,bio:r.bio,isAvailable:!0,rating:5,totalSessions:0,availableSlots:["09:00","10:00","11:00","14:00","15:00","16:00","17:00"],languages:["Português"],education:"Psicologia",approach:r.specialty,certifications:[],insurance:!1,virtualSessions:r.acceptsOnline,inPersonSessions:!0,createdAt:gv(),updatedAt:gv()})),alert("Conta criada com sucesso!"),x("psicologo"===t?"/psychologist-dashboard":"/connected")}catch(e){alert(e.message)}finally{h(!1)}}else alert("O username deve ter entre 3 e 20 caracteres e conter apenas letras, números e underscore (_).");else alert("As senhas não coincidem");else alert("Por favor, preencha todos os campos obrigatórios.")}),className:"space-y-4",children:[Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"name",className:"block text-xs font-light text-white/80",children:"Nome"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:v,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"Seu nome completo",required:!0})]})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"username",className:"block text-xs font-light text-white/80",children:"Username"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"text",id:"username",name:"username",value:r.username,onChange:v,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"seu_usuario",required:!0})]})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"email",className:"block text-xs font-light text-white/80",children:"E-mail"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:v,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"seu@email.com",required:!0})]})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"birthDate",className:"block text-xs font-light text-white/80",children:"Data de Nascimento"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"date",id:"birthDate",name:"birthDate",value:r.birthDate,onChange:v,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",required:!0})]})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"phone",className:"block text-xs font-light text-white/80",children:"Telefone"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:"tel",id:"phone",name:"phone",value:r.phone,onChange:v,className:"w-full pl-9 pr-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"(11) 99999-9999",required:!0})]})]}),"psicologo"===t&&Je.jsxs(Je.Fragment,{children:[Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"crp",className:"block text-xs font-light text-white/80",children:"CRP"}),Je.jsx("input",{type:"text",id:"crp",name:"crp",value:r.crp,onChange:v,className:"w-full px-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"CRP 00/00000",required:!0})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"specialty",className:"block text-xs font-light text-white/80",children:"Especialidade"}),Je.jsx("input",{type:"text",id:"specialty",name:"specialty",value:r.specialty,onChange:v,className:"w-full px-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"Ex.: TCC, Ansiedade, Depressão",required:!0})]}),Je.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"yearsExperience",className:"block text-xs font-light text-white/80",children:"Anos de experiência"}),Je.jsx("input",{type:"number",id:"yearsExperience",name:"yearsExperience",value:r.yearsExperience,onChange:v,className:"w-full px-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"0",min:"0",required:!0})]}),Je.jsxs("label",{className:"flex items-center justify-start gap-2 mt-5",children:[Je.jsx("input",{type:"checkbox",name:"acceptsOnline",checked:r.acceptsOnline,onChange:v,className:"w-3 h-3 rounded border-white/30 bg-black/40 text-white focus:ring-white/30 focus:ring-2"}),Je.jsx("span",{className:"text-xs text-white/80",children:"Atende online"})]})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"bio",className:"block text-xs font-light text-white/80",children:"Bio (opcional)"}),Je.jsx("textarea",{id:"bio",name:"bio",rows:"2",value:r.bio,onChange:v,className:"w-full px-4 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"Fale brevemente sobre sua abordagem."})]})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"password",className:"block text-xs font-light text-white/80",children:"Senha"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:i?"text":"password",id:"password",name:"password",value:r.password,onChange:v,className:"w-full pl-9 pr-10 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"••••••••",required:!0}),Je.jsx("button",{type:"button",onClick:()=>a(e=>!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white transition-colors",children:i?Je.jsx(de,{className:"w-4 h-4"}):Je.jsx(ce,{className:"w-4 h-4"})})]})]}),Je.jsxs("div",{className:"space-y-1",children:[Je.jsx("label",{htmlFor:"confirmPassword",className:"block text-xs font-light text-white/80",children:"Confirmar Senha"}),Je.jsxs("div",{className:"relative",children:[Je.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-white/50"}),Je.jsx("input",{type:o?"text":"password",id:"confirmPassword",name:"confirmPassword",value:r.confirmPassword,onChange:v,className:"w-full pl-9 pr-10 py-2.5 bg-black/40 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-white/30 focus:border-white/30 transition-all duration-200 text-sm",placeholder:"••••••••",required:!0}),Je.jsx("button",{type:"button",onClick:()=>l(e=>!e),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white transition-colors",children:o?Je.jsx(de,{className:"w-4 h-4"}):Je.jsx(ce,{className:"w-4 h-4"})})]})]}),Je.jsxs("button",{type:"submit",disabled:c,className:"w-full py-2.5 px-4 bg-white text-black hover:bg-white/90 disabled:bg-white/60 font-medium rounded-lg transition-all duration-300 transform hover:scale-[1.02] hover:shadow-[0_8px_30px_rgba(255,255,255,0.3)] disabled:scale-100 disabled:cursor-not-allowed shadow-lg text-sm group overflow-hidden relative",onMouseEnter:()=>g("submit"),onMouseLeave:()=>g(null),children:[Je.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full transition-transform duration-1000 "+("submit"!==m||c?"":"translate-x-full")}),c?Je.jsxs("div",{className:"flex items-center justify-center",children:[Je.jsx("div",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin mr-2"}),"Criando..."]}):Je.jsx("span",{className:"relative z-10",children:"Criar Conta"})]})]}),Je.jsx("div",{className:"mt-4 text-center",children:Je.jsxs("p",{className:"text-white/70 text-sm",children:["Já tem uma conta?"," ",Je.jsx("button",{onClick:()=>x("/login"),className:"text-white hover:text-white/80 font-medium transition-all duration-300 hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.5)] hover:scale-105 inline-block",children:"Fazer login"})]})})]}),Je.jsx("div",{className:"mt-6 text-center text-white/50 text-xs animate-fade-in",style:{animationDelay:"0.5s"},children:Je.jsxs("p",{className:"hover:text-white/70 transition-colors duration-300 cursor-default",children:["Conecte-se, Entenda-se, ",Je.jsx("span",{className:"text-white hover:drop-shadow-[0_0_8px_rgba(255,255,255,0.3)] transition-all duration-300",children:"Evolua."})]})})]})]})},iN=()=>{const t=Ot(),{user:s}=Vb(),[r,n]=f.useState("profile"),[i,a]=f.useState(!0),[o,l]=f.useState(!1),[c,h]=f.useState(""),[m,g]=f.useState(""),[x,v]=f.useState(!1),[b,w]=f.useState(""),[y,N]=f.useState(!1),[j,C]=f.useState({username:"",displayName:"",bio:"",location:"",website:"",language:"pt-BR"}),[k,S]=f.useState({emailNotifications:!0,pushNotifications:!0,messageNotifications:!0,groupNotifications:!0,sessionReminders:!0,moodReminders:!0,weeklyReports:!1}),[E,_]=f.useState({profileVisibility:"public",showEmail:!1,showPhone:!1,allowMessages:!0,allowFriendRequests:!0,showOnlineStatus:!0,dataSharing:!1}),[T,I]=f.useState({theme:"dark",fontSize:"medium",compactMode:!1,animations:!0});f.useEffect(()=>{p(e,null,function*(){var e;try{if(a(!0),s){const t=s.profileData||{};C({username:t.username||(null==(e=s.displayName)?void 0:e.toLowerCase().replace(/\s+/g,"."))||"",displayName:s.displayName||t.displayName||"",bio:t.bio||"",location:t.location||"",website:t.website||"",language:t.language||"pt-BR"}),S({emailNotifications:void 0===t.emailNotifications||t.emailNotifications,pushNotifications:void 0===t.pushNotifications||t.pushNotifications,messageNotifications:void 0===t.messageNotifications||t.messageNotifications,groupNotifications:void 0===t.groupNotifications||t.groupNotifications,sessionReminders:void 0===t.sessionReminders||t.sessionReminders,moodReminders:void 0===t.moodReminders||t.moodReminders,weeklyReports:t.weeklyReports||!1}),_({profileVisibility:t.profileVisibility||"public",showEmail:t.showEmail||!1,showPhone:t.showPhone||!1,allowMessages:void 0===t.allowMessages||t.allowMessages,allowFriendRequests:void 0===t.allowFriendRequests||t.allowFriendRequests,showOnlineStatus:void 0===t.showOnlineStatus||t.showOnlineStatus,dataSharing:t.dataSharing||!1})}}catch(t){g("Erro ao carregar configurações")}finally{a(!1)}})},[s]);const A=(e,t,s)=>{switch(e){case"profile":C(e=>u(d({},e),{[t]:s}));break;case"notifications":S(e=>u(d({},e),{[t]:s}));break;case"privacy":_(e=>u(d({},e),{[t]:s}));break;case"appearance":I(e=>u(d({},e),{[t]:s}))}};return i?Je.jsx("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:Je.jsxs("div",{className:"flex items-center justify-center py-12",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("span",{className:"ml-3 text-white/70",children:"Carregando configurações..."})]})}):s?Je.jsxs("div",{className:"min-h-screen bg-black py-8 animation-initial animate-fade-in-up animation-delay-100",children:[Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Je.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[Je.jsx(M,{className:"w-6 h-6 text-gray-400"}),Je.jsx("h2",{className:"text-xl font-semibold text-white",children:"Configurações"})]}),Je.jsx("div",{className:"flex space-x-1 bg-white/5 rounded-lg p-1",children:[{id:"profile",name:"Perfil",icon:J},{id:"notifications",name:"Notificações",icon:_e},{id:"privacy",name:"Privacidade",icon:L},{id:"account",name:"Conta",icon:q}].map(e=>{const t=e.icon;return Je.jsxs("button",{onClick:()=>n(e.id),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 flex items-center justify-center space-x-2 "+(r===e.id?"bg-white text-black":"text-white/70 hover:text-white"),children:[Je.jsx(t,{className:"w-4 h-4"}),Je.jsx("span",{children:e.name})]},e.id)})})]}),c&&Je.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-xl p-4 text-green-300",children:c}),m&&Je.jsx("div",{className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 text-red-300",children:m}),"profile"===r&&Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Je.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configurações do Perfil"}),Je.jsxs("div",{className:"space-y-6",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Username da Plataforma"}),Je.jsx("input",{type:"text",value:j.username,onChange:e=>A("profile","username",e.target.value.toLowerCase()),placeholder:"Digite seu username",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all"}),Je.jsx("p",{className:"text-white/50 text-xs mt-1",children:"Este será seu identificador único na plataforma"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Nome de Exibição"}),Je.jsx("input",{type:"text",value:j.displayName,onChange:e=>A("profile","displayName",e.target.value),placeholder:"Digite seu nome completo",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Biografia"}),Je.jsx("textarea",{value:j.bio,onChange:e=>A("profile","bio",e.target.value),rows:"3",placeholder:"Conte um pouco sobre você...",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all resize-none"})]}),Je.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Localização"}),Je.jsx("input",{type:"text",value:j.location,onChange:e=>A("profile","location",e.target.value),placeholder:"Ex: São Paulo, SP",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all"})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Website"}),Je.jsx("input",{type:"url",value:j.website,onChange:e=>A("profile","website",e.target.value),placeholder:"https://seusite.com",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/50 focus:ring-2 focus:ring-white focus:border-transparent transition-all"})]})]}),Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Idioma"}),Je.jsxs("select",{value:j.language,onChange:e=>A("profile","language",e.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white focus:ring-2 focus:ring-white focus:border-transparent transition-all",children:[Je.jsx("option",{value:"pt-BR",children:"Português (Brasil)"}),Je.jsx("option",{value:"en-US",children:"English (US)"}),Je.jsx("option",{value:"es-ES",children:"Español"})]})]}),Je.jsx("div",{className:"flex justify-end",children:Je.jsx("button",{onClick:()=>p(e,null,function*(){try{l(!0),g(""),h(""),yield new Promise(e=>setTimeout(e,1e3)),h("Configurações de perfil salvas com sucesso!"),setTimeout(()=>h(""),3e3)}catch(e){g("Erro ao salvar configurações")}finally{l(!1)}}),disabled:o,className:"px-6 py-3 bg-white hover:bg-gray-100 disabled:bg-gray-800 disabled:cursor-not-allowed text-black rounded-lg font-medium transition-colors flex items-center space-x-2",children:o?Je.jsxs(Je.Fragment,{children:[Je.jsx("div",{className:"loading-spinner-small"}),Je.jsx("span",{children:"Salvando..."})]}):Je.jsxs(Je.Fragment,{children:[Je.jsx(Pe,{className:"w-4 h-4"}),Je.jsx("span",{children:"Salvar Perfil"})]})})})]})]}),"notifications"===r&&Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Je.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configurações de Notificação"}),Je.jsxs("div",{className:"space-y-6",children:[[{key:"emailNotifications",label:"Notificações por Email",description:"Receber notificações importantes por email"},{key:"pushNotifications",label:"Notificações Push",description:"Receber notificações no dispositivo"},{key:"messageNotifications",label:"Mensagens",description:"Notificar sobre novas mensagens"},{key:"groupNotifications",label:"Atividade em Grupos",description:"Notificar sobre atividades nos grupos"},{key:"sessionReminders",label:"Lembretes de Sessão",description:"Lembrar sobre sessões agendadas"},{key:"moodReminders",label:"Lembretes de Humor",description:"Lembrar de registrar seu humor diário"},{key:"weeklyReports",label:"Relatórios Semanais",description:"Receber resumo semanal de atividades"}].map(e=>Je.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-lg",children:[Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-white font-medium",children:e.label}),Je.jsx("p",{className:"text-white/60 text-sm",children:e.description})]}),Je.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[Je.jsx("input",{type:"checkbox",checked:k[e.key],onChange:t=>A("notifications",e.key,t.target.checked),className:"sr-only peer"}),Je.jsx("div",{className:"w-11 h-6 bg-white/20 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},e.key)),Je.jsx("div",{className:"flex justify-end",children:Je.jsx("button",{onClick:()=>p(e,null,function*(){try{l(!0),g(""),h(""),yield new Promise(e=>setTimeout(e,1e3)),h("Configurações de notificação salvas com sucesso!"),setTimeout(()=>h(""),3e3)}catch(e){g("Erro ao salvar configurações")}finally{l(!1)}}),disabled:o,className:"px-6 py-3 bg-white hover:bg-gray-100 disabled:bg-gray-800 disabled:cursor-not-allowed text-black rounded-lg font-medium transition-colors flex items-center space-x-2",children:o?Je.jsxs(Je.Fragment,{children:[Je.jsx("div",{className:"loading-spinner-small"}),Je.jsx("span",{children:"Salvando..."})]}):Je.jsxs(Je.Fragment,{children:[Je.jsx(Pe,{className:"w-4 h-4"}),Je.jsx("span",{children:"Salvar Notificações"})]})})})]})]}),"privacy"===r&&Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Je.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configurações de Privacidade"}),Je.jsxs("div",{className:"space-y-6",children:[Je.jsxs("div",{children:[Je.jsx("label",{className:"block text-white/70 text-sm font-medium mb-2",children:"Visibilidade do Perfil"}),Je.jsxs("select",{value:E.profileVisibility,onChange:e=>A("privacy","profileVisibility",e.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white focus:ring-2 focus:ring-white focus:border-transparent transition-all",children:[Je.jsx("option",{value:"public",children:"Público"}),Je.jsx("option",{value:"friends",children:"Apenas Amigos"}),Je.jsx("option",{value:"private",children:"Privado"})]})]}),[{key:"showEmail",label:"Mostrar Email",description:"Permitir que outros vejam seu email"},{key:"showPhone",label:"Mostrar Telefone",description:"Permitir que outros vejam seu telefone"},{key:"allowMessages",label:"Permitir Mensagens",description:"Permitir que outros te enviem mensagens"},{key:"allowFriendRequests",label:"Permitir Solicitações",description:"Permitir solicitações de amizade"},{key:"showOnlineStatus",label:"Mostrar Status Online",description:"Mostrar quando você está online"},{key:"dataSharing",label:"Compartilhar Dados",description:"Permitir compartilhamento de dados para pesquisas"}].map(e=>Je.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-lg",children:[Je.jsxs("div",{children:[Je.jsx("h4",{className:"text-white font-medium",children:e.label}),Je.jsx("p",{className:"text-white/60 text-sm",children:e.description})]}),Je.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[Je.jsx("input",{type:"checkbox",checked:E[e.key],onChange:t=>A("privacy",e.key,t.target.checked),className:"sr-only peer"}),Je.jsx("div",{className:"w-11 h-6 bg-white/20 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},e.key)),Je.jsx("div",{className:"flex justify-end",children:Je.jsx("button",{onClick:()=>p(e,null,function*(){try{l(!0),g(""),h(""),yield new Promise(e=>setTimeout(e,1e3)),h("Configurações de privacidade salvas com sucesso!"),setTimeout(()=>h(""),3e3)}catch(e){g("Erro ao salvar configurações")}finally{l(!1)}}),disabled:o,className:"px-6 py-3 bg-white hover:bg-gray-100 disabled:bg-gray-800 disabled:cursor-not-allowed text-black rounded-lg font-medium transition-colors flex items-center space-x-2",children:o?Je.jsxs(Je.Fragment,{children:[Je.jsx("div",{className:"loading-spinner-small"}),Je.jsx("span",{children:"Salvando..."})]}):Je.jsxs(Je.Fragment,{children:[Je.jsx(Pe,{className:"w-4 h-4"}),Je.jsx("span",{children:"Salvar Privacidade"})]})})})]})]}),"account"===r&&Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Je.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Configurações da Conta"}),Je.jsx("div",{className:"space-y-6",children:Je.jsxs("div",{className:"border border-red-500/30 rounded-xl p-6 bg-red-500/5",children:[Je.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Je.jsx(q,{className:"w-6 h-6 text-red-400"}),Je.jsx("h4",{className:"text-lg font-semibold text-red-400",children:"Zona de Perigo"})]}),Je.jsx("p",{className:"text-white/70 mb-4",children:"As ações abaixo são irreversíveis e resultarão na perda permanente de todos os seus dados."}),Je.jsx("div",{className:"space-y-4",children:Je.jsxs("div",{className:"p-4 bg-red-500/10 rounded-lg border border-red-500/20",children:[Je.jsx("h5",{className:"font-medium text-red-300 mb-2",children:"Excluir Conta Permanentemente"}),Je.jsx("p",{className:"text-white/60 text-sm mb-4",children:"Esta ação irá:"}),Je.jsxs("ul",{className:"text-white/60 text-sm space-y-1 mb-4",children:[Je.jsx("li",{children:"• Deletar todos os seus dados pessoais"}),Je.jsx("li",{children:"• Remover todos os seus posts e comentários"}),Je.jsx("li",{children:"• Excluir seu perfil e configurações"}),Je.jsx("li",{children:"• Encerrar sua conta de autenticação"}),Je.jsxs("li",{children:["• ",Je.jsx("strong",{children:"Esta ação não pode ser desfeita"})]})]}),Je.jsxs("button",{onClick:()=>{v(!0),w(""),g("")},className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors flex items-center space-x-2",children:[Je.jsx(q,{className:"w-4 h-4"}),Je.jsx("span",{children:"Excluir Minha Conta"})]})]})})]})})]}),x&&Je.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Je.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 max-w-md w-full border border-red-500/30",children:[Je.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Je.jsx("div",{className:"w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center",children:Je.jsx(q,{className:"w-6 h-6 text-red-400"})}),Je.jsxs("div",{children:[Je.jsx("h3",{className:"text-xl font-semibold text-white",children:"Excluir Conta"}),Je.jsx("p",{className:"text-white/60 text-sm",children:"Esta ação é irreversível"})]})]}),Je.jsxs("div",{className:"space-y-4 mb-6",children:[Je.jsxs("div",{className:"p-4 bg-red-500/10 rounded-lg border border-red-500/20",children:[Je.jsxs("p",{className:"text-white/70 text-sm",children:[Je.jsx("strong",{children:"Atenção:"})," Ao excluir sua conta, você perderá permanentemente:"]}),Je.jsxs("ul",{className:"text-white/60 text-sm mt-2 space-y-1",children:[Je.jsx("li",{children:"• Todos os seus posts e comentários"}),Je.jsx("li",{children:"• Seu perfil e configurações"}),Je.jsx("li",{children:"• Histórico de atividades"}),Je.jsx("li",{children:"• Dados de sessões e humor"})]})]}),Je.jsxs("div",{children:[Je.jsxs("label",{className:"block text-white/70 text-sm font-medium mb-2",children:["Digite ",Je.jsx("strong",{children:"EXCLUIR"})," para confirmar:"]}),Je.jsx("input",{type:"text",value:b,onChange:e=>w(e.target.value),placeholder:"EXCLUIR",className:"w-full px-4 py-3 bg-white/5 border border-red-500/30 rounded-lg text-white placeholder-white/30 focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"})]})]}),m&&Je.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-red-300 text-sm",children:m}),Je.jsxs("div",{className:"flex space-x-3",children:[Je.jsx("button",{onClick:()=>{v(!1),w(""),g("")},className:"flex-1 px-4 py-3 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors",children:"Cancelar"}),Je.jsx("button",{onClick:()=>p(e,null,function*(){if("EXCLUIR"===b)try{if(N(!0),g(""),!(null==s?void 0:s.uid))throw new Error("Usuário não autenticado");const e=ex(Lb,"users",s.uid);yield cv(e);const r=Pb.currentUser;r&&(yield Zo(r)),t("/login")}catch(e){g("Erro ao excluir conta. Tente novamente.")}finally{N(!1)}else g("Digite EXCLUIR para confirmar a exclusão da conta")}),disabled:y||"EXCLUIR"!==b,className:"flex-1 px-4 py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center space-x-2",children:y?Je.jsxs(Je.Fragment,{children:[Je.jsx("div",{className:"loading-spinner-small"}),Je.jsx("span",{children:"Excluindo..."})]}):Je.jsxs(Je.Fragment,{children:[Je.jsx(q,{className:"w-4 h-4"}),Je.jsx("span",{children:"Excluir Conta"})]})})]})]})})]}):Je.jsxs("div",{className:"text-center py-20",children:[Je.jsx("div",{className:"w-24 h-24 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:Je.jsx(pe,{className:"w-12 h-12 text-red-400"})}),Je.jsx("h3",{className:"text-xl text-white/60 mb-2",children:"Usuário não autenticado"}),Je.jsx("p",{className:"text-white/40 mb-6",children:"Faça login para acessar as configurações"}),Je.jsx("button",{onClick:()=>t("/login"),className:"px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-colors",children:"Ir para Login"})]})},aN=()=>{const[t,s]=f.useState(null),r=Ot(),[n,i]=f.useState("available"),[a,o]=f.useState(""),[l,c]=f.useState("all"),d=[{id:1,therapist:"Dra. Ana Silva",date:"2024-01-15",time:"14:00",duration:"50 min",type:"Online",status:"confirmed"},{id:2,therapist:"Dr. Carlos Santos",date:"2024-01-18",time:"10:00",duration:"50 min",type:"Presencial",status:"pending"}];f.useEffect(()=>{p(e,null,function*(){try{const e=Pb.currentUser;if(e){const t=ex(Lb,"users",e.uid),r=yield nv(t);r.exists()&&s(r.data())}}catch(e){}})},[]);const u=[{id:1,name:"Dra. Ana Silva",specialty:"Psicóloga Clínica",crp:"06/123456",rating:4.9,reviews:127,experience:"8 anos",acceptsOnline:!0,location:"São Paulo, SP",avatar:null,bio:"Especialista em ansiedade, depressão e estresse. Trabalho com abordagem cognitivo-comportamental e mindfulness.",availability:[{day:"Segunda",time:"14:00 - 18:00"},{day:"Terça",time:"09:00 - 17:00"},{day:"Quarta",time:"14:00 - 18:00"},{day:"Quinta",time:"09:00 - 17:00"},{day:"Sexta",time:"14:00 - 18:00"}],price:"R$ 150,00",sessionType:"Online/Presencial"},{id:2,name:"Dr. Carlos Santos",specialty:"Psicólogo",crp:"06/789012",rating:4.8,reviews:89,experience:"12 anos",acceptsOnline:!0,location:"Rio de Janeiro, RJ",avatar:null,bio:"Especialista em TDAH, autismo e desenvolvimento infantil. Abordagem humanista e integrativa.",availability:[{day:"Segunda",time:"08:00 - 16:00"},{day:"Terça",time:"08:00 - 16:00"},{day:"Quarta",time:"08:00 - 16:00"},{day:"Quinta",time:"08:00 - 16:00"},{day:"Sexta",time:"08:00 - 16:00"}],price:"R$ 180,00",sessionType:"Online/Presencial"},{id:3,name:"Dra. Maria Costa",specialty:"Psicóloga Especialista",crp:"06/345678",rating:4.7,reviews:156,experience:"15 anos",acceptsOnline:!1,location:"Belo Horizonte, MG",avatar:null,bio:"Especialista em trauma, TEPT e EMDR. Abordagem psicodinâmica e técnicas de reprocessamento.",availability:[{day:"Segunda",time:"13:00 - 19:00"},{day:"Terça",time:"13:00 - 19:00"},{day:"Quarta",time:"13:00 - 19:00"},{day:"Quinta",time:"13:00 - 19:00"},{day:"Sexta",time:"13:00 - 19:00"}],price:"R$ 200,00",sessionType:"Presencial"}].filter(e=>{const t=e.name.toLowerCase().includes(a.toLowerCase())||e.specialty.toLowerCase().includes(a.toLowerCase())||e.bio.toLowerCase().includes(a.toLowerCase()),s="all"===l||"online"===l&&e.acceptsOnline||"presencial"===l&&!e.acceptsOnline;return t&&s});return Je.jsx("div",{className:"min-h-screen bg-black py-8 animation-initial animate-fade-in-up animation-delay-100",children:Je.jsxs("div",{className:"bg-white/10 backdrop-blur-sm border border-gray-200/50 rounded-2xl p-6 shadow-2xl",children:[Je.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx(P,{className:"w-6 h-6 text-gray-400"}),Je.jsx("h2",{className:"text-xl font-semibold text-white",children:"Sessões de Terapia"})]}),Je.jsxs("button",{className:"bg-white/10 border border-white/30 text-white px-4 py-2 rounded-lg hover:bg-white/20 transition-all duration-300 text-sm",children:[Je.jsx(H,{className:"w-4 h-4 inline mr-2"}),"Nova Sessão"]})]}),Je.jsxs("div",{className:"flex space-x-1 mb-6 bg-white/5 rounded-lg p-1",children:[Je.jsx("button",{onClick:()=>i("available"),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 "+("available"===n?"bg-white text-black":"text-white/70 hover:text-white"),children:"Terapeutas Disponíveis"}),Je.jsx("button",{onClick:()=>i("scheduled"),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 "+("scheduled"===n?"bg-white text-black":"text-white/70 hover:text-white"),children:"Sessões Agendadas"})]}),"available"===n?Je.jsxs("div",{className:"space-y-4",children:[Je.jsxs("div",{className:"flex space-x-3",children:[Je.jsxs("div",{className:"relative flex-1",children:[Je.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50 w-4 h-4"}),Je.jsx("input",{type:"text",placeholder:"Pesquisar terapeutas...",value:a,onChange:e=>o(e.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg pl-10 pr-4 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30"})]}),Je.jsxs("select",{value:l,onChange:e=>c(e.target.value),className:"bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-white/30",children:[Je.jsx("option",{value:"all",children:"Todos"}),Je.jsx("option",{value:"online",children:"Online"}),Je.jsx("option",{value:"presencial",children:"Presencial"})]})]}),Je.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:u.map(e=>Je.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 hover:bg-white/10 transition-all duration-200",children:Je.jsxs("div",{className:"flex items-start space-x-4",children:[Je.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-full flex items-center justify-center flex-shrink-0",children:e.avatar?Je.jsx("img",{src:e.avatar,alt:"",className:"w-full h-full rounded-full"}):Je.jsx(J,{className:"w-8 h-8 text-white/70"})}),Je.jsxs("div",{className:"flex-1 min-w-0",children:[Je.jsxs("div",{className:"flex items-start justify-between mb-2",children:[Je.jsxs("div",{children:[Je.jsx("h3",{className:"font-medium text-white text-lg",children:e.name}),Je.jsx("p",{className:"text-white/70 text-sm",children:e.specialty}),Je.jsxs("p",{className:"text-white/50 text-xs",children:["CRP: ",e.crp]})]}),Je.jsxs("div",{className:"text-right",children:[Je.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[Je.jsx(j,{className:"w-4 h-4 text-yellow-400 fill-current"}),Je.jsx("span",{className:"text-white text-sm",children:e.rating}),Je.jsxs("span",{className:"text-white/50 text-xs",children:["(",e.reviews,")"]})]}),Je.jsx("p",{className:"text-white/70 text-sm",children:e.price})]})]}),Je.jsx("p",{className:"text-white/80 text-sm mb-3",children:e.bio}),Je.jsxs("div",{className:"flex items-center space-x-4 text-xs text-white/60 mb-3",children:[Je.jsxs("div",{className:"flex items-center space-x-1",children:[Je.jsx(oe,{className:"w-3 h-3"}),Je.jsx("span",{children:e.experience})]}),Je.jsxs("div",{className:"flex items-center space-x-1",children:[Je.jsx(S,{className:"w-3 h-3"}),Je.jsx("span",{children:e.location})]}),Je.jsxs("div",{className:"flex items-center space-x-1",children:[e.acceptsOnline?Je.jsx(Ue,{className:"w-3 h-3 text-green-400"}):Je.jsx(k,{className:"w-3 h-3 text-blue-400"}),Je.jsx("span",{children:e.sessionType})]})]}),Je.jsxs("div",{className:"flex space-x-2",children:[Je.jsx("button",{onClick:()=>r("/user/"+encodeURIComponent(e.name).toLowerCase().replace(/%20/g,"-")),className:"bg-white/10 border border-white/30 text-white px-4 py-2 rounded-lg hover:bg-white/20 transition-all duration-300 text-sm",children:"Ver Perfil"}),Je.jsx("button",{className:"bg-white text-black px-4 py-2 rounded-lg hover:bg-white/90 transition-all duration-300 text-sm",children:"Agendar"})]})]})]})},e.id))})]}):Je.jsx("div",{className:"space-y-4",children:0===d.length?Je.jsxs("div",{className:"text-center py-8",children:[Je.jsx(F,{className:"w-16 h-16 text-white/20 mx-auto mb-4"}),Je.jsx("p",{className:"text-white/50 text-lg",children:"Nenhuma sessão agendada"}),Je.jsx("p",{className:"text-white/30 text-sm mt-2",children:"Agende sua primeira sessão com um terapeuta"})]}):d.map(e=>Je.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:Je.jsxs("div",{className:"flex items-center justify-between",children:[Je.jsxs("div",{className:"flex items-center space-x-3",children:[Je.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full flex items-center justify-center",children:Je.jsx(J,{className:"w-6 h-6 text-white/70"})}),Je.jsxs("div",{children:[Je.jsx("h3",{className:"font-medium text-white",children:e.therapist}),Je.jsxs("div",{className:"flex items-center space-x-4 text-sm text-white/70",children:[Je.jsxs("span",{children:[e.date," às ",e.time]}),Je.jsx("span",{children:"•"}),Je.jsx("span",{children:e.duration}),Je.jsx("span",{children:"•"}),Je.jsx("span",{children:e.type})]})]})]}),Je.jsxs("div",{className:"flex items-center space-x-2",children:[Je.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("confirmed"===e.status?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"),children:"confirmed"===e.status?"Confirmada":"Pendente"}),Je.jsx("button",{className:"bg-white/10 border border-white/30 text-white p-2 rounded-lg hover:bg-white/20 transition-all duration-300",children:Je.jsx(Be,{className:"w-4 h-4"})})]})]})},e.id))})]})})},oN=()=>{const{userId:t}=Mt(),s=Ot(),{user:r}=Vb();f.useState(null);const[n,i]=f.useState(null),[a,o]=f.useState([]),[l,c]=f.useState(!0),[h,m]=f.useState(!1),[g,x]=f.useState(!1),[b,y]=f.useState(!1),[N,j]=f.useState(""),[C,k]=f.useState(""),[E,_]=f.useState(!1),[T,I]=f.useState({displayName:"",bio:"",location:"",website:"",birthDate:""});f.useEffect(()=>{p(e,null,function*(){try{const e=Pb.currentUser;let r=t||(null==e?void 0:e.uid);if(!r)return void s("/login");let n=r,a=null;const l=ex(Lb,"users",r),c=yield nv(l);if(c.exists())n=r,a=c.data();else if(t){const e=Vx(Zg(Lb,"users"),$x("username","==",t)),s=yield av(e);if(!s.empty){const e=s.docs[0];n=e.id,a=e.data()}}if(_((null==e?void 0:e.uid)===n),a)i(a),I({displayName:a.displayName||"",bio:a.bio||"",location:a.location||"",website:a.website||"",birthDate:a.birthDate||""});else if(t){const e=decodeURIComponent(t).replace(/-/g," ");i({displayName:e,username:t}),I(t=>u(d({},t),{displayName:e})),n=t}const h=Vx(Zg(Lb,"posts"),$x("userId","==",n),Hx("createdAt","desc")),m=(yield av(h)).docs.map(e=>d({id:e.id},e.data()));o(m)}catch(e){j("Erro ao carregar dados do perfil")}finally{c(!1)}})},[t,s]);const A=e=>{const{name:t,value:s}=e.target;I(e=>u(d({},e),{[t]:s}))},P=e=>e?new Date(e).toLocaleDateString("pt-BR",{year:"numeric",month:"long",day:"numeric"}):"",R=e=>{if(!e)return"";const t=new Date(e),s=new Date,r=Math.floor((s-t)/36e5);return r<1?"Agora mesmo":r<24?`${r}h`:r<48?"Ontem":t.toLocaleDateString("pt-BR",{day:"numeric",month:"short"})};return l?Je.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:Je.jsx("div",{className:"text-white",children:"Carregando perfil..."})}):Je.jsxs("div",{className:"min-h-screen bg-black text-white",children:[Je.jsx("div",{className:"bg-black/95 backdrop-blur-sm border-b border-white/10 sticky top-0 z-50",children:Je.jsx("div",{className:"max-w-2xl mx-auto px-4",children:Je.jsxs("div",{className:"flex items-center justify-between h-16",children:[Je.jsxs("button",{onClick:()=>s(-1),className:"flex items-center space-x-2 text-white/70 hover:text-white transition-colors",children:[Je.jsx(O,{className:"w-5 h-5"}),Je.jsx("span",{children:"Voltar"})]}),Je.jsx("h1",{className:"text-xl font-light",children:"Perfil"}),Je.jsx("div",{className:"w-20"})]})})}),Je.jsxs("div",{className:"max-w-2xl mx-auto",children:[N&&Je.jsx("div",{className:"mx-4 mt-4 p-4 bg-red-500/20 border border-red-500/30 rounded-xl text-red-300",children:N}),C&&Je.jsx("div",{className:"mx-4 mt-4 p-4 bg-green-500/20 border border-green-500/30 rounded-xl text-green-300",children:C}),Je.jsx("div",{className:"relative h-48 bg-white",children:E&&Je.jsxs("label",{className:"absolute top-4 right-4 bg-black/50 hover:bg-black/70 p-2 rounded-full cursor-pointer transition-all duration-300 backdrop-blur-md",children:[Je.jsx("input",{type:"file",accept:"image/*",onChange:t=>p(e,null,function*(){if(t.target.files[0]){y(!0);try{k("Banner atualizado com sucesso!")}catch(e){j("Erro ao fazer upload do banner")}finally{y(!1)}}}),className:"hidden",disabled:b}),b?Je.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):Je.jsx(K,{className:"w-5 h-5 text-white"})]})}),Je.jsxs("div",{className:"px-4 -mt-16 relative z-10",children:[Je.jsxs("div",{className:"relative inline-block",children:[Je.jsx("div",{className:"w-32 h-32 rounded-full bg-white/10 border-4 border-black overflow-hidden",children:(null==n?void 0:n.photoURL)?Je.jsx("img",{src:n.photoURL,alt:"Foto de perfil",className:"w-full h-full object-cover"}):Je.jsx(J,{className:"w-full h-full text-white/50 p-8"})}),E&&Je.jsxs("label",{className:"absolute bottom-0 right-0 bg-black/50 hover:bg-black/70 p-2 rounded-full cursor-pointer transition-all duration-300 backdrop-blur-md",children:[Je.jsx("input",{type:"file",accept:"image/*",onChange:t=>p(e,null,function*(){var e,s;const n=t.target.files[0];if(n){x(!0);try{const t=null==(e=null==r?void 0:r.backend)?void 0:e.id,i=(null==r?void 0:r.idToken)||(yield null==(s=Pb.currentUser)?void 0:s.getIdToken());if(!t)throw new Error("Usuário do backend não identificado");yield Jy.uploadProfilePhoto(n,t,i),k("Foto de perfil atualizada com sucesso!")}catch(i){j("Erro ao fazer upload da foto")}finally{x(!1)}}}),className:"hidden",disabled:g}),g?Je.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):Je.jsx(Y,{className:"w-5 h-5 text-white"})]})]}),E&&Je.jsx("div",{className:"flex justify-end mt-4",children:h?Je.jsxs("div",{className:"flex space-x-2",children:[Je.jsxs("button",{onClick:()=>p(e,null,function*(){try{j(""),k("");const e=Pb.currentUser;if(!e)return;const t=ex(Lb,"users",e.uid);yield lv(t,u(d({},T),{updatedAt:new Date})),k("Perfil atualizado com sucesso!"),m(!1),i(e=>d(d({},e),T))}catch(e){j("Erro ao atualizar perfil. Tente novamente.")}}),className:"bg-white text-black px-4 py-2 rounded-full font-medium hover:bg-white/90 transition-all duration-300 flex items-center space-x-2",children:[Je.jsx(Pe,{className:"w-4 h-4"}),Je.jsx("span",{children:"Salvar"})]}),Je.jsxs("button",{onClick:()=>m(!1),className:"bg-transparent border border-white/30 text-white px-4 py-2 rounded-full font-medium hover:bg-white/10 transition-all duration-300 flex items-center space-x-2",children:[Je.jsx(v,{className:"w-4 h-4"}),Je.jsx("span",{children:"Cancelar"})]})]}):Je.jsxs("button",{onClick:()=>m(!0),className:"bg-transparent border border-white/30 text-white px-4 py-2 rounded-full font-medium hover:bg-white/10 transition-all duration-300 flex items-center space-x-2",children:[Je.jsx(ue,{className:"w-4 h-4"}),Je.jsx("span",{children:"Editar perfil"})]})}),Je.jsxs("div",{className:"mt-4",children:[Je.jsx("h2",{className:"text-2xl font-bold",children:h?Je.jsx("input",{type:"text",name:"displayName",value:T.displayName,onChange:A,className:"bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 w-full",placeholder:"Seu nome"}):(null==n?void 0:n.displayName)||"Usuário"}),Je.jsxs("p",{className:"text-white/70 mt-1",children:["@",(null==n?void 0:n.username)||"usuario"]}),h?Je.jsx("textarea",{name:"bio",value:T.bio,onChange:A,rows:3,className:"mt-4 bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 w-full resize-none",placeholder:"Conte um pouco sobre você..."}):Je.jsx("p",{className:"text-white mt-4",children:(null==n?void 0:n.bio)||"Nenhuma biografia adicionada"}),Je.jsx("div",{className:"mt-4 space-y-2",children:h?Je.jsxs(Je.Fragment,{children:[Je.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Je.jsx(S,{className:"w-4 h-4"}),Je.jsx("input",{type:"text",name:"location",value:T.location,onChange:A,className:"bg-transparent border-none text-white/70 placeholder-white/50 focus:outline-none focus:ring-0 flex-1",placeholder:"Adicionar localização"})]}),Je.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Je.jsx(qe,{className:"w-4 h-4"}),Je.jsx("input",{type:"url",name:"website",value:T.website,onChange:A,className:"bg-transparent border-none text-white/70 placeholder-white/50 focus:outline-none focus:ring-0 flex-1",placeholder:"Adicionar website"})]}),Je.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Je.jsx(F,{className:"w-4 h-4"}),Je.jsx("input",{type:"date",name:"birthDate",value:T.birthDate,onChange:A,className:"bg-transparent border-none text-white/70 placeholder-white/50 focus:outline-none focus:ring-0 flex-1"})]})]}):Je.jsxs(Je.Fragment,{children:[(null==n?void 0:n.location)&&Je.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Je.jsx(S,{className:"w-4 h-4"}),Je.jsx("span",{children:n.location})]}),(null==n?void 0:n.website)&&Je.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Je.jsx(qe,{className:"w-4 h-4"}),Je.jsx("a",{href:n.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline",children:n.website})]}),(null==n?void 0:n.birthDate)&&Je.jsxs("div",{className:"flex items-center space-x-2 text-white/70",children:[Je.jsx(F,{className:"w-4 h-4"}),Je.jsxs("span",{children:["Nascido em ",P(n.birthDate)]})]})]})}),Je.jsxs("div",{className:"mt-4 text-white/70",children:["Entrou em ",P(null==n?void 0:n.createdAt)]})]})]}),Je.jsxs("div",{className:"mt-8 border-t border-white/10",children:[Je.jsx("div",{className:"px-4 py-4",children:Je.jsx("h3",{className:"text-xl font-bold",children:"Posts"})}),0===a.length?Je.jsxs("div",{className:"px-4 py-8 text-center",children:[Je.jsx("p",{className:"text-white/50",children:"Nenhum post ainda"}),Je.jsx("p",{className:"text-white/30 text-sm mt-2",children:"Quando você postar algo, aparecerá aqui"})]}):Je.jsx("div",{className:"space-y-0",children:a.map(e=>Je.jsx("div",{className:"border-b border-white/10 p-4 hover:bg-white/5 transition-colors",children:Je.jsxs("div",{className:"flex space-x-3",children:[Je.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-full flex items-center justify-center flex-shrink-0",children:(null==n?void 0:n.photoURL)?Je.jsx("img",{src:n.photoURL,alt:"",className:"w-full h-full rounded-full object-cover"}):Je.jsx(J,{className:"w-6 h-6 text-white/50"})}),Je.jsxs("div",{className:"flex-1 min-w-0",children:[Je.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[Je.jsx("span",{className:"font-bold text-white",children:(null==n?void 0:n.displayName)||"Usuário"}),Je.jsxs("span",{className:"text-white/50",children:["@",(null==n?void 0:n.username)||"usuario"]}),Je.jsx("span",{className:"text-white/50",children:"•"}),Je.jsx("span",{className:"text-white/50",children:R(e.createdAt)})]}),Je.jsx("p",{className:"text-white mb-3",children:e.content}),e.image&&Je.jsx("div",{className:"mb-3 rounded-xl overflow-hidden",children:Je.jsx("img",{src:e.image,alt:"",className:"w-full max-h-96 object-cover"})}),Je.jsxs("div",{className:"flex items-center space-x-8 text-white/50",children:[Je.jsxs("button",{className:"flex items-center space-x-2 hover:text-blue-400 transition-colors",children:[Je.jsx(D,{className:"w-5 h-5"}),Je.jsx("span",{children:e.commentCount||0})]}),Je.jsxs("button",{className:"flex items-center space-x-2 hover:text-red-400 transition-colors",children:[Je.jsx(w,{className:"w-5 h-5"}),Je.jsx("span",{children:Array.isArray(e.likes)?e.likes.length:0})]}),Je.jsx("button",{className:"flex items-center space-x-2 hover:text-green-400 transition-colors",children:Je.jsx($,{className:"w-5 h-5"})})]})]})]})},e.id))})]})]})]})},lN=f.createContext(),cN=({children:t})=>{const{user:s}=Vb(),[r,n]=f.useState([]),[i,a]=f.useState(!1),[o,l]=f.useState(null),c=f.useCallback(()=>p(e,null,function*(){if(s){a(!0),l(null);try{const e=yield ly.getUserPosts(s.uid,100,s.uid);n(e)}catch(e){l("Erro ao carregar posts do usuário")}finally{a(!1)}}}),[s]),u=f.useCallback(e=>{n(t=>[e,...t])},[]),h=f.useCallback((e,t)=>{n(s=>s.map(s=>s.id===e?d(d({},s),t):s))},[]),m=f.useCallback(e=>{n(t=>t.filter(t=>t.id!==e))},[]),g=f.useCallback(()=>{c()},[c]);f.useEffect(()=>{s?c():n([])},[s,c]);const x={userPosts:r,loading:i,error:o,addUserPost:u,updateUserPost:h,removeUserPost:m,refreshUserPosts:g,loadUserPosts:c};return Je.jsx(lN.Provider,{value:x,children:t})},dN=({children:e})=>{const{user:t,loading:s}=Vb();return s?Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("div",{className:"text-white ml-3",children:"Carregando..."})]}):t?e:Je.jsx(Kt,{to:"/login",replace:!0})},uN=({children:e})=>{const{user:t,loading:s}=Vb();return s?Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("div",{className:"text-white ml-3",children:"Carregando..."})]}):t?"psicologo"!==t.role?Je.jsx(Kt,{to:"/home",replace:!0}):e:Je.jsx(Kt,{to:"/login",replace:!0})},hN=({children:e})=>{const{user:t,loading:s,needsProfileCompletion:r}=Vb();return s?Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("div",{className:"text-white ml-3",children:"Carregando..."})]}):t?r?Je.jsx(Kt,{to:"/complete-profile",replace:!0}):e:Je.jsx(Kt,{to:"/login",replace:!0})},mN=[{path:"/",element:Je.jsx(Qb,{}),public:!0,title:"Sereno - Início"},{path:"/login",element:Je.jsx(Fy,{}),public:!0,title:"Sereno - Login"},{path:"/register",element:Je.jsx(nN,{}),public:!0,title:"Sereno - Registro"},{path:"/connected",element:Je.jsx(gy,{}),public:!0,title:"Sereno - Conectado"},{path:"/complete-profile",element:Je.jsx(dN,{children:Je.jsx(fy,{})}),protected:!0,title:"Sereno - Completar Perfil",category:"profile"},{path:"/home",element:Je.jsx(hN,{children:Je.jsx(cN,{children:Je.jsx(Wy,{children:Je.jsx(Oy,{})})})}),protected:!0,title:"Sereno - Home",category:"main"},{path:"/psychologist-dashboard",element:Je.jsx(uN,{children:Je.jsx(rN,{})}),protected:!0,title:"Sereno - Dashboard do Psicólogo",category:"psychologist"},{path:"/home/profile",element:Je.jsx(hN,{children:Je.jsx(cN,{children:Je.jsx(Wy,{children:Je.jsx(Yy,{})})})}),protected:!0,title:"Sereno - Meu Perfil",category:"main"},{path:"/home/sessions",element:Je.jsx(hN,{children:Je.jsx(Wy,{children:Je.jsx(aN,{})})}),protected:!0,title:"Sereno - Sessões de Terapia",category:"main"},{path:"/home/diary",element:Je.jsx(hN,{children:Je.jsx(Wy,{children:Je.jsx(vy,{})})}),protected:!0,title:"Sereno - Diário Evolutivo",category:"main"},{path:"/home/humor",element:Je.jsx(hN,{children:Je.jsx(Wy,{children:Je.jsx(My,{})})}),protected:!0,title:"Sereno - Rastreador de Humor",category:"main"},{path:"/home/chat/:roomCode",element:Je.jsx(hN,{children:Je.jsx(Wy,{children:Je.jsx(Uy,{})})}),protected:!0,title:"Sereno - Chat ao Vivo",category:"main"},{path:"/home/chat",element:Je.jsx(hN,{children:Je.jsx(Wy,{children:Je.jsx(Uy,{})})}),protected:!0,title:"Sereno - Chat ao Vivo",category:"main"},{path:"/home/groups",element:Je.jsx(hN,{children:Je.jsx(cN,{children:Je.jsx(Wy,{children:Je.jsx(Zw,{})})})}),protected:!0,title:"Sereno - Grupos",category:"main"},{path:"/home/notifications",element:Je.jsx(hN,{children:Je.jsx(Wy,{children:Je.jsx(Ky,{})})}),protected:!0,title:"Sereno - Notificações",category:"main"},{path:"/home/settings",element:Je.jsx(hN,{children:Je.jsx(Wy,{children:Je.jsx(iN,{})})}),protected:!0,title:"Sereno - Configurações",category:"main"},{path:"/profile",element:Je.jsx(hN,{children:Je.jsx(cN,{children:Je.jsx(Yy,{})})}),protected:!0,title:"Sereno - Meu Perfil",category:"main"},{path:"/profile/:userId",element:Je.jsx(hN,{children:Je.jsx(Yy,{})}),protected:!0,title:"Sereno - Perfil",category:"main"},{path:"/user/:userId",element:Je.jsx(hN,{children:Je.jsx(oN,{})}),protected:!0,title:"Sereno - Perfil do Usuário",category:"main"},{path:"/welcome-tour",element:Je.jsx(hN,{children:Je.jsx(Gy,{})}),protected:!0,title:"Sereno - Tour de Boas-vindas",category:"main"},{path:"/groups",element:Je.jsx(hN,{children:Je.jsx(Zw,{})}),protected:!0,title:"Sereno - Grupos",category:"community"},{path:"/explore",element:Je.jsx(hN,{children:Je.jsx(by,{})}),protected:!0,title:"Sereno - Explorar Comunidades",category:"community"},{path:"/community/:communityId",element:Je.jsx(hN,{children:Je.jsx(Jb,{})}),protected:!0,title:"Sereno - Comunidade",category:"community"},{path:"/humor-tracker",element:Je.jsx(hN,{children:Je.jsx(My,{})}),protected:!0,title:"Sereno - Rastreador de Humor",category:"mental-health"},{path:"/therapy-sessions",element:Je.jsx(hN,{children:Je.jsx(aN,{})}),protected:!0,title:"Sereno - Sessões de Terapia",category:"mental-health"},{path:"/live-chat",element:Je.jsx(hN,{children:Je.jsx(Uy,{})}),protected:!0,title:"Sereno - Chat ao Vivo",category:"communication"},{path:"/chat/:roomCode",element:Je.jsx(hN,{children:Je.jsx(Uy,{})}),protected:!0,title:"Sereno - Chat",category:"communication"},{path:"/post/:postId",element:Je.jsx(hN,{children:Je.jsx(Qy,{})}),protected:!0,title:"Sereno - Post",category:"communication"},{path:"/settings",element:Je.jsx(hN,{children:Je.jsx(iN,{})}),protected:!0,title:"Sereno - Configurações",category:"settings"},{path:"/notifications",element:Je.jsx(hN,{children:Je.jsx(Ky,{})}),protected:!0,title:"Sereno - Notificações",category:"settings"},{path:"*",element:Je.jsx(Kt,{to:"/",replace:!0}),public:!0,title:"Sereno - Página não encontrada"}],pN=document.getElementById("root"),fN=pN?Qe(pN):null;function gN(){const{user:e,loading:t}=Vb();return t?Je.jsxs("div",{className:"min-h-screen bg-black flex items-center justify-center",children:[Je.jsx("div",{className:"loading-spinner"}),Je.jsx("div",{className:"text-white ml-3",children:"Carregando..."})]}):Je.jsx(Yt,{children:mN.map(e=>Je.jsx(Qt,{path:e.path,element:e.element},e.path))})}fN&&fN.render(Je.jsx(f.StrictMode,{children:Je.jsx(bs,{children:Je.jsx(Fb,{children:Je.jsx(gN,{})})})}))}},function(){return Je||(0,Qe[r(Qe)[0]])((Je={exports:{}}).exports,Je),Je.exports});export default Ye();
